<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www2.lib.uchicago.edu/keith/emacs/">Original</a>
    <h1>Use GNU Emacs</h1>
    
    <div id="readability-page-1" class="page"><div id="outline-container-org5f0c440">

<div id="text-org5f0c440">
<blockquote>
<p>
Using Emacs is kind of like making a piece of art.  You start with a big block
and you slowly chip away, bringing it closer and closer to what you want. —
<a href="https://usesthis.com/interviews/mary.rose.cook/"><i>Mary Rose Cook</i></a>
</p>
</blockquote>

<blockquote>
<p>
[Emacs is] a Lisp Machine with several compatible user interface modalities.
Which is just amazingly helpful to [blind] people like me […] who are
typically forgotten about these days. […]  Emacs is a shining beacon in a dark
age of canvases and decorative user interface design. — <a href="https://lists.gnu.org/archive/html/emacs-devel/2020-09/msg01260.html"><i>Mario Lang</i></a>
</p>
</blockquote>

<blockquote>
<p>
It wouldn’t make sense to start out with anything other than Emacs.  I don’t
think there has been a piece of software which has had a larger impact on my
life.  I began using this about fifteen years ago, and it has followed me across
operating systems, jobs, roles (I used it to manage my teams), languages, and
needs.  Every time I start something new, Emacs has been there to make it just a
little easier, and the more I do in it, the easier everything gets.  I believe
this power comes from Emacs being the closest thing we have to a working Lisp
Machine.  — <a href="https://usesthis.com/interviews/katherine.cox-buday/"><i>Katherine Cox-Buday</i></a>
</p>
</blockquote>

<blockquote>
<p>
Emacs outshines all other editing software in approximately the same
way that the noonday sun does the stars.  It is not just bigger and
brighter; it simply makes everything else vanish.
— <i>Neal Stephenson</i>
</p>
</blockquote>

<blockquote>
<p>
Emacs is the King of Editors because it’s a Lisp interpreter.
Each and every key you tap runs some Emacs Lisp code snippet, and since
Emacs Lisp is an interpreted language, that means that you can configure
any key to run any arbitrary code.  You just, like, do it. — <i>Lars Magne Ingebrigtsen</i>
</p>
</blockquote>

<blockquote>
<p>
I’m using Linux. A library that Emacs uses to communicate with Intel
hardware.  — Erwin, #emacs, Freenode
</p>
</blockquote>

<blockquote>
<p>
OSs and GUIs come and go, only Emacs has lasting power. — <i>Per Abrahamsen</i>
</p>
</blockquote>

<blockquote>
<p>
I am large, I contain multitudes. — <i>Walt Whitman</i>
</p>
</blockquote>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org518a03c">PREFACE</a></li>
<li><a href="#org68588e6"><b>FUNDAMENTALS</b></a>
<ul>
<li><a href="#org92ca48f">Introduction</a>
<ul>
<li><a href="#org0f24f97">What GNU Emacs Is</a></li>
<li><a href="#orgc5a18fe">What GNU Emacs Is Not</a></li>
</ul>
</li>
<li><a href="#org11e39b9">Emacs as Operating System </a></li>
<li><a href="#org070fd65">Quickstart</a>
<ul>
<li><a href="#org86c297a">Installing Emacs</a></li>
<li><a href="#org7a3b6b2">Starting Up and Running Emacs </a></li>
<li><a href="#org0f769a4">Entering Emacs</a></li>
<li><a href="#org3081b84">Exiting Emacs</a></li>
<li><a href="#org4de76ad">What Emacs Looks Like</a>
<ul>
<li><a href="#org1c32782">The Screen</a></li>
<li><a href="#org5e90da7">The Mode Line</a></li>
<li><a href="#org0b79d18">The Echo Area </a></li>
</ul>
</li>
<li><a href="#org368b785">Using Emacs Like It’s Notepad?</a></li>
<li><a href="#org4b9ca28">Configuring Emacs </a></li>
<li><a href="#org6cc4e80">The Built-In Emacs Tutorial </a></li>
</ul>
</li>
<li><a href="#orge733e95">The Fundamental Emacs Concepts </a>
<ul>
<li><a href="#org81cf159">Functions</a></li>
<li><a href="#org089a1d4">The Keyboard and Key Bindings</a></li>
<li><a href="#orgd0207a4">Variables</a></li>
<li><a href="#orgef94a1e">Discovery, Help and Completion</a></li>
<li><a href="#org4cef90f">Buffers</a></li>
<li><a href="#org93fc1dc">Plain Text</a></li>
<li><a href="#orge6b125f">Windows</a></li>
<li><a href="#orgdccbf7d">Search</a></li>
<li><a href="#org319a0da">Undo and Redo</a></li>
<li><a href="#org2cfc95a">Major and Minor Modes</a></li>
<li><a href="#org1218139">Customization</a></li>
<li><a href="#org5bfa59e">Programmabililty</a></li>
<li><a href="#org1f8f36a">Free Software</a></li>
</ul>
</li>
<li><a href="#org8dd614c">The Keyboard and Key Bindings </a>
<ul>
<li><a href="#org696d674">Notation</a></li>
<li><a href="#orge0695d4">Simple Keys</a></li>
<li><a href="#orgb193780">Prefix or Compound Keys </a></li>
<li><a href="#orgd8dfff8">Aborting a Command </a></li>
<li><a href="#org94d0389">Using Extended Commands</a></li>
<li><a href="#org9db2da1">Too Many Commands?</a></li>
<li><a href="#org890d810">Giving Commands Arguments </a></li>
<li><a href="#org1096803">Disabled Commands </a></li>
<li><a href="#orge9bdd97">Felicity in Key Bindings </a></li>
<li><a href="#org0945e19">About Mouse Bindings</a></li>
</ul>
</li>
<li><a href="#org83330ca">Files, Buffers and Windows in Brief</a>
<ul>
<li><a href="#orgefe16aa">Basic File Concepts and Commands</a></li>
<li><a href="#org48369b5">Basic Commands to Manipulate Buffers </a></li>
<li><a href="#org44a8629">Basic Commands to Manipulate Windows </a>
<ul>
<li><a href="#org14597bf">Create a New Window</a></li>
<li><a href="#org8058223">Delete a Window</a></li>
<li><a href="#org46519cc">Resize Windows</a></li>
<li><a href="#orgcd34868">Switch Windows</a></li>
<li><a href="#org782cfcc">Scroll Within a Window </a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org0d4f158">Selecting Text: the Point, the Mark, and the Region </a>
<ul>
<li><a href="#org93ec176">The Point </a></li>
<li><a href="#org357d96a">The Mark </a></li>
<li><a href="#orgb1d3ecc">The Region </a></li>
</ul>
</li>
<li><a href="#org01245f1">Cutting, Copying, and Pasting </a>
<ul>
<li><a href="#org13df4de">Welcome back!</a></li>
<li><a href="#org36f3138">The Kill Ring </a></li>
<li><a href="#org3fa2e1a">Yanking Older Kills (“Clipboard History”) </a></li>
<li><a href="#org7f0cfb5">Undoing a Yank</a></li>
<li><a href="#org32961f2">I Can’t Picture This!</a></li>
<li><a href="#orgbac1e59">Other Ways to Set the Region</a></li>
<li><a href="#org37112ab">Appending to a Kill</a></li>
<li><a href="#org82b0609">The Clipboard </a></li>
<li><a href="#org2eba956">CUA Mode </a></li>
</ul>
</li>
<li><a href="#orgf04ada7">Editing with Textual Objects </a>
<ul>
<li><a href="#org451e311">Shift Selection</a></li>
<li><a href="#org372754f">Transposing and Dragging Objects </a></li>
<li><a href="#org72662b3">Characters, Words, and Lines</a>
<ul>
<li><a href="#orgac7a55a">Characters</a></li>
<li><a href="#org485bf3d">Words</a></li>
<li><a href="#orgb3fc2b6">Lines</a></li>
</ul>
</li>
<li><a href="#org8ded883">Prose Objects: Sentences and Paragraphs</a>
<ul>
<li><a href="#orgbb59cb2">Sentences</a></li>
<li><a href="#org8e1ba01">Paragraphs</a></li>
</ul>
</li>
<li><a href="#org243de2a">Larger Objects: Pages and Buffers </a></li>
<li><a href="#orgd49d8e7">Code Objects: Balanced Parentheses and Function Definitions</a></li>
<li><a href="#org6bf89c6">Extending Kills </a></li>
<li><a href="#orgc9f20d5">Adjusting the Region</a></li>
</ul>
</li>
<li><a href="#orge5ab769">Other Ways to Move Around</a>
<ul>
<li><a href="#org630cc03">Move by Searching</a></li>
<li><a href="#orgec67d8d">Follow a Breadcrumb Trail (The Mark Ring)</a>
<ul>
<li><a href="#orgd963645">The Global Mark Ring</a></li>
</ul>
</li>
<li><a href="#org4817b54">Move Via Your History of Changes </a></li>
<li><a href="#orga307de7">Mode-specific Motion</a></li>
<li><a href="#org0c1b4ec">Move by Scrolling</a></li>
<li><a href="#org1085978">Goto Commands </a></li>
</ul>
</li>
<li><a href="#orge03e083">Variables and Symbols </a>
<ul>
<li><a href="#org5fadeb9">What Are These Variables For?</a></li>
<li><a href="#org3655271">Types of Variable Values</a></li>
<li><a href="#org29e12c6">Inspecting Variables</a></li>
<li><a href="#org26ccb3a">Changing the Value of a Variable</a></li>
<li><a href="#orgc1d8417">Buffer-Local Variables</a>
<ul>
<li><a href="#orgb76b176">File- and Directory-Local Variables </a></li>
<li><a href="#orgdb8f0c6">Hooks </a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org7f25cea">Help, Discovery, and Documentation</a>
<ul>
<li><a href="#orgf45ccaa">Help </a>
<ul>
<li><a href="#orgbd88b75">The Help Buffer</a></li>
<li><a href="#orgd0c821e">Parsing the Help Buffer</a></li>
<li><a href="#org34fde42">Help for a Variable</a></li>
<li><a href="#org5a3f32b">Help for a Mode</a></li>
</ul>
</li>
<li><a href="#orgbf1c14f">Discoverability via Apropos </a>
<ul>
<li><a href="#org9fc26e5">The Apropos Query Language</a></li>
</ul>
</li>
<li><a href="#orgfcd64ec">Additional Information</a></li>
</ul>
</li>
<li><a href="#org4232dab">Info: The Emacs Documentation Reader </a>
<ul>
<li><a href="#org6d3bb90">Hyperlinks</a></li>
<li><a href="#org55bb1d4">Menus </a></li>
<li><a href="#orgb9d2090">Searching</a></li>
<li><a href="#org13cc7ef">Indexes</a></li>
<li><a href="#org0f9efd2">Higher-Level Navigation</a></li>
<li><a href="#org96e3314">Write Your Own Manual</a></li>
</ul>
</li>
<li><a href="#orgc7c22ed">Messages, Errors, and Lossage</a>
<ul>
<li><a href="#org3a12fe4">Messages</a></li>
<li><a href="#org0a66385">What Just Happened?</a></li>
</ul>
</li>
<li><a href="#orgdd4a756">The Minibuffer </a>
<ul>
<li><a href="#org0e8546c">Minibuffer History </a></li>
<li><a href="#orga206f64"><i>Future</i> History</a></li>
<li><a href="#orge870079">Recursive Minibuffers</a></li>
<li><a href="#org8886ef5">Temporary Excursions</a></li>
<li><a href="#org422ffdb">Repeating Complex Commands</a></li>
<li><a href="#orgd358f17">An Aside Concerning Completion Frameworks</a></li>
</ul>
</li>
<li><a href="#org3c9b664">Completion </a>
<ul>
<li><a href="#org96b6507">A Shortcut to Completion </a></li>
<li><a href="#org19f68d1">Done!</a></li>
<li><a href="#orgf93a41c">Complementary Packages </a></li>
<li><a href="#orgcd8ef1f">Other Incremental Narrowing Frameworks </a>
<ul>
<li><a href="#org39f512b">Third-Party INFs</a></li>
</ul>
</li>
<li><a href="#org203daa3">Completion in Normal Buffers</a></li>
<li><a href="#orgfcb2139">References</a></li>
</ul>
</li>
<li><a href="#org75f9f72">What is Text? </a>
<ul>
<li><a href="#org688c9e8">The Structure of Text </a></li>
<li><a href="#org5843dca">What <i>Isn’t</i> Text? </a></li>
<li><a href="#org69d53e6">Inserting Non-Printing Characters </a></li>
</ul>
</li>
<li><a href="#orgeedc5fe">Buffers </a>
<ul>
<li><a href="#org4d6d199">Switching Buffers </a></li>
<li><a href="#orge971051">The Tab Line </a></li>
<li><a href="#org52f9d54">Creating Buffers</a></li>
<li><a href="#org937d530">To Save or Not to Save</a></li>
<li><a href="#org2993d89">Buffer Names</a>
<ul>
<li><a href="#orgfa4060a">Asterisks</a></li>
<li><a href="#org878f400">Hidden Buffers </a></li>
</ul>
</li>
<li><a href="#org212f59a">The Default Directory</a></li>
<li><a href="#org8f19b47">Reverting Buffers</a></li>
<li><a href="#orge6d7f6d">Killing Buffers</a></li>
<li><a href="#orgabea527">Buffer Menus</a></li>
<li><a href="#orge399863">Narrowing </a></li>
</ul>
</li>
<li><a href="#orgc206819">Modes, Major and Minor </a>
<ul>
<li><a href="#org9e3af5e">How a Mode Happens to Your File</a>
<ul>
<li><a href="#orge81d3a0">Mode via File-Local Variable</a></li>
<li><a href="#org8b36c09">Mode via Shebang, or Interpreter Directive</a></li>
<li><a href="#org02c7b3d">Mode via Filename</a></li>
<li><a href="#org10e994f">Mode via Magic Fallback </a></li>
<li><a href="#org71ed7cc">The Last Resort</a></li>
</ul>
</li>
<li><a href="#org7fea640">Setting the Mode Explicitly </a></li>
<li><a href="#org3b99fd6">Help for Your Mode</a></li>
<li><a href="#org1b4e7dc">Customizing Modes</a></li>
<li><a href="#org7a63b4b">Derived Modes and Inheritance</a></li>
<li><a href="#org20775fb">Basic Major Modes</a>
<ul>
<li><a href="#org7c881ce"><code>fundamental-mode</code> </a></li>
<li><a href="#orgdc1eb66"><code>text-mode</code></a></li>
<li><a href="#orgc22075c"><code>outline-mode</code></a></li>
</ul>
</li>
<li><a href="#org954b271">Programming Language Modes</a></li>
<li><a href="#org9f3206a">Application Modes</a></li>
<li><a href="#org2ae80ff">Minor Modes </a></li>
</ul>
</li>
<li><a href="#org3a08627">Application Buffers </a></li>
<li><a href="#org88770b5"><span>UNFINISHED</span> Windows </a>
<ul>
<li><a href="#orgfde58b2">Splitting Windows</a></li>
<li><a href="#org6e199c8">Deleting Windows</a></li>
<li><a href="#org2f2d7ef">Switching Windows </a></li>
<li><a href="#org3784a91"><span>UNFINISHED</span> Quitting Windows </a></li>
<li><a href="#org6dbd37f">Window Configurations </a></li>
<li><a href="#org8f973be">The Tab Bar </a></li>
<li><a href="#org266ae82">Tweaking Window Sizes</a></li>
<li><a href="#org57d5919">Vertical Scrolling </a></li>
<li><a href="#orga27f788">Where in the Window is Point?</a></li>
<li><a href="#orge230032">The Display of Lines </a>
<ul>
<li><a href="#org866cae3">Continuation Lines</a></li>
<li><a href="#org203b928">Line Truncation</a></li>
<li><a href="#org869de6f">Visual Line Mode</a></li>
<li><a href="#org8445994">The Horizontal Scroll Bar: the Last Resort?</a></li>
</ul>
</li>
<li><a href="#orgff9fb74">The Header Line </a></li>
<li><a href="#orgf8a70bd">The Fringes </a></li>
<li><a href="#org657906c">Follow Mode </a></li>
<li><a href="#org6c5ec86">Scrolling Many Different Buffers at Once</a></li>
</ul>
</li>
<li><a href="#org9f7e44e">The Mode Line in Detail </a>
<ul>
<li><a href="#org4afe067"><i>C</i> — Coding Systems</a></li>
<li><a href="#orgfe22524"><i>E</i> — End-of-Line Encodings</a></li>
<li><a href="#org3e6a01c"><i>F</i> — Client Frame Indicator</a></li>
<li><a href="#org1eb78f8"><i>B</i> — Buffer State</a></li>
<li><a href="#org0e126af"><i>BUF</i> — Buffer Name</a></li>
<li><a href="#orgcb13fb6"><i>POS</i> — Visible Text Position</a></li>
<li><a href="#org340ca86"><i>LINE</i> — Point’s Line Number</a></li>
<li><a href="#orgdf69c3a"><i>VC</i> — Version Control State </a></li>
<li><a href="#org3f6cab7"><i>MAJOR</i> — Major Mode Name</a></li>
<li><a href="#org9e78b85"><i>MINOR</i> — Minor Modes</a></li>
<li><a href="#org4c1a662">The Mode Line and the Mouse</a></li>
<li><a href="#orga9b8918">Optional Mode Line Features </a></li>
</ul>
</li>
<li><a href="#org5cc0ca4">Frames </a>
<ul>
<li><a href="#orgf9e2ed2">Frame Commands</a></li>
<li><a href="#org4601457">Frames and Monitors</a></li>
<li><a href="#orgb17b652">Controlling Graphical Window Elements</a></li>
<li><a href="#org8756525">Customizing Frame Appearance</a></li>
<li><a href="#orgef64a25">Saving Frame Configurations</a></li>
<li><a href="#orge4cd298">Frames in Non-Graphical Mode</a></li>
</ul>
</li>
<li><a href="#org4c5bcc5">Files </a>
<ul>
<li><a href="#org707496a">Visiting Files </a></li>
<li><a href="#orgb7414c0">Find File at Point </a></li>
<li><a href="#org3047448">Persisting Files Across Sessions</a></li>
<li><a href="#org385a1cd">Large Files </a></li>
<li><a href="#org998a2d0">Saving Files </a></li>
<li><a href="#orgaa35628">Read-Only Buffers, or, Emacs is More </a></li>
<li><a href="#orge054767">Reverting Buffers </a></li>
<li><a href="#orgfb086ab">Auto-Reverting (Watching Files) </a></li>
<li><a href="#org6b89c4a">Backup Files </a></li>
<li><a href="#org5e873e9">Auto-Save Files </a></li>
<li><a href="#orgaffd2cc">Lock Files</a></li>
<li><a href="#org3323fc2">Files Modified Behind Emacs’s Back </a></li>
<li><a href="#org018d07b">Compressed Files </a></li>
<li><a href="#org62a3867">Encrypted Files </a></li>
<li><a href="#org48098c0">Archive Files </a></li>
<li><a href="#orgf605164">Document Files (PDFs and the Like) </a>
<ul>
<li><a href="#org02c655d">Toggling the Display Mode</a></li>
<li><a href="#org6c3210d">Just the Text, Please</a></li>
<li><a href="#org516ce5f">Searching</a></li>
<li><a href="#org5d9b1ef">Slicing</a></li>
<li><a href="#org1b65907">Better PDF Handling with PDF Tools </a></li>
</ul>
</li>
<li><a href="#org049bf33">Image Files </a>
<ul>
<li><a href="#org938f2c4">Browsing Images</a></li>
<li><a href="#org840f53f">Resizing Images and Animations</a></li>
</ul>
</li>
<li><a href="#org15c9d7c">Binary Data Files </a></li>
<li><a href="#org7684aa5"><span>UNFINISHED</span> Quoting File Names </a></li>
<li><a href="#org680457b"><span>UNFINISHED</span> Filesets </a></li>
<li><a href="#orga26731e">References</a></li>
</ul>
</li>
<li><a href="#org2daaa5a">Directory Editing with Dired </a>
<ul>
<li><a href="#org4251264">Basic File Operations</a></li>
<li><a href="#orgb3a35b7">Subdirectories</a></li>
<li><a href="#org0db6c6e">Compressing and Archiving Files</a></li>
<li><a href="#orgdb9a4a3">Deleting Files by <i>Flagging</i></a></li>
<li><a href="#org863debf">Marking Files </a></li>
<li><a href="#orgdc01d52">The Mark Keymap</a></li>
<li><a href="#org51aa8f7">Mass Name Changes by Regular Expression </a></li>
<li><a href="#orge752a09">What Went Wrong? </a></li>
<li><a href="#org0a08813">Writable Dired </a></li>
<li><a href="#orgc0aac34">Two-Panel Dired </a></li>
<li><a href="#org2b6a3c8">Searching and Replacing</a></li>
<li><a href="#orgc990384">Diffing and Comparing</a></li>
<li><a href="#org5cbc411">Reverting and Sorting the Dired Buffer</a></li>
<li><a href="#org6554940">Omitting Uninteresting Files </a></li>
<li><a href="#org9905c06">Running External Commands </a>
<ul>
<li><a href="#org2a21bc1">What is the nature of the <i>command</i>?</a></li>
<li><a href="#org2df35f2">You mentioned running commands in parallel?</a></li>
</ul>
</li>
<li><a href="#org78ec9b9">Image-Dired </a></li>
<li><a href="#orgbf7bdce">Tagging and Commenting Images</a></li>
<li><a href="#orga9acffc">Remote Directories</a></li>
<li><a href="#org168b8d6">More Dired Entry Points</a></li>
<li><a href="#org35a21b2">Third-Party Directory Tools</a></li>
<li><a href="#orgcd82ef0">References</a></li>
</ul>
</li>
<li><a href="#orgfbe307e">Searching …</a>
<ul>
<li><a href="#org07445cb">Incremental Search </a>
<ul>
<li><a href="#orge699ef6">Failing Searches and Making Corrections</a></li>
<li><a href="#org6b3a411">Editing Your Search</a></li>
<li><a href="#orge714116">Aborting Your Search</a></li>
<li><a href="#org1f9dc3d">Quick Search Exit</a></li>
<li><a href="#org11c931d">Scrolling</a></li>
<li><a href="#org9e3d96f">The Region is Set for Free</a></li>
<li><a href="#org84c0256">Changing Directions</a></li>
<li><a href="#orgf7b7de5">Restarting Your Last Search</a></li>
<li><a href="#orgb5a1ee4">Searching for Funny Characters</a></li>
<li><a href="#orgef652ca">Case Sensitivity and Whitespace </a></li>
<li><a href="#orgf2fd102">Varieties of Isearch</a></li>
<li><a href="#org6a5931d">Nonincremental Search </a></li>
<li><a href="#orgef8b9de">Yanking Into the Search</a></li>
<li><a href="#org5993c2c">Transitioning to Other Search Types</a></li>
<li><a href="#orgbb54cef">Help</a></li>
</ul>
</li>
<li><a href="#org57fc613">Occurrences </a>
<ul>
<li><a href="#org1c71479">Writable Occur, or <code>occur-edit-mode</code> </a></li>
</ul>
</li>
<li><a href="#orgbed46de">Multi-Buffer Searching </a></li>
</ul>
</li>
<li><a href="#org6a0c607">… and Replacing </a>
<ul>
<li><a href="#orge59c295">Query Replace with a Regular Expression </a>
<ul>
<li><a href="#org51be2a2">Elisp Replacement Strings</a></li>
</ul>
</li>
<li><a href="#org608922a">Other Entry Points</a></li>
</ul>
</li>
<li><a href="#org96ce5d7">Meet the Greps </a>
<ul>
<li><a href="#org80d2c22">The <code>*grep*</code> Buffer and Grep Mode </a></li>
<li><a href="#org5a44822"><code>next-error</code> Integration</a></li>
<li><a href="#org5278bce">Indirect Editing with Writable Grep </a></li>
<li><a href="#orgdcaab17">Plain Old <code>M-x grep</code></a></li>
<li><a href="#org5ebc6d9">Local Directory Grep with <code>M-x lgrep</code> </a></li>
<li><a href="#org54c5df0">Recursive Grep with <code>M-x rgrep</code></a></li>
<li><a href="#org3c4ce56">Just the Skeleton with <code>M-x grep-find</code></a></li>
<li><a href="#org34caea8">Grep Files Aliases</a></li>
<li><a href="#orgf2b590d">Grepping from Dired</a></li>
<li><a href="#org5963a3f">Which <code>grep</code> Is It, Really? </a></li>
</ul>
</li>
<li><a href="#org1b6c266">Regular Expressions </a>
<ul>
<li><a href="#org8e808c1">Powerful Pattern Matching</a></li>
<li><a href="#org8d15d2e">Unique Aspects of Emacs Regexps </a>
<ul>
<li><a href="#org7869422">Backslash Constructs</a></li>
</ul>
</li>
<li><a href="#orgb73c956">References </a></li>
</ul>
</li>
<li><a href="#org8bb0469">Unlimited Undo with Redo </a>
<ul>
<li><a href="#orgea92a67">Just Undo It</a></li>
<li><a href="#org4cec3d8">What, When, and Where Can You Undo?</a></li>
<li><a href="#org3df65a2">How Unlimited is Unlimited?</a></li>
<li><a href="#orgaf886b2">Undo in the Region (Selective Undo)</a></li>
<li><a href="#org18a782a">Redo, or Undo the Undos </a></li>
<li><a href="#orgea2a34f">What Can’t You Undo?</a></li>
<li><a href="#orgdd571b8"><code>undo-tree</code> </a></li>
</ul>
</li>
<li><a href="#org77efab3">Approaching Programming: Keyboard Macros </a>
<ul>
<li><a href="#org07cc622">Your First Macro </a></li>
<li><a href="#orgc1c7f7b">Repeating a Macro</a></li>
<li><a href="#orgb460141">Aborting a Macro Definition</a></li>
<li><a href="#orgb029f24">Line-by-Line Macros</a></li>
<li><a href="#org8b578f5">What Happens If You Make a Mistake?</a></li>
<li><a href="#orgcf87f0a">Minibuffer Prompts</a></li>
<li><a href="#org95046b2">The Keyboard Macro Map</a>
<ul>
<li><a href="#org2c4937a">Macro Definition Commands</a></li>
<li><a href="#org1ceda92">The Macro Ring </a></li>
<li><a href="#org680744f">Macro Query</a></li>
<li><a href="#org43b672a">Macro Counters </a></li>
<li><a href="#org3d64727">Editing Your Macro </a></li>
<li><a href="#orgde526af">Debugging Your Macro</a></li>
<li><a href="#orgef55d7c">Naming and Binding Your Macros </a></li>
</ul>
</li>
<li><a href="#org33f1e0e">A Musical Example</a></li>
</ul>
</li>
<li><a href="#orgae24bc9">The Customize Facility </a>
<ul>
<li><a href="#org1d232b7">Entry Points</a></li>
<li><a href="#org5f5fce8">Experiment Without Fear</a></li>
<li><a href="#org63291be">Changing the Value of a Variable</a></li>
<li><a href="#org5e7172c">Customizing Multiple Options</a></li>
<li><a href="#org6ed53be">Customizing a Face </a></li>
<li><a href="#org23a1865">Customize Buffers Are Non-Modal</a></li>
<li><a href="#org4ae6f20">Long-Term Customization Management</a></li>
<li><a href="#org2df481a">Where Are Customizations Saved?</a></li>
<li><a href="#orgd55a240">Customizing Key Bindings</a></li>
</ul>
</li>
<li><a href="#org2e85fab">The Package Manager  </a>
<ul>
<li><a href="#org3ba666d">Configuration</a></li>
<li><a href="#orgefb9cb9">About Packages</a></li>
<li><a href="#org5fe1035">Searching and Browsing</a></li>
<li><a href="#orge2f73e5">Installing Packages</a></li>
<li><a href="#org8478170">Package Maintenance </a></li>
<li><a href="#org8fcf665">Should You Write Your Own Packages?</a></li>
<li><a href="#org7d5f3da">Security Issues</a></li>
</ul>
</li>
<li><a href="#orgcbc267d">Updates and Bugs </a>
<ul>
<li><a href="#orgd3d2569">Emacs Updates</a></li>
<li><a href="#org285bca2">Emacs Bugs </a>
<ul>
<li><a href="#orgf6e610b">Not Emacs’s Fault!</a></li>
<li><a href="#org9c28ae1">Helping Squash Bugs</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgcb54293">Exiting Emacs </a>
<ul>
<li><a href="#org2e0b3b6">The Desktop: Persisting Your Buffers </a></li>
</ul>
</li>
<li><a href="#org729069b">Starting Emacs! </a>
<ul>
<li><a href="#orge196e6a">File Arguments</a></li>
<li><a href="#org72bdab7">Occasional Options</a></li>
<li><a href="#orgf22a128">Scripting Options</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgdaf0c8d"><b>ADDITIONAL TOPICS</b></a>
<ul>
<li><a href="#orgf90c84a">Completion at Point </a>
<ul>
<li><a href="#org41ec069">Dynamic Abbrevs</a>
<ul>
<li><a href="#orgaf2345b">Dabbrevs via the Minibuffer</a></li>
<li><a href="#orgffad858">Hippie Expand</a></li>
</ul>
</li>
<li><a href="#org0a7b773">Pop-up Menu Completion</a></li>
</ul>
</li>
<li><a href="#orgba16ed4">Registers </a>
<ul>
<li><a href="#orgc6b72fc">Register Preview and Contents</a></li>
<li><a href="#orgc941cad">Text in Registers</a></li>
<li><a href="#orgfcdce61">Numbers in Registers</a></li>
<li><a href="#org6d18bd1">Rectangles in Registers</a></li>
<li><a href="#org92820cd">Buffer Positions in Registers</a></li>
<li><a href="#orgca5b97e">Filenames in Registers</a></li>
<li><a href="#orgd09696c">Window and Frame Configurations in Registers</a></li>
<li><a href="#orgec64898">Keyboard Macros in Registers</a></li>
<li><a href="#orgafe75d7">Saving Your Registers </a></li>
</ul>
</li>
<li><a href="#org1a385c3">Rectangles </a>
<ul>
<li><a href="#orgbcec1fe">Inactive Rectangular Regions</a></li>
<li><a href="#org7d99a08">Old- and New-School Rectangle Commands</a></li>
<li><a href="#orgeef9d5b">Empty Rectangles</a></li>
<li><a href="#org95698a5">Yanking Rectangles is Subtle</a></li>
</ul>
</li>
<li><a href="#org569fad0">Bookmarks </a>
<ul>
<li><a href="#org231a697">Bookmark Maintenance with the Bookmark Menu</a></li>
<li><a href="#org8e37556">Bookmark Annotations</a></li>
</ul>
</li>
<li><a href="#org2a3d5ab">Abbreviations </a>
<ul>
<li><a href="#org75ba235">Multi-Word Expansions</a></li>
<li><a href="#org56909a2">Abbrevs and Case</a></li>
<li><a href="#orga7ec0a9">Unexpanding Unhappy Expansions</a></li>
<li><a href="#org11518ad">Prefixed Abbrevs</a></li>
<li><a href="#org5c87f68">Turning <code>abbrev-mode</code> on in Your Init File</a></li>
<li><a href="#orgd2d95ef">Listing and Editing Abbrevs</a></li>
<li><a href="#org034ac0f">Saving Your Abbrevs</a></li>
</ul>
</li>
<li><a href="#orgff5c55d">Recursive Edit </a>
<ul>
<li><a href="#org837b38c">Exiting a Recursive Edit</a></li>
</ul>
</li>
<li><a href="#org9ecc5a9">Visual Display and Color </a>
<ul>
<li><a href="#org052a30e">Fonts and Faces </a>
<ul>
<li><a href="#org68031eb">Changing the Default Font</a></li>
<li><a href="#org43833f4">Changing Fonts on the Fly</a></li>
<li><a href="#org239becf">Text Scale: Changing the Font Size</a></li>
</ul>
</li>
<li><a href="#orgff53b6b">Themes and Colors</a>
<ul>
<li><a href="#org5cd1839">Colors</a></li>
</ul>
</li>
<li><a href="#org023b16e">The Cursor</a>
<ul>
<li><a href="#org01037c7">Emphasizing the Cursor’s Line</a></li>
</ul>
</li>
<li><a href="#org1c98072">Highlighting Text </a>
<ul>
<li><a href="#orgacf4a6c">Hi-Lock Mode</a></li>
</ul>
</li>
<li><a href="#orgcf81a64">Visualizing Whitespace </a></li>
</ul>
</li>
<li><a href="#orgee5f7d0">Manipulating Plain Text </a>
<ul>
<li><a href="#org04c6531">Mass Line Deletions</a></li>
<li><a href="#orgcacb5a2">Sorting Lines</a>
<ul>
<li><a href="#org68f6623">Ignoring Case Distinctions</a></li>
<li><a href="#orgef164c0">Reversing Lines</a></li>
</ul>
</li>
<li><a href="#orgd967049">Numbering Lines</a></li>
<li><a href="#orgec0da97">Whitespace and Blank Lines </a>
<ul>
<li><a href="#org083bff9">Tabs vs. Spaces </a></li>
<li><a href="#orgc8482ca">Horizontal Whitespace</a></li>
<li><a href="#org354b9d1">Blank Lines</a></li>
</ul>
</li>
<li><a href="#org7d353f4">Indenting Lines </a></li>
<li><a href="#org9448bdf">Tabs and Tab Stops </a></li>
<li><a href="#org88fb99c">Case Changing</a></li>
<li><a href="#org0fc6708">Tables</a></li>
<li><a href="#org2064878">References</a></li>
</ul>
</li>
<li><a href="#org71fb38c">Folding Text </a>
<ul>
<li><a href="#org82844ce">Markup-Based Folding</a></li>
<li><a href="#org150678f">Implicit Folding</a>
<ul>
<li><a href="#orgfba68e9">Hideshow Minor Mode</a></li>
<li><a href="#org884dfb9">Yafolding Mode </a></li>
<li><a href="#orgea88240">Selective Display</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orga19d683">International Character Set Support </a>
<ul>
<li><a href="#org6caecc6">Language Environment</a></li>
<li><a href="#org270b962">Inserting the Occasional Funny Character </a></li>
<li><a href="#org2ff91da">Input Methods</a></li>
<li><a href="#orgbab6846">Coding Systems </a></li>
<li><a href="#org9966932">Line Endings</a></li>
</ul>
</li>
<li><a href="#org28301c2">Remote File Editing with Tramp </a>
<ul>
<li><a href="#orgced554b">Getting Started</a></li>
<li><a href="#org3f66c5d">Troubleshooting</a></li>
<li><a href="#orgf80a02e">Tramp Methods</a>
<ul>
<li><a href="#orgcc6bd5e">Unix Remote Access Methods</a></li>
<li><a href="#orgba76e75">Local Permission Access</a></li>
<li><a href="#orgf2c9e61">Specialized File System Access</a></li>
<li><a href="#orgbaeb418">Windows-Specific Access Methods</a></li>
</ul>
</li>
<li><a href="#org2eece26">Multi-Hop Connections</a></li>
<li><a href="#orgb93e5ab">Connection Cleanup</a></li>
<li><a href="#org05c7268">References</a></li>
</ul>
</li>
<li><a href="#orga741bb2">Client / Server </a>
<ul>
<li><a href="#org9a5a6d2"><code>emacsclient</code> Operating Modes </a></li>
<li><a href="#org9c3b825">Edit, Compile, Run Cycle </a></li>
<li><a href="#org4024a5f">Remote Server</a></li>
<li><a href="#org3ad88b7">Starting Up the Server </a>
<ul>
<li><a href="#org2d4e02b">The <code>--daemon</code> Option</a></li>
<li><a href="#org9e1606f">Have the OS Start the Server</a></li>
<li><a href="#orgdb01922">Start the Daemon in Your Init File</a></li>
</ul>
</li>
<li><a href="#org8a7f959">Shutting Down the Server</a></li>
<li><a href="#org54865bb">Troubleshooting</a></li>
<li><a href="#org63b2370">Midnight Mode </a></li>
</ul>
</li>
<li><a href="#orga424e99"><span>UNFINISHED</span> Ubiquitous Capture </a></li>
<li><a href="#orgcfcc463"><span>UNFINISHED</span> Printing </a></li>
<li><a href="#orgff8f880"><span>UNFINISHED</span> Org Mode </a>
<ul>
<li><a href="#org900137d">References</a></li>
</ul>
</li>
<li><a href="#org2ff7f10"><span>UNFINISHED</span> Third-Party Packages </a></li>
<li><a href="#org8213317"><span>UNFINISHED</span> Security Concerns </a>
<ul>
<li><a href="#org70cb5fc">Third-Party Packages</a></li>
</ul>
</li>
<li><a href="#org9df1e26"><span>UNFINISHED</span> Authentication </a></li>
<li><a href="#org5f48be9">Programming the Lisp Machine </a>
<ul>
<li><a href="#orgd9008f8">Customization in Emacs Lisp </a>
<ul>
<li><a href="#orgc413609">Where is My Init File?</a></li>
<li><a href="#orgb3e62d1">Basics of Elisp Syntax</a></li>
<li><a href="#org1d13f50">Quoting</a></li>
<li><a href="#org5fe54f1">Setting User Options</a></li>
<li><a href="#orgea6d6f2">Setting Default Values</a></li>
<li><a href="#org534aa0f">Setting Hooks </a></li>
<li><a href="#org827e7d8">Defining Key Bindings</a></li>
<li><a href="#org8c2354a">Test Your Init File Modifications!</a></li>
</ul>
</li>
<li><a href="#org431dde2">Defining Your Own Commands</a>
<ul>
<li><a href="#orgd8f65f1">A Missing Command</a></li>
<li><a href="#org45bd8a3">An Implementation</a></li>
<li><a href="#orgff4917c">Comments</a></li>
<li><a href="#org4875131">Naming Things</a></li>
<li><a href="#orge4ff8e5">Function Parameters</a></li>
<li><a href="#orgfe71c86">The Docstring</a></li>
<li><a href="#orgc5a1d98">Commands Must be Interactive</a></li>
<li><a href="#org30eea6d">The Algorithm</a></li>
<li><a href="#org4f182b8">The Actual Code</a></li>
<li><a href="#org6d06757">Bind It to a Key </a></li>
</ul>
</li>
<li><a href="#org5e9b007">References</a></li>
</ul>
</li>
<li><a href="#org9b84fb8">The Emacs Community </a>
<ul>
<li><a href="#org1b817fa">Project GNU</a></li>
<li><a href="#org1a9e8ec">The GNU Emacs FAQ</a></li>
<li><a href="#org55544db">The Emacs Wiki </a></li>
<li><a href="#org95d965c">Mailing Lists </a></li>
<li><a href="#orgdf1a938">Web Sites and Blogs</a></li>
<li><a href="#orge14efe5">Github</a></li>
<li><a href="#org24cc84c">Videos, Screencasts, and Podcasts</a></li>
<li><a href="#org01b978c">IRC</a></li>
<li><a href="#org6eec958">EmacsConf</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org1d7f608"><b>NEVER LEAVE EMACS: APPLICATIONS</b> </a>
<ul>
<li><a href="#org37b6f88">External Commands, Shells and Terminals </a>
<ul>
<li><a href="#orgf916208">Running One Command</a>
<ul>
<li><a href="#org0a0608e">Which shell is being used?</a></li>
<li><a href="#orgf106a08">Where’s the output?</a></li>
<li><a href="#orgc9c3af8">What happens to the output Buffer if I do <code>M-!</code> twice?</a></li>
<li><a href="#orgdeae98e">What do you mean, synchronously?</a></li>
<li><a href="#org822d191">Isn’t there an easier way to insert command output?</a></li>
<li><a href="#org78e5f65">What about standard input?</a></li>
<li><a href="#org4e51243">Can I run any program this way? </a></li>
<li><a href="#orge46ca16">What if I don’t want to wait? </a></li>
<li><a href="#org46d858f">Managing Asynchronous Processes </a></li>
</ul>
</li>
<li><a href="#org2d1931f">Run Commands from Dired</a></li>
<li><a href="#org3e9bc8f">Interactive Shells</a>
<ul>
<li><a href="#org506e58c"><code>shell-mode</code> Advantages</a></li>
<li><a href="#org8ceaaf9">Command History</a></li>
<li><a href="#orge6b2df6">Manipulating the Transcript</a></li>
<li><a href="#orgda7e6cb">Directory Tracking</a></li>
<li><a href="#org2fdf113">Terminating the Shell</a></li>
<li><a href="#org6cf4bda">Multiple Shell Buffers</a></li>
<li><a href="#org0fcda49">What about the memory usage of the shell Buffer?</a></li>
<li><a href="#orge1e7489"><code>shell-mode</code> Disadvantages</a></li>
<li><a href="#org24f45d2">Recommended Third-Party Packages </a></li>
<li><a href="#org428e486">Shell Init File Tweaks</a></li>
</ul>
</li>
<li><a href="#orgb091621">Terminal Emulation </a>
<ul>
<li><a href="#org5ee3efc">Thanks for wasting my time with all that stuff about <code>shell-mode</code> then!</a></li>
<li><a href="#org0c1a606">Complexities?</a></li>
<li><a href="#orgda062ef">Line Mode versus Char Mode</a></li>
<li><a href="#org28659af">Disadvantages of the Terminal Emulator</a></li>
</ul>
</li>
<li><a href="#org54851a1">Remote Shells</a></li>
<li><a href="#orgf58e197">Eshell</a>
<ul>
<li><a href="#org631d494">References</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgd4e62c9">Browsing the Web </a>
<ul>
<li><a href="#orgef24aab">EWW: Emacs Web Wowser </a>
<ul>
<li><a href="#org1b95afb">Entry Points</a></li>
<li><a href="#org333eae5">Using the Browser</a></li>
<li><a href="#orgcac4816">Page Display</a></li>
<li><a href="#orgc4dda76">Navigating Links</a></li>
<li><a href="#orgd1b8327">Managing “Tabs” (EWW Buffers)</a></li>
<li><a href="#orgbd91c1d">Browser History</a></li>
<li><a href="#org0e87398">Web Site Navigation</a></li>
<li><a href="#org3756fa6">EWW Bookmarks </a></li>
<li><a href="#orgac35c06">Miscellaneous EWW Commands</a></li>
<li><a href="#org768d3a6">EWW From the Command Line</a></li>
</ul>
</li>
<li><a href="#orga9fc8a6">Browse URL </a></li>
<li><a href="#orgac9acc6">Goto Address Mode </a></li>
<li><a href="#org0068b91">HTTP Cookies </a></li>
<li><a href="#orgb7ead6f">User Options</a></li>
<li><a href="#orga8a7729">References</a></li>
</ul>
</li>
<li><a href="#org84c1c34">The Calendar, Diary, and Clocks </a>
<ul>
<li><a href="#org75943fd">Setting Up the Calendar</a></li>
<li><a href="#org9099796">Motion</a></li>
<li><a href="#org8ad7d74">Counting Days</a></li>
<li><a href="#org04f0dfe">Holidays</a></li>
<li><a href="#orgd6764f1">The Emacs Ephemeris: Astronomical Information</a></li>
<li><a href="#orgca8eb00">To and From Other Calendar Systems</a></li>
<li><a href="#org74f58b1">Printed Calendars</a></li>
<li><a href="#org79bf2bf">The Diary</a></li>
<li><a href="#org4727f38">Appointments </a></li>
<li><a href="#org0cd897a">Customization</a></li>
<li><a href="#org1b3398b">Clocks and Time</a>
<ul>
<li><a href="#orgfcbd81b">Mode Line Clock</a></li>
<li><a href="#org83f047a">World Clock </a></li>
<li><a href="#orge6846bf">Time Stamps in Files</a></li>
<li><a href="#org92a2d64">Timeclocks</a></li>
</ul>
</li>
<li><a href="#orgae75d27">References</a></li>
</ul>
</li>
<li><a href="#orgea33152">Version Control </a>
<ul>
<li><a href="#orgbefb84c">Supported Version Control Systems </a></li>
<li><a href="#orgce10868">VC “Modes”</a></li>
<li><a href="#org1821f42">VC File Mode in One Command</a></li>
<li><a href="#org09849b1">More VC File Mode Commands</a></li>
<li><a href="#org3012105">Initializing a Repository</a></li>
<li><a href="#org8a434e8">Diffing and Comparing</a></li>
<li><a href="#orga6d564c">Examining the Logs</a></li>
<li><a href="#orgd34172d">Viewing Older Revisions</a></li>
<li><a href="#orgadfffaa">Discarding Changes</a></li>
<li><a href="#org13f9126">Other File Operations</a></li>
<li><a href="#orge3bc7de">Tagging</a></li>
<li><a href="#orge88e7db">Branching and Merging</a></li>
<li><a href="#orgb0b4be3">Working With Remote Repositories</a></li>
<li><a href="#orge676bd4">VC Project Mode</a></li>
<li><a href="#orgbb69895">VC Grepping</a></li>
</ul>
</li>
<li><a href="#org44968da">Diffing and Merging </a>
<ul>
<li><a href="#orge0e739d">Simple Diffing </a>
<ul>
<li><a href="#org177cf11">Diff Mode</a></li>
</ul>
</li>
<li><a href="#org8da4cf8">Ediff </a>
<ul>
<li><a href="#org4f3c879">Personal Preferences</a></li>
<li><a href="#orgf07620e">Ediff Entry Points</a></li>
<li><a href="#org8c21c4d">The Expanded <code>*Ediff Control Panel*</code></a></li>
</ul>
</li>
<li><a href="#org8e44690">Merging </a>
<ul>
<li><a href="#org9908281">Ediff Merge Entry Points</a></li>
</ul>
</li>
<li><a href="#org1fb2e9a">Integrating Ediff into External Programs</a></li>
<li><a href="#org6d1d1cb">Comparing and Merging Directories </a></li>
<li><a href="#org0256054">Patching </a></li>
<li><a href="#org6c3f023">Emerge</a></li>
<li><a href="#org36918d1">Simple Window Comparison</a></li>
<li><a href="#org4d5d999">References</a></li>
</ul>
</li>
<li><a href="#org4f4168c">Playing Music</a>
<ul>
<li><a href="#org7eb90fa">EMMS: Emacs Multimedia System</a></li>
<li><a href="#org0caa3fc">Music Player Daemon (MPD) </a></li>
<li><a href="#org615d012">References</a></li>
</ul>
</li>
<li><a href="#org47c704f"><span>UNFINISHED</span> Mail, News, and Feeds </a>
<ul>
<li><a href="#org1116a51">Sending Mail</a>
<ul>
<li><a href="#org756ffc9">Configuring SMTP</a></li>
<li><a href="#org4bfca05">Composing Email</a></li>
</ul>
</li>
<li><a href="#orgeabe54d">Reading Mail </a>
<ul>
<li><a href="#org1556987">Other Emacs Mailers </a></li>
<li><a href="#org288d223">The Mailers</a></li>
</ul>
</li>
<li><a href="#orgcc6155c">Browsing Mbox Files </a></li>
<li><a href="#org5ccdaab"><span>UNFINISHED</span> Web and News Feeds (Syndication) </a></li>
<li><a href="#org95ee87a">References</a></li>
</ul>
</li>
<li><a href="#orgf27f6ce"><span>UNFINISHED</span> Address Book: The Insidious Big Brother Database (BBDB) </a></li>
<li><a href="#org40902b9"><span>UNFINISHED</span> Drawing Pictures </a>
<ul>
<li><a href="#orge6674b7">Picture Mode</a></li>
<li><a href="#org6c15ae2">Artist Mode</a></li>
</ul>
</li>
<li><a href="#org845bebf"><span>UNFINISHED</span> DNS Lookups </a></li>
<li><a href="#org8cf2441"><span>UNFINISHED</span> EUDC: Emacs Unified Directory Client (LDAP) </a>
<ul>
<li><a href="#org536d1b5">References</a></li>
</ul>
</li>
<li><a href="#org507afcd"><span>UNFINISHED</span> FTP (File Transfer Protocol)</a></li>
<li><a href="#orgf6f9ce3"><span>UNFINISHED</span> Editing Processes with <code>proced</code> </a></li>
<li><a href="#org1fe86f0"><span>UNFINISHED</span> Unix Manual Pages</a></li>
<li><a href="#org0d2e942"><span>UNFINISHED</span> Calc </a>
<ul>
<li><a href="#org79bf84e">Interactive Tutorial</a></li>
<li><a href="#org5713e6d">Embedded Mode</a></li>
<li><a href="#org46a2d4c">Unit Conversion</a></li>
<li><a href="#orgf5ed2b3">References</a></li>
</ul>
</li>
<li><a href="#org532913b"><span>UNFINISHED</span> EasyPG Assistant </a>
<ul>
<li><a href="#orgad232a0">References</a></li>
</ul>
</li>
<li><a href="#org407a3bd"><span>UNFINISHED</span> Emacs Speaks Statistics: Data Analysis</a></li>
<li><a href="#orgb427cd5"><span>UNFINISHED</span> Maps</a></li>
<li><a href="#orgedb782b"><span>UNFINISHED</span> Chat </a>
<ul>
<li><a href="#orgbb48e07">Internet Relay Chat (IRC) </a></li>
<li><a href="#orgd6360f8">Jabber</a></li>
</ul>
</li>
<li><a href="#org4d5caa6"><span>UNFINISHED</span> Emacs as Window Manager</a></li>
<li><a href="#org7cfd197">Games and Amusements </a>
<ul>
<li><a href="#org7db2042">Actual Games</a></li>
<li><a href="#org1064210">Puzzles</a></li>
<li><a href="#org534ad52">Cryptography</a></li>
<li><a href="#org8a4c024">Display Hacks </a></li>
<li><a href="#org85a2159">Jokes / Wackiness</a></li>
<li><a href="#orga28eb72">References</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org82d92b7"><b>EMACS FOR…</b></a>
<ul>
<li><a href="#org6ca77f6"><span>UNFINISHED</span> Emacs for Writers </a>
<ul>
<li><a href="#orgc4542d0"><span>UNFINISHED</span> Text Mode</a></li>
<li><a href="#org921022f"><span>UNFINISHED</span> Filling </a>
<ul>
<li><a href="#org8101543">Breakable and Non-breakable Space </a></li>
</ul>
</li>
<li><a href="#orga0275bd"><span>UNFINISHED</span> Word Wrap</a></li>
<li><a href="#org4702d95"><span>UNFINISHED</span> Electric Quotes</a></li>
<li><a href="#org0e7bbae"><span>UNFINISHED</span> Spell Check </a></li>
<li><a href="#org54b303f"><span>UNFINISHED</span> Dictionaries and Thesauri </a></li>
<li><a href="#org214258c"><span>UNFINISHED</span> Footnote Minor Mode</a></li>
</ul>
</li>
<li><a href="#org905f170"><span>UNFINISHED</span> Emacs for Programmers</a>
<ul>
<li><a href="#org5ae199d"><span>UNFINISHED</span> Emacs: Text Editor or IDE?  Yes.</a></li>
<li><a href="#org6b9f1e6"><span>UNFINISHED</span> Commenting and Uncommenting </a></li>
<li><a href="#orgeed8173"><span>UNFINISHED</span> Change Logs </a></li>
<li><a href="#org0948e01"><span>UNFINISHED</span> Compiling Code </a></li>
<li><a href="#org423a04e"><span>UNFINISHED</span> Managing Projects </a></li>
<li><a href="#org424b922"><span>UNFINISHED</span> On-the-Fly Syntax Checking</a></li>
<li><a href="#orgbd0b083"><span>UNFINISHED</span> Tags and The Xref Subsystem</a></li>
<li><a href="#org4b25a19"><span>UNFINISHED</span> Elisp Programming</a>
<ul>
<li><a href="#orgd2038b1"><span>UNFINISHED</span> The Debuggers </a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#orge4b57f7"><b>THE BACK OF THE BOOK</b></a>
<ul>
<li><a href="#orgaa34281">Appendices</a>
<ul>
<li><a href="#org646c534">Varieties of Emacs: A History </a></li>
<li><a href="#org15771de">Emacs vs. The Unix Philosophy</a>
<ul>
<li><a href="#org22bc734">References</a></li>
</ul>
</li>
<li><a href="#org681449c"><span>UNFINISHED</span> Compilation Mode and its Many Descendants </a></li>
<li><a href="#orgc4fbf5d">The Great Sentence-Ending Controversy</a></li>
<li><a href="#orgfcf48eb"><span>UNFINISHED</span> Install Emacs on ChromeOS </a></li>
<li><a href="#org8e15afa">The Famous Canards </a></li>
<li><a href="#org961f8d0">The Troublesome Meta Key </a></li>
<li><a href="#org7a1e474">The <code>ESC</code> Prefix </a></li>
<li><a href="#org13ca444"><span>UNFINISHED</span> Emacs on Your Phone </a>
<ul>
<li><a href="#org1212c02">Org Mode on Your Phone</a></li>
</ul>
</li>
<li><a href="#org6edd19b">An Initial Init File </a>
<ul>
<li><a href="#org7a7cd69">The Init File</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org7d4d555">Bibliography </a></li>
<li><a href="#orgb2ef1b0">Colophon </a></li>
<li><a href="#org1bb90b8">Acknowledgments</a></li>
<li><a href="#orgd546957">About the Author</a></li>
</ul>
</li>
</ul>
</div>
</div>

</div>
</div><div id="outline-container-org518a03c">
<h2 id="org518a03c">PREFACE</h2>
<div id="text-org518a03c">
<p>
This document was originally written around 1997 for GNU Emacs version 19.29 and
published under the title <i>A Tutorial Introduction to GNU Emacs</i>.  It has
subsequently been updated for version 28.2, and
thoroughly revised and expanded.  This is document version 28.2.43 and is an
unfinished work-in-progress.
</p>

<p>
This work by Keith Waclena is copyright 2023 and is licensed
under a <a href="https://creativecommons.org/licenses/by-nc-nd/3.0/">CC BY-NC-ND 3.0 License</a>.
</p><p>

This document is also available in <a href="https://blog.veitheller.de/emacs-tutorial.pdf">PDF</a>
and <a href="https://blog.veitheller.de/emacs-tutorial.epub">EPUB</a> formats.
</p></div>
</div><div id="outline-container-org68588e6">
<h2 id="org68588e6"><b>FUNDAMENTALS</b></h2>

<div id="outline-container-org92ca48f">
<h3 id="org92ca48f">Introduction</h3>
<div id="text-org92ca48f">

<div id="org667d565">
<p><a href="https:./images/startup.png" alt="Emacs Splash Screen" title="Emacs Splash Screen" width="100%"><img src="https://blog.veitheller.de/images/startup.png" alt="Emacs Splash Screen" title="Emacs Splash Screen" width="100%"/></a>
</p>
<p><span>Figure 1: </span>Emacs Splash Screen</p>
</div>
</div>

<div id="outline-container-org0f24f97">
<h4 id="org0f24f97">What GNU Emacs Is</h4>
<div id="text-org0f24f97">
<p>
<a href="http://www.gnu.org/software/emacs/index.html">GNU Emacs</a> is a free, portable, extensible, internationalized, self-documenting
text editor.  That it is <i>free</i> means specifically that the source code is freely
copyable and redistributable, so Emacs can never be discontinued and disappear.
That it is <i>portable</i> means that it runs on many computers under many different
operating systems, so that you can probably count on being able to use the same
program no matter what computer you’re using.  That it is <i>extensible</i> means that
you can not only customize all aspects of its usage (from keystrokes through
fonts, colors, mousage and menus), but that you, and the community, can modify
and program Emacs, <i>even while Emacs is running</i>, to do entirely new things that
its designers never thought of.  That it is <i>internationalized</i> means that it has
full Unicode<sup><a id="fnr.1" href="#fn.1" role="doc-backlink">1</a></sup> support, including bidirectional text and many input methods
for non-Latin scripts.  That it is <i>self-documenting</i> means that every keystroke,
menu item, and function can thoroughly explain itself and its usage, and that
Emacs contains 395,759 lines of hypertext reference manuals and
tutorial documentation about itself and its subsystems.
</p>

<p>
Because of all this, GNU Emacs is an extremely successful program (having been
in continuous development for 38 years<sup><a id="fnr.2" href="#fn.2" role="doc-backlink">2</a></sup>),
and does more for you than any other editor. It’s particularly good for
programmers. No matter what programming language you use, Emacs probably
provides a <i>mode</i> that makes it especially easy to edit code in that language,
providing syntax highlighting, context sensitive indentation, and layout. It also
allows you to compile your programs inside Emacs, with links from error messages
to source code; debug your programs inside Emacs, with links to the source;
interact directly with the language interpreter (REPL); jump across multiple files to
the definition of a symbol in your source code; and interact with your version
control system<sup><a id="fnr.3" href="#fn.3" role="doc-backlink">3</a></sup>.
</p>

<p>
Emacs also provides many built-in applications such as:
</p>
<ul>
<li><a href="#org5e201bd">mail readers</a> (at least half a dozen)</li>
<li><a href="#org5138d90">web browsers</a> (at least two)</li>
<li>a powerful <a href="https://en.wikipedia.org/wiki/File_manager">file manager</a> like <a href="https://en.wikipedia.org/wiki/File_Explorer">Windows Explorer</a> (File Explorer) or Apple’s macOS <a href="https://en.wikipedia.org/wiki/Finder_(software)">Finder</a></li>
<li><a href="#org039ef0a">interactive shells</a>, <a href="#org2bfdd17">logins</a> (ssh, ftp, sudo), and <a href="#org1271dbd">terminal emulators</a></li>
<li>a powerful and easy to use <a href="#orgd2c3858">macro system</a> to automate your tasks</li>
<li><a href="#org4d9b857">diffing and merging</a> of files</li>
<li><a href="#org0c5e670">calendars</a>, project planning, TODO lists, scheduling, and agendas</li>
<li>a powerful infinite precision <a href="#orgb2b6b30">programmable calculator</a> with symbolic algebra and data graphics</li>
<li><a href="#orgd9f78fb">image</a>, PDF, <a href="https://en.wikipedia.org/wiki/Device_independent_file_format">DVI</a>, ebook (<a href="https://en.wikipedia.org/wiki/EPUB">EPUB</a>), OpenDocument, Microsoft Office, and PostScript
viewers (via <a href="#org8dc49db">DocView Mode</a>), and inline images in plain text</li>
<li>typesetting and publication of text or source code to HTML, PDF, and
presentation slideshows (this document is an example)</li>
<li><a href="https://en.wikipedia.org/wiki/Literate_programming">literate programming</a></li>
<li>interactive notebooks: that is, documents that contain live code, data,
equations, visualizations, and text</li>
<li><a href="#org22671bb">client / server mode</a> (connect to a running local Emacs from any terminal, or
to a remote Emacs running on a different computer)</li>
<li>multilingual <a href="#orgda03eba">spell checking</a>, <a href="#org75022c7">dictionaries</a>, and thesauri (available in all of
the above applications and subsystems, too)</li>
<li>transparent editing of <a href="#orgc045bbb">encrypted</a> and <a href="#org9732371">compressed</a> files, and of files inside
<a href="#org648e64d">containers</a> (like tar and zip archives)</li>
<li><a href="#org2bfdd17">remote file editing</a> (any file or directory you want to edit can be
transparently accessed via ssh, ftp and the like)</li>
<li>spreadsheets (three)</li>
<li><a href="#orgcbc7d14">music players</a> (at least half a dozen)</li>
<li>chat / messaging systems (like IRC, Jabber, Slack)</li>
<li>native Emacs <a href="#org4041080">games</a> and interfaces to external games</li>
<li>a Rogerian therapist (in case this is all a little overwhelming)</li>
</ul>

<p>
In addition, Emacs’s extensibility has resulted in a vibrant ecosystem; users
share packages that provide new functionality, and it’s easy to browse a few
thousand of these via the built-in <a href="#orgc96889a">package manager</a>, and install the ones of
interest.  Many more Emacs packages are available on <a href="https://github.com/search?l=Emacs+Lisp&amp;q=emacs&amp;type=Repositories">GitHub</a> and in the <a href="https://www.emacswiki.org/">Emacs
Wiki</a>.
</p>

<div id="orgd925e0c">
<p><a href="https:./images/emacs-as-os.png" alt="Emacs as Operating System" title="Emacs as Operating System" width="100%"><img src="https://blog.veitheller.de/images/emacs-as-os.png" alt="Emacs as Operating System" title="Emacs as Operating System" width="100%"/></a>
</p>
<p><span>Figure 2: </span>Emacs as Operating System</p>
</div>

<p>
The image above shows Emacs “in use”.  It’s a little unrealistic in that I, at
least, never want that many windows open simultaneously, but it’s a real screen
shot.  Going across the columns from left to right, we have email (a folder
and a message) and an agenda from my project planner; <a href="https://ocaml.org/">OCaml</a> source code with a
compilation error message and a type-throwback window; a Google search in one of
Emacs’s web browsers above a PDF; and finally, a directory in the file manager,
a shell, and a paused game of Tetris.
</p>

<p>
At the very bottom of the screen, I’m in the middle of typing an Emacs command
by its name (<code>M-x list</code>), and have hit <code>TAB</code> to get completion — the completions
window has temporarily popped up and spans the width of the screen.
</p>

<p>
In the grey <a href="#org6456ffd">mode line</a> along the bottom of the completions window (and
replicated, albeit truncated, in slightly different form at the bottom of every
other window) you can see that I have incoming email that I haven’t yet seen
(red envelope icon) and an unseen chat message from someone named “Tex”.
</p>
</div>
</div>
<div id="outline-container-orgc5a18fe">
<h4 id="orgc5a18fe">What GNU Emacs Is Not</h4>
<div id="text-orgc5a18fe">
<p>
First and foremost, Emacs is not a WYSIWYG word processor.  This is because
Emacs leverages plain text to get maximum flexibility and avoid lock-in to
opaque file formats.  But Emacs is also used to edit and typeset documents by
people who use document preparation systems and markup languages like LaTeX,
Markdown, and Emacs’s own Org markup language<sup><a id="fnr.4" href="#fn.4" role="doc-backlink">4</a></sup>.
</p>

<p>
Actually, this is about the only thing I can think of that GNU Emacs is not.
</p>
</div>
</div>
</div>
<div id="outline-container-org11e39b9">
<h3 id="org11e39b9">Emacs as Operating System <a id="orgcdeeae8"></a></h3>
<div id="text-org11e39b9">
<p>
Emacs is one of those rare pieces of software that can change your life.  It’s
not really a text editor, nor an IDE.  It’s really the last remaining <a href="https://en.wikipedia.org/wiki/Lisp_machine">Lisp
Machine</a>, a synergistic system that you live in, which replaces most of the
dozens of single-purpose applications you’d otherwise be using, some of which
lock you into black-box file formats or corporate licensing.
</p>

<p>
The more things you do in Emacs, the more those things multiplicatively enhance
each other.
</p>

<p>
Imagine you use Emacs (as I do) for your document creation, web site publishing,
interactive development environment (IDE), email, TODO lists, file manager, web
browser (sometimes), shells and terminals, calendar and agenda, and chat system.
As a result, in all of these:
</p>

<ul>
<li>you use the same exact <a href="#org75fb6a2">completion</a> system (with history), whether entering
command names, file names, email addresses, or web urls</li>
<li>you search with the exact same <a href="#org19c6ad0">regular expression</a> syntax and the same
keystrokes</li>
<li>you can copy any text from anyplace<sup><a id="fnr.5" href="#fn.5" role="doc-backlink">5</a></sup></li>
<li>you can search across all or a subset of the windows running these
applications at once (“which window did I see that error message in?”; “which
browser tab is that text in?”)</li>
<li>you can dynamically <a href="#orgde73944">highlight</a> lines and words in various colors to make them
stand out or distinguish between them</li>
<li>you automate tasks within and across all these systems with the same <a href="#orgd2c3858">macro facility</a></li>
<li>you have the same <a href="#orgda03eba">spellcheck</a> interface and dictionaries</li>
<li>after a restart (we all have to reboot occasionally), you can have most of
these windows and files come back with everything (down to your cursor
location) exactly where you left it</li>
<li>you configure and customize all these applications in the same configuration
language (and in a single file, unless you choose to split it up), and the
language is a complete programming language</li>
<li>you can modify, extend, fix bugs, and generally hack all of these
applications, live, while they’re running</li>
<li>you can program entirely new applications by combining functions and elements
from any of the others</li>
</ul>

<p>
Emacs insulates you from the operating system.  If you full-screen your Emacs,
you will barely be able to tell whether it’s Linux, BSD, Mac OS, Windows, or ChromeOS
underneath.  You can use the same configuration everywhere, and since the config
language is <a href="https://en.wikipedia.org/wiki/Lisp_(programming_language)">Lisp</a>, you have conditionals to make any OS- or computer-specific
tweaks that might be necessary.  You can even load your config over the network
— from a web page if you like.
</p>
</div>
</div>
<div id="outline-container-org070fd65">
<h3 id="org070fd65">Quickstart</h3>

<div id="outline-container-org86c297a">
<h4 id="org86c297a">Installing Emacs</h4>
<div id="text-org86c297a">
<p>
If you are running Unix, Emacs may already be installed.  If not, it will
certainly be easily installed via your package manager.
</p>

<table>


<colgroup>
<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td>Arch Linux</td>
<td><code>sudo pacman -S emacs-nativecomp</code></td>
</tr>

<tr>
<td>Debian</td>
<td><code>sudo apt-get install emacs</code></td>
</tr>

<tr>
<td>Fedora</td>
<td><code>sudo yum install emacs</code></td>
</tr>

<tr>
<td>Ubuntu</td>
<td><code>sudo apt-get install emacs</code></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org7a3b6b2">
<h4 id="org7a3b6b2">Starting Up and Running Emacs <a id="org6444e1f"></a></h4>
<div id="text-org7a3b6b2">
<p>
Emacs can run in two different modes: a graphical version, which requires a
window system like X11 (or the Mac or Windows native interface), and a
“text-only” terminal version, like old-school Unix programs such as <code>vi</code> or <code>vim</code>.
I say you should run the graphical version; in the terminal version (forced
via the <code>-nw</code> (“no windows”) option if a window system is running), you won’t be able to
display images or combine multiple fonts, and many useful key combinations will be
impossible to type, requiring clunkier alternatives<sup><a id="fnr.8" href="#fn.8" role="doc-backlink">8</a></sup>.  Mouse-button and
-motion combinations will be severely limited.
</p>

<p>
Note that using the graphical version doesn’t imply working in a GUI style with
heavy mouse action; I never use the mouse, and configure my Emacs so that the
graphical version looks like <code>vim</code> in a terminal (right down to my beloved
fixed-pitch font).  However, because I’m running the graphical version, I get
better font and character set support, can view images and PDFs, and make use of
all the exotic keys on my keyboard.  If what you like about an editor such as <code>vim</code>
is the way its invocation is tightly bound to your shell and working directory,
or its fast startup speed, running the graphical Emacs in <a href="#org22671bb">client / server</a> mode
achieves exactly the same thing.
</p>

<p>
Unless you go out of your way to change this (e.g. with <code>-nw</code>), the graphical
version is what you’ll get if you invoke Emacs from an X11, Mac, or Windows
desktop launcher, or from a shell in a terminal under one of those desktops.  This
book everywhere assumes you’re running the graphical version.
</p>
</div>
</div>
<div id="outline-container-org0f769a4">
<h4 id="org0f769a4">Entering Emacs</h4>
<div id="text-org0f769a4">
<p>
To enter Emacs, you just say:
</p>
<pre>emacs
</pre>

<p>
on the command line, or invoke it from your desktop via a launcher, menu or
icon<sup><a id="fnr.9" href="#fn.9" role="doc-backlink">9</a></sup>.  When it comes up, you won’t be editing any file.  You can then use
the file commands to read in files for editing.  Alternatively, you can fire up
Emacs with an initial file (or files) by saying:
</p>
<pre>emacs foo.py
</pre>


<p>
Note that for many Emacs users, starting Emacs is something that’s done very
rarely: I only do it when I’ve needed to reboot my computer.  You don’t use
Emacs the way you use <code>vim</code>, starting it in a shell to edit one file, then exiting
to compile, then lather rinse repeat.  Loading and unloading files, compiling,
debugging, file management, version control, and everything else is done inside
Emacs with special commands that provide very tight and seamless integration.
</p>

<p>
If you really <i>prefer</i> to work
in a many-sessions, multi-terminal style after trying the native Emacs approach,
the way to do it is via <a href="#org22671bb">client / server</a> mode: start up an Emacs server, and then
repeatedly run <code>emacsclient</code> in your terminals as you navigate around, just the
way you’d run <code>vim</code>.
</p>
</div>
</div>
<div id="outline-container-org3081b84">
<h4 id="org3081b84">Exiting Emacs</h4>
<p>
You can exit Emacs from the menu via File / Quit, or type the two keys <i>Control+x</i>
followed by <i>Control+c</i> (which we write as <code>C-x C-c)</code>.  If you’ve made any changes to a
file, you’ll be asked if you want to save them.
</p>
</div>
<div id="outline-container-org4de76ad">
<h4 id="org4de76ad">What Emacs Looks Like</h4>

<div id="outline-container-org1c32782">
<h5 id="org1c32782">The Screen</h5>
<div id="text-org1c32782">
<p>
If you started up Emacs without loading a file, you’ll be looking at the <a href="#org667d565"><i>splash
screen</i></a> <sup><a id="fnr.10" href="#fn.10" role="doc-backlink">10</a></sup>; this is not something you’ll see in everyday use.  Otherwise,
you’ll be looking at your file.
</p>

<p>
The default Emacs screen looks pretty conventional, if old-fashioned: it has a
menu bar at the top, a toolbar beneath that, and a scrollbar on the left (you
can ultimately disable any of these; I have, and my Emacs has the clean retro
look of <code>vi</code>); the rest of the screen is completely devoted to the text of your
file, except for the bottom line of the screen — the <i>echo area</i> — and the
line above that — the <i>mode line</i>.
</p>
</div>
</div>
<div id="outline-container-org5e90da7">
<h5 id="org5e90da7">The Mode Line</h5>
<p>
The Mode Line displays some essential information, in particular the name of the
file you’re editing and whether or not you’ve modified it, what line you’re on,
and what <a href="#org5b21ef0">Mode</a> you’re in.  It’s completely customizable and can show lots of
other information too, such as the time, load average, mail availability (<a href="https://en.wikipedia.org/wiki/Biff_(Unix)">biff</a>),
and version control status.  See <a href="#org6456ffd"><i>The Mode Line in Detail</i></a> below.
</p>
</div>
<div id="outline-container-org0b79d18">
<h5 id="org0b79d18">The Echo Area <a id="org7e7133f"></a></h5>
<p>
The blank line below the mode line is the <i>Echo Area</i>.  The Echo Area is used by
Emacs to display short messages, and also for input when Emacs is prompting you
to type something (it may want you to type yes or no in answer to a question,
the name of a file to be edited, the long name of a command, etc).  Unless you
are actively using the mouse, Emacs will typically <i>not</i> use a modal dialog box
for this sort of thing.
</p>
</div>
</div>

<div id="outline-container-org368b785">
<h4 id="org368b785">Using Emacs Like It’s Notepad?</h4>
<div id="text-org368b785">
<p>
Emacs has a reputation of being difficult to use, but in fact anybody can
readily use Emacs out of the box with no instruction<sup><a id="fnr.11" href="#fn.11" role="doc-backlink">11</a></sup> by using the menu
bar and toolbar.  Simply choose File / Open File from the menu; for common
programming languages, you’ll see syntax highlighting automatically.  Navigate
conventionally with the scrollbar, mouse, and the Page Up, Page Down, and arrow
keys.  To insert text, just start typing (Emacs isn’t modal like <code>vim</code> (not by
default, anyway<sup><a id="fnr.12" href="#fn.12" role="doc-backlink">12</a></sup>)); delete text with Delete or Backspace.  Finally, choose
File / Save and then File / Quit from the menu.
</p>

<p>
This ought to sound <i>extremely</i> familiar.
</p>

<p>
And pretty boring.  You may not be impressed, but you’ll be able to get a lot of
work done right away.
</p>

<p>
But if you want to use Emacs efficiently and give it a chance to change your
life, you need to learn to control it the way it was originally designed: via
the keyboard.
</p>

<p>
The enormous Emacs keyboard command set is indeed daunting.  Fortunately, you
can learn the keystrokes incrementally, using the menus for things you don’t
yet know how to do.  Eventually, you may stop using the menus entirely; I turned
off the menu bar, tool bar and even the scroll bars years ago to save screen
real estate and haven’t missed them.
</p>
</div>
</div>
<div id="outline-container-org4b9ca28">
<h4 id="org4b9ca28">Configuring Emacs <a id="orgceb37e2"></a></h4>
<div id="text-org4b9ca28">
<p>
Don’t.  Yet.  Emacs is all about customizing and making it act the way you want,
but in my opinion, you should learn the basics in a stock, mostly uncustomized Emacs,
so that if you have questions or problems and look up an answer, that answer
will apply to you.
</p>

<p>
In recent years, there’s been something of a cottage industry in Emacs “<a href="https://www.emacswiki.org/emacs/StarterKits">starter
kits</a>” (such as <a href="https://github.com/bbatsov/prelude"><i>Prelude</i></a>, <a href="https://github.com/hlissner/doom-emacs"><i>Doom Emacs</i></a>, <a href="https://github.com/eschulte/emacs24-starter-kit/"><i>Emacs Starter Kit</i></a>, <a href="https://www.spacemacs.org/"><i>Spacemacs</i></a>,
etc<sup><a id="fnr.13" href="#fn.13" role="doc-backlink">13</a></sup>): distributions that give you a heavily pre-customized, sexy-looking
Emacs to fix what are perceived to be “old-fashioned defaults” and load and
start up everything you could conceivably want. I would avoid these at first for
the same reason<sup><a id="fnr.14" href="#fn.14" role="doc-backlink">14</a></sup>.  In fact, some of these starter kits change so much about
the experience that large parts of this book will appear to be completely
inapplicable to you, so bear that in mind.
</p>

<p>
I hope browsing this book will convince you that there’s great stuff to come,
and that therefore you’ll be able to resist immediately adding a million bits of
other people’s configuration tweaks and third-party packages for just a little
while, until you get up to speed with the basics.
</p>

<p>
However, there <i>are</i> a few places where I do recommend some
customizations that I think make a significant improvement to the
Emacs experience, even while you’re learning.  These will pop up from
time to time and are all collected together in an <a href="#org76237ea">appendix</a>.
</p>

<p>
My own Emacs is so heavily customized from decades of use that I can barely
function in a stock Emacs!  I’m all in favor of customizing<sup><a id="fnr.15" href="#fn.15" role="doc-backlink">15</a></sup>, but don’t jump in
too early.
</p>
</div>
</div>
<div id="outline-container-org6cc4e80">
<h4 id="org6cc4e80">The Built-In Emacs Tutorial <a id="org0e79444"></a></h4>
<div id="text-org6cc4e80">
<p>
If you want to dive in immediately and start using Emacs as it ought to be used,
now is a good time to run the built-in learn-by-doing Emacs tutorial.  This is a
simply a special text file that explains some basic Emacs commands and has you
try them out, explaining how to get back to where you were and continue.  It’s
very effective and you don’t have to finish it all at once — it’ll remember
where you left off for next time.
</p>

<p>
If you fire up Emacs without a filename and are looking at the splash screen,
you’ll notice that your cursor is sitting right on a “clickable” button labeled
“Emacs Tutorial” — just hit return or click the label with the mouse and the
tutorial will start up.
</p>

<p>
If you aren’t looking at the splash screen, you can start (or continue) the
tutorial at any time by typing   <code>C-h t</code> (that’s <i>Control+h</i> followed
by the letter <i>t</i>).  If you type instead <code>C-u C-h t</code> Emacs will ask what national
language to use for the tutorial; it’s available in twenty languages: Brazilian,
Portuguese, Chinese, Czech, Dutch, English, Esperanto, French, German, Hebrew,
Italian, Japanese, Korean, Polish, Romanian, Russian, Slovak, Slovenian,
Spanish, Swedish and Thai.  The default is to use the language of your computing
environment, if available.
</p>
</div>
</div>
</div>
<div id="outline-container-orge733e95">
<h3 id="orge733e95">The Fundamental Emacs Concepts <a id="org3c3917b"></a></h3>
<p>
To really make Emacs work for you requires an appreciation of its fundamental
concepts and how they work together to form a synergistic system.
</p>
<div id="outline-container-org81cf159">
<h4 id="org81cf159">Functions</h4>
<p>
Everything you do in Emacs involves the invocation of functions<sup><a id="fnr.16" href="#fn.16" role="doc-backlink">16</a></sup> and these
functions take arguments and have help and documentation.
</p>
</div>
<div id="outline-container-org089a1d4">
<h4 id="org089a1d4">The Keyboard and Key Bindings</h4>
<p>
Most of the time you invoke these functions with simple keystrokes — even just
typing a single letter into a file invokes a specific function, as do all the
editing operations (like deleting a word), and all things like opening files or
setting a reminder or sending an email.  Most of these functions are associated
with <a href="#orge245187">keystrokes</a> in a malleable, context-sensitive hierarchical organization with
an (at least aspirational) mnemonic scheme.
</p>
</div>
<div id="outline-container-orgd0207a4">
<h4 id="orgd0207a4">Variables</h4>
<p>
Emacs also contains <a href="#org39438a9"><i>variables</i></a> exactly like those of any programming language,
which store a huge variety of data.  Most of them are used only by programmers,
but a subset of them are <a href="#org27e6769"><i>Customizable Variables</i></a> (a.k.a. <i>User Options</i>), which
you’ll use to configure Emacs to your liking.  These variables aren’t something
that you just set up once in a configuration file: you’ll soon be comfortable setting
and inspecting them on the fly as you’re using Emacs.
</p>
</div>
<div id="outline-container-orgef94a1e">
<h4 id="orgef94a1e">Discovery, Help and Completion</h4>
<p>
No one wants to memorize all the thousands of Emacs key bindings<sup><a id="fnr.17" href="#fn.17" role="doc-backlink">17</a></sup>,
including those they might use only weekly or monthly.  Less frequently used
functions are invoked by name with a powerful and extensible <a href="#org75fb6a2">completion</a> system,
unknown functions are discovered with the <a href="#org42f1d6b">Apropos</a> facility, the <a href="#orge57a011">Help</a> system
tells you how to use them, and the <a href="#orga6bbd55">Info</a> hypertext documentation system provides
even more complete discursive documentation (and there’s a clickable link from
the help for any function to its source code, if you really want to know what’s
going on).
</p>
</div>
<div id="outline-container-org4cef90f">
<h4 id="org4cef90f">Buffers</h4>
<p>
The text of any file you’re editing is stored in a <a href="#orgc3260f6"><i>Buffer</i></a>.  But so is almost
everything else: documentation, error messages, and the user interfaces (UIs) to
the many Emacs subsystems (file managers, email, REPLs, etc).  This means that
to a great extent you can manipulate a UI using the same commands you use to
manipulate the text you’re editing, which is very powerful and means you have
less to learn.
</p>
</div>
<div id="outline-container-org93fc1dc">
<h4 id="org93fc1dc">Plain Text</h4>
<p>
The power of the Buffer is due to the fact that Emacs prioritizes plain text.
Almost everything you see in Emacs is plain text.  This doesn’t mean everything
<i>looks</i> plain; the typical Emacs Buffer is colorized, uses a variety of fonts and
possibly character sets, and may include “clickable”<sup><a id="fnr.18" href="#fn.18" role="doc-backlink">18</a></sup> buttons, read-only
sections, dynamically updating data, icons and full-size images, and more: but
the Buffer still consists of plain text and the enhancements are applied on top
of it.
</p>
</div>
<div id="outline-container-orge6b125f">
<h4 id="orge6b125f">Windows</h4>
<p>
<a href="#org9409b46">Windows</a> are the viewports into your Buffers.  You can have an arbitrary number
of open windows at any time, divided up horizontally and vertically, and Emacs
acts like a <a href="https://en.wikipedia.org/wiki/Tiling_window_manager">tiling window manager</a> to manage them for you.
</p>
</div>
<div id="outline-container-orgdccbf7d">
<h4 id="orgdccbf7d">Search</h4>
<p>
Emacs has a very wide variety of <a href="#org3fa1f0c">search</a> commands which do more than simply find
the next occurrence of “foo” in your file.  You can search within a Buffer,
across multiple Buffers, across files that aren’t loaded into Emacs yet, and
across the web.  You can search back in time by searching version control
history.  You can search more than just files: since Emacs subsystems (like
calendars, shells, and email) run in Buffers, you can search their user
interfaces and outputs.  You can search all the Emacs documentation, and you can
search for things by their names as well as by what they contain.  Searches can
take you directly to a match or pop up a Buffer of all the matches (rather like
a page of Google search results), from which you can jump to the actual
locations.  All these searches come in a flexible variety of modes (fixed text,
lax spacing, case- and diacritic-folding, word search, <a href="#org19c6ad0">regular expression</a>, and
more), and since you’re doing all this searching in Emacs rather than in a dozen
distinct programs, they share the same options and syntax.
</p>
</div>
<div id="outline-container-org319a0da">
<h4 id="org319a0da">Undo and Redo</h4>
<p>
While common now, <a href="#org3f93c8e">unlimited Undo with redo</a> probably debuted in Emacs in the
early 1980s.  You can undo all changes (even back through file saves) and redo
them (undo the undo) all the way forward again, in any combination (you can undo
the redo of the undo of the undo).  Undo is smart in that it groups togther tiny
changes (e.g. consecutive single-character insertions) to make undoing less
tedious, and commands that make big structured changes (like search-and-replace)
arrange for undo to happen in sensible units.  There’s an alternative Undo that
works in a tree-structured manner.  Most powerful is that you can mark off a
specific subregion of the Buffer, and then undo only the changes made within
that region (even if you’ve since made other changes elsewhere).
</p>
</div>
<div id="outline-container-org2cfc95a">
<h4 id="org2cfc95a">Major and Minor Modes</h4>
<div id="text-org2cfc95a">
<p>
Every Buffer has a <a href="#org5b21ef0"><i>Major Mode</i></a> that’s specialized for some particular sort of
text.  The specializations typically affect the visual display of the text,
tweak general-purpose commands to better suit the text, and provide key bindings
for new commands written specifically to work with that kind of text.  The
classic case is a Major Mode for editing the source code of a given programming
language — for example, the mode specializations of <code>python-mode</code> turn Emacs
into a Python IDE.
</p>

<p>
In addition to <i>Major</i> Modes, we also have <i>Minor Modes</i>.  A Major Mode implements
sweeping specializations — you wouldn’t want to edit HTML in <code>python-mode</code> —
but Minor Modes are like mix-ins: each Minor Mode implements some sort of tweak
to behavior or appearance that’s usually suitable to add to any number of Major
Modes.  While any Buffer has exactly one Major Mode, you might turn on a few
dozen Minor Modes as well.  Minor Modes can implement additional varieties of
navigation, formatting, indentation, highlighting, templating, diagramming,
spellcheck, footnotes, tables, outlining, text folding, hypertext linking, and
much more.
</p>

<p>
My Emacs at the moment has 638 major and minor modes ready to be
enabled.
</p>
</div>
</div>
<div id="outline-container-org1218139">
<h4 id="org1218139">Customization</h4>
<p>
One of the hallmarks of Emacs is that virtually every aspect of it can be
customized.  Not only can you customize fonts, colors, and keystrokes but you
can customize them all differently in different parts of Emacs (one font set for
Python, another for Haskell).  Conversely, if you use Emacs for your email and
someone mails you a snippet of Python, you see it, in the email, colorized
according to your preferences.  Emacs customization is sometimes thought of as
unfathomable unless you’re a Lisp programmer, but for decades Emacs has had an
interactive forms-based customization system (called <a href="#org27e6769">Customize</a>) that lets
anybody easily tweak anything.
</p>
</div>
<div id="outline-container-org5bfa59e">
<h4 id="org5bfa59e">Programmabililty</h4>
<div id="text-org5bfa59e">
<p>
But if you <i>are</i> willing to learn a little Lisp (or a lot), you can also customize
Emacs in the programming language that it’s implemented in, <a href="https://en.wikipedia.org/wiki/Emacs_Lisp">Emacs Lisp</a>
(a.k.a. <i>Elisp)</i>; having used Emacs since before the Customize system existed,
I still do all my customizations this way.<sup><a id="fnr.19" href="#fn.19" role="doc-backlink">19</a></sup>  But with Elisp you can go well
beyond mere customization: you can add completely new features to Emacs that
never existed.  This could range from three lines of code to add an
idiosyncratic way of scrolling text (I’ve defined a keystroke to scroll by
paragraphs) to building large software systems that would, in a non-Emacs
universe, be standalone applications.  The popular <a href="https://magit.vc/">Magit</a> front-end to the <a href="https://git-scm.com/">Git</a>
version control system comprises 30,000 lines of Elisp code.  <a href="">Gnus</a>, one of
several Emacs mail readers, comprises 117,485 lines!  Emacs itself is about 79%
Elisp (the rest being a C core that implements the Lisp interpreter).
</p>

<p>
Note that Emacs Lisp isn’t an ad hoc scripting language invented for use in just
one editor.  It’s a dialect of the <a href="https://en.wikipedia.org/wiki/Lisp_(programming_language)">famous programming language Lisp</a>, which means
it has a decades-old well-designed syntax and semantics.  It’s a <i>real</i>
programming language: in addition to the multiple books and articles written
about Elisp, you can also learn from the hundreds of books and articles written
about Lisp itself.  And, what you learn about Elisp sets you on the way to
becoming a real Lisp programmer.
</p>

<p>
But if you’re not interested in learning Lisp, you can still program your Emacs
via the incredibly powerful macro system called <a href="#orgd2c3858">Keyboard Macros</a>.  You simply
start defining a macro, perform a sequence of editing actions (e.g., search for
a keyword, capitalize it, delete the next two words, and add another word at the
end of the line), then indicate you’re done.  Now a keystroke runs the macro to
repeat those actions.  Once you’re convinced it’s working, you can tell Emacs to
repeat the macro until it’s processed everything.  Macros aren’t limited to
operating on just one Buffer: you can use any Emacs commands in defining one,
and so can switch Buffers mid-macro at will.
</p>

<p>
But Emacs goes well beyond the capabilities of most macro systems.  Since
invoking an external shell command is a basic capability of Emacs, you can do
that in your macro and use the result.  You can have many macros defined at
once.  You can edit your macro (rather than having to redefine it) if you
discover it’s not quite right.  You can save your macro with a name for use in
future Emacs sessions.  A macro can count (to do things like numbering).  It can
ask for confirmation of a step, or allow you to do a localized tweak at
each invocation.  All this without being a programmer.
</p>
</div>
</div>
<div id="outline-container-org1f8f36a">
<h4 id="org1f8f36a">Free Software</h4>
<p>
Finally, GNU Emacs is <i>free software</i>.  This doesn’t mean that you don’t have to
pay for Emacs (though you don’t).  It means that the project is built upon what
the <a href="https://www.fsf.org/">Free Software Foundation</a> (FSF) calls the “four freedoms” — the freedom to
(0) run the program, (1) study and change the program in source code form, (2)
redistribute exact copies, and (3) distribute modified versions.  The FSF
achieves this via the frankly amazing invention of the <a href="https://www.gnu.org/copyleft/"><i>Copyleft license</i></a>.
Without it, Emacs probably wouldn’t exist as the long-lived, continuously
improving project that it is.  And it assures that Emacs can never be taken away
from you by any corporate entity.
</p>
</div>
</div>
<div id="outline-container-org8dd614c">
<h3 id="org8dd614c">The Keyboard and Key Bindings <a id="orge245187"></a></h3>
<div id="text-org8dd614c">
<blockquote>
<p>
It makes sense for someone who spends most of their time manipulating
text to learn a group of obscure key combinations.  It saves time and
increases productivity.  Learning to use Emacs properly reminds me of
playing Jazz on the piano.  I’ve learnt all those chords and runs and
fills so that I can use them without thinking when I’m improvising.
Likewise, I’ve practised using Emacs key strokes such as <code>M-f</code>, [ <code>M-c</code> ]
and <code>C-M-&lt;Space&gt;</code> so often I use them without thinking when editing.  I
rely on <code>M-/</code> to complete words, and I can’t do without <code>M-h</code> and <code>C-e</code> to
select and move around text. — <a href="https://tonyballantyne.com/my-emacs-writing-setup/"><i>Tony Ballantyne (SF and Fantasy Writer)</i></a>
</p>
</blockquote>

<p>
For Emacs, every keystroke is actually a command (i.e., a function that does
something), even simple keystrokes like the letter A: printing characters like
this are commands to insert themselves into your text.  Non-printing characters
(like control characters) are editing commands, which might move the cursor,
scroll some text, delete or copy text, rename a file, initiate sending an email,
etc.
</p>

<p>
Every command has a long name, which you can look up in the documentation, like
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Killing-by-Lines"><code>kill-line</code></a>﻿,   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Deletion"><code>delete-backward-char</code></a>﻿, or
  <code>self-insert-command</code>.  Many commands are bound to keystrokes
for convenient editing.  We call such a pairing of keystroke and command a <i>key
binding</i>, or <i>binding</i> for short.
</p>

<p>
The set of all bindings make up the Emacs command set.  However, Emacs is an
extensible, customizable editor.  This means that:
</p>

<ul>
<li>bindings can be different when editing different types of text, by virtue of
extensibility</li>
<li>bindings can be different for different users, by virtue of customizability</li>
</ul>

<p>
In this document I describe the standard, uncustomized, Emacs key bindings.
</p>
</div>

<div id="outline-container-org696d674">
<h4 id="org696d674">Notation</h4>
<div id="text-org696d674">
<p>
I use the standard Emacs notation to describe keystrokes:
</p>

<dl>
<dt><code>C-x</code></dt><dd>For any <i>x</i>, the keystroke <i>Control+x</i>.</dd>
<dt><code>M-x</code></dt><dd>For any <i>x</i>, the keystroke <i>Meta+x</i> (see below for more details on Meta
keystrokes).</dd>
<dt><code>C-M-x</code></dt><dd>For any <i>x</i>, the keystroke <i>Control+Meta+x</i> (which is exactly
the same as <i>Meta+Control+x</i>.).</dd>
<dt><code>S-x</code></dt><dd>For any <i>x</i>, the keystroke <i>Shift+x</i></dd>
<dt><code>s-x</code></dt><dd>For any <i>x</i>, the keystroke <i>Super+x</i><sup><a id="fnr.20" href="#fn.20" role="doc-backlink">20</a></sup></dd>
<dt><code>RET</code></dt><dd>The return key.</dd>
<dt><code>SPC</code></dt><dd>The space bar.</dd>
<dt><code>ESC</code></dt><dd>The escape key.</dd>
</dl>

<p>
Control, Meta, and Super are <i>modifier keys</i>, i.e. they only take effect when held
down <i>simultaneously</i> with another key, exactly like Shift.  If you hold down
Shift, Control, or Meta alone, and then simply release it, Emacs doesn’t even
know you’ve done so: you must add a non-modifier key for the combination to
register as a keystroke.  You can combine as many modifier keys together as you
have fingers for.
</p>

<p>
Your keyboard may have even more modifier keys.  Emacs is aware of these other
modifiers but doesn’t have any standard bindings that use them (you can use them
for your own purposes though).  In fact, because of arbitrary differences
between the keyboards of different computer manufacturers<sup><a id="fnr.21" href="#fn.21" role="doc-backlink">21</a></sup>, Emacs’s Meta
modifier really stands for “your preferred non-Control modifier key”.
</p>

<p>
We don’t typically mention Shift as a modifier key, usually just writing <code>X</code>
instead of <code>S-x</code>, and only use the <code>S-</code> notation occasionally for disambiguation or
emphasis.  The <code>S-</code> modifier can of course be combined with other modifiers
(e.g. <code>S-M-x</code>, which is equivalent to <code>M-X</code>, or <code>S-C-M-5</code>, which is equivalent to
<code>C-M-%</code>).  Unless you choose to make a distinction with a custom binding, Emacs
almost always equates a shifted letter in a keystroke with the lowercase version
of the same keystroke: so for example both <code>M-x</code> and <code>M-X</code> (a.k.a. <code>S-M-x</code>) are
equivalent: both invoke   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/M-x"><code>execute-extended-command</code></a>﻿.  See
<a href="#orgacaa0f1"><i>Shift Selection</i></a> for the only major exception.
</p>
</div>
</div>
<div id="outline-container-orge0695d4">
<h4 id="orge0695d4">Simple Keys</h4>
<div id="text-orge0695d4">
<p>
There are 95 different basic printable characters<sup><a id="fnr.22" href="#fn.22" role="doc-backlink">22</a></sup>, and they are all bound to
  <code>self-insert-command</code> so that they insert themselves as text
when typed.  For editing commands, Emacs uses all the control characters: <code>C-a</code>,
<code>C-b</code>, etc.  But this is only 32 characters, and Emacs has more than 32 editing
commands.<sup><a id="fnr.23" href="#fn.23" role="doc-backlink">23</a></sup>
</p>

<p>
To provide access to more key bindings, Emacs uses a <i>Meta</i> key<sup><a id="fnr.24" href="#fn.24" role="doc-backlink">24</a></sup>.  This gives
us access to keystrokes such as <code>M-a</code>, <code>M-b</code>, etc.
</p>

<p>
Since Control and Meta are both shift-like <a href="https://en.wikipedia.org/wiki/Modifier_key">modifier keys</a>, what happens if you
hold down both and then type a key?  These combinations are valid keystrokes as
well; they are notated <code>C-M-a</code>, etc.  Because both Control and Meta are modifier
keys, <code>C-M-a</code> must necessarily be the same keystroke as <code>M-C-a</code>.  For consistency we
always write the former.
</p>
</div>
</div>

<div id="outline-container-orgb193780">
<h4 id="orgb193780">Prefix or Compound Keys <a id="org7ae2b56"></a></h4>
<div id="text-orgb193780">
<p>
The Control and Meta keys plus the printing characters give us 256 possible
keystrokes<sup><a id="fnr.25" href="#fn.25" role="doc-backlink">25</a></sup>, or 160 editing commands after eliminating the self-inserting
characters.  But Emacs has many more than 160 commands!  To handle this we also
use <i>prefix commands</i>.  A prefix command is a keystroke that, when typed, waits
for another keystroke to be typed, making a pair (sequence) of keystrokes bound
to one command.  Each prefix command adds another 256 keystrokes that we can
bind commands to.  Prefix commands often group together commands that are
somehow related.
</p>

<p>
The most important prefix commands are:
</p>

<dl>
<dt><code>C-h</code></dt><dd>The <i>help</i> prefix, used for Help commands.</dd>
<dt><code>C-x</code></dt><dd>The <i>extended</i> prefix; this prefix is used mostly for commands that
manipulate files, buffers and windows.</dd>
<dt><code>C-c</code></dt><dd>The <i>context-specific</i> prefix.  Used for commands that are specific to
particular <a href="#org5b21ef0">Modes</a>, so they are free to be used for different commands depending
on context.  This prefix also reserves a set of keystrokes specifically for
the user to use for their own purposes.  These are the most variable of Emacs
commands.</dd>
</dl>

<p>
These three prefixes give us another 768 keystrokes, for a total of 928.  But
Emacs has far more than 928 commands!  To handle this, you can bind one of the
subcommands of a prefix command to another prefix command, like <code>C-x 4</code> for
example, or <code>C-x v</code>, each such binding yielding potentially another 256
keystrokes.  A number of these two-character prefixes exist, but they’re rather
specialized, and don’t contain a full set of 256 commands (usually there are
only a few, and the prefix is just used for a mnemonic grouping).  There are
even three character prefixes, but most people won’t admit to using them.
</p>

<table>
<caption><span>Table 1:</span> Some More Prefix Keys</caption>

<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Prefix</th>
<th scope="col">Bindings</th>
<th scope="col">Commands</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>C-h</code></td>
<td>40</td>
<td><a href="#orge57a011">Help</a> commands</td>
</tr>

<tr>
<td><code>C-x 4</code></td>
<td>15</td>
<td>Other-Window commands</td>
</tr>

<tr>
<td><code>C-x 5</code></td>
<td>15</td>
<td>Other-Frame commands</td>
</tr>

<tr>
<td><code>C-x 8</code></td>
<td>185</td>
<td><a href="#org5f6b09d">Unicode character insertion</a></td>
</tr>

<tr>
<td><code>C-x @</code></td>
<td>6</td>
<td>Keyboard Event commands</td>
</tr>

<tr>
<td><code>C-x RET</code></td>
<td>11</td>
<td><a href="#org2733d30">Coding System</a> commands</td>
</tr>

<tr>
<td><code>C-x a</code></td>
<td>12</td>
<td><a href="#orgd0268b2">Abbrev</a> commands</td>
</tr>

<tr>
<td><code>C-x n</code></td>
<td>5</td>
<td><a href="#org39c0e40">Narrowing</a> commands</td>
</tr>

<tr>
<td><code>C-x r</code></td>
<td>27</td>
<td><a href="#orgf8d8a5e">Rectangle</a>, <a href="#orgcfc576b">Register</a>, and <a href="#org5690965">Bookmark</a> commands</td>
</tr>

<tr>
<td><code>C-x t</code></td>
<td>20</td>
<td><a href="#orgc6b43c3">Tab Bar</a> commands</td>
</tr>

<tr>
<td><code>C-x v</code></td>
<td>25</td>
<td><a href="#org53af7eb">Version Control</a> commands</td>
</tr>

<tr>
<td><code>C-x x</code></td>
<td>7</td>
<td><a href="#orgc3260f6">Buffer</a> commands</td>
</tr>

<tr>
<td><code>M-g</code></td>
<td>9</td>
<td><a href="#org6517779">Goto</a> commands</td>
</tr>

<tr>
<td><code>M-s</code></td>
<td>8</td>
<td><a href="#org3fa1f0c">Search</a> commands</td>
</tr>

<tr>
<td><code>M-s h</code></td>
<td>7</td>
<td><a href="#orgde73944">Highlight</a> commands</td>
</tr>

<tr>
<td><code>&lt;f1&gt;</code></td>
<td> </td>
<td>An alias for <code>C-h</code></td>
</tr>

<tr>
<td><code>&lt;f2&gt;</code></td>
<td>4</td>
<td>Two-Column commands</td>
</tr>

<tr>
<td><code>C-x 6</code></td>
<td> </td>
<td>An alias for <code>&lt;f2&gt;</code></td>
</tr>
</tbody>
<tbody>
<tr>
<td> </td>
<td>396</td>
<td> </td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgd8dfff8">
<h4 id="orgd8dfff8">Aborting a Command <a id="org60577ca"></a></h4>
<div id="text-orgd8dfff8">
<p>
What if you start typing a prefix, like <code>C-x</code>, and then decide you didn’t mean it?
Emacs will be sitting there, showing this in the Echo Area:
</p>
<pre>C-x-
</pre>

<p>
waiting for you to finish.  You can abort this partially completed prefix by
typing     <code>C-g</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Quitting"><code>keyboard-quit</code></a>﻿).<sup><a id="fnr.26" href="#fn.26" role="doc-backlink">26</a></sup>
</p>

<p>
You can also interrupt a command that’s asking you a question, or for
information (like a file name): if you type the command to open a file and it’s
asking you for the filename, but you’ve changed your mind, <code>C-g</code> will abort it.
It will also interrupt a running command that you want to now stop.  Perhaps
you’re editing a file and have initiated a search-and-replace operation, and
after several replacements, you see it was not what you wanted: <code>C-g</code> will
interrupt it in the middle (and, of course, you can then Undo what you’d already
done).
</p>
</div>
</div>
<div id="outline-container-org94d0389">
<h4 id="org94d0389">Using Extended Commands</h4>
<div id="text-org94d0389">
<p>
By now we’ve entered a sort of rarefied atmosphere: even the most hardcore
Emacs nerd doesn’t really use all these key bindings.  Some Emacs commands are
used very rarely, and, when you need one, it’s easier to invoke the command by
typing its long name directly, using the completion system to remind you of the
precise name.
</p>

<p>
There’s one Emacs command that can be used to execute any other command by
typing its long name: <code>M-x</code> (mnemonic: “eXecute” or “eXtended”).  When you type
<code>M-x</code>, Emacs prompts you, in the Echo Area<sup><a id="fnr.27" href="#fn.27" role="doc-backlink">27</a></sup>, for the name of any command (with
completion), even if that command is bound to one or more keys already, and then
executes it.
</p>

<p>
The prompt looks like:
</p>
<pre>M-x
</pre>

<p>
and the completion works rather like that of any Unix shell, by typing an
initial part of the command and hitting <code>TAB</code><sup><a id="fnr.28" href="#fn.28" role="doc-backlink">28</a></sup>.  So you might type:
</p>
<pre>M-x backw
</pre>

<p>
and hit <code>TAB</code> at that point; Emacs will partially complete this to:
</p>
<pre>M-x backward-
</pre>

<p>
and if you then type:
</p>
<pre>M-x backward-sen
</pre>

<p>
and hit another <code>TAB</code>, it will complete the entire command (because the prefix is
now unambiguous):
</p>
<pre>M-x backward-sentence
</pre>

<p>
Now you can hit return (<code>RET</code>) to execute the command or if that’s not what you
meant, you can edit what you’ve typed (using any Emacs editing commands)
and keep completing as you go; of course a <code>C-g</code> will abort the <code>M-x</code>.
</p>

<p>
If you hit <code>TAB</code> again at the  point at which you’ve achieved a partial completion
(at the point of <code>backw</code> or <code>backward-</code> or <code>backward-sen</code> above), Emacs will pop up a
transient buffer showing all the possible completions (you may discover some
surprising and interesting-sounding commands this way).
</p>

<p>
This can be a lot of commands!  If you type <code>M-x</code> and immediately hit <code>TAB</code>, Emacs
will pop up a buffer showing <i>all</i> the interactive commands that exist at the
moment.  In a stock Emacs, freshly started, this will be over 4,000 commands; in
my current Emacs session, with many third-party packages loaded, I get about
8,000.
</p>

<p>
When you see something like this “    <code>M-a</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Sentences"><code>backward-sentence</code></a>﻿)”
in this book, it means that the keystroke <code>M-a</code> is bound (by default) to the
command <code>backward-sentence</code> (in most Modes, or in the Mode I’m currently talking
about), and so at any moment you can use <code>M-x backward-sentence</code> or <code>M-a</code>, as you
prefer.
</p>
</div>
</div>

<div id="outline-container-org9db2da1">
<h4 id="org9db2da1">Too Many Commands?</h4>
<div id="text-org9db2da1">
<p>
How does anyone remember these 928 commands?  Simple: you don’t.  Every Emacs
user knows a different subset of commands.  I’ve used Emacs for
44 years (starting with the original
TECO Emacs), and I learn useful Emacs commands that are new to me all the time.
Often I notice another Emacs user doing something and I have no idea how they’ve
done it, so I ask and learn some Emacs command that I just never came across, or
never developed as a habit, or once knew and forgot!
</p>

<p>
Some Emacs users just learn the most basic commands and are completely happy.
Most users learn the basics and then some advanced commands that suit their
needs.  Some users are constantly learning new commands to speed their editing.
A nerdy few progress to writing their own totally new Emacs commands.
</p>
</div>
</div>
<div id="outline-container-org890d810">
<h4 id="org890d810">Giving Commands Arguments <a id="orgb0f6ffd"></a></h4>
<div id="text-org890d810">
<p>
Many Emacs commands take arguments, the way a procedure or function takes
arguments in a programming language.  Most commands prompt you for their
arguments: e.g., a command to read in a file will prompt you for the filename.
</p>

<p>
There’s one kind of argument that’s so commonly accepted that there’s a special
way to provide it: a numeric argument.  Many commands will interpret a numeric
argument as a request to repeat themselves that many times.  For example, the
    <code>C-d</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Deletion"><code>delete-char</code></a>﻿) command, which normally deletes one
character to the right of the cursor, will delete <i>N</i> characters if given a
numeric argument of <i>N</i>.  It works with <code>M-x</code> commands and self-inserting commands
too: try giving a numeric argument to a printing character, like a hyphen.
</p>

<p>
To give a command a numeric argument of, say, 12, type <code>C-u 12</code> before typing the
command.  If you type very slowly, you’ll see:
</p>
<pre>C-u 1 2-
</pre>

<p>
in the Echo Area.  Then type <code>C-d</code> and you’ll have given <code>delete-char</code> an argument
of 12.  You can type any number of digits after <code>C-u</code>.  A leading hyphen (<code>C-u - 1
2</code>) makes a negative argument; a lone hyphen (<code>C-u -</code>) is the same as an argument
of -1 (which makes many commands “go backwards” in some sense).  If you begin
typing a numeric argument and change your mind, you can of course type <code>C-g</code> to
abort it.
</p>

<p>
Because a numeric argument is given <i>before</i> you type the command, it’s also
called a <i>prefix argument</i>; see <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Arguments">“Arguments”</a> in the <i>Emacs</i> manual.
</p>

<p>
Since one often isn’t interested in <i>precisely</i> how many times a command is
repeated, there’s a shorthand way to get numeric arguments of varying
magnitudes.  <code>C-u</code> by itself, without any subsequent digits, is equal to a numeric
argument of 4.  Another <code>C-u</code> multiplies that by 4 more, giving a numeric argument
of 16.  Another <code>C-u</code> multiplies that by 4 more, giving a numeric argument of 64,
etc.  So <code>C-u C-u C-u C-d</code> would delete the next 64 characters.
</p>

<p>
<code>C-u</code> can be used before any other command, and for this reason <code>C-u</code> is called the
<i>universal argument</i>.  But note that commands aren’t required to interpret numeric
arguments as specifying repetitions.  It depends on what’s appropriate: some
commands ignore numeric arguments, some interpret them as Boolean (the presence
of a numeric argument — any numeric argument — as opposed to its absence),
etc.  Read the <a href="#orge57a011">documentation</a> for a command before trying it.
</p>
</div>
</div>
<div id="outline-container-org1096803">
<h4 id="org1096803">Disabled Commands <a id="org46fc1c3"></a></h4>
<div id="text-org1096803">
<p>
Some commands that are especially confusing for novices are <i>disabled</i> by
default.  When a command is disabled, invoking it subjects you to a brief
dialog, popping up a window displaying the documentation for the command, and
giving you four choices; for example:
</p>
<pre id="org1f2fb52">You have typed C-x n n, invoking disabled command narrow-to-region.
It is disabled because new users often find it confusing.
Here’s the first part of its description:

   Restrict editing in this buffer to the current region.
   The rest of the text becomes temporarily invisible and untouchable
   but is not deleted; if you save the buffer in a file, the invisible
   text is included in the file.  C-x n w makes all visible again.
   See also ‘save-restriction’.

Do you want to use this command anyway?

You can now type
y   to try it and enable it (no questions if you use it again).
n   to cancel--don’t try the command, and it remains disabled.
SPC to try the command just this once, but leave it disabled.
!   to try it, and enable all disabled commands for this session only.
</pre>
<p>
If you invoked the command by accident, just hit <code>n</code>.  If you’re sure you know
what you’re doing, hit <code>y</code>.  Otherwise, <code>SPC</code> is the way to go, until for any given
command you’re comfortable enough with it to say <code>y</code>.
</p>

<p>
In this book, I make occasional recommendations to un-disable certain commands I
consider very useful; you can see them all in my recommended <a href="#org76237ea">Initial Init File</a>.
</p>
</div>
</div>
<div id="outline-container-orge9bdd97">
<h4 id="orge9bdd97">Felicity in Key Bindings <a id="org38efd5c"></a></h4>
<div id="text-orge9bdd97">
<p>
I define a <i>felicitous key binding</i> to be one that can be easily repeated, possibly
even auto-repeated by your keyboard.  The most felicitous binding is a single
keystroke, like <code>C-f</code>; you can repeat it easily by just holding down Control and
tapping away af <code>f</code>.  Even <i>chorded</i> single keystrokes like <code>C-M-f</code> are maximally
felicitous.
</p>

<p>
Any prefix binding is less so.  A two-character prefix binding that uses the
same modifier key in each case, such as <code>C-x C-t</code>, is not too bad, as you can just
keep the modifier held down and quickly tap <code>x</code> and <code>t</code>.  But when the modifiers
differ, we have maximum infelicity.
</p>

<p>
Consider the horrible horizontal scrolling key-binding
    <code>C-x &lt;</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Horizontal-Scrolling"><code>scroll-left</code></a>﻿),<sup><a id="fnr.29" href="#fn.29" role="doc-backlink">29</a></sup> which is effectively <code>C-x S-,</code>.
Repeatedly invoking this command while observing the change in the visible part
of the text in the Window is like playing a particularly complex arpeggiated
piano part: hold down Control, hit <code>x</code>, lift finger from <code>x</code> and lift finger from
Control, hold down Shift, hit <code>&lt;</code>, lift finger from Shift and from <code>&lt;</code>, and finally
repeat.
</p>

<p>
Since any Emacs command can be bound to more than one keystroke, in some cases
like this, I provide <a href="#org2af3730">Init File</a> snippets with additional more felicitous
bindings, like my <code>S-C-&lt;</code> for <code>scroll-left</code>, which can be easily tapped out or
auto-repeated.
</p>

<p>
In most cases, the felicity of key bindings is a minor issue, but for commands
that you tend to repeat in sequences, like <a href="#org7e57cd2">scrolling commands</a>, <a href="#orgf6ece5b">Window-switching
commands</a>, and <a href="#org6706174">dragging commands</a>, more felicitous bindings can make a big
difference.
</p>
</div>
</div>

<div id="outline-container-org0945e19">
<h4 id="org0945e19">About Mouse Bindings</h4>
<div id="text-org0945e19">
<p>
As mentioned, I don’t use the mouse in Emacs at all (and barely at all in an
external web browser, my only other GUI application), so I won’t be devoting
much space to it, except to say that Emacs fully supports it.
</p>

<p>
The <a href="https://en.wikipedia.org/wiki/Computer_mouse">mouse</a> is a much more complex user interface device than the keyboard.
Consider the traditional hand-held mouse (ignoring laptop <a href="https://en.wikipedia.org/wiki/Touchpad">touchpads</a> for the
moment).  The minimal mouse has one button, which, like a key on a keyboard, can
be pressed (or <i>clicked</i>) to generate an <i>event</i> that can be bound to an Emacs
command.  Also like a key-press, this button-click can be modified by any of the
keyboard modifier keys, such as Shift, Control, Meta, and the like.
</p>

<p>
But the complexity of a single mouse click goes way beyond this.  We need to
potentially distinguish between a button-<i>press</i> and a button-<i>release</i>, a simple
in-place click versus a <i>drag</i>, motion without clicking, and double- and triple-clicks
(or even more).
</p>

<p>
But that’s not all: many mice have more than one button: mice on Unix systems
traditionally have three buttons, and two- and five-button mice are common.
Unlike non-modifier keyboard keys, multiple mouse buttons can be <i>chorded</i>: that
is, pressing or clicking two or more buttons simultaneously counts as a
completely different button!<sup><a id="fnr.30" href="#fn.30" role="doc-backlink">30</a></sup>  Many mice have a <i>scroll wheel</i>, which acts as
another, more complex button, which may also <i>tilt</i>.  Laptop touchpads add more
complexity.  And the keyboard modifier keys can be mixed into all of this.
</p>

<p>
Emacs defines an abstraction of all this complexity, defines a set of default
global mouse bindings, and of course allows you to modify or add mouse bindings
yourself.<sup><a id="fnr.31" href="#fn.31" role="doc-backlink">31</a></sup>
</p>

<p>
All that said, I’ll just summarize the most basic default global mouse bindings;
you can get complete details in
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Mouse-Commands">the manual</a>.
</p>

<ul>
<li>clicking button 1 moves <a href="#orgba1f634">Point</a> to the location of the click</li>
<li>dragging with button 1 <a href="#org34ab2da">selects text</a></li>
<li>clicking button 2 moves Point and <a href="#orge04d5e2">pastes</a> the contents of the system
clipboard<sup><a id="fnr.32" href="#fn.32" role="doc-backlink">32</a></sup></li>
<li>clicking button 3 copies the text between Point and the clicked location to the <a href="#orgee263e4">kill ring</a></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org83330ca">
<h3 id="org83330ca">Files, Buffers and Windows in Brief</h3>
<div id="text-org83330ca">

<div id="org1e0e9e4">
<p><img src="https://blog.veitheller.de/images/data-structures.png" alt="data-structures.png" width="100%"/>
</p>
<p><span>Figure 3: </span>Emacs Data Structures</p>
</div>
<p>
<b>Legend:</b>
</p>
<table>


<colgroup>
<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td>*</td>
<td>One or more</td>
</tr>

<tr>
<td>1</td>
<td>Exactly one</td>
</tr>

<tr>
<td>1?</td>
<td>One or none</td>
</tr>
</tbody>
</table>

<p>
Emacs has three data structures (actually four) that are intimately related,
and essential to appreciate.
</p>

<dl>
<dt>File</dt><dd>A <i>file</i> is the actual file on disk.  You are never directly editing the
data in this file.  Rather, you read a copy into Emacs to initialize a <i>buffer</i>,
edit the buffer’s copy, and write the contents of the buffer back out to the
file to save it.  A file of course contains <i>text</i>: characters in some character
set, say, Unicode<sup><a id="fnr.33" href="#fn.33" role="doc-backlink">33</a></sup>.</dd>

<dt>Buffer</dt><dd>A <i>buffer</i> is the internal data structure that holds the text you
actually edit.  Emacs can have any number of buffers at any moment.  Many
buffers, but by no means all, are associated with a file.  Buffers have names;
a buffer that has been initialized from a file is almost always named for that
file, and we say that the buffer is <i>visiting</i> the file.  This means, in
particular, that when you save the buffer, it’s saved to the proper file.  At
any given instant exactly one buffer is selected or <i>current</i> (even if several are
visible): this is the buffer that your focused cursor is in, and this is where
most of the commands you type take effect (including self-insert commands).
Buffers can be deleted at will; deleting a buffer in no way deletes any file
on disk, and if you have any unsaved editing changes, Emacs won’t let you
delete the buffer (unless you insist).  See <a href="#orgc3260f6"><i>Buffers</i></a> for details.</dd>

<dt>Window</dt><dd><p>
A window is a view into a buffer.  You can split any window,
horizontally or vertically, into as many windows as you like (or at least have
room for), each viewing a different buffer.  It’s also possible to have
several windows viewing different portions of the <i>same</i> buffer.  The
relationship between buffers and windows is transient: typically, many buffers
have no window viewing them at any moment and in general, buffers outnumber
windows by a large margin.
</p>

<p>
Windows can be created and deleted at will; deleting a window in no way
deletes the buffer associated with the window.  Each window has its own Mode
Line, but there’s still only the one Echo Area.  See <a href="#org9409b46"><i>Windows</i></a> for details.
</p>

<p>
Don’t confuse Emacs windows with windows on your desktop!  Emacs had
multiple windows two years before Graphical User Interfaces were commercially
available.  Once GUI desktops became common and used the term “window” for their own
purposes, Emacs added support for these “desktop windows”, but needed to use a
new name for them: <i>Frame</i>.
</p></dd>

<dt>Frame</dt><dd>A frame is a “desktop window” that is treated as a separate entity
under a windowing system like <a href="https://en.wikipedia.org/wiki/X_Window_System">X</a>.  When Emacs starts up, it creates one frame
for you, but you can have as many as you like.  Each frame can hold several
Emacs windows, and, in fact, has it’s own Echo Area (I lied above), but all
buffers are shared in common across all frames.  I won’t be discussing frames
much, as I rarely want more than one.  But see <a href="#org4dd50c2"><i>Frames</i></a> for details.</dd>
</dl>
</div>

<div id="outline-container-orgefe16aa">
<h4 id="orgefe16aa"><a id="org12c0a40"></a> Basic File Concepts and Commands</h4>
<div id="text-orgefe16aa">
<p>
The most common things you do with files are load them and save them.
</p>

<dl>
<dt>    <code>C-x C-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-file</code></a>﻿)</dt><dd>This is the main command used to
read a file into a buffer for editing and is what the menu item File / Open
File does.  It’s actually rather subtle.  When you execute this command, it
prompts you for the name of the file (with <a href="#org75fb6a2">completion</a>).  Then it checks to see
if you’re already editing that file in some buffer; if you are, it simply
switches to that buffer and doesn’t actually read in the file from disk again.
If you’re not, a new buffer is created, named for the file, and initialized
with the contents of the file.  To create a brand new file, just type a nonexistent
file name; you’ll get an empty buffer that will create a new file when saved<sup><a id="fnr.34" href="#fn.34" role="doc-backlink">34</a></sup>.  In
any case, the current window is switched to view this buffer.</dd>
<dt>    <code>C-x C-s</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Save-Commands"><code>save-buffer</code></a>﻿)</dt><dd>This is the main command used to
save a file, or, more accurately, to write a copy of the current buffer out
to the disk, overwriting the buffer’s file, and handling <a href="#org0c51c8b">backup versions</a>.</dd>
<dt>    <code>C-x s</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Save-Commands"><code>save-some-buffers</code></a>﻿)</dt><dd>This command allows you to
save all your buffers that are visiting files and have modifications, querying
you for each one and offering several options for each (save it, don’t save
it, peek at it first then maybe save it, just save all of them without asking,
etc).<sup><a id="fnr.35" href="#fn.35" role="doc-backlink">35</a></sup></dd>
</dl>

<p>
See <a href="#orgeabd905"><i>Files</i></a> for more information.
</p>
</div>
</div>
<div id="outline-container-org48369b5">
<h4 id="org48369b5">Basic Commands to Manipulate Buffers <a id="orgcf558ce"></a></h4>
<div id="text-org48369b5">
<p>
The most common things you do with buffers, which you can for now think of as
opened files, are switch between them, list them (in case you’ve forgotten which
ones you’ve opened), and occasionally clean them up.  But to paraphrase
<a href="https://en.wikipedia.org/wiki/Fran%C3%A7ois-Andr%C3%A9_Danican_Philidor">Philidor</a>, “The buffers are the soul of Emacs” and in short order you’ll be doing
a lot more with them.
</p>

<dl>
<dt>    <code>C-x b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer"><code>switch-to-buffer</code></a>﻿)</dt><dd>Prompts for a buffer name
(with <a href="#org75fb6a2">completion</a>) and switches the buffer of the current window to that
buffer.  Doesn’t change your window configuration (if you had three windows
before, you still have three afterwards).  This command will also create a new
empty buffer if you type a new name; this new buffer will not be visiting any
file, no matter what you name it (until you save it, at which point it will be
visiting the just-created file).</dd>

<dt>    <code>C-x C-b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/List-Buffers"><code>list-buffers</code></a>﻿)</dt><dd>Pops up a new window which
lists all your buffers, showing for each the name, state (modified or not),
size in bytes, the buffer’s <a href="#org5b21ef0">major mode</a>, and the file the buffer is visiting
(if any).  This is an <i>interactive buffer</i>, meaning that, within it, you’re in a
special mode that allows you to manipulate buffers: select them, delete them,
save them, search a subset of them, etc.</dd>

<dt>    <code>C-x k</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Kill-Buffer"><code>kill-buffer</code></a>﻿)</dt><dd>Prompts for a buffer name (with
<a href="#org75fb6a2">completion</a>) and removes the entire data structure for that buffer from Emacs.
If the buffer is modified <i>and</i> is visiting a file, you’ll be given an
opportunity to save it.  Note that this in no way removes or deletes the
associated file (nor does it delete the window; that window will simply start
displaying some other buffer).  <code>kill-buffer</code> is happy to delete a modified non-file buffer
without any warning however, so don’t keep important notes in buffers like
this (such as the <code>*scratch*</code> buffer).  (Emacs has <a href="#org4a851ca">better ways</a> of note-taking
anyway.)</dd>
</dl>

<dl>
<dt>    <code>C-x C-q</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Misc-Buffer"><code>read-only-mode</code></a>﻿)</dt><dd>Make a buffer <a href="#orgdb8bc3e">read-only</a> (so
that attempts to modify it are treated as errors), or make it read-write if it
was read-only.  If you open a file that you don’t have permission to modify,
Emacs sets the buffer to read-only, to prevent you from wasting your time
editing it when you won’t be able to (directly) save it.  This command lets
you have your way with it.</dd>
</dl>

<p>
See <a href="#orgc3260f6"><i>Buffers</i></a> for more information.
</p>
</div>
</div>
<div id="outline-container-org44a8629">
<h4 id="org44a8629">Basic Commands to Manipulate Windows <a id="org341aea6"></a></h4>
<div id="text-org44a8629">
<p>
Just like the windows on your desktop, the most common things you do with Emacs
windows are create them, delete them, resize them, switch between them (i.e.,
change the focus), and scroll around in them.  Emacs manages its windows in a
<i>tiling</i> manner, like one of those <a href="https://en.wikipedia.org/wiki/Tiling_window_manager">tiling window managers</a> that are all the rage
these days.
</p>

<p>
See <a href="#org9409b46"><i>Windows</i></a> for more information.
</p>
</div>

<div id="outline-container-org14597bf">
<h5 id="org14597bf">Create a New Window</h5>
<div id="text-org14597bf">
<p>
To create a new window, you have to pick an existing window (there’s always at
least one!) and split it in two.  You can split it vertically (which means you
now have less vertical space in the original window) or horizontally.
</p>

<dl>
<dt>    <code>C-x 2</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Split-Window"><code>split-window-below</code></a>﻿)</dt><dd>Splits the current window
in two, vertically (into two windows, one below the other).  This creates a
new window, but not a new buffer: the same buffer will now be viewed in the
two windows.  This allows you to view two different parts of the same
buffer simultaneously, by moving around independently in the two windows.
Of course you can switch to a different buffer in one of these two windows
with, say,     <code>C-x b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer"><code>switch-to-buffer</code></a>﻿) or
    <code>C-x C-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-file</code></a>﻿).  Mnemonic: “2 windows where there was 1”.</dd>
<dt>    <code>C-x 3</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Split-Window"><code>split-window-right</code></a>﻿)</dt><dd>Splits the current
window in two, horizontally (into two windows, side by side).  This also
creates only a new window, and not a new buffer: the same buffer will now be
viewed in the two windows.  Mnemonic: “slightly different from <code>C-x 2</code>”.</dd>
</dl>
</div>
</div>
<div id="outline-container-org8058223">
<h5 id="org8058223">Delete a Window</h5>
<div id="text-org8058223">
<dl>
<dt>    <code>C-x 0</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Change-Window"><code>delete-window</code></a>﻿)</dt><dd>Deletes just the current window,
resizing the other windows in the current frame appropriately.  This does <i>not</i>
delete the buffer (nor file) associated with the window.  Mnemonic: “zero this
window”.</dd>
<dt>    <code>C-x 1</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Change-Window"><code>delete-other-windows</code></a>﻿)</dt><dd>Deletes all other windows
in the frame except the current one, making one window in the frame.  Does <i>not</i>
delete the buffers (or files) associated with the other windows.  Mnemonic:
“show me just this 1 window”.</dd>
</dl>
</div>
</div>

<div id="outline-container-org46519cc">
<h5 id="org46519cc">Resize Windows</h5>
<div id="text-org46519cc">
<p>
Since Emacs tiles windows, you can’t resize just one window<sup><a id="fnr.36" href="#fn.36" role="doc-backlink">36</a></sup>.  If you want to
make it bigger, you have to steal real estate from some other window, and if you
want to make it smaller, you have to donate real estate.
</p>

<p>
I think the default Emacs key bindings for resizing windows are very awkward;
see <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Change-Window">“Change Window”</a> in the <i>Emacs</i> manual.  This is easily fixed with some
custom bindings; I’ll give the ones I’ve used for years later.
</p>

<p>
In <a href="#org6444e1f">graphical mode</a>, you can use the mouse: just point the mouse at the Mode Line
that’s between the two windows whose mutual sizes you want to adjust.  Point
anywhere in the mode line as long it’s not on top of any text or icon, and then
click and drag with the left mouse button.
</p>

<p>
Side-by-side windows (as created by     <code>C-x 3</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Split-Window"><code>split-window-right</code></a>﻿)) don’t have a Mode Line between them, of course, but
there is a vertical dividing line that you can likewise use, with the mouse, for resizing.
</p>
</div>
</div>

<div id="outline-container-orgcd34868">
<h5 id="orgcd34868">Switch Windows</h5>
<div id="text-orgcd34868">
<p>
The simplest way to switch windows is to cycle through all of them with <code>C-x o</code>,
stopping at the one you wanted to get to.  I rarely do it this way and will
discuss better, less tedious methods later.  In <a href="#org6444e1f">graphical mode</a>, you can use the
mouse to switch windows: just click anywhere in the desired window with the left
mouse button.
</p>

<dl>
<dt>    <code>C-x o</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Window"><code>other-window</code></a>﻿)</dt><dd>Switch to another window, making
it the active window.  Repeated invocation of this command moves through all
the windows in the frame, left to right and top to bottom, and then circles
around again.</dd>
</dl>
</div>
</div>

<div id="outline-container-org782cfcc">
<h5 id="org782cfcc">Scroll Within a Window <a id="orga7c843b"></a></h5>
<div id="text-org782cfcc">
<p>
Scrolling horizontally is only necessary if you have a combination of skinny
windows and long lines; we’ll ignore that for now.  But it’s very common for a
file to have many more lines than will fit vertically in a window.
</p>

<p>
You can of course scroll with the mouse and the scrollbar (or the scroll wheel)
if you don’t mind taking your hands off the keyboard.
</p>

<dl>
<dt>    <code>C-v</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Scrolling"><code>scroll-up</code></a>﻿)</dt><dd>The basic command to scroll forward
(towards the end of the file) by one screenful.  (Is this up or down?  Depends
on your point of view.)  By default Emacs leaves you two lines of context
from the previous screen.  Mnemonic: “View more of the buffer” or “The <i>V</i>
points toward the text you want to see”.  <code>scroll-up</code> is also bound to the
<code>&lt;PageDown&gt;</code> key<sup><a id="fnr.37" href="#fn.37" role="doc-backlink">37</a></sup>.</dd>
<dt>    <code>M-v</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Scrolling"><code>scroll-down</code></a>﻿)</dt><dd>Just like <code>C-v</code>, but scrolls
backwards.  Mnemonic: “Meta V goes the other way”.  <code>scroll-down</code> is also bound
to the <code>&lt;PageUp&gt;</code> key.</dd>
</dl>

<p>
You can also directly scroll a window other than the one you’re in.  This is
just a shorthand for switching to the window you want to scroll, scrolling it,
and switching back to the window you came from.  If you have a lot of windows in
your frame, that’s exactly what you’ll have to do, but for the common case of
two windows, we have a simple command:
</p>

<dl>
<dt>    <code>C-M-v</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Window"><code>scroll-other-window</code></a>﻿)</dt><dd>Just like <code>C-v</code>, but scrolls
the other window.  This works with more than two windows, in which case the
other window is the window that <code>C-x o</code> would switch to.  You can give it a
negative argument to make it scroll backwards.</dd>
</dl>

<p>
There’s more about <a href="#org7e57cd2">scrolling</a> to come.
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org0d4f158">
<h3 id="org0d4f158">Selecting Text: the Point, the Mark, and the Region <a id="orgfab3d04"></a></h3>
<div id="text-org0d4f158">
<p>
Selecting a range of text is fundamental to editing.  It enables you to act
upon the text: delete it, copy it, modify it, change how it’s displayed
(highlight or colorize it, change its font or size), investigate it (count its
words or lines), <a href="#org3fa1f0c">search</a> for other occurrences of it, focus on it (search or undo
within it, <a href="#org39c0e40">narrow</a> to it so that’s all you can see), feed it to something outside
of Emacs.
</p>

<p>
The Emacs term for a range of selected text is the <i>Region</i> (<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Using-Region">“Using Region”</a> in the <i>Emacs</i> manual):
it’s simply the text in your buffer between the <i>Point</i> and the <i>Mark</i>.
</p>
</div>

<div id="outline-container-org93ec176">
<h4 id="org93ec176">The Point <a id="orgba1f634"></a></h4>
<div id="text-org93ec176">
<p>
<i>Point</i> (<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Point">“Point”</a> in the <i>Emacs</i> manual) is the Emacs term for what we’ve been loosely
calling your <i>cursor</i> up to now; the cursor always shows the position of Point.
Point is where text is inserted when you type, and where most editing operations
happen.  When you “move” in a buffer, you’re simply adjusting the location of
Point.
</p>

<p>
Point is really just a number: the offset, in characters, from the beginning of
the buffer, of the character after Point.  You typically don’t care about this
number as such unless you’re writing Elisp, but if you want to know the value of
Point,     <code>C-x =</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Position-Info"><code>what-cursor-position</code></a>﻿) will report it in the <a href="#org7e7133f">echo
area</a> (along with some other interesting information).
</p>

<p>
Point always identifies a location <i>between</i> two characters.  By default, Emacs
displays, in the current window, a cursor at Point in the form of a solid box.
The box seems to be <i>on top of</i> a character, but Point is <i>before</i> that character.
(You could ask Emacs to instead display the cursor as a thin vertical line,
which would make the position of point as <i>between</i> two characters more obvious.)
</p>

<p>
Every window has a distinct Point which is always visible in that window.  This
means that if you visit a file and split the window into two, you can have Point
in a different position in each window, so you can look at distant parts of the
file at the same time.
</p>
</div>
</div>
<div id="outline-container-org357d96a">
<h4 id="org357d96a">The Mark <a id="org40fd5a7"></a></h4>
<div id="text-org357d96a">
<p>
The <i>Mark</i> (<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Setting-Mark">“Setting Mark”</a> in the <i>Emacs</i> manual) is a sort of additional, invisible,
Point.  A buffer has only one Mark<sup><a id="fnr.38" href="#fn.38" role="doc-backlink">38</a></sup>, and every buffer’s is distinct.
However, unlike Point, there’s no Mark in a buffer until you set one (explicitly
or implicitly).
</p>

<p>
The main purpose of the Mark is to determine one end of the Region, Point being
the other.
</p>

<p>
You set the Mark (at the same location as Point) with a special command,
    <code>C-SPC</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Setting-Mark"><code>set-mark-command</code></a>﻿); <code>C-@</code> is an old synonym.  Then, as
you move Point, the Mark stays where you set it and whatever is between the two
forms the Region.
</p>
</div>
</div>
<div id="outline-container-orgb1d3ecc">
<h4 id="orgb1d3ecc">The Region <a id="org34ab2da"></a></h4>
<div id="text-orgb1d3ecc">

<div id="orgc83c433">
<p><a href="https:images/the-region.png" alt="The Active Region (Mark at the beginning)" title="The Active Region (Mark at the beginning)" width="100%"><img src="https://blog.veitheller.de/images/the-region.png" alt="The Active Region (Mark at the beginning)" title="The Active Region (Mark at the beginning)" width="100%"/></a>
</p>
<p><span>Figure 4: </span>The Active Region (Mark at the beginning)</p>
</div>

<p>
The <i>Region</i> is the text between Point and Mark.  If the Mark exists in a buffer,
so does the Region (because Point always exists).  The Region can be of any
size: a few words, many paragraphs, the next 253 characters.  If you set the
Mark and don’t move Point, the Region is of size zero. (Yes, an empty Region is
useful.)  If you set the Mark at the end of the buffer, and move Point to the
beginning of the buffer, then the Region encompasses the entire buffer.
</p>

<p>
In fact, the Region is the same regardless of whether Point comes first in the
buffer or Mark does; it makes no difference, just do what’s convenient.
</p>

<p>
This scheme predates the commercial availability of the mouse, and provides a
keyboard-driven equivalent of sweeping out text with the mouse.  In fact, if you
click mouse button 1 (usually the left button) at a position in the buffer, and
drag the mouse pointer in any direction, and then let go of the button, Emacs
sets the Mark at the place where you clicked, and the Point at the place where
you let go — another way to set the region.
</p>

<p>
When you explicitly set the Mark with <code>C-SPC</code> (or the mouse), the Mark is <i>activated</i>,
and the Region is suddenly colored differently so you can visualize it (see
Figure <a href="#orgc83c433">4</a>).  If the color becomes distracting, a <code>C-g</code> will deactivate
the Region, as will most commands that operate on the Region after they’re done
with it (so the Active Region is typically transient: set it — color! — act
on it — color gone).
</p>

<p>
But remember, the Region still exists (because there’s a Mark) even if inactive
and invisible: you can still use it<sup><a id="fnr.39" href="#fn.39" role="doc-backlink">39</a></sup>.  If at any time you’re not sure
of its extent,     <code>C-x C-x</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Setting-Mark"><code>exchange-point-and-mark</code></a>﻿) will
reactivate the Region (and hence colorize it); it also swaps Point and Mark,
which is handy if you want to fine-tune the extent of the Region with additional
motion commands, or if you want to get to, or just peek at, the other end (the
Region might be big enough that you can’t see both ends at the same time).
</p>

<p>
Once you’ve got a Region, you can do stuff to it.  What kind of stuff?  Delete
it; copy it; duplicate it; capitalize or otherwise change the case of it;
<a href="#org3fa1f0c">search-and-replace</a> or <a href="#org3f93c8e">undo</a> within it; <a href="#org39c0e40">narrow</a> your view of the buffer to it; do a
web search for it; treat it as a <a href="#orgf8d8a5e">rectangle</a>; write it out to a different file;
<a href="#orgde73944">colorize</a> it; <a href="#orga31f0ee">comment it out</a>, count the words, characters, and lines within it; pipe it through a
shell command.  There are hundreds, nay, thousands, of Emacs commands that
operate on the Region, and you can readily make your own.
</p>

<p>
In a typical GUI editor like Microsoft Word or Google Docs, you spend much of
your time sweeping out or selecting text with the mouse and then activating a
menu or toolbar item; the Emacs equivalent is to set the Region and then execute
a command with a keystroke.  In Emacs, you can likewise use the mouse and a
menu, but you can also do everything with the keyboard, and in addition to
setting the Region by setting the Mark and explicitly moving, you can set it
implicitly via <a href="#orgee51965">textual object</a> commands, search commands, and more.
</p>

<p>
So now you know how to define the Region: let’s do stuff to it.
</p>

<dl>
<dt>    <code>C-w</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Kill-Commands"><code>kill-region</code></a>﻿)</dt><dd>Kills the Region.  (You can <a href="#orgee263e4">yank it
back</a> elsewhere.)  Other editors call this operation <i>cut</i>.  Mnemonic: <i>wipe</i> the
region.</dd>
<dt>    <code>M-w</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Kill-Commands"><code>kill-ring-save</code></a>﻿)</dt><dd>Saves the Region without removing
it from the buffer (so you can yank a copy back elsewhere).  Other editors
call this operation <i>copy</i>.  Mnemonic: a “bigger” wipe (which includes a “paste”).</dd>
<dt>    <code>C-x C-i</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Indentation-Commands"><code>indent-rigidly</code></a>﻿)</dt><dd>Rigidly indents (or dedents)
the Region using the arrow keys; <code>C-u 12 C-x C-i</code> indents the region exactly 12
characters, without using the arrow keys.</dd>
<dt>    <code>C-x C-l</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Case"><code>downcase-region</code></a>﻿)</dt><dd>Convert the entire Region to
lowercase.  This command is <a href="#org46fc1c3">disabled</a> by default.</dd>
<dt>    <code>C-x C-u</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Case"><code>upcase-region</code></a>﻿)</dt><dd>Convert the entire Region to
uppercase.  This command is <a href="#org46fc1c3">disabled</a> by default.</dd>
<dt>    <code>M-q</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Fill-Commands"><code>fill-region</code></a>﻿)</dt><dd>Fills, i.e., justifies with a ragged
right margin, all the paragraphs within the Region; with a prefix argument,
right justify the paragraphs.</dd>
</dl>

<p>
There are hundreds more commands that act on the Region, and the Region is
fundamental to the way cutting and pasting is done in Emacs.
</p>
</div>
</div>
</div>
<div id="outline-container-org01245f1">
<h3 id="org01245f1">Cutting, Copying, and Pasting <a id="orge04d5e2"></a></h3>
<div id="text-org01245f1">
<p>
Cutting, copying, and pasting to and from the clipboard — the fundamental
editing operations — in most applications exist as three keyboard shortcuts,
known as <i>Control+x</i>, <i>Control+c</i> and <i>Control+v</i> respectively, called <i>CUA</i><sup><a id="fnr.40" href="#fn.40" role="doc-backlink">40</a></sup>.
</p>

<p>
Emacs, of course, uses different terminology and key bindings — how can it
not, predating the CUA “standard” by close to ten years?
</p>

<table>


<colgroup>
<col/>

<col/>

<col/>
</colgroup>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">CUA Menu Item</th>
<th scope="col">Key</th>
<th scope="col">Mac OS</th>
<th scope="col">Emacs Command</th>
<th scope="col">Key</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cut</td>
<td><i>Control+x</i></td>
<td><i>Command+x</i></td>
<td><code>kill-region</code></td>
<td><code>C-w</code></td>
</tr>

<tr>
<td>Copy</td>
<td><i>Control+c</i></td>
<td><i>Command+c</i></td>
<td><code>kill-ring-save</code></td>
<td><code>M-w</code></td>
</tr>

<tr>
<td>Paste</td>
<td><i>Control+v</i></td>
<td><i>Command+v</i></td>
<td><code>yank</code></td>
<td><code>C-y</code></td>
</tr>
</tbody>
<tbody>
<tr>
<td>Select All</td>
<td><i>Control+a</i></td>
<td><i>Command+a</i></td>
<td><code>mark-whole-buffer</code></td>
<td><code>C-x h</code></td>
</tr>
</tbody>
</table>
<p>
Emacs calls cutting, “killing”; and it calls pasting, “yanking”.  So <a href="#orgfab3d04">select</a> your
text (by setting the <a href="#org34ab2da">Region</a>), and then use the Emacs keystrokes in the table
above, and things will work mostly as you expect.
</p>

<p>
Aside from the keystrokes, this is directly analogous to the way cutting and pasting
is done everywhere else.  If you really can’t face the idea of learning these
four keystrokes, you can enable <a href="#org1213cc6">CUA Mode</a>, which will let you use the keystrokes
you’re used to.
</p>

<p>
Now we’re done with this chapter, right?  Feel free to skip ahead to the next
chapter to continue your Emacs exploration, but be sure to come back here
later for a little more info.
</p>
</div>
<div id="outline-container-org13df4de">
<h4 id="org13df4de">Welcome back!</h4>
<div id="text-org13df4de">
<p>
It’s time for some tough love.  Emacs cut-and-paste goes significantly beyond
that of most applications, but, I have to admit, at the cost of a significant
learning curve.  The advanced features are probably the most complicated part of
beginner-level Emacs knowledge.  The reason is just that it’s all very abstract
and tenuous, and you have to picture invisible things in your head.
</p>

<p>
What are these advanced features?
</p>
<ol>
<li>Commands to precisely select (i.e. set the region around) a whole range of
<a href="#orgee51965"><i>textual objects</i></a>: words, symbols, lines, sentences, paragraphs, and more.
We cover these in the <a href="#orgee51965">next chapter</a>.  There are commands to directly kill (cut)
these objects.</li>
<li>A history of previously killed and copied text.  The Mac OS and Windows
clipboards only hold one item—the last piece of text you killed or copied.
Emacs remembers your 60 most
recent items, and there’s no limit—you can increase it if you like.<sup><a id="fnr.41" href="#fn.41" role="doc-backlink">41</a></sup></li>
</ol>

<p>
Emacs calls its “clipboard” the <i>Kill Ring</i>, and it’s an invisible (albeit
inspectable) data structure that you normally have to picture in your mind’s eye
as you use and change it.
</p>

<p>
With the addition of one more command, new in version 28 of Emacs, your suite of
cutting and pasting commands looks like this:
</p>
<table>


<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Action</th>
<th scope="col">Key</th>
<th scope="col">Emacs Command</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cut</td>
<td><code>C-w</code></td>
<td><code>kill-region</code></td>
</tr>

<tr>
<td>Copy</td>
<td><code>M-w</code></td>
<td><code>kill-ring-save</code></td>
</tr>

<tr>
<td>Paste</td>
<td><code>C-y</code></td>
<td><code>yank</code></td>
</tr>
</tbody>
<tbody>
<tr>
<td>Paste from History</td>
<td><code>M-y</code></td>
<td><code>yank-pop</code></td>
</tr>
</tbody>
</table>

<p>
<a id="org87669b1"></a>
<code>C-y</code> yanks (“pastes”) your most recent kill (or copy), but you can get back any
of your last 60 kills by instead
using <code>M-y</code>.  It presents all your kills using the <a href="#org75fb6a2">Completion</a> system: just choose
the text you want to yank, as in Figure <a href="#org208b1bf">5</a>.
</p>


<div id="org208b1bf">
<p><a href="https:images/completing-yank.png" alt="Yanking Back in Time" title="Yanking Back in Time" width="100%"><img src="https://blog.veitheller.de/images/completing-yank.png" alt="Yanking Back in Time" title="Yanking Back in Time" width="100%"/></a>
</p>
<p><span>Figure 5: </span>Yanking Back in Time</p>
</div>

<p>
This function works best with an <a href="#orgeb3f098">Incremental Narrowing Framework</a> like <a href="https://github.com/abo-abo/swiper">Ivy</a> or
<a href="https://github.com/raxod502/selectrum">Selectrum</a> (Ivy is shown in Figure <a href="#org208b1bf">5</a>).
</p>

<p>
Until you read <a href="#org421bb45"><i>Yanking Older Kills</i></a>, you shouldn’t invoke this command
immediately after <code>C-y</code>: it will have a different effect.  If you need to use <code>M-y</code>
right after a <code>C-y</code>, just precede it with     <code>C-g</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Quitting"><code>keyboard-quit</code></a>﻿).
</p>
</div>
</div>
<div id="outline-container-org36f3138">
<h4 id="org36f3138">The Kill Ring <a id="orgee263e4"></a></h4>
<div id="text-org36f3138">
<p>
When you kill the Region with <code>C-w</code>, Emacs adds the killed text to a data
structure called the <i>Kill Ring</i>, which holds the last several kills.  This
allows you to get older kills back.  When you yank with <code>C-y</code>, the most recent
kill from the Kill Ring is inserted into the buffer at Point; it’s not removed
or popped off the Kill Ring, so if you yank again, you get another copy.
</p>

<p>
The Kill Ring is really a linear list, and killing with <code>C-w</code> feels like pushing
onto a stack; but the commands that deal with it actually treat it as a circular
structure, so we call it a <i>ring</i>.
</p>

<p>
The Kill Ring is a <i>global</i> data structure, shared by all buffers: this is so that
you can use the Kill Ring to move text from one buffer to another: kill some
text in buffer A, switch to buffer B and yank it: you’ve moved the text.
</p>

<p>
What about copying text?  Clearly, you can <i>copy</i> and paste by doing <code>C-w</code> to kill,
<i>immediately</i> yank it back to where it was with <code>C-y</code>, and then move elsewhere and
yank again (your text is still at the front because yanking doesn’t pop the Kill
Ring).  That’s <code>C-w C-y</code> (move somewhere) <code>C-y</code>.
</p>

<p>
<code>M-w</code> is a shortcut for <code>C-w C-y</code>, so we usually use that for copying: <code>M-w</code> (move
somewhere) <code>C-y</code>.
</p>
</div>
</div>
<div id="outline-container-org3fa2e1a">
<h4 id="org3fa2e1a">Yanking Older Kills (“Clipboard History”) <a id="org421bb45"></a></h4>
<div id="text-org3fa2e1a">
<p>
Here’s how yanking older kills worked in olden times (before v28’s new
    <code>M-y</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Earlier-Kills"><code>yank-pop</code></a>﻿) command).  Unless you’re a connoisseur of
Emacs history (this all still works…), I suggest you <a href="#orgbf20fa0">skip ahead</a>!
</p>

<p>
Suppose we kill the word “foo” in some buffer.  This pushes it onto the front of
the Kill Ring (who knows what else is behind it):
</p>
<table>


<colgroup>
<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td>foo</td>
<td>…</td>
</tr>

<tr>
<td>↑</td>
<td> </td>
</tr>
</tbody>
</table>
<p>
The arrow points to what <code>C-y</code> will yank, by default the latest kill.  Then we do
some more work, and kill the word “bar” somewhere else.  Now the Kill Ring looks
like this:
</p>
<table>


<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td>bar</td>
<td>foo</td>
<td>…</td>
</tr>

<tr>
<td>↑</td>
<td> </td>
<td> </td>
</tr>
</tbody>
</table>
<p>
Now we want to paste the “foo” somewhere<sup><a id="fnr.42" href="#fn.42" role="doc-backlink">42</a></sup>.  How do we get at it?
</p>

<p>
We yank with <code>C-y</code> and “bar” (what the arrow points to) is inserted.  But now we
immediately type     <code>M-y</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Earlier-Kills"><code>yank-pop</code></a>﻿).  When invoked immediately
after <code>C-y</code>, it moves the yank-pointer back one step:
</p>
<table>


<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td>bar</td>
<td>foo</td>
<td>…</td>
</tr>

<tr>
<td> </td>
<td>↑</td>
<td> </td>
</tr>
</tbody>
</table>
<p>
and <i>simultaneously</i> replaces the just-yanked “bar” at Point with “foo”.  If we
immediately type <code>M-y</code> again, it would move the yank-pointer back one more step,
and replace “foo” with whatever is next oldest in the Kill Ring.
</p>

<p>
You don’t really need to picture the Kill Ring.  When you want something from
it, just type <code>C-y</code> and then if you think, “no, older” type <code>M-y</code>, and if you think,
“no, older”, type another <code>M-y</code> and so on.
</p>

<p>
The only trick here is that you have to type <code>M-y</code> <i>immediately</i> after a <code>C-y</code>, or
after a <code>M-y</code>: if you do anything in between — moving, typing, popping up the
calendar — <code>M-y</code> will do the wonderful new thing of offering up older
kills for Completion; if your Emacs is older then v28, it will complain with
“Previous command was not a yank”.
</p>

<p>
If you actually type 60 <code>M-y</code>’s, you would then cycle around to the front of the
Kill Ring again!
</p>

<p>
Suppose the Kill Ring looks like this:
</p>
<table>


<colgroup>
<col/>

<col/>

<col/>

<col/>

<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td>echo</td>
<td>delta</td>
<td>charlie</td>
<td>bravo</td>
<td>alpha</td>
<td>…</td>
</tr>

<tr>
<td>↑</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
</tr>
</tbody>
</table>
<p>
Let’s look at the results of some yanks (each of these examples is an
alternative to any of the others):
</p>
<ul>
<li><code>C-y</code> would yank “echo”</li>
<li>instead, <code>C-y M-y</code> would yank “delta”</li>
<li>or, <code>C-y M-y M-y</code> would yank “charlie”</li>
<li>or, <code>C-y M-y M-y C-y</code> would yank “charliecharlie” (<code>C-y</code> always yanks from the
pointer)</li>
</ul>

<p>
Note that <code>C-y</code> takes a numeric argument (positive or negative), so that <code>C-u 3 C-y</code>
in our example is the same as <code>C-y M-y M-y</code>.  <code>M-y</code> works the same way.
</p>

<p>
What if you type several <code>M-y</code>’s and decide you don’t want what you end up with?
Usually you just <a href="#org3f93c8e">undo</a> them, but note that this undoes the changes to your
buffer, but doesn’t undo the motion of the yank pointer.  If you do <code>C-y M-y M-y</code>,
yielding “charlie”, you can undo, yielding “delta”.  But your next <code>C-y</code> will yank
“charlie” again, since that’s where you left the yank pointer.
</p>

<p>
When you’ve got your yanked text (whether acquired by one <code>C-y</code> or a chain of
<code>M-y</code>’s, or the new Completion-based <code>M-y</code>), the Mark is set for you at the
beginning of the restored kill, to make it easy for you to jump there (with
    <code>C-x C-x</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Setting-Mark"><code>exchange-point-and-mark</code></a>﻿); see also <a href="#org40be37b">the Mark Ring</a>)
— remember that you may have just yanked back a very large chunk of text, so
the beginning could be a long way away.
</p>
</div>
</div>
<div id="outline-container-org7f0cfb5">
<h4 id="org7f0cfb5">Undoing a Yank</h4>
<div id="text-org7f0cfb5">
<p>
I stole a function from the <a href="https://www.emacswiki.org/emacs/KillingAndYanking">EmacsWiki</a> that I call <code>undo-yank</code> (originally
named <code>yank-pop-forwards</code>), that lets you reverse direction in the middle of a
sequence of <code>M-y</code>’s, in case you overshoot; this actually moves the yank pointer,
so you can think of it as an undo for yanks.
</p>
<div>
<pre><span>;; </span><span>thanks to an anonymous EmacsWiki coder</span>
(<span>defun</span> <span>undo-yank</span> (arg)
  <span>&#34;Undo the yank you just did.  Really, adjust just-yanked text</span>
<span>like \\[</span><span>yank-pop</span><span>] does, but in the opposite direction.&#34;</span>
  (<span>interactive</span> <span>&#34;p&#34;</span>)
  (yank-pop (- arg)))
(global-set-key (kbd <span>&#34;C-M-Y&#34;</span>) &#39;undo-yank)
</pre>
</div>
</div>
</div>
<div id="outline-container-org32961f2">
<h4 id="org32961f2">I Can’t Picture This!</h4>
<div id="text-org32961f2">
<blockquote>
<p>
Ever feel that ’C-y M-y M-y M-y …’ is not a great way of trying to find that
piece of text you know you killed a while back? — Colin Walters
</p>
</blockquote>
<p>
Emacs’s abstract approach to the Kill Ring (an invisible data structure with an
invisible yank-pointer), which may seem a mite austere, is very fast and
efficient once you get used to it.  But you might occasionally prefer a sort of
WYSIWYG alternative, that lets you browse the Kill Ring interactively: see its
entire contents and search it too.  The new functionality of <a href="#org87669b1"><code>M-y</code></a> command does
this for you; an alternative is Colin Walters’ third party package
<a href="#org660cffc"><code>browse-kill-ring</code></a>.
</p>
</div>
</div>
<div id="outline-container-orgbac1e59">
<h4 id="orgbac1e59">Other Ways to Set the Region</h4>
<p>
So far, we’ve been talking about killing (or copying) <i>the Region</i>: as if you were
always going to be sweeping out text, mouse-like (even if with the keyboard).
But really, it’s much more common to work in terms of <i>textual objects</i> — in
other words, kill a word or a line or a paragraph without bothering to sweep out
its boundaries.  We’ll discuss textual objects in detail in the <a href="#orgee51965">next chapter</a>.
</p>
</div>
<div id="outline-container-org37112ab">
<h4 id="org37112ab">Appending to a Kill</h4>
<div id="text-org37112ab">
<p>
Since the Kill Ring is a sequence of kills, you might think to use it to
accumulate several separate chunks of text that you want to yank back elsewhere.
Kill the first piece of text, move to the next and kill <i>it</i>; repeat several times
and you’ve now got everything you want, in several chunks at the front of the
Kill Ring.
</p>

<p>
But when it comes time to yank all these chunks back, you’ll have to do a bit of
a dance with a combination of <code>C-y</code>’s and <code>M-y</code>’s in a somewhat surprising order
(because the kills are accumulated on the Kill Ring <i>backwards</i>).
</p>

<p>
What you want to do instead is append to a single kill at the front of the Kill
Ring, with     <code>C-M-w</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Appending-Kills"><code>append-next-kill</code></a>﻿).  So you kill the first
piece of text, move to the second, but now type <code>C-M-w</code> before killing it with
<code>C-w</code>; this causes the second piece to be appended to the text of the front kill,
instead of added as a new kill as usual.  Think of <code>C-M-w C-w</code> as a single <i>append
to the kill</i> command.
</p>

<p>
If the three pieces of text are “alpha”, “beta”, and “gamma”, the process looks
like:
</p>
<ul>
<li><p>
move to “alpha”, set the Region, and <code>C-w</code>:
</p>
<table>


<colgroup>
<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td>alpha</td>
<td>…</td>
</tr>

<tr>
<td>↑</td>
<td> </td>
</tr>
</tbody>
</table></li>
<li><p>
move to “beta”, set the Region, and <code>C-M-w C-w</code>:
</p>
<table>


<colgroup>
<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td>alphabeta</td>
<td>…</td>
</tr>

<tr>
<td>↑</td>
<td> </td>
</tr>
</tbody>
</table></li>
<li><p>
move to “gamma”, set the Region, and <code>C-M-w C-w</code>:
</p>
<table>


<colgroup>
<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td>alphabetagamma</td>
<td>…</td>
</tr>

<tr>
<td>↑</td>
<td> </td>
</tr>
</tbody>
</table></li>
</ul>

<p>
Now you can move elsewhere, and with one <code>C-y</code>, you yank back “alphabetagamma”.
</p>

<p>
Obviously, <code>C-M-w</code> works the same with <code>M-w</code>, if you want to leave the original text
in place.
</p>

<p>
<code>C-M-w</code> is a pretty low-level tool; Emacs has better ways of approaching the task
of <a id="org98dc638"></a> accumulating scattered chunks of text that don’t use
the Kill Ring at all.
</p>

<p>
Move to the first piece of text you want to collect—let’s say the word
“alpha”—and set the Region, but don’t bother to kill or copy; instead say
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Accumulating-Text"><code>append-to-buffer</code></a>﻿.  You’ll be prompted for a buffer name which
will collect all the pieces of text you’re gathering; just make up any name you
like!  If you’re collecting Greek letters, you could call the buffer “greek” or
“g”.
</p>

<p>
Now find your “beta”.    <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Accumulating-Text"><code>append-to-buffer</code></a>﻿ again and use the same
buffer name.  Repeat for “gamma” and as many other things you’re looking to
collect.
</p>

<p>
When you’re done, go to the place you want to “yank” your collection, and say
  <code>M-x</code> <code>insert-buffer</code>: the entire contents of your accumulation buffer
is inserted at Point.
</p>

<p>
This scheme has several advantages over the Kill Ring for ambitious text
rearrangement.
</p>
<ul>
<li>You can do your collecting and appending over a span of hours (or even days).</li>
<li>It allows you to use the Kill Ring as you like in between accumulations.</li>
<li>You can freely use several different collection buffers for different sorts of
text, and intermix your accumulations.</li>
<li>The accumulation buffer is just a buffer like any other, so you can switch to
it at any point to fix it up, or save it to a file; you also aren’t required
to use   <code>M-x</code> <code>insert-buffer</code> to get your text; you can kill or copy
the text you’ve accumulated to extract what you’ve collected in any order or
combination.</li>
</ul>

<p>
See <a href="#org8a78e8f"><i>Mass Line Deletion</i></a> for another solution, and  <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Accumulating-Text">“Accumulating Text”</a> in the <i>Emacs</i> manual for more information.
</p>
</div>
</div>
<div id="outline-container-org82b0609">
<h4 id="org82b0609">The Clipboard <a id="orgbf20fa0"></a></h4>
<div id="text-org82b0609">
<p>
The Kill Ring is a data structure to which only Emacs has access.  But every
time you kill or copy text to the Kill Ring — with any of the many commands
that do so, not just <code>C-w</code> and <code>M-w</code> — Emacs also copies that text to the <i>system
clipboard</i>.  This is the data structure that all your other non-Emacs
applications paste from (with the CUA keystroke <i>Control+v</i>, probably).  So this
gives you a simple way passing text to them.
</p>

<p>
It also works in the other direction: if the contents of the system clipboard
are newer than the Kill Ring — because you did a cut or copy in a non-Emacs
application — then <code>C-y</code> instead inserts the clipboard text — not the first
item in the Kill Ring.
</p>

<p>
There are several configuration variables to control exactly how Emacs and the
clipboard<sup><a id="fnr.43" href="#fn.43" role="doc-backlink">43</a></sup> interoperate; see <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Clipboard">“Clipboard”</a> in the <i>Emacs</i> manual.
</p>
</div>
</div>
<div id="outline-container-org2eba956">
<h4 id="org2eba956">CUA Mode <a id="org1213cc6"></a></h4>
<div id="text-org2eba956">
<p>
If you’re a long-time Windows user and the <i>Control+x</i>, <i>Control+c</i> and <i>Control+v</i>
keystrokes are so thoroughly wired into your fingers that you just <i>can’t</i> get
used to <code>C-w</code>, <code>M-w</code>, and <code>C-y</code>, don’t give up hope.  Just say
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/CUA-Bindings"><code>cua-mode</code></a>﻿ and Emacs will let you use the commands you’re used to.
In order not to completely clobber the hundreds of key bindings on the <code>C-x</code> and
<code>C-c</code> prefixes, the CUA bindings are only operative when the Region is active
(colorized).  There are several subtleties and extra features, so see
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/CUA-Bindings">“CUA Bindings”</a> in the <i>Emacs</i> manual for the complete story.
</p>

<p>
If you like <code>cua-mode</code>, you can turn it on by default in your <a href="#org2af3730">init file</a> with this
line of code:
</p>

</div>
</div>
</div>
<div id="outline-container-orgf04ada7">
<h3 id="orgf04ada7">Editing with Textual Objects <a id="orgee51965"></a></h3>
<div id="text-orgf04ada7">
<p>
Editing in general consists of inserting text, either by typing it or acquiring
it from some existing source; and then, over time, moving from one spot to
another in order to make changes (i.e. transform it).
</p>

<p>
In Emacs, both moving around and making changes are done largely via <i>textual
objects</i> — things like characters, words, lines, sentences, and such — and
you can:
</p>
<ul>
<li>move in terms of them, and by moving, optionally:</li>
<li>select them, and after selecting them,</li>
<li>copy them,</li>
<li>kill them, or</li>
<li>transform them.</li>
</ul>

<p>
For each such object, there is a motion command that moves forward over it and
another that moves backward (you can also think of this as moving to the end and
to the beginning).  All these motion commands interpret <a href="#orgb0f6ffd">numeric arguments</a> as
repetitions, so with an argument of <i>N</i>, you can move over <i>N</i> objects with one
command.
</p>

<p>
But of course, if you simply set the mark before moving, then when you’ve moved,
you’ve also <i>selected</i> text — that is, you’ve put <a href="#org34ab2da">the Region</a> around whatever
you’ve moved over.  Having selected, you can now immediately <a href="#orgee263e4">copy or kill</a> the
text, or transform it.
</p>

<p>
Suppose Point is the <code>|</code> in this line — you’re in the middle of the word
“telecommunications” — and you want to kill that word:
</p>
<pre id="orgc03b1eb">the intermediary of some telecommu|nications program, where the
</pre>
<p>
To do so, you can move to the beginning of the word, set the mark, move to the
end, and kill: that’s four keystrokes:
</p>
<table>


<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td>1</td>
<td><code>M-b</code></td>
<td><code>backward-word</code></td>
</tr>

<tr>
<td>2</td>
<td><code>C-SPC</code></td>
<td><code>set-mark-command</code></td>
</tr>

<tr>
<td>3</td>
<td><code>M-f</code></td>
<td><code>forward-word</code></td>
</tr>

<tr>
<td>4</td>
<td><code>C-w</code></td>
<td><code>kill-region</code></td>
</tr>
</tbody>
</table>

<p>
Besides being completely general (killing a sentence just requires you to
substitute sentence-motion commands for the word-motion commands, for example)
this technique means that all you need to learn to use textual objects are the
motion commands.  But most of the textual objects also have a special command
that <i>marks</i>, i.e. <i>selects</i>, them, which saves you a keystroke, so we could also
kill “telecommunications” with just:
</p>
<table>


<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td>1</td>
<td><code>M-b</code></td>
<td><code>backward-word</code></td>
</tr>

<tr>
<td>2</td>
<td><code>M-@</code></td>
<td><code>mark-word</code></td>
</tr>

<tr>
<td>3</td>
<td><code>C-w</code></td>
<td><code>kill-region</code></td>
</tr>
</tbody>
</table>

<p>
In addition, most of the objects also define a command to kill them, which can
save you another keystroke:
</p>
<table>


<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td>1</td>
<td><code>M-b</code></td>
<td><code>backward-word</code></td>
</tr>

<tr>
<td>2</td>
<td><code>M-d</code></td>
<td><code>kill-word</code></td>
</tr>
</tbody>
</table>

<p>
Or if you happen to already be at the beginning of the word, it’s just one
keystroke:
</p>
<table>


<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td>1</td>
<td><code>M-d</code></td>
<td><code>kill-word</code></td>
</tr>
</tbody>
</table>

<p>
You can choose how much mental effort to put into learning these additional
commands, knowing that you can always achieve your goal in the 4-step manner.
But most expert Emacs users eventually learn all of these special commands: even
micro-optimizations pay off for things you do frequently.
</p>
</div>
<div id="outline-container-org451e311">
<h4 id="org451e311"><a id="orgacaa0f1"></a> Shift Selection</h4>
<div id="text-org451e311">
<p>
If you execute any of the motion commands while also holding the Shift key, you
can short-cut the selection process via <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Shift-Selection">Shift Selection</a>.  Consider     <code>M-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Words"><code>forward-word</code></a>﻿).  If
you instead use <code>S-M-f</code>, the Mark is automatically set at Point, and <i>then</i> you move
forward one word: so the word is automatically selected.  <code>S-M-f</code> is essentially
<code>C-SPC M-f</code>.  In our example:
</p>
<table>


<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td>1</td>
<td><code>M-b</code></td>
<td><code>backward-word</code></td>
</tr>

<tr>
<td>2</td>
<td><code>C-SPC</code></td>
<td><code>set-mark-command</code></td>
</tr>

<tr>
<td>3</td>
<td><code>M-f</code></td>
<td><code>forward-word</code></td>
</tr>

<tr>
<td>4</td>
<td><code>C-w</code></td>
<td><code>kill-region</code></td>
</tr>
</tbody>
</table>
<p>
we can instead do:
</p>
<table>


<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td>1</td>
<td><code>M-b</code></td>
<td><code>backward-word</code></td>
</tr>

<tr>
<td>2</td>
<td><code>S-M-f</code></td>
<td><code>forward-word</code> (shifted)</td>
</tr>

<tr>
<td>4</td>
<td><code>C-w</code></td>
<td><code>kill-region</code></td>
</tr>
</tbody>
</table>

<p>
The same thing is true for motion backwards, and for any of the other textual
object motion commands.  Just add the Shift.
</p>

<p>
And, if you type a shifted motion command, and immediately repeat it (while
holding down the Shift key), the selection is enlarged until you finally issue a
non-shifted-motion command.  So if you say <code>S-M-f S-M-f S-M-f</code> you will have set
the Region around three words.
</p>

<p>
You can mix different objects too: <code>S-M-f S-C-n S-C-f</code> is also legitimate.
</p>
</div>
</div>
<div id="outline-container-org372754f">
<h4 id="org372754f">Transposing and Dragging Objects <a id="org6706174"></a></h4>
<div id="text-org372754f">
<p>
A special case is <i>transposing</i> (or <i>swapping</i>) two objects: that is, put Point
between two objects (say, sentences) and swap them — the left hand sentence is
now the right hand sentence and vice versa.  One single command replaces a more
complicated pattern of killing, moving, and yanking.
</p>

<p>
For example, here in line 0 Point (<code>|</code>) is between “one” and “two”.  If we
<code>transpose-words</code> with <code>M-t</code>, we get the result in line 1:
</p>
<pre id="orge2abb6e">0 one | two three four five
1 two one | three four five
2 two three one | four five
</pre>
<p>
Note that Point has moved forward, or if you prefer, it remains after “one”.
This means that another <code>M-t</code> will result in line 2.  So several transpose
commands in a row can be chained together.  You might think of this as <i>dragging</i>
“one” to the right.
</p>

<p>
Most of the transpose commands react to a numeric argument of <i>N</i> by transposing
the object to the left of Point with the one <i>N</i> objects to the right.  This means
that an argument of <code>1</code> is the same as no argument (on line 0 above, the word
“two” is one word away from the left-hand word “one”).
</p>

<p>
But if we say <code>C-u 2 M-t</code>, we get this result, because “three” is two words to the
right of “one”:
</p>
<pre id="org34a6890">0 one | two three four five
1 two three | one four five
</pre>
<p>
Personally I think it’s easier to chain several transpose commands to achieve
the equivalent effect, but your brain may work differently.
</p>

<p>
A negative argument transposes in the opposite direction (backwards, rather than
forwards).  In addition, a numeric argument of <code>0</code> (which would otherwise not do
anything!) is interpreted specially: it swaps the object containing or after
Mark with the object containing or after Point, no matter how far apart they
are!  This is a long-distance transposition, with no chaining or counting
required.  Here in line 0 <code>^</code> indicates Mark (in “one”), and <code>|</code> Point (in
“eleven”); we say <code>C-u 0 M-t</code>:
</p>
<pre id="org224e29e">0 ^one two three four five six seven eight nine ten ele|ven twelve thirteen
1 ele|ven two three four five six seven eight nine ten ^one twelve thirteen
</pre>
<p>
(Frankly I’ve never internalized this and always just Kill, move, and Yank in
this use case.)
</p>

<p>
The exact definition of what makes up a given textual object is often
customizable and may vary slightly from mode to mode.  This is useful because it
means that you can use the same motion commands and yet have them automatically
customized for different types of text.
</p>

<p>
Here’s the complete list of standard Emacs textual objects, with their backward-
and forward-motion, marking, killing, and transposing key bindings:
</p>
<table>


<colgroup>
<col/>

<col/>

<col/>

<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Object</th>
<th scope="col">Backward</th>
<th scope="col">Forward</th>
<th scope="col">Mark</th>
<th scope="col">Kill</th>
<th scope="col">Transpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>Character</td>
<td><code>C-b</code>, <code>←</code></td>
<td><code>C-f</code>, <code>→</code></td>
<td> </td>
<td><code>C-d</code></td>
<td><code>C-t</code></td>
</tr>

<tr>
<td>Word</td>
<td><code>M-b</code></td>
<td><code>M-f</code></td>
<td><code>M-@</code></td>
<td><code>M-d</code></td>
<td><code>M-t</code></td>
</tr>

<tr>
<td>Horizontal Line</td>
<td><code>C-a</code></td>
<td><code>C-e</code></td>
<td> </td>
<td><code>C-k</code></td>
<td> </td>
</tr>

<tr>
<td>Vertical Line</td>
<td><code>C-p</code>, <code>↑</code></td>
<td><code>C-n</code>, <code>↓</code></td>
<td> </td>
<td> </td>
<td><code>C-x C-t</code></td>
</tr>

<tr>
<td>Sentence</td>
<td><code>M-a</code></td>
<td><code>M-e</code></td>
<td><code>M-x ...</code></td>
<td><code>M-k</code></td>
<td><code>M-x ...</code></td>
</tr>

<tr>
<td>Paragraph</td>
<td><code>M-{</code></td>
<td><code>M-}</code></td>
<td><code>M-h</code></td>
<td><code>M-h C-w</code></td>
<td><code>M-x ...</code></td>
</tr>

<tr>
<td>Sexp</td>
<td><code>C-M-b</code></td>
<td><code>C-M-f</code></td>
<td><code>C-M-@</code></td>
<td><code>C-M-k</code></td>
<td><code>C-M-t</code></td>
</tr>

<tr>
<td>Defun</td>
<td><code>C-M-a</code></td>
<td><code>C-M-e</code></td>
<td><code>C-M-h</code></td>
<td><code>C-M-h C-w</code></td>
<td> </td>
</tr>

<tr>
<td>Page</td>
<td><code>C-x [</code></td>
<td><code>C-x ]</code></td>
<td><code>C-x C-p</code></td>
<td><code>C-x C-p C-w</code></td>
<td> </td>
</tr>

<tr>
<td>Buffer</td>
<td><code>M-&lt;</code></td>
<td><code>M-&gt;</code></td>
<td><code>C-x h</code></td>
<td><code>C-x h C-w</code></td>
<td> </td>
</tr>
</tbody>
</table>
<p>
<i>N.B.</i>: in these charts, <code>M-x ...</code> means that the obvious command exists but isn’t,
by default, bound to a key — that is,   <code>M-x</code> <code>mark-end-of-sentence</code>,
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Transpose"><code>transpose-sentences</code></a>﻿, and   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Transpose"><code>transpose-paragraphs</code></a>﻿.
</p>
</div>
</div>
<div id="outline-container-org72662b3">
<h4 id="org72662b3">Characters, Words, and Lines</h4>
<div id="text-org72662b3">
<table>


<colgroup>
<col/>

<col/>

<col/>

<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Object</th>
<th scope="col">Backward</th>
<th scope="col">Forward</th>
<th scope="col">Mark</th>
<th scope="col">Kill</th>
<th scope="col">Transpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>Character</td>
<td><code>C-b</code>, <code>←</code></td>
<td><code>C-f</code>, <code>→</code></td>
<td> </td>
<td><code>C-d</code></td>
<td><code>C-t</code></td>
</tr>

<tr>
<td>Word</td>
<td><code>M-b</code></td>
<td><code>M-f</code></td>
<td><code>M-@</code></td>
<td><code>M-d</code></td>
<td><code>M-t</code></td>
</tr>

<tr>
<td>Horizontal Line</td>
<td><code>C-a</code></td>
<td><code>C-e</code></td>
<td> </td>
<td><code>C-k</code></td>
<td> </td>
</tr>

<tr>
<td>Vertical Line</td>
<td><code>C-p</code>, <code>↑</code></td>
<td><code>C-n</code>, <code>↓</code></td>
<td> </td>
<td> </td>
<td><code>C-x C-t</code></td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-orgac7a55a">
<h5 id="orgac7a55a">Characters</h5>
<div id="text-orgac7a55a">
<table>


<colgroup>
<col/>

<col/>

<col/>

<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Object</th>
<th scope="col">Backward</th>
<th scope="col">Forward</th>
<th scope="col">Mark</th>
<th scope="col">Delete</th>
<th scope="col">Transpose</th>
</tr>

<tr>
<th scope="col"> </th>
<th scope="col"> </th>
<th scope="col"> </th>
<th scope="col"> </th>
<th scope="col">(left, right)</th>
<th scope="col"> </th>
</tr>
</thead>
<tbody>
<tr>
<td>Character</td>
<td><code>C-b</code>, <code>←</code></td>
<td><code>C-f</code>, <code>→</code></td>
<td> </td>
<td><code>DEL</code>,  <code>C-d</code></td>
<td><code>C-t</code></td>
</tr>
</tbody>
</table>
<p>
The character is the smallest, the atomic, textual object.
</p>

<dl>
<dt>    <code>C-b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>backward-char</code></a>﻿)</dt><dd>Moves backward (to the left) over
a character.  This is mostly the same thing that the left-arrow
(    <code>&lt;left&gt;</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>left-char</code></a>﻿)) does (but there are subtle
differences in the context of <a href="#org5f6b09d">bi-directional text</a>).</dd>
<dt>    <code>C-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>forward-char</code></a>﻿)</dt><dd>Moves forward (to the right) over a
character.  Same deal with right-arrow (    <code>&lt;right&gt;</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>right-char</code></a>﻿)).</dd>
</dl>

<p>
The <i>f</i> for <i>forward</i> and <i>b</i> for <i>backward</i> mnemonic will recur.
</p>

<dl>
<dt>    <code>DEL</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Deletion"><code>delete-backward-char</code></a>﻿)</dt><dd>Deletes the character to
the left of Point; note that this is not a <i>Kill</i> and the deleted character
doesn’t go on the Kill Ring (because at one keystroke per character, it’s
quicker to retype it than to kill and yank it).</dd>
<dt>    <code>C-d</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Deletion"><code>delete-char</code></a>﻿)</dt><dd>Deletes the character to the right
of Point; also not a Kill.</dd>
<dt>    <code>C-t</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Transpose"><code>transpose-chars</code></a>﻿)</dt><dd>Swap the characters around Point;
at the very end of the line, swap the two previous characters.</dd>
</dl>
</div>
</div>

<div id="outline-container-org485bf3d">
<h5 id="org485bf3d">Words</h5>
<div id="text-org485bf3d">
<table>


<colgroup>
<col/>

<col/>

<col/>

<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Object</th>
<th scope="col">Backward</th>
<th scope="col">Forward</th>
<th scope="col">Mark</th>
<th scope="col">Kill</th>
<th scope="col">Transpose</th>
</tr>

<tr>
<th scope="col"> </th>
<th scope="col"> </th>
<th scope="col"> </th>
<th scope="col"> </th>
<th scope="col">(left, right)</th>
<th scope="col"> </th>
</tr>
</thead>
<tbody>
<tr>
<td>Word</td>
<td><code>M-b</code></td>
<td><code>M-f</code></td>
<td><code>M-@</code></td>
<td><code>M-DEL</code>, <code>M-d</code></td>
<td><code>M-t</code></td>
</tr>
</tbody>
</table>
<dl>
<dt>    <code>M-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Words"><code>forward-word</code></a>﻿)</dt><dd>Moves forward over a word.</dd>
<dt>    <code>M-b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Words"><code>backward-word</code></a>﻿)</dt><dd>Moves backward over a word.</dd>
</dl>

<p>
Note the f/b mnemonic.  Also, as another mnemonic, note that M-f is like a
“bigger” version of C-f.
</p>

<dl>
<dt>  <code>M-@</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Marking-Objects"><code>mark-word</code></a>﻿)</dt><dd>Sets the Mark at the end of the
current word; immediately repeating this command moves the Mark to the end of
the next word, enlarging the Region by one word (this is generally the way
all marking commands work).</dd>
<dt>    <code>M-d</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Words"><code>kill-word</code></a>﻿)</dt><dd>Kills text forward from Point to the
end of the word.</dd>
<dt>    <code>M-DEL</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Words"><code>backward-kill-word</code></a>﻿)</dt><dd>Kills text backward to the
beginning of the word.</dd>
<dt>    <code>M-t</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Transpose"><code>transpose-words</code></a>﻿)</dt><dd>Swap the words around Point.</dd>
</dl>
</div>
</div>

<div id="outline-container-orgb3fc2b6">
<h5 id="orgb3fc2b6">Lines</h5>
<div id="text-orgb3fc2b6">
<table>


<colgroup>
<col/>

<col/>

<col/>

<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Object</th>
<th scope="col">Backward</th>
<th scope="col">Forward</th>
<th scope="col">Mark</th>
<th scope="col">Kill</th>
<th scope="col">Transpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>Horizontal Line</td>
<td><code>C-a</code></td>
<td><code>C-e</code></td>
<td> </td>
<td><code>C-k</code></td>
<td> </td>
</tr>

<tr>
<td>Vertical Line</td>
<td><code>C-p</code>, <code>↑</code></td>
<td><code>C-n</code>, <code>↓</code></td>
<td> </td>
<td> </td>
<td><code>C-x C-t</code></td>
</tr>
</tbody>
</table>
<p>
Lines can be considered vertically or horizontally.  Horizontal first.
</p>

<dl>
<dt>    <code>C-a</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>move-beginning-of-line</code></a>﻿)</dt><dd>Moves to the beginning of the current line.</dd>
<dt>    <code>C-e</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>move-end-of-line</code></a>﻿)</dt><dd>Moves to the end of the current
line.</dd>
</dl>
<p>
A for the beginning of the alphabet, E for “end”.
</p>

<p>
Strangely, there’s no command to set the region around the entire current line
(though it’s very easy to write one!).
</p>

<dl>
<dt>    <code>C-k</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Killing-by-Lines"><code>kill-line</code></a>﻿)</dt><dd>Kills from Point to the end of the
current line, not including the newline unless the line is blank.  Thus, if
you’re at the beginning of a non-blank line it takes two C-k’s to kill the
whole line and close up the whitespace.</dd>
<dt>    <code>C-u 0 C-k</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Killing-by-Lines"><code>kill-line</code></a>﻿)</dt><dd>Kills to the beginning of the
current line, not including the newline.</dd>
</dl>

<p>
Now let’s consider lines vertically.
</p>

<dl>
<dt>    <code>C-p</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>previous-line</code></a>﻿)</dt><dd>Moves up to the previous line;
also on <code>↑</code>.</dd>
<dt>    <code>C-n</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>next-line</code></a>﻿)</dt><dd>Moves down to the next line; also on <code>↓</code>.</dd>
<dt>    <code>C-x C-t</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Transpose"><code>transpose-lines</code></a>﻿)</dt><dd>Swap the line containing
Point and the previous line, leaving Point after both (allowing chaining).</dd>
</dl>

<p>
When moving vertically by lines, the cursor tries to stay in the same column,
but if the target line is too short, the cursor will be at the end of the line
instead: Emacs doesn’t automatically insert spaces at the ends of lines (end of
line is unambiguous)<sup><a id="fnr.44" href="#fn.44" role="doc-backlink">44</a></sup>.
</p>

<p>
It doesn’t seem too intuitive to kill lines vertically by analogy with <code>C-n</code> and
<code>C-p</code>; I know of no such commands.
</p>
</div>
</div>
</div>

<div id="outline-container-org8ded883">
<h4 id="org8ded883">Prose Objects: Sentences and Paragraphs</h4>
<div id="text-org8ded883">
<table>


<colgroup>
<col/>

<col/>

<col/>

<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Object</th>
<th scope="col">Backward</th>
<th scope="col">Forward</th>
<th scope="col">Mark</th>
<th scope="col">Kill</th>
<th scope="col">Transpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>Sentence</td>
<td><code>M-a</code></td>
<td><code>M-e</code></td>
<td><code>M-x ...</code></td>
<td><code>M-k</code></td>
<td><code>M-x ...</code></td>
</tr>

<tr>
<td>Paragraph</td>
<td><code>M-{</code></td>
<td><code>M-}</code></td>
<td><code>M-h</code></td>
<td><code>M-h C-w</code></td>
<td><code>M-x ...</code></td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-orgbb59cb2">
<h5 id="orgbb59cb2"><a id="org0fca16b"></a> Sentences</h5>
<div id="text-orgbb59cb2">
<p>
When you’re editing prose, motion by sentences and paragraphs is very
convenient.  Note that, by default, for the purposes of motion, sentences need
to end with two spaces after their terminal punctuation (period, exclamation
point, or question mark).  This has become something of a <a href="#orgc715b4b"><i>cause célèbre</i></a>
lately, but don’t worry, you can change sentence-ending to only require one
space by <a href="#org27e6769">customizing</a>   <code>sentence-end-double-space</code>.
</p>

<dl>
<dt>    <code>M-a</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Sentences"><code>backward-sentence</code></a>﻿)</dt><dd>Moves to the beginning of the
current sentence.</dd>
<dt>    <code>M-e</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Sentences"><code>forward-sentence</code></a>﻿)</dt><dd>Moves to the end of the current
sentence.</dd>
</dl>

<p>
Note the mnemonic relationship between C-a / M-a and C-e / M-e.  Again the Meta
version is for a “bigger” object.
</p>

<dl>
<dt>  <code>M-x</code> <code>mark-end-of-sentence</code></dt><dd>Sets Mark at the end of the current
sentence; this command doesn’t have a default key binding (but you could give
it one).</dd>
<dt>    <code>M-k</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Sentences"><code>kill-sentence</code></a>﻿)</dt><dd>Kill the text from Point to the end
of the sentence.</dd>
<dt>    <code>C-u -1 M-k</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Sentences"><code>kill-sentence</code></a>﻿)</dt><dd>Kill the text from Point to
the beginning of the sentence.</dd>
</dl>
</div>
</div>

<div id="outline-container-org8e1ba01">
<h5 id="org8e1ba01">Paragraphs</h5>
<div id="text-org8e1ba01">
<p>
You can similarly move by paragraphs — but what is a paragraph exactly?  It
depends on the <a href="#org5b21ef0">Major Mode</a> and you can tweak the definition yourself<sup><a id="fnr.45" href="#fn.45" role="doc-backlink">45</a></sup>, but most
commonly, paragraphs are delimited by blank lines.
</p>

<dl>
<dt>    <code>M-{</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Paragraphs"><code>backward-paragraph</code></a>﻿)</dt><dd>Move to the beginning of the
current paragraph.</dd>
<dt>    <code>M-}</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Paragraphs"><code>forward-paragraph</code></a>﻿)</dt><dd>Move to the end of the current
paragraph.</dd>
<dt>    <code>M-h</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Paragraphs"><code>mark-paragraph</code></a>﻿)</dt><dd>Sets the Region around the <i>entire</i>
current paragraph; unlike the marking commands for smaller objects, in
addition to setting the Mark at the end of the object, this one also moves
Point to the beginning (this turns out to be much more useful for large
objects).</dd>
<dt>  <code>M-x</code> <code>kill-paragraph</code></dt><dd>Kill the text from Point to the end of the
paragraph.</dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-org243de2a">
<h4 id="org243de2a">Larger Objects: Pages and Buffers <a id="org45c89bb"></a></h4>
<div id="text-org243de2a">
<table>


<colgroup>
<col/>

<col/>

<col/>

<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Object</th>
<th scope="col">Backward</th>
<th scope="col">Forward</th>
<th scope="col">Mark</th>
<th scope="col">Kill</th>
<th scope="col">Transpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>Page</td>
<td><code>C-x [</code></td>
<td><code>C-x ]</code></td>
<td><code>C-x C-p</code></td>
<td><code>C-x C-p C-w</code></td>
<td> </td>
</tr>

<tr>
<td>Buffer</td>
<td><code>M-&lt;</code></td>
<td><code>M-&gt;</code></td>
<td><code>C-x h</code></td>
<td><code>C-x h C-w</code></td>
<td> </td>
</tr>
</tbody>
</table>
<p>
Pages are separated by <a href="https://en.wikipedia.org/wiki/Page_break"><i>form feed</i></a> characters (<code>C-l</code> — that’s L, not the digit 1),
just as lines are separated by newline characters.  This used to be a common
concept back when Emacs was young; when printing, you had to manually indicate
where a page break should occur, causing the printer to skip to the top of the next
page (or “form”), and to do this you would insert a form feed character.
</p>

<p>
Since form feeds count as whitespace in most programming and markup languages,
pages are still a useful idea, and Emacs has several commands that do things in terms
of them.  You can insert a form feed into your file by typing <code>C-q C-l</code> (see
<a href="#org244f9ee">Quoted Insert</a>).
</p>

<p>
So while it’s rare now to use a form feed to actually force a new page when
printing<sup><a id="fnr.46" href="#fn.46" role="doc-backlink">46</a></sup>, it’s handy to be able to separate a large file into “pages” which are
really just bigger sections than paragraphs.  A typical organization in a file
of source code is to precede each section header comment with a form feed, and
then you can navigate by these logical sections via <code>C-x [</code> and <code>C-x ]</code>.
</p>

<p>
Here’s what it looks like in a file of my Emacs Lisp source code (Elisp comments
start with one or more semicolons, and a form feed character displays as <code>^L</code>):
</p>

<pre id="orga1ec76d">^L
;;; parsing and unparsing
</pre>
<p>
That <code>^L</code> is <i>not</i> two characters, as you can clearly see if you move your cursor
across it one character at a time: it just looks like it.
</p>

<dl>
<dt>    <code>C-x [</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Pages"><code>backward-page</code></a>﻿)</dt><dd>Moves to the beginning of the
current page.</dd>
<dt>    <code>C-x ]</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Pages"><code>forward-page</code></a>﻿)</dt><dd>Moves to the end of the current
page.</dd>
<dt>    <code>C-x C-p</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Pages"><code>mark-page</code></a>﻿)</dt><dd>Sets the Region around the <i>entire</i>
current page; unlike most marking commands, in addition to setting the
Mark at the end of the object, this one also moves Point to the beginning.</dd>
</dl>

<p>
Finally, it’s useful to be able to jump directly to the beginning or the end of
the buffer without having to scroll.
</p>

<dl>
<dt>    <code>M-&lt;</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>beginning-of-buffer</code></a>﻿)</dt><dd>Moves to the beginning of
the buffer.</dd>
<dt>    <code>M-&gt;</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>end-of-buffer</code></a>﻿)</dt><dd>Moves to the end of the buffer.</dd>
</dl>

<p>
Mnemonic: the beginning of the buffer is a location that’s less-than any other
location, and vice versa.
</p>

<dl>
<dt>    <code>C-x h</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Marking-Objects"><code>mark-whole-buffer</code></a>﻿)</dt><dd>Move Point to the beginning
of the buffer and set Mark at the end of the buffer.</dd>
<dt>  <code>M-x</code> <code>mark-beginning-of-buffer</code></dt><dd>Set Mark at the beginning of the
buffer, without moving Point,</dd>
<dt>  <code>M-x</code> <code>mark-end-of-buffer</code></dt><dd>Set Mark at the end of the buffer,
without moving Point.</dd>
</dl>
</div>
</div>
<div id="outline-container-orgd49d8e7">
<h4 id="orgd49d8e7"><a id="orge30bd19"></a> Code Objects: Balanced Parentheses and Function Definitions</h4>
<div id="text-orgd49d8e7">
<table>


<colgroup>
<col/>

<col/>

<col/>

<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Object</th>
<th scope="col">Backward</th>
<th scope="col">Forward</th>
<th scope="col">Mark</th>
<th scope="col">Kill</th>
<th scope="col">Transpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>Sexp</td>
<td><code>C-M-b</code></td>
<td><code>C-M-f</code></td>
<td><code>C-M-@</code></td>
<td><code>C-M-k</code></td>
<td><code>C-M-t</code></td>
</tr>

<tr>
<td>Defun</td>
<td><code>C-M-a</code></td>
<td><code>C-M-e</code></td>
<td><code>C-M-h</code></td>
<td><code>C-M-h C-w</code></td>
<td> </td>
</tr>
</tbody>
</table>
<p>
An <i>S-expression<sup><a id="fnr.47" href="#fn.47" role="doc-backlink">47</a></sup></i> (“sexp” for short) is the name, in Lisp, for <i>atoms</i>
(symbols, numbers, and quoted strings) and the balanced parentheses that enclose
them, recursively.  In Emacs, this useful notion is available everywhere; it’s
especially useful for editing programming languages, but even in prose it’s very
useful to be able to move over, copy, or kill a parenthesized phrase.  The
characters that Emacs recognizes as parens are usually regular parentheses (aka
round brackets), square brackets, and braces (aka curly brackets), but it
depends on the Major Mode (for some languages, angle brackets (i.e. <code>&lt;</code> and <code>&gt;</code>) may
act as parens too).
</p>

<p>
But sexps are more than just balanced parens. A <i>symbol</i> (roughly, a <i>word</i>) that
doesn’t contain any parens also counts as a sexp, as does a number.  In most
programming language modes, quoted strings are sexps (using either single or
double quotes, depending on the syntax of the language).  A sexp is any of
those, or a parenthesized sequence of them, recursively.
</p>

<p>
These commands may seem confusing at first, but for editing most programming
languages they’re fantastic.  Not only do they move you around quickly and
accurately, but they help spot syntax errors while you’re editing, because
they’ll generate an error if your parens or quotes are unbalanced.
</p>

<dl>
<dt>    <code>C-M-b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Expressions"><code>backward-sexp</code></a>﻿)</dt><dd>Moves backward over the next
sexp.  If your cursor is just to the right of an opening paren, <code>C-M-b</code> will
beep, because there’s no sexp to the left to move over: you have to move up.</dd>
<dt>    <code>C-M-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Expressions"><code>forward-sexp</code></a>﻿)</dt><dd>Moves forward over the next sexp.
Same error if your cursor is just to the left of a closing paren.</dd>
</dl>

<p>
Here’s an example of linear movement via sexps.  The location of Point is shown
by |, and we move forward with <code>C-M-f</code> each time.  After three <code>C-M-f</code>’s Point is
after “Emacs” in line <code>3</code>, because each of the first three words count as symbols
and thus are sexps.  But the next <code>C-M-f</code> leaps over the entire parenthesized
expression in line <code>4</code>.
</p>
<pre id="org767caa3">0. |In  1976,  Emacs  (in its original TECO form)  was invented.
1.  In| 1976,  Emacs  (in its original TECO form)  was invented.
2.  In  1976|, Emacs  (in its original TECO form)  was invented.
3.  In  1976,  Emacs| (in its original TECO form)  was invented.
4.  In  1976,  Emacs  (in its original TECO form)| was invented.
</pre>

<dl>
<dt>    <code>C-M-u</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-by-Parens"><code>backward-up-list</code></a>﻿)</dt><dd>Move backward up one level of
parens.  In other words, move to the opening paren of the parens containing
the cursor, skipping over balanced sexps.</dd>
<dt>    <code>C-M-d</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-by-Parens"><code>down-list</code></a>﻿)</dt><dd>Move down one level of parens.  In
other words, move to the inside of the next opening paren, skipping
over intervening sexps.</dd>
</dl>

<p>
Let’s move up in nested parentheses with <code>C-M-u</code>.  On line <code>0</code>, Point is in front of
the word “Lisp”.  We type <code>C-M-u</code> and on line <code>1</code>, Point is now in front of the
nested parentheses.  One more <code>C-M-u</code> and Point moves in front of the leftmost
paren.
</p>

<pre id="org512606e">0. (in its original TECO form  (which preceded the |Lisp implementation))
1. (in its original TECO form |(which preceded the  Lisp implementation))
2. |(in its original TECO form (which preceded the  Lisp implementation))
</pre>
<p>
Nested parentheticals may be poor prose style, but they’re extremely common in
source code in almost any programming language.
</p>

<p>
Now let’s move down with <code>C-M-d</code>.  On line <code>0</code>, Point is on the return type of this
C function definition; on line 1, after <code>C-M-d</code>, Point is inside the formal
parameter list:
</p>
<pre id="org0be2b8b">0. |void synctex_updater_free( synctex_updater_t updater) {
1.  void synctex_updater_free(|synctex_updater_t updater) {
</pre>

<dl>
<dt>  <code>C-M-@</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Marking-Objects"><code>mark-sexp</code></a>﻿)</dt><dd>Set Mark at the end of this sexp.</dd>
<dt>    <code>C-M-k</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Expressions"><code>kill-sexp</code></a>﻿)</dt><dd>Kills the sexp after Point.</dd>
</dl>

<p>
Since function defintions are such an important unit of text in programming
languages, whether they’re called defuns, subroutines, procedures, procs, or
whatever, they also count as textual objects.  Like the sexp commands, these
commands work appropriately in most programming language modes.  Emacs calls
this generic notion of function or procedure <i>defun</i>, again after Lisp.
</p>

<dl>
<dt>    <code>C-M-a</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>move-beginning-of-defun</code></a>﻿)</dt><dd>Move to the beginning of
the current function definition.</dd>
<dt>    <code>C-M-e</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-by-Defuns"><code>end-of-defun</code></a>﻿)</dt><dd>Move to the end of the current
function definition.</dd>
<dt>    <code>C-M-h</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-by-Defuns"><code>mark-defun</code></a>﻿)</dt><dd>Sets the Mark at the end of the
current defun.</dd>
</dl>

<p>
Note the mnemonic analogy with lines and sentences.
</p>
</div>
</div>
<div id="outline-container-org6bf89c6">
<h4 id="org6bf89c6">Extending Kills <a id="org4924429"></a></h4>
<p>
If you kill several times in a row, with any combination of kill commands, but
<i>without any non-kill commands in between</i>, these kills are appended together in
one entry on the Kill Ring — there’s no need to precede the kills with
    <code>C-M-w</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Appending-Kills"><code>append-next-kill</code></a>﻿).  For example you can kill the next
six words as a unit with <code>M-d M-d M-d M-d M-d M-d</code>, move elsewhere and yank back
all six (with their intervening whitespace) with one <code>C-y</code>.  <code>C-u 6 M-d</code> would be
equivalent.  You can kill a block of lines with a sequence of several <code>C-k</code>’s, or
you could kill the next sentence and the following two words with <code>M-k C-u 2 M-d</code>
(note that the numeric argument <code>C-u 2</code> doesn’t break up the sequence of kills,
because <code>C-u 2</code> is <i>part of</i> the following <code>M-d</code> command).
</p>
</div>
<div id="outline-container-orgc9f20d5">
<h4 id="orgc9f20d5">Adjusting the Region</h4>
<p>
After setting the Region around one or more textual objects, whether by setting
the Mark and moving, or Shift Selection, or by object-specific mark commands,
you can fine-tune the Region by lengthening or shortening it at either end with
any other motion commands — perhaps you selected a paragraph with <code>M-h</code> but you
don’t want the blank line at the front of it, or selected a sentence and
want to add the two words at the beginning of the following sentence.  Just move Point in any
manner.  If you want to adjust the <i>other</i> end, where Mark is, use     <code>C-x C-x</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Setting-Mark"><code>exchange-point-and-mark</code></a>﻿): now Point is where the Mark was and you can
adjust that end.
</p>
</div>
</div>

<div id="outline-container-orge5ab769">
<h3 id="orge5ab769">Other Ways to Move Around</h3>
<p>
The textual object motion commands covered in the last chapter are probably the
most important means of motion in Emacs.  But there are several other ways to
move around.
</p>
<div id="outline-container-org630cc03">
<h4 id="org630cc03">Move by Searching</h4>
<p>
You can exploit your knowledge of the contents of your text by using Emacs’s
many <a href="#org3fa1f0c">search capabilities</a> to move around.  If you want move to where you were
discussing Ursula K. Le Guin, just search for her name.
</p>
</div>
<div id="outline-container-orgec67d8d">
<h4 id="orgec67d8d"><a id="org40be37b"></a> Follow a Breadcrumb Trail (The Mark Ring)</h4>
<div id="text-orgec67d8d">
<p>
We learned in <i>Selecting Text</i> that there’s only one <a href="#org40fd5a7">Mark</a> in any buffer.  This is
strictly true, but there’s an additional data structure in each buffer called
the <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Mark-Ring">Mark Ring (see Info)</a> that holds a
history of previous Mark locations<sup><a id="fnr.48" href="#fn.48" role="doc-backlink">48</a></sup>.
</p>

<p>
You set these Marks explicitly whenever you set the Region, whether with
    <code>C-SPC</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Setting-Mark"><code>set-mark-command</code></a>﻿) or a mouse selection, or implicitly
with <a href="#orgee51965">textual object</a> mark commands (like     <code>M-h</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Paragraphs"><code>mark-paragraph</code></a>﻿)).  They’re also left for you automatically at places where
you’ve done “significant” things, like changing text, moving a long way away in
one big jump (there being many ways to do this), the spot where you issued a
search command, and the like<sup><a id="fnr.49" href="#fn.49" role="doc-backlink">49</a></sup>.
</p>

<p>
Thus a breadcrumb trail of Marks is left for you to find your way back,
Theseus-like, to where you’ve been, and provides a quick way to get back to
these previous locations.  The way to jump back to the previous Mark location is
to give     <code>C-SPC</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Setting-Mark"><code>set-mark-command</code></a>﻿) an argument, so <code>C-u C-SPC</code>.
It also rotates the Mark Ring, so that a repeated, uninterrupted sequence of <code>C-u
C-SPC</code> commands will take you back in time through your previous Mark locations.
The Mark Ring is a circular structure, so when you hit the end, you’ll circle
round to the most recent Mark location again.  You’ll notice the analogies to
the operation of the <a href="#orgee263e4">Kill Ring</a>.
</p>

<p>
It’s a common idiom to set the Mark explicitly as a breadcrumb to jump back to,
rather than as part of selecting some text.  If you set the Mark, which
activates the Region, and immediately set it again in the same spot, the Region
is deactivated; this is nice for using the Mark to record your position —
you’re not really setting the Region, so why be distracted by the color of the
active region?  So remember <code>C-SPC C-SPC</code> as the breadcrumb-dropping command.
</p>
</div>
<div id="outline-container-orgd963645">
<h5 id="orgd963645">The Global Mark Ring</h5>
<p>
In addition to each buffer’s specific Mark Ring, there’s a also a <i>Global</i> Mark
Ring: this records a history of your locations in previous <i>buffers</i>.  So if you
want to jump to the last place you were in the previous buffer you were in, just
use     <code>C-x C-SPC</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Global-Mark-Ring"><code>pop-global-mark</code></a>﻿).  The setting of these
global marks is automatic: whenever you switch buffers, Emacs pushes the buffer
you just left (and your location there) onto the Global Mark Ring.  You can
cycle through this ring, too.
</p>
</div>
</div>
<div id="outline-container-org4817b54">
<h4 id="org4817b54">Move Via Your History of Changes <a id="orgbcb1a3b"></a></h4>
<div id="text-org4817b54">
<p>
Perhaps the most surprising way of moving is by <a href="#org3f93c8e">undoing</a>; if you recently made a
change to your text (possibly just by adding some more) and then moved
elsewhere, it’s pretty common to want to go back to where you made that change,
and the easiest way to get there is to just undo it, because wherever you may be
now, an undo pops you right back to the last change <i>in that buffer</i>.  You can use
this trick even if you don’t <i>want</i> to undo your change — because you can
instantly restore it by a redo.
</p>

<p>
Obviously this trick gets much trickier if you want to move back to where you
were, say, three changes ago: three undos gets you to the right spot, but assuming
you <i>liked</i> your changes, if you redo them you’re now back where you came from!
The <a href="#org660cffc">third-party packages</a> <code>goto-last-change</code> and <code>goto-chg</code> solve the problem by
going to the undo locations without actually undoing!
</p>
</div>
</div>
<div id="outline-container-orga307de7">
<h4 id="orga307de7">Mode-specific Motion</h4>
<p>
Various <a href="#org5b21ef0">Major Modes</a> may implement special ways of moving.  Perhaps the most
obvious is moving by <i>identifiers</i> (names) in programming language modes: you can
move from a use of a function or variable to the definition, for example, or
move through all the uses of an identifier.  This typically works across all the
files in a defined <a href="#orga12fa37">project</a>.  Some languages have a bespoke way of handling this
via the <a href="https://en.wikipedia.org/wiki/Language_Server_Protocol"><i>language server protocol</i></a> (LSP)<sup><a id="fnr.50" href="#fn.50" role="doc-backlink">50</a></sup>, but Emacs also supports various
language-agnostic approaches, such as the <a href="#org922bfe4">Xref</a> subsystem.
</p>
</div>
<div id="outline-container-org0c1b4ec">
<h4 id="org0c1b4ec">Move by Scrolling</h4>
<p>
Sometimes, rather than moving pointedly to get to a precise location, you just
want to scroll through your text to get an overview and stop at the spot that
catches your fancy; scrolling is covered in the chapter on <a href="#org7e57cd2">Windows</a>.
</p>
</div>
<div id="outline-container-org1085978">
<h4 id="org1085978">Goto Commands <a id="org6517779"></a></h4>
<div id="text-org1085978">
<p>
Most of the textual-object motion commands can be thought of as moving
<i>relatively</i>: when you move forward by one word (sentence, paragraph, …) you’re
moving relative to the location of Point.
</p>

<p>
But occasionally it’s useful to move to an <i>absolute</i> position (though
much less often than one might think).  The most common type of
absolute motion is to move to a specific line by its line number.  For
example, according to   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Position-Info"><code>what-line</code></a>﻿, this line as I’m
writing it is line 1,497.  If I move elsewhere, I can come right back
here by jumping to line 1,497!
</p>

<p>
Of course, since I’m editing, in a few minutes that line probably
isn’t line 1,497 anymore, and I probably won’t remember that number
for more than a few seconds, and anyway, if I wanted to come back here
why don’t I just use the <a href="#org40fd5a7">Mark Ring</a> or search?
</p>

<p>
<a id="org77f509a"></a> I think most people who use line numbers as motion targets have line numbers
turned on.
</p>
<p alt="linum-mode in action" title="linum-mode in action">
<a href="https:./images/startup.png" alt="linum-mode in action" title="linum-mode in action"><img src="https://blog.veitheller.de/images/linum.png" alt="linum-mode in action" title="linum-mode in action"/></a>
Emacs doesn’t display line numbers by default, though it does show
the current line number in the mode line, but you can toggle the traditional
left-margin display of line numbers on and off with   <code>M-x</code> <code>linum-mode</code>,
or arrange for them to always be on in every buffer<sup><a id="fnr.51" href="#fn.51" role="doc-backlink">51</a></sup>.  To me they just
waste screen real estate.
</p>

<p>
But what if you’re compiling a program in your terminal and it reports a syntax
error on line 563?  Well, you should be compiling that program in Emacs with
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Compilation"><code>compile</code></a>﻿, and then you can jump to that error with a keystroke,
with no need to type any line number; see <a href="#org76cafbe"><i>Compiling Code</i></a>.
</p>

<p>
However, it’s true that you do occasionally get a line number foisted upon you
in an unpredictable manner — say, from a stack trace when a program blows up,
or from some log file.  When you do,     <code>M-g g</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>goto-line</code></a>﻿)
will prompt you for the number and jump there.
</p>

<p>
Much more rarely, you’ll have a byte (character) offset from the beginning of
some file;     <code>M-g c</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>goto-char</code></a>﻿) will take you there.
</p>

<p>
Finally,     <code>M-g TAB</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>move-to-column</code></a>﻿) is what you need for
absolute positioning on the other axis: it moves to the given character offset
from the left margin.  There are lots of subtleties to this command — like,
how do you count tab characters in the line, or multibyte (say, Unicode)
characters? — but hopefully you’ll never need it; I’d never used it before I
had to write this paragraph!  See the documentation for details.
</p>
</div>
</div>
</div>
<div id="outline-container-orge03e083">
<h3 id="orge03e083">Variables and Symbols <a id="org39438a9"></a> <a id="org84d9891"></a></h3>
<div id="text-orge03e083">
<p>
Usually the programming language in which a program is implemented is only of
incidental interest to the user of the program.  But all Emacs users know that
it’s implemented in <a href="https://en.wikipedia.org/wiki/Emacs_Lisp">Emacs Lisp</a>, because the Lisp <a href="https://en.wikipedia.org/wiki/Interpreter_(computing)">interpreter</a> is always there,
running Emacs and interacting with you to a degree that’s unheard of in most
programs.
</p>

<p>
One of the most important parts of the running Lisp interpreter is the
collection of <i>symbols</i> that it contains: 40,974 at
startup.  A symbol — which is a name like <code>what-line</code> or <code>compile</code> or
<code>kill-paragraph</code> — can hold a function, in which case the symbol
serves as the <i>name</i> of the function, which you can use to execute the
function via     <code>M-x</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/M-x"><code>execute-extended-command</code></a>﻿) or by
which it can be attached to a keystroke via a <a href="#orge245187">key binding</a>.
</p>

<p>
A symbol can also be a <i>variable</i>—initially Emacs has
15,121 of them— and have a <i>value</i>.  We say the value
is <i>bound</i> to the variable.  Most of these variables are used only by
programmers in the implementation of the functions they write for you
to use, but a subset of them—2,885—are
<i>Customizable Variables</i> (a.k.a. <i>User Options</i>), which you can use to
configure Emacs to your liking.
</p>

<p>
In this chapter we’ll be talking mostly about User Options.  They’re
fundamentally the same as plain old variables, but distinguished by being
variables that you’re <i>expected</i> to want to customize, and they have additional
features to assist in this.  But you can customize almost any variable if you
want to, and some lazy Elisp programmers<sup><a id="fnr.52" href="#fn.52" role="doc-backlink">52</a></sup> simply might not bother to mark
their variables as customizable.  So I’ll generally just use the term “variable”
here.
</p>
</div>
<div id="outline-container-org5fadeb9">
<h4 id="org5fadeb9">What Are These Variables For?</h4>
<div id="text-org5fadeb9">
<p>
Emacs is famously malleable and customizable: you can make it work and look
exactly the way you want, and this is mostly achieved through variables.  Do you
not like the red color of the squiggles under your spelling errors?  That
color<sup><a id="fnr.53" href="#fn.53" role="doc-backlink">53</a></sup> is specified in the variable
  <code>flyspell-incorrect</code>, so you can change it.
</p>

<p>
Do you wish Emacs wouldn’t beep at you when an error occurs?  The
  <code>visible-bell</code> variable lets you change that.
</p>

<p>
Throughout this book, I make some recommendations for tweaks to some variables,
and give examples of others that you might want to change.
</p>
</div>
</div>
<div id="outline-container-org3655271">
<h4 id="org3655271">Types of Variable Values</h4>
<div id="text-org3655271">
<p>
A variable can hold any kind of Lisp value, and there are several types:
truth values (corresponding to true / false or on / off: called <i>Booleans</i> by
programmers), numbers, text (called <i>strings</i> by programmers), functions, and,
perhaps most importantly, <i>lists</i>, which are sequences or collections of values of
any types<sup><a id="fnr.54" href="#fn.54" role="doc-backlink">54</a></sup>.  Also, and I don’t want to blow your mind here, but a variable (which
is a symbol, you’ll recall) can also hold…  <i>a symbol</i>.
</p>

<p>
Let’s look at some examples of real Emacs variables and the (typical) types of
values they hold.
</p>
<table id="orgeefcd77">
<caption><span>Table 2:</span> Examples of variables</caption>

<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Variable Name</th>
<th scope="col">Default Value</th>
<th scope="col">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>visible-bell</code></td>
<td><code>t</code></td>
<td>Boolean</td>
</tr>

<tr>
<td><code>delete-by-moving-to-trash</code></td>
<td><code>nil</code></td>
<td>Boolean</td>
</tr>

<tr>
<td><code>kill-ring-max</code></td>
<td><code>60</code></td>
<td>number</td>
</tr>

<tr>
<td><code>report-emacs-bug-address</code></td>
<td><code>&#34;bug-gnu-emacs@gnu.org&#34;</code></td>
<td>string</td>
</tr>

<tr>
<td><code>tool-bar-position</code></td>
<td><code>top</code></td>
<td>symbol</td>
</tr>

<tr>
<td><code>split-window-preferred-function</code></td>
<td><code>split-window-sensibly</code></td>
<td>function</td>
</tr>

<tr>
<td><code>image-types</code></td>
<td><code>(svg png gif tiff jpeg xpm xbm pbm)</code></td>
<td>list</td>
</tr>
</tbody>
</table>
<p>
In Table <a href="#orgeefcd77">2</a>, we see that <code>visible-bell</code> is <i>on</i> (because <code>t</code> is the
Elisp Boolean true value) while <code>delete-by-moving-to-trash</code> is <i>off</i> (because <code>nil</code>
is the Boolean false value).
</p>

<p>
<code>kill-ring-max</code> determines the size of the <a href="#orgee263e4">Kill Ring</a>.
</p>

<p>
<code>report-emacs-bug-address</code> is the email address for Emacs bug reports such as
those generated by   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Checklist"><code>report-emacs-bug</code></a>﻿, and as such must be a
string.
</p>

<p>
<code>tool-bar-position</code> specifies where the tool bar should be displayed, and must be
one of the four symbols <code>top</code>, <code>bottom</code>, <code>left</code>, or <code>right</code>.<sup><a id="fnr.55" href="#fn.55" role="doc-backlink">55</a></sup>
</p>

<p>
<code>split-window-preferred-function</code> is a variable that holds a <i>function</i> that is
actually called to split a window; <code>split-window-sensibly</code> is a symbol that names
a function suitable for this purpose.  Variables that hold a function are
typically set to the symbol that names the function.
</p>

<p>
Finally, <code>image-types</code> is a list—of symbols, in this case, but Elisp lists can
hold any types or combination of types (including nested lists).
</p>
</div>
</div>

<div id="outline-container-org26ccb3a">
<h4 id="org26ccb3a">Changing the Value of a Variable</h4>
<div id="text-org26ccb3a">
<p>
As the name implies, you can also change the value that’s bound to a variable.
There are three <i>times</i> at which you might do this:
</p>
<ol>
<li>when Emacs starts up, via your <a href="#org2af3730">Init File</a>;</li>
<li>explicitly and interactively, while you are using Emacs;</li>
<li>whenever you visit a given file.</li>
</ol>

<p>
For cases 1 and 2, it’s best to use the <a href="#org27e6769">Customize Facility</a>, because it provides
documentation about how the variable works, guides you though the possibilities,
prevents you from making common mistakes, and allows you to revert your changes
or save them for future sessions.  It’s equally good for making settings for
your startup configuration, for setting a value just for this session, or just
to try out a new value for a while.  You’ll know you can use Customize when <code>C-h
v</code> says, “You can customize this variable.”
</p>

<p>
Note, however, that Customize only works for User Options.  If you want to
change a variable that hasn’t been defined as such, you’ll have to learn a
little about <a href="#org36dd556">Elisp</a>.
</p>
</div>
</div>
<div id="outline-container-orgc1d8417">
<h4 id="orgc1d8417">Buffer-Local Variables</h4>
<div id="text-orgc1d8417">
<p>
Variables can have different values in different buffers.  For example, you
might want to indent lines differently when you’re writing a <a href="https://en.wikipedia.org/wiki/Python_(programming_language)">Python</a> program than
when you’re writing prose.  We call these <i>buffer-local</i> variables.  They start
out with a <i>default value</i>, but if you change the value of such a variable, the
change only applies in the current buffer.<sup><a id="fnr.56" href="#fn.56" role="doc-backlink">56</a></sup>
</p>

<p>
You can’t change the local value of a buffer-local variable with <a href="#org27e6769">Customize</a>; you
either do it via Elisp in your <a href="#org2af3730">Init File</a> (if you want the change in every Emacs
session; see <a href="#orgc54c064"><i>Hooks</i></a> below), or else you use   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Examining"><code>set-variable</code></a>﻿ to do it
just for now, in the current buffer.
</p>

<p>
To set a variable with <code>set-variable</code>, you need to know the type of value the
variable expects; that means you need to read its documentation with <code>C-h v</code>.  You
also need to know enough about Elisp to understand the <i>syntax</i> of the different
types.  There’s a difference between the number \(256\) and a string
containing the three digits \(2\), \(5\), and \(6\).
</p>

<p>
If you say <code>M-x set-variable</code>, Emacs will prompt you for the name of a variable.
You might enter:<sup><a id="fnr.57" href="#fn.57" role="doc-backlink">57</a></sup>
</p>
<pre>Set variable: report-emacs-bug-address
</pre>

<p>
The next prompt would be:<sup><a id="fnr.58" href="#fn.58" role="doc-backlink">58</a></sup>
</p>
<pre>Set report-emacs-bug-address globally to value:
</pre>

<p>
According to the documentation, this value needs to be a string; if you were to
enter:
</p>
<pre>Set report-emacs-bug-address globally to value: myself@example.com
</pre>

<p>
you would get a <i>type error</i>:
</p>
<pre>user-error: Value ‘myself@example.com’ does not match type string of report-emacs-bug-address
</pre>

<p>
Table <a href="#org07c1cba">3</a> provides a cheat-sheet for entering values of the
major data types in the correct syntax; see
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Init-Syntax">“Init Syntax”</a> in the <i>Emacs</i> manual for details, and also for how to set
variables in your <a href="#org2af3730">Init File</a>.  But remember, prefer
  <code>M-x</code> <code>customize-variable</code> whenever possible.
</p>
<table id="org07c1cba">
<caption><span>Table 3:</span> Elisp Data Type Syntax</caption>

<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Type</th>
<th scope="col">Example</th>
<th scope="col">Another Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>Boolean (true or on)</td>
<td><code>t</code></td>
<td> </td>
</tr>

<tr>
<td>Boolean (false or off)</td>
<td><code>nil</code></td>
<td> </td>
</tr>

<tr>
<td>number</td>
<td>256</td>
<td>1</td>
</tr>

<tr>
<td>string</td>
<td>“256”</td>
<td>“myself@example.com”</td>
</tr>

<tr>
<td>symbol</td>
<td><code>flyspell-incorrect</code></td>
<td><code>top</code></td>
</tr>

<tr>
<td>function (same as symbol)</td>
<td><code>find-file</code></td>
<td><code>set-variable</code></td>
</tr>

<tr>
<td>list</td>
<td><code>(1 4 12)</code></td>
<td><code>(&#34;/tmp&#34;)</code></td>
</tr>
</tbody>
</table>
<p>
The syntax of Booleans is very simple: the true value is spelled <code>t</code> and the false
value, <code>nil</code>.<sup><a id="fnr.59" href="#fn.59" role="doc-backlink">59</a></sup> I could give you other examples of the true and of the false
values, but it would require a little
<a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/nil-and-t">too much explanation</a>.
</p>

<p>
Numbers are represented as a sequence of base 10 digits, like <code>256</code>, possibly
including a decimal point, as in <code>3.141593</code>.  There’s a special syntax to enter
numbers in other bases.
</p>

<p>
Strings are enclosed in double-quotes; there are some tricks here, like how to
include a double-quote in a string---<code>&#34;&#34;&#34;</code> is no good, because the enclosed
(second) <code>&#34;</code> terminates the string: you have to <i>escape</i> it with a backslash like
this: <code>&#34;\&#34;&#34;</code>.  There are also other “escapes” so that you can include control
characters and such; see <a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/String-Type">“String Type”</a> in the <i>Elisp</i> manual.
</p>

<p>
Symbols look rather like strings without quotes (they don’t need quotes because
they can’t contain spaces); you can just type their names.  As discussed above,
a function is typically represented by the symbol that names it (though for the
Elisp programmer, there are other possibilities) and so uses the syntax of
symbols.
</p>

<p>
Lists are simply zero or more space-separated instances of any types enclosed in
parentheses.  The empty list is <code>()</code>.  There’s no problem nesting lists: this list
contains two values, a string followed by a list of three numbers: <code>(&#34;foo&#34; (1 2
3))</code>.
</p>

<p>
This should be enough syntax for you to enter values at the <code>set-variable</code> prompt.
</p>
</div>

<div id="outline-container-orgb76b176">
<h5 id="orgb76b176">File- and Directory-Local Variables <a id="org3917dde"></a></h5>
<div id="text-orgb76b176">
<p>
Elisp also lets you initialize buffer-local variables inside arbitrary files:
these are called <i>file-local variables</i>.  When you visit such a file, the
variables are automatically given their values in the buffer that the file
initializes.  This is especially useful as a way to set the <a href="#org5b21ef0">Major Mode</a> in which
the file should be edited—see <a href="#org834988b"><i>Mode via File-Local Variable</i></a>—but you can set
additional variables too (subject to <a href="#org0959336">Security</a> limitations).
</p>

<p>
You can also set buffer-local variables on a per-directory basis; this is very
convenient when you would otherwise be repeatedly setting (or forgetting to
set…) the same file-local variables every time you add a file to a directory;
see <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Directory-Variables">“Directory Variables”</a> in the <i>Emacs</i> manual.
</p>
</div>
</div>
<div id="outline-container-orgdb8f0c6">
<h5 id="orgdb8f0c6">Hooks <a id="orgc54c064"></a></h5>
<div id="text-orgdb8f0c6">
<p>
An essential part of Emacs’s customizability is provided by <i>hook</i> variables.
They cleverly solve the problem of how you can customize, in your <a href="#org2af3730">Init File</a>,
dynamic things that <i>haven’t happened yet</i>, like all future buffers in some
particular <a href="#org5b21ef0">Major Mode</a>, or an Emacs application like <a href="#orgc4ddf2e">Eww</a> (the web browser), <a href="#orgcc42ce0">Dired</a>
the file manager, or a third-party application like <a href="#org53af7eb">Magit</a> that doesn’t even
ship with Emacs.
</p>

<p>
A hook is nothing more than an ordinary variable that’s used in a conventional
way by Emacs programmers.  The value of a hook is a list of functions, such that
at some documented and distinguished time—like when you visit a file in, say,
<code>python-mode</code>, or pull up a web page in Eww, or start playing an audio file in
<a href="#org7fd78c3">EMMS</a>—the functions are executed, or <i>run</i>.
</p>

<p>
Most hooks have a default value of the empty list: when the hook is run, nothing
happens!  But the important point is that you can add your choice of functions
to the hook to cause magical things to occur.  For example, you might add the
function   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Spelling"><code>flyspell-prog-mode</code></a>﻿ to the
  <code>python-mode-hook</code> variable to enable spell-checking of
Python comments.  Now you’ll get this spell-checking in every Python file that
you visit.
</p>

<p>
<a href="#org29e5e5d">Minor Modes</a> are a very common class of functions to add to hooks, as is a
function that changes the value of one or more buffer-local variables, whether
one of the 98 predefined buffer-locals, or one defined
specifically by a Major Mode for customization purposes.  You can also write a
function yourself to do any crazy thing that no one else could have thought of
in advance, like send an email to somebody mentioning that you’ve started
editing that Python file.
</p>

<p>
Hooks are almost always set in the Init File, rather than via
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Examining"><code>set-variable</code></a>﻿; see <a href="#org36dd556"><i>Programming the Lisp Machine</i></a>.
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org7f25cea">
<h3 id="org7f25cea">Help, Discovery, and Documentation</h3>
<p>
All kinds of help for Emacs is never more than a keystroke away — no need to
switch to a web browser.  The Help system (commands on the prefix key <code>C-h</code>)
provides quick access, especially for known-item searches (“what is”, “where
is”, “what does it do”).  The Apropos facility is more like a Google search,
used when you want to do something but don’t know what commands or modes or
subsystems are available to do it (a query like “version control diff”, say).
Finally, Emacs has a built-in hypertext documentation reader, called Info, for
long-form, book-length documentation.  To enter it, type   <code>C-h i</code>.  See <a href="#orga6bbd55">the <i>Info</i> chapter</a> for more information.
</p>

<div id="outline-container-orgf45ccaa">
<h4 id="orgf45ccaa">Help <a id="orge57a011"></a></h4>
<div id="text-orgf45ccaa">
<p>
Emacs’s extensive online help is available via the <i>help key</i>,
  <code>C-h</code> <sup><a id="fnr.60" href="#fn.60" role="doc-backlink">60</a></sup>.  <code>C-h</code> is a prefix key.  Type <code>C-h</code> twice to get a
window describing all the following commands and more (a <code>SPC</code> will scroll this window).
Some of the most useful help commands are:
</p>

<dl>
<dt>    <code>C-h a</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Apropos"><code>apropos-command</code></a>﻿)</dt><dd>Prompts for keywords and then
lists all the commands whose names match.  If you’ve forgotten the name of the
command that counts words, <code>C-h a word count</code> will reveal it.</dd>
<dt>    <code>C-h k</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Key-Help"><code>describe-key</code></a>﻿)</dt><dd>Prompts for a keystroke and
describes the function bound to that key, if any.  If you remember
<code>M-= </code> but
can’t recall what it is, use <code>C-h k</code> (it’s   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Position-Info"><code>count-words-region</code></a>﻿).</dd>
<dt>    <code>C-h w</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Key-Help"><code>where-is</code></a>﻿)</dt><dd>Prompts (with completion) for the
name of a function and tells you (in the Echo Area) what keystrokes will
invoke it.  If you cheekily type <code>C-h w where-is</code>, you’ll see: <code>C-h w, &lt;f1&gt; w,
  &lt;help&gt; w</code>.</dd>
<dt>    <code>C-h o</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Name-Help"><code>describe-symbol</code></a>﻿)</dt><dd>Prompts (with completion) for
the name of a function, a variable, or a <a href="#orgb1883e1">face</a><sup><a id="fnr.61" href="#fn.61" role="doc-backlink">61</a></sup> and describes all the
matches.  If you remember <code>count-words-region</code> but not what it does, <code>C-h o
  count-words-region</code> will tell you.  (<code>C-h f</code> will do the same but only for
functions, and <code>C-h v</code> only for variables, if you want to narrow it down.)</dd>
<dt>    <code>C-h m</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Misc-Help"><code>describe-mode</code></a>﻿)</dt><dd>Describes the current <a href="#org5b21ef0">major mode</a>
and its particular key bindings.</dd>
<dt>    <code>C-h r</code> (<code>info-emacs-manual</code>)</dt><dd>Enters the <a href="#orga6bbd55">Info</a> hypertext
documentation reader at the Emacs manual, which contains many hundreds of
pages of documentation.</dd>
<dt>    <code>C-h p</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Package-Keywords"><code>finder-by-keyword</code></a>﻿)</dt><dd>Runs an interactive
subject-oriented browser of installable Emacs packages<sup><a id="fnr.62" href="#fn.62" role="doc-backlink">62</a></sup>.  These lists of
packages are actually presented by the package manager itself, so you can
directly install packages from here.</dd>
<dt>    <code>C-h t</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Basic"><code>help-with-tutorial</code></a>﻿)</dt><dd>Run the Emacs tutorial.
Have you done this yet?</dd>
</dl>

<p>
There are 39 more help commands on <code>C-h</code>, which <code>C-h C-h</code> will reveal.
</p>

<p>
Of the commands I list above, <code>C-h k</code>, <code>C-h o</code>, <code>C-h f</code>, <code>C-h v</code>, <code>C-h m</code> (and a few of
the other 39) bring up a Help Buffer.  This is something of a simplification,
but there are three main varieties of the Help Buffer:
</p>
<ul>
<li>help for commands and functions, whether acquired via a keystroke or via a
command name</li>
<li>help for variables</li>
<li>help for modes</li>
</ul>
<p>
Let’s see what these are like.
</p>
</div>
<div id="outline-container-orgbd88b75">
<h5 id="orgbd88b75">The Help Buffer</h5>
<div id="text-orgbd88b75">
<p>
Let’s get help from <code>C-h k</code> for whatever <code>C-x C-b</code> is!  This is the same kind of
buffer you’d get from     <code>C-h f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Name-Help"><code>describe-function</code></a>﻿).
</p>

<div id="orgb24db37">
<p><a href="https:./images/help-C-x-C-b.png" alt="Help for key =C-x C-b=" title="Help for key =C-x C-b=" width="100%"><img src="https://blog.veitheller.de/images/help-C-x-C-b.png" alt="Help for key =C-x C-b=" title="Help for key =C-x C-b=" width="100%"/></a>
</p>
<p><span>Figure 6: </span>Help for key <code>C-x C-b</code></p>
</div>

<p>
First note that the help pops up in its own buffer (named <code>*Help*</code>) in a new
window (stealing some screen real estate from the <code>PKGBUILD</code> buffer I was looking
at); the buffer is in   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Help-Mode"><code>help-mode</code></a>﻿ (which of course usefully
redefines some keystrokes).
</p>

<p>
Often a quick glance at this buffer is enough to answer your question and you
just get rid of it with a quick     <code>C-x 1</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Change-Window"><code>delete-other-windows</code></a>﻿), perhaps after giving it a quick scroll with
    <code>C-M-v</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Window"><code>scroll-other-window</code></a>﻿).
</p>

<p>
If you’re in an investigative mood, you might jump into the help buffer with
    <code>C-x o</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Window"><code>other-window</code></a>﻿), where you can exploit its clickable
buttons (cyan text) and the the key bindings of <code>help-mode</code>.
</p>
</div>
</div>

<div id="outline-container-orgd0c821e">
<h5 id="orgd0c821e">Parsing the Help Buffer</h5>
<div id="text-orgd0c821e">
<p>
The first line identifies the function that <code>C-x C-b</code> runs: <code>list-buffers</code>, and
tells us which <i>keymap</i> (<code>global-map</code>) the keystroke was found in<sup><a id="fnr.63" href="#fn.63" role="doc-backlink">63</a></sup>.
</p>

<p>
It also tells us what kind of a function <code>list-buffers</code> is — “an interactive
compiled Lisp function”; it might also be a “built-in function” (which would
mean it’s implemented in C, rather than Elisp) — and it tells us which file of
source code the function is defined in.  You don’t need to worry about any of
this as a person just learning to use Emacs, but it isn’t just idle chat: the
cyan color of the file name means that it’s a hypertext link, and if you “click”
it (with mouse button 1 or by hitting return) it will take you directly to the
definition of that function in that file and you can read the source code
yourself.
</p>

<blockquote>
<p>
As an aside: this is an incredibly powerful tool for learning how to extend
Emacs.  I guarantee that if you are wondering what function the back-arrow
button in Firefox runs when you click it, you’ll have to spend a lot of time
plowing through the &gt;1 GB of source code (after you download it) and cross your
fingers when you search for “back”.  And if we were talking about the bold-face
toolbar button in Google Docs or Microsoft Word, you wouldn’t even be allowed to
download the proprietary source code.
</p>
</blockquote>

<p>
The next paragraph lists all the key bindings which run <code>list-buffers</code> — this is
just what     <code>C-h w</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Key-Help"><code>where-is</code></a>﻿) would tell you.
</p>

<p>
The next line (“<code>(list-buffers &amp;optional ARG)</code>”) shows you how you would call the
<code>list-buffers</code> function if you were writing Elisp, and after that, how old this
function is in terms of the Emacs version number (this is mostly useful for
programmers who might not want to write code using a new bleeding-edge function
that won’t be available in older Emacsen<sup><a id="fnr.64" href="#fn.64" role="doc-backlink">64</a></sup>).
</p>

<p>
The remainder of the buffer describes precisely what <code>list-buffers</code> does.  This
text may include more hyperlinks to other, related, functions or variables (like
<code>buffer-menu</code> here).
</p>

<p>
The help for a command can be extensive.  But this is because the documentation
includes <i>everything</i> an Elisp programmer might need to know; usually the first
line or two tells you everything you need for interactive use.
</p>

<p>
Finally, if this isn’t the first help buffer you’ve popped up in this Emacs
session, at the bottom of the buffer will be a button labeled “[back]” which
will take you to the previous help buffer you looked at.  Once you’ve gone back,
there will be a “[forward]” button to return you to where you came from.  These
are just like the back and forward buttons in your web browser and make it easy
to browse through the hypertext of the Emacs help system.  Note that there’s
really only one <code>*Help*</code> buffer, to keep from cluttering your Emacs; the
navigation buttons recreate the previous text in the same <code>*Help*</code> buffer.
</p>

<p>
I mentioned that the help buffer is in Help Mode.  This gives you 25 useful key
bindings for use when you’re in the <code>*Help*</code> buffer.  For example, <code>SPC</code> is bound to
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Scrolling"><code>scroll-up-command</code></a>﻿ and <code>S-SPC</code> to
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Scrolling"><code>scroll-down-command</code></a>﻿ for easy reading.  <code>C-c C-b</code> and <code>C-c C-f</code>
are keyboard equivalents of the “[back]” and “[forward]” buttons.  <code>TAB</code> and
<code>&lt;backtab&gt;</code> (a.k.a <code>S-TAB</code>) take you to the next and previous clickable button
respectively.
</p>
</div>
</div>

<div id="outline-container-org34fde42">
<h5 id="org34fde42"><a id="orge922ac1"></a> Help for a Variable</h5>
<div id="text-org34fde42">
<p>
Now let’s look at the help for the variable <code>completion-styles</code>, which we could
see by executing <code>C-h o completion-styles</code> (or <code>C-h v</code>).
</p>

<div id="org212ae7a">
<p><a href="https:./images/help-completion-styles.png" alt="Help for variable =completion-styles=." title="Help for variable =completion-styles=." width="100%"><img src="https://blog.veitheller.de/images/help-completion-styles.png" alt="Help for variable =completion-styles=." title="Help for variable =completion-styles=." width="100%"/></a>
</p>
<p><span>Figure 7: </span>Help for variable <code>completion-styles</code>.</p>
</div>

<p>
It’s very similar to the help for a function, but it tells you right up front
the most important thing about a variable: what it’s current value is (here, the
list of symbols
<code>(basic partial-completion substring initials flex)</code>).  Interestingly, it also
tells you that its original value was <code>(basic partial-completion emacs22)</code>: this
is the default value in a fresh Emacs: I changed it to demonstrate this
feature.  There may also be a hyperlink into the <a href="#org27e6769">Customize facility</a>, as here.
The rest of the buffer is the documentation for the variable, with the same
features as for functions.
</p>

<p>
<a id="org871902b"></a> For some variables, the help will say “Automatically becomes
buffer-local when set.”  This means that the variable can have distinct values
in different buffers, which is very useful for customization.  For some
variables, a buffer-local value doesn’t really make a lot of sense, like
  <code>confirm-kill-emacs</code>, which lets you specify whether you want
to be asked to confirm your intention when you give the exit command.  But you
may well prefer the values of other variables to vary from buffer to buffer or
mode to mode, such as   <code>indicate-empty-lines</code>,
  <code>fill-column</code>, or   <code>truncate-lines</code>.
</p>

<p>
The help for some variables may also address the <i>safety</i> of the variable with a
statement like “This variable is safe as a file local variable if its value
satisfies the predicate ‘integerp’.”; see <a href="#org0959336"><i>Security Concerns</i></a>.
</p>
</div>
</div>

<div id="outline-container-org5a3f32b">
<h5 id="org5a3f32b">Help for a Mode</h5>
<div id="text-org5a3f32b">
<p>
To get help for a <a href="#org5b21ef0">Major Mode</a>, just switch to a buffer that’s in that mode and do
<code>C-h m</code>.  The help buffer gives a description of the mode, and lists all the
mode-specific key bindings.  In addition, each enabled Minor Mode is described
separately.
</p>

<p>
You can also access Major Mode help from any Buffer using <code>C-h f</code> and the name of
the Mode, e.g. <code>C-h f org-mode</code>.
</p>
</div>
</div>
</div>
<div id="outline-container-orgbf1c14f">
<h4 id="orgbf1c14f">Discoverability via Apropos <a id="org42f1d6b"></a></h4>
<div id="text-orgbf1c14f">
<p>
Most of the Help commands described above answer specific questions about known
items: what is this key?  what does this function do?  what kind of values can I
set this variable to?  The Apropos facility is how you search for unknown
functions and variables related to what you want to do.
</p>

<p>
We’ve been introduced to the Apropos facility via <code>C-h a</code> above.  This is
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Apropos"><code>apropos-command</code></a>﻿ which searches for commands by name.
<i>Command</i> is the technical term for an <i>interactive function</i>: that is, a
function you can call via a key binding or with <code>M-x</code>.  The reason for making
this distinction is purely practical.  Emacs has tens of thousands of functions,
most of which would only ever be called by an Emacs Lisp programmer.  Commands
are functions that are likely to be useful to the non-programmer (or to the
programmer when she’s acting like a non-programmer).
</p>

<p>
If you’re interested in seeing non-command functions as well, you can give <code>C-h a</code>
an argument (e.g. <code>C-u C-h a</code>).
</p>

<p>
Even more broad-minded is just plain   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Apropos"><code>apropos</code></a>﻿, which includes all
functions, variables, and faces.
</p>

<p>
If you want to limit your search to variables, you can use
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Apropos"><code>apropos-variable</code></a>﻿.  But there are other Apropos commands to make
finer distinctions among variables:
</p>
<dl>
<dt>  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Apropos"><code>apropos-user-option</code></a>﻿</dt><dd>only considers <a href="#org27e6769">user-customizable</a>
variables (sometimes called <i>options</i>)</dd>
<dt>  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Apropos"><code>apropos-local-variable</code></a>﻿</dt><dd>only considers <a href="#org871902b">buffer-local</a>
variables defined in the current buffer</dd>
</dl>

<p>
All of the above commands are only searching by function or variable <i>name</i>, to
avoid overwhelming you.  But you can include in your search all the text of the
function’s or variable’s documentation with     <code>C-h d</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Apropos"><code>apropos-documentation</code></a>﻿).  This is just like <code>C-h a</code> but instead of limiting
its search to the names of <i>commands</i>, it includes all symbols (like variables)
<i>and</i> also searches the full text of the documentation of these symbols.  This is
a much broader search, and for reasons of both speed and concision, it limits
the search to the standard built-in Emacs commands.  If you give <code>C-h d</code> an
argument, i.e., <code>C-u C-h d</code>, it searches the documentation of literally all
symbols in your running Emacs, including those from third-party packages you may
have loaded.
</p>

<p>
Finally, you can also search the <i>values</i> of variables with
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Apropos"><code>apropos-value</code></a>﻿.  This is a pretty big search.  My Emacs at
the moment has 15,121 defined variables, and some of them have
pretty big values.
</p>
</div>

<div id="outline-container-org9fc26e5">
<h5 id="org9fc26e5">The Apropos Query Language</h5>
<div id="text-org9fc26e5">
<p>
All the Apropos commands use the same query language.  Your query can take any
of the following three forms:
</p>
<dl>
<dt>a single word</dt><dd>all the results must contain this word</dd>
<dt>two or more words</dt><dd>all the results must contain at least two of these words</dd>
<dt>a <a href="#org19c6ad0">regular expression</a></dt><dd>all the results must match this regular expression.</dd>
</dl>
</div>
</div>
</div>
<div id="outline-container-orgfcd64ec">
<h4 id="orgfcd64ec">Additional Information</h4>
<div id="text-orgfcd64ec">
<p>
The Help key has several additional subcommands that provide access to more
information.  Some of these are shortcuts into the Emacs or Elisp manuals in
Info, but some are standalone files.
</p>
<dl>
<dt><code>C-h C-a</code></dt><dd>Information about Emacs (recreates the splash screen you saw when
you started up Emacs).</dd>
<dt><code>C-h C-c</code></dt><dd>Emacs copying permission (displays the complete text of the GNU
General Public License, which gives you your freedom to copy, modify, and
redistribute Emacs and its source code).</dd>
<dt><code>C-h C-d</code></dt><dd>Instructions for debugging GNU Emacs.  This is for real hard-core
programmers hacking on Emacs to fix deep bugs.</dd>
<dt><code>C-h C-e</code></dt><dd>External packages and information about Emacs.</dd>
<dt><code>C-h C-f</code></dt><dd>Emacs FAQ (the Frequently Asked Questions list).</dd>
<dt><code>C-h C-m</code></dt><dd>How to order printed Emacs manuals.</dd>
<dt><code>C-h C-n</code></dt><dd>News of recent Emacs changes; see <a href="#orgd14cc9c"><i>Updates and Bugs</i></a>.</dd>
<dt><code>C-h C-o</code></dt><dd>Emacs ordering and distribution information.  This used to provide
postal addresses you could write to in order to get copies of Emacs mailed to
you on giant 9-track magnetic tapes to load on your mainframe!  Nowadays, it
just contains a few URLs and notes how you can make donations to the Free
Software Foundation.</dd>
<dt><code>C-h C-p</code></dt><dd>Info about known Emacs problems.  This is a broad summary of the
standout Emacs bugs; the real bug list is available on the Web in the <a href="https://debbugs.gnu.org/">Bug
Tracker</a>, which is also available in Emacs via the <code>debbugs</code> package; see
<a href="#org0eaad53">Reporting Bugs</a>.</dd>
<dt><code>C-h C-t</code></dt><dd>Emacs TODO list.  If you’re a Lisp or C programmer and want to
contribute to the development of Emacs, you can start here.</dd>
<dt><code>C-h C-w</code></dt><dd>Information on absence of warranty for GNU Emacs.</dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-org4232dab">
<h3 id="org4232dab">Info: The Emacs Documentation Reader <a id="orga6bbd55"></a></h3>
<div id="text-org4232dab">
<p>
Emacs has a built-in documentation reader called <i>Info</i>.  It dates from
1985 and actually predates GNU Emacs (it was present in <a href="#orgf0a0641">ITS TECO
Emacs</a>) and was one of the earliest freely available <a href="https://en.wikipedia.org/wiki/Hypertext">hypertext</a> systems,
predating the World Wide Web by five to ten years.
</p>

<p>
The Emacs manual is the most important Info document, but Emacs ships with
63 additional manuals, comprising 395,759
lines of text, describing various subsystems and major modes (e.g. <a href="#org4a851ca">Org</a>, <a href="#org9017fdf">Gnus</a>,
<a href="#orgb2b6b30">Calc</a>).
</p>

<p>
Info documents are written in their own markup language, called <a href="https://www.gnu.org/software/texinfo/manual/texinfo/html_node/">Texinfo</a>, and
Texinfo is used to document many other non-Emacs software projects<sup><a id="fnr.65" href="#fn.65" role="doc-backlink">65</a></sup>.  The
non-Emacs packages I’ve installed on my Arch Linux system include an additional
75 Info manuals.  (Non-Emacs users read these
manuals with the <code>info</code> command-line documentation reader, which is sort of like a
clone of the Emacs Info system for Vim users and other Emacs-averse types, I suppose.)
</p>

<p>
The main entry points for Info are:
</p>
<dl>
<dt><code>C-h i</code> or <code>M-x info</code></dt><dd>Lists all installed manuals (there will be at least
sixty, if you’ve done a full install of Emacs).</dd>
<dt><code>C-h r</code> or <code>M-x info-emacs-manual</code></dt><dd>Skip the top-level list and enter the Emacs
manual directly.</dd>
<dt>    <code>C-h R</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/info/Create-Info-buffer"><code>info-display-manual</code></a>﻿)</dt><dd>Open a specific manual by
name, with completion.  <code>C-h R calc</code> would go directly to the Calc manual, for
example.</dd>
<dt>    <code>C-h F</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Name-Help"><code>Info-goto-emacs-command-node</code></a>﻿)</dt><dd>This is like
    <code>C-h f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Name-Help"><code>describe-function</code></a>﻿)—it prompts for the name of an
Emacs function—except it tries to find a discussion of the function in the
Emacs manual (while every Emacs function has <a href="#orge57a011">Help</a> documentation, they aren’t
all described in detail in the manual).</dd>
<dt>    <code>C-h K</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Key-Help"><code>Info-goto-emacs-key-command-node</code></a>﻿)</dt><dd>This command is
to     <code>C-h k</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Key-Help"><code>describe-key</code></a>﻿) as <code>C-h F</code> is to <code>C-h f</code>.</dd>
</dl>

<p>
Info is of course documented in its own Info-manual, which you can read with:
</p>
<pre>M-x info-display-manual RET info RET
</pre>

<p>
(or just navigate to it from the main Info menu via <code>C-h i</code>).
</p>

<p>
Info has its own interactive tutorial<sup><a id="fnr.66" href="#fn.66" role="doc-backlink">66</a></sup>, modeled on the <a href="#org0e79444">Emacs Tutorial</a>, to teach
you how the hypertext system works.  Ideally, you should take it before you
start using Info; you can start the tutorial by typing <code>h</code>
(  <code>Info-help</code>) from anywhere in Info.  But you can read any
Info document in its entirety by just hitting
    <code>SPC</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/info/Help-%5EL"><code>Info-scroll-up</code></a>﻿), so feel free to just dive in; if you
want more or need help, hit <code>h</code>.
</p>


<div id="org25ee6fa">
<p><a href="https:./images/info-typical-chap.png" alt="Typical Info node with menu" title="Typical Info node with menu" width="100%"><img src="https://blog.veitheller.de/images/info-typical-chap.png" alt="Typical Info node with menu" title="Typical Info node with menu" width="100%"/></a>
</p>
<p><span>Figure 8: </span>Typical Info node with menu</p>
</div>

<p>
A typical page in an Info document (called a <i>node</i>) looks like that in Figure
<a href="#org25ee6fa">8</a>.  The very first line is a <a href="#orgbe2bf62"><i>header line</i></a> with next, previous,
and up navigation links for mouse navigation.  The next line is a <i>breadcrumbs line</i> that
shows your position in the document hierarchy with clickable links.  The rest of
the page consists of text, typically with clickable hyperlinks to other pages.
Often there is (as here) a <i>menu</i> of links to subsections of the chapter; these
are exactly the same kind of links as appear interspersed in the text.
</p>

<p>
You can move around in Info within a node, or between nodes.  The usual motion
and scrolling commands work fine for the former, along with the convenient
bindings <code>SPC</code> and <code>DEL</code> for scrolling up and down by screenfuls.
</p>

<p>
Moving between nodes is more interesting.  If you’re looking at the bottom of a
node<sup><a id="fnr.67" href="#fn.67" role="doc-backlink">67</a></sup>, <code>SPC</code> will move on to the next node, in the order you’d use to read
the entire document (<code>DEL</code> does the same backwards if you’re at the top of a
node).
</p>

<p>
Like any hypertext, an Info document has a tree structure<sup><a id="fnr.68" href="#fn.68" role="doc-backlink">68</a></sup>.  While <code>SPC</code>
moves node by node through the whole tree in reading order (that’s a <a href="https://en.wikipedia.org/wiki/Tree_traversal#Depth-first_search">depth-first
traversal</a>), you can cut across the branches at any level (breadth-first-wise)
with     <code>n</code> (<code>Info-next</code>) and     <code>p</code> (<code>Info-prev</code>).  So,
if you’re in the node for Chapter 3, <code>n</code> will go directly to Chapter 4, skipping
all subsections of Chapter 3, and if you’re in subsection 4 of section 2 of
Chapter 6, <code>n</code> will go to subsection 5, and so on.  <code>p</code> does the same thing
backwards.  In other words, <code>n</code> and <code>p</code> are the keyboard shortcuts for the <code>Next:</code> and
<code>Prev:</code> links in the node’s header line.  <code>u</code> will go up to the parent of this node.
</p>

<p>
You can also move through nodes in the order in which you visited them: that is,
move via your node-browsing history.  The
    <code>l</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/info/Help-Int"><code>Info-history-back</code></a>﻿) command goes <i>left</i> to the last node you
were in; more <code>l</code>’s go further back in time.  The
    <code>r</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/info/Help-Int"><code>Info-history-forward</code></a>﻿) command goes <i>right</i>, forward in time,
assuming you’ve already gone backward.  These commands have no relation to the
order of the nodes in the document, but only to the order in which you’ve read
them.      <code>L</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/info/Help-Int"><code>Info-history</code></a>﻿) takes you to a node containing the
history of all the nodes you’ve visited, as a <a href="#org3fa8bca">Menu</a>.
</p>
</div>
<div id="outline-container-org6d3bb90">
<h4 id="org6d3bb90">Hyperlinks</h4>
<div id="text-org6d3bb90">
<p>
Info documents wouldn’t be hypertexts if they didn’t have <i>hyperlinks</i>.  These are
exactly like the links in a web page and look similar: colorized and underlined.
You can navigate from link to link in a node with <code>TAB</code> (<code>S-TAB</code> goes in reverse)
and then follow a link by “clicking” on it (either with <code>RET</code> or the mouse).  Info
links can take you to other places within a node, to other nodes in the
document, and also to nodes in other Info documents.<sup><a id="fnr.69" href="#fn.69" role="doc-backlink">69</a></sup>  Links to places in
the same page are formatted like footnotes.
</p>

<p>
You can also follow any of the links in the current node (even if you can’t see
some of them) without navigating to them with
    <code>f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/info/Help-Xref"><code>Info-follow-reference</code></a>﻿), which prompts you for the text of
the link.  You can use <a href="#org75fb6a2">Completion</a> to complete any of the links in the node; note
that Menu links and Footnote links are excluded from the Completion, because
they have their own shortcut commands.
</p>
</div>
</div>
<div id="outline-container-org55bb1d4">
<h4 id="org55bb1d4">Menus <a id="org3fa8bca"></a></h4>
<div id="text-org55bb1d4">
<p>
Many Info nodes have <i>menus</i>, especially in the first node of a document and in
each chapter.  Menus are nothing more than a list of hyperlinks and work the
same way; it’s just a convention for organizing an Info document.  Menus
typically list all the children of a given node: that is, a chapter menu will
list all the sections in that chapter, and a section menu all its subsections.
</p>

<p>
You can use Completion to select a Menu item by typing
    <code>m</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/info/Help-M"><code>Info-menu</code></a>﻿), analogous to the <code>f</code> command for cross
references, and the digit keys will jump directly to the node of the
corresponding menu item: e.g., <code>3</code> would jump to the node named in the 3rd menu
item and so on.
</p>
</div>
</div>
<div id="outline-container-orgb9d2090">
<h4 id="orgb9d2090">Searching</h4>
<p>
Since an Info node is just a buffer, you can obviously search within it with the
usual search commands like     <code>C-s</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Basic-Isearch"><code>isearch-forward</code></a>﻿),
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Repeating-Search"><code>occur</code></a>﻿, and the like.  <a href="#org3ffa52a">Incremental search</a> commands like <code>C-s</code> will
beep when you get to the end of the node, but if you force the search with one
more <code>C-s</code> then instead of wrapping to the beginning of the buffer, they will skip
ahead to the next hit in the next node of the document.
</p>
</div>
<div id="outline-container-org13cc7ef">
<h4 id="org13cc7ef">Indexes</h4>
<div id="text-org13cc7ef">
<p>
In addition to full text searching, most Info documents are actually manually
indexed by their authors, and everybody knows that a good index, what with
synonyms, related terms, and inversion, can offer accessibility that full text
searching can’t.  In addition, an index allows for the possibility of Completion
on index terms!
</p>

<p>
An Info document can have one or more indexes—Emacs-related documents
will often have separate indexes of Key Bindings, User Options, Commands, Variables,
and Concepts (the Emacs manual has all of these).
</p>

<p>
The index pages of document are always listed at the end of the top-level menu
of the document (its table of contents), but from any node the
    <code>i</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/info/Search-Index"><code>Info-index</code></a>﻿) command prompts you for an index term, with
Completion, from any of the document’s indexes.  Since a given term can point to
any number of nodes, it will take you to the first occurrence, and if there are
more, you might see a message like this in the Echo Area:
</p>
<pre>Found ‘INDEXTERM’ in Concept Index.  (20 total; use ‘,’ for next)
</pre>

<p>
and indeed, the comma key will step you through all the hits.
</p>

<p>
Alternatively, you can instead use     <code>I</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/info/Search-Index"><code>Info-virtual-index</code></a>﻿),
which presents the same hits as <code>i</code> but lists them all in a dynamically-generated
Menu.
</p>

<p>
You can also search across <i>all</i> sixty-plus Info documents at once with
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/info/Search-Index"><code>info-apropos</code></a>﻿, the search-engine of Info commands.  It works like
other <a href="#org42f1d6b">Apropos</a> commands but targets the text of the indexes of all installed Info
files, and generates a dynamic Menu page from the hits.
</p>
</div>
</div>
<div id="outline-container-org0f9efd2">
<h4 id="org0f9efd2">Higher-Level Navigation</h4>
<p>
You can jump directly to the top of the current Info document, with its master
Menu table of contents, with     <code>t</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/info/Help-Int"><code>Info-top-node</code></a>﻿), and the
    <code>d</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/info/Help-Int"><code>Info-directory</code></a>﻿) command goes to the Menu at the root of the entire
Info system, listing all installed Info documents (the same place that <code>C-h i</code>
takes you to).
</p>
</div>
<div id="outline-container-org96e3314">
<h4 id="org96e3314">Write Your Own Manual</h4>
<p>
If you are writing a book-length document, especially a manual for software, and
very especially a new manual for an Emacs subsystem or Mode, you might consider
using Texinfo format.<sup><a id="fnr.70" href="#fn.70" role="doc-backlink">70</a></sup>  You’ll get many output options—PDF, HTML,
DocBook, EPUB, and of course Info, which can be read in Emacs and even by non-Emacs
users via the <code>info</code> command-line reader that’s standard on most Unix systems.
And Emacs is of course especially suited for authoring with its Texinfo Mode;
see <a href="#org6412830"><i>Emacs For Writers</i></a> for more information.
</p>
</div>
</div>
<div id="outline-container-orgc7c22ed">
<h3 id="orgc7c22ed">Messages, Errors, and Lossage</h3>

<div id="outline-container-org3a12fe4">
<h4 id="org3a12fe4">Messages</h4>
<div id="text-org3a12fe4">
<p>
Various brief messages appear in the <a href="#org7e7133f">Echo Area</a> from time to time.  This includes
error messages (like, trying to save a file that you don’t have permission to write),
and also informational messages.  Some commands exist only to print informational
messages, such as     <code>C-x l</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Pages"><code>count-lines-page</code></a>﻿), which tells you
how many lines there are in your buffer<sup><a id="fnr.71" href="#fn.71" role="doc-backlink">71</a></sup>:
</p>
<pre>Page has 5549 lines (2407 + 3143)
</pre>

<p>
If you miss a message like this, or if you want to make a copy of the message,
you can use     <code>C-h e</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Misc-Help"><code>view-echo-area-messages</code></a>﻿).  This pops up
the <code>*Messages*</code> buffer, which you can switch to for copies of the <i>N</i> most recent<sup><a id="fnr.72" href="#fn.72" role="doc-backlink">72</a></sup>
Echo Area messages.  It’s just a buffer like any other, so you can copy and
paste from it.
</p>

<p>
<a id="orge724ca4"></a> There’s a separate buffer for <i>warnings</i>.  Warnings are obviously
like errors, but less severe.  While errors go to the Echo Area, and behind the
scenes are copied to the <code>*Messages*</code> buffer, warnings instead go to a separate
<code>*Warnings*</code> buffer, and when a warning is generated this buffer pops up and is
very noticeable.  It seems counterintuitive that warnings should be more
in-your-face than errors; I think the reason is two-fold: 1. the special
handling of warnings is a relatively new feature, dating from about Emacs
version 22; and 2. an error terminates whatever function raised it — it beeps,
and you’ll look at the Echo Area — whereas a function that generates a warning
will continue with what it was doing, but wants you to know something that you
might need to act upon.  There’s no special command to pop up the <code>*Warnings*</code>
buffer; if you’ve deleted the window that popped up, and you want to reexamine
it, you can just switch to it by name with     <code>C-x b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer"><code>switch-to-buffer</code></a>﻿) (which you can also do to get to <code>*Messages*</code>).
</p>
</div>
</div>
<div id="outline-container-org0a66385">
<h4 id="org0a66385">What Just Happened?</h4>
<div id="text-org0a66385">
<p>
Occasionally as you’re working, you might suddenly notice that something
unexpected has happened — perhaps a chunk of text has disappeared before your
eyes, or you’re suddenly in a completely different location!  What happened?
</p>

<p>
Almost certainly this means you accidentally hit some unintended combination of
keystrokes, and since so many such combinations are bound to commands, this
means you inadvertently told Emacs to do something.
</p>

<p>
If a change to your text occurred, you can just <a href="#org3f93c8e">undo it</a> and continue on.  While
you can’t undo a location change, you can use the <a href="#org40be37b">Mark Ring</a> or the <a href="#org40be37b">Global Mark
Ring</a> to return to where you were.  But you might want to know what keystrokes
and command you invoked so that you can avoid hitting it in the future — or
perhaps you’ve discovered a new useful command to use intentionally!
</p>

<p>
The     <code>C-h l</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Misc-Help"><code>view-lossage</code></a>﻿) command<sup><a id="fnr.73" href="#fn.73" role="doc-backlink">73</a></sup> pops up a <a href="">Help Buffer</a>
showing the last 300 keystrokes you’ve typed.  The lines look like this:
</p>
<pre id="org8971398">M-&gt;                           ;; end-of-buffer
q                             ;; quit-window
C-x b                         ;; switch-to-buffer
c                             ;; self-insert-command
o                             ;; self-insert-command
</pre>
<p>
showing you the keystroke and the command name.  You can ask for help for any of
the command names (with     <code>C-h f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Name-Help"><code>describe-function</code></a>﻿))
which can help you figure out what happened.
</p>
</div>
</div>
</div>
<div id="outline-container-orgdd4a756">
<h3 id="orgdd4a756">The Minibuffer <a id="orga329460"></a></h3>
<div id="text-orgdd4a756">
<p>
Sometimes a command needs to ask you a question.    <code>C-x C-f</code> asks,
“What file did you want?”    <code>C-x b</code> asks, “What buffer did you
want?”    <code>M-x</code> asks, “What long-named command did you want me to
execute?”
</p>

<p>
To get your answer, Emacs uses its most general and most powerful data
structure, the <a href="#orgc3260f6">Buffer</a>, but to avoid constantly popping up a new one and messing
with your window layout, it uses a special buffer called the <i>Minibuffer</i>
(see <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Minibuffer">“Minibuffer”</a> in the <i>Emacs</i> manual), which is always displayed in a compact form in
the same location.  In fact, the Minibuffer reuses the fixed window that’s used
for the <a href="#org7e7133f">Echo Area</a> at the bottom of the screen.  The question, or prompt, appears
in the Echo Area, which is automatically focused to receive your response, and
when you hit <code>RET</code>, the little excursion is over.
</p>

<p>
The advantage of using a Buffer, rather than something like a <a href="https://en.wikipedia.org/wiki/Modal_window">modal GUI dialog
widget</a>, would be that you already know how buffers work, and you can interact
with this Minibuffer using the same commands you use all day long.<sup><a id="fnr.74" href="#fn.74" role="doc-backlink">74</a></sup>
</p>

<p>
The Echo Area, and thus the Minibuffer’s window, is normally only one line high
— just enough space for a typical prompt and your response, though it will
dynamically expand to more lines as needed, and you can change the default
height if you like.
</p>

<p>
The Minibuffer has its own <a href="#org5b21ef0">Major Mode</a>, with a few specialized key
bindings.  Most notable is that hitting <code>RET</code> is how you indicate that
you’re done typing your answer: <code>RET</code> deactivates the Minibuffer and
your cursor is returned to the window it was in when the interaction
started.
</p>

<p>
While it has some special behavior and a few restrictions, the
Minibuffer is otherwise very much a fully-functional Emacs buffer.
All the usual editing commands work — you can move around within it
to correct mistakes, you can even do fancy things like search within
it, you can kill and yank text, use spelling correction, or anything
else<sup><a id="fnr.75" href="#fn.75" role="doc-backlink">75</a></sup>.
</p>
</div>

<div id="outline-container-org0e8546c">
<h4 id="org0e8546c">Minibuffer History <a id="orgee992bc"></a></h4>
<div id="text-org0e8546c">
<p>
In addition to the special treatment of <code>RET</code>, the Minibuffer’s Major Mode
provides convenient history commands.  You can instantly recall your previous
input — command name, filename, buffer name… — with     <code>M-p</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Minibuffer-History"><code>previous-history-element</code></a>﻿); subsequent <code>M-p</code>’s will go further back, and you
can switch directions and go forward again with     <code>M-n</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Minibuffer-History"><code>next-history-element</code></a>﻿) — the up- and down-arrow keys are synonyms.
(Rather than navigating the history, <code>C-p</code> and <code>C-n</code> navigate multi-line input as in
any buffer — multiple lines, while atypical, are completely supported in the
Minibuffer).
</p>

<p>
You can also search backward in the history with
    <code>C-r</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Basic-Isearch"><code>isearch-backward</code></a>﻿) or
    <code>C-M-r</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Regexp-Search"><code>isearch-backward-regexp</code></a>﻿).  You could, say,
quickly pull up the last <a href="#org4a851ca">Org Mode</a> file you edited with <code>C-x C-f C-r
.org</code>, even if you last typed that filename days ago.
</p>

<p>
Note that any individual command can have its own distinct history list.  This
is typically done to tamp down the completion possibilities for any given
command to those that are most likely to be useful.  Since the Minibuffer is
used for all prompted inputs, if it only had one history list, then you’d have
to wade through buffer names, command names, color names, variable names — you
get the idea — no matter what you were about to enter.
</p>

<p>
Instead, all the file-visiting commands, like   <code>C-x C-f</code>, share a
single history list which only contains filenames; likewise for
  <code>C-x b</code> and buffer names,   <code>M-x</code> and command names,
etc.
</p>
</div>
</div>

<div id="outline-container-orga206f64">
<h4 id="orga206f64"><a id="org1fb87bb"></a>  <i>Future</i> History</h4>
<div id="text-orga206f64">
<p>
One of the lesser-known features of the Minibuffer<sup><a id="fnr.76" href="#fn.76" role="doc-backlink">76</a></sup> is that its
history extends into the future: that is, Emacs can predict inputs
that you haven’t typed yet!  More prosaically, you could call these
predictions, <i>defaults</i>.  You access these defaults with
    <code>M-n</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Minibuffer-History"><code>next-history-element</code></a>﻿) — use it immediately
after you’ve been prompted for input by some command and it’ll offer
up suggestions: if you’re at the end of the history, the <i>next</i> history
element is from the future!
</p>

<p>
For example, after     <code>C-x b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer"><code>switch-to-buffer</code></a>﻿), <code>M-n</code> will offer
up names of buffers that you’ve recently visited (even if you haven’t ever
explicitly input their names).    <code>C-x C-f</code> will do something
similar, but in addition, if, before you invoked <code>C-x C-f</code>, Point happened to be
in the name of an existing file, it will offer up that filename.  Sometimes the
things <code>M-n</code> comes up with can seem telepathic.  (The flip side is that sometimes
it won’t have any guesses for you.)
</p>
</div>
</div>

<div id="outline-container-orge870079">
<h4 id="orge870079">Recursive Minibuffers</h4>
<div id="text-orge870079">
<p>
The Minibuffer is the sole, unified way to get prompted input, and
you can use any commands you like when you’re entering text there.  So
what happens if you type   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/EWW"><code>eww</code></a>﻿ to pull up a web page in
the <a href="#orgc4ddf2e">Emacs web browser</a>.  Eww is now using the Minibuffer to read a URL,
prompting you with:
</p>
<pre>Enter URL or keywords:
</pre>

<p>
Then you realize you don’t remember the precise URL you need, but you know it’s
in a file.  So you naturally type     <code>C-x C-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-file</code></a>﻿) so you
can observe and copy that URL.
</p>

<p>
But no!  Emacs will beep at you and refuse to execute <code>C-x C-f</code>, saying:
</p>
<pre>Command attempted to use minibuffer while in minibuffer
</pre>

<p>
That is, you’re in the Minibuffer (entering a URL) but <code>C-x C-f</code> now
needs to use the Minibuffer to read a filename!
</p>

<p>
This is not really a limitation of Emacs, which actually has no
problem allowing you to invoke the Minibuffer recursively to any
(reasonable) depth.  However, this feature is <a href="#org46fc1c3">disabled</a> by default —
because it’s been found to confuse Emacs newbies.
</p>

<p>
But this many pages into this book, you’re no longer a newbie!  While
my example may be somewhat contrived, recursive Minibuffers are very
useful and you’ll probably want them several times in a day.  I
recommend turning them on with this snippet of code in your <a href="#org2af3730">init file</a>:
</p>
<div>
<pre>(<span>setq</span> enable-recursive-minibuffers t)
</pre>
</div>

<p>
If you recursively invoke a Minibuffer and change your mind about it,
just hit     <code>C-g</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Quitting"><code>keyboard-quit</code></a>﻿) as usual; it will
abort the most recent Minibuffer and you’ll be back in the previous
one and can complete your input there as you like.
</p>
</div>
</div>
<div id="outline-container-org8886ef5">
<h4 id="org8886ef5">Temporary Excursions</h4>
<div id="text-org8886ef5">
<p>
When you’re entering information in the Minibuffer, you may occasionally realize
that you don’t actually know what you need to type, as in our URL example.  You
have to check something first.
</p>

<p>
The normal procedure is just to use     <code>C-g</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Quitting"><code>keyboard-quit</code></a>﻿) to
cancel the command that’s using the Minibuffer, do your investigation, and then
reissue the command.  How very modal of you.
</p>

<p>
But you can instead just temporarily switch out of the Minibuffer with any
command that switches windows.  Normally that would be     <code>C-x o</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Window"><code>other-window</code></a>﻿) but any window-changing command, or clicking in another
window with the mouse, is fine.
</p>

<p>
Now you’re in one of your “normal” windows, and the Echo Area, instead of being
blank, as usual, still contains the Minibuffer prompt and whatever else was
displayed there when you jumped out: the Minibuffer is frozen the way you left
it, waiting for you to return and finish what you were doing.  In a graphical
mode Emacs, you’ll notice that the Minibuffer cursor has changed from a solid
rectangle to a hollow one.
</p>

<p>
While you’re away, you can do anything you like: continue editing, play a game
with   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Amusements"><code>tetris</code></a>﻿, <a href="#orgfab3d04">copy some text</a> you need for the Minibuffer:
you can even, of course, use a command that uses the Minibuffer!<sup><a id="fnr.77" href="#fn.77" role="doc-backlink">77</a></sup>  You can stay
away as long as you like.  When you’re ready to get back to where you left off,
just navigate to the Minibuffer (again,   <code>C-x o</code>
or a mouse click is the most natural), and complete your action, perhaps yanking
in some text you copied for the purpose.  Hit <code>RET</code> to execute the patient,
long-suffering command-in-progress, and you’ll be returned to wherever you were
when you started this excursion — the window layout and your buffer position
will be restored as they were, even if, during your excursion, you changed
windows around radically.  This is the essence of non-modal editing!
</p>
</div>
</div>
<div id="outline-container-org422ffdb">
<h4 id="org422ffdb">Repeating Complex Commands</h4>
<div id="text-org422ffdb">
<p>
Among people who use Emacs mostly as a text editor, the Minibuffer is probably
most heavily used to input file names, followed by buffer names.  But as you use
Emacs for more things, the use of the Minibuffer to enter command names with
    <code>M-x</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/M-x"><code>execute-extended-command</code></a>﻿) probably dominates.  So Emacs
provides special history support for these.
</p>

<p>
We know that if you type <code>M-x</code> you can retrieve previous commands from the history
with   <code>M-p</code>,   <code>C-r</code>, and   <code>M-r</code>, but some
commands have multi-part inputs.  Consider   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Grep-Searching"><code>rgrep</code></a>﻿ (see
<a href="#orgfdf7146">Meet the Greps</a>).  It’s nice that the Minibuffer history helps you avoid typing all
five characters of “rgrep” to run a <i>new</i> Rgrep, but what if you want to rerun a
previous Rgrep exactly?
</p>

<p>
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Grep-Searching"><code>rgrep</code></a>﻿ prompts you for three things: a search term or <a href="#org19c6ad0">regular
expression</a>, a file type wildcard pattern (e.g., <code>*.org</code>), and a base directory
from which to start the search.  You can use the history commands at each of
these prompts, but that can be a little tedious if you just want to rerun the
command exactly: <code>M-x M-p RET M-p RET M-p RET M-p RET</code>.
</p>

<p>
Instead, you can use     <code>C-x ESC ESC</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Repetition"><code>repeat-complex-command</code></a>﻿).
You get a Minibuffer prompt showing your previous <code>M-x</code> command, in its true Elisp
form; it might look like this:
</p>
<pre>Redo: (rgrep &#34;minibuffer&#34; &#34;*.org&#34; &#34;~/txt/&#34; nil)
</pre>

<p>
Even if you’re not an Elisp programmer (yet), this should be recognizable as
your grep for the string “minibuffer” in <a href="#org4a851ca">Org Mode</a> files contained (recursively)
in <code>~/txt/</code>; just hit <code>RET</code> to re-run it, with no need to reenter the three
parameters.  You can edit the command beforehand (perhaps to tweak the regexp,
or the file type, or the base directory)<sup><a id="fnr.78" href="#fn.78" role="doc-backlink">78</a></sup>.
</p>

<p>
You can use the Minibuffer history (<code>M-p</code>, <code>C-r</code>, <code>M-r</code>) as usual here to choose a
different prior command.  Note that the history includes any command that used
the Minibuffer, even if you invoked it via a key binding, so you’ll find old
friends like     <code>C-x C-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-file</code></a>﻿) and
    <code>C-x b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer"><code>switch-to-buffer</code></a>﻿) here as well.
</p>

<p>
You can view a buffer of the <i>N</i> most recent<sup><a id="fnr.79" href="#fn.79" role="doc-backlink">79</a></sup> <code>M-x</code> commands with
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Repetition"><code>list-command-history</code></a>﻿.  The commands are in their true
Elisp form, as for   <code>C-x ESC ESC</code>, one per line.  In this buffer you
can re-run the command at Point by typing <code>x</code> (  <code>command-history-repeat</code>).
</p>

<p>
Since the default command history list is so short, and since I think <code>RET</code> in
this buffer should execute the command at Point, I recommend this snippet for
your init file:
</p>
<div>
<pre>(<span>with-eval-after-load</span> &#39;chistory
  (<span>setq</span> list-command-history-max 120)
  (define-key command-history-map (kbd <span>&#34;&lt;return&gt;&#34;</span>) &#39;command-history-repeat))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd358f17">
<h4 id="orgd358f17">An Aside Concerning Completion Frameworks</h4>
<p>
Note that alternative completion frameworks, and <a href="#orgeb3f098">Incremental Narrowing
Frameworks</a> in particular, may radically alter the nature of the Minibuffer,
making it seem less like a normal buffer, and some of the things described in
this chapter may not work precisely the same way.
</p>
</div>
</div>
<div id="outline-container-org3c9b664">
<h3 id="org3c9b664">Completion <a id="org75fb6a2"></a></h3>
<div id="text-org3c9b664">
<p>
Everyone is familiar with <i>completion</i>, perhaps under the name “auto­fill”, which
usually refers to the automatic completion of fields in forms.  Web browsers,
spreadsheets, and smartphone applications autofill via drop-downs, and Unix
users are of course familiar with the TAB-completion of commands, options,
and filenames in any conventional shell<sup><a id="fnr.80" href="#fn.80" role="doc-backlink">80</a></sup>.
</p>

<p>
Emacs definitely had completion for the <a href="#orga329460">Minibuffer</a> by 1985 and as a
text-oriented computing interface that prioritizes the keyboard over menus, it’s
fundamental to using Emacs.  Completion is pervasive: almost anytime Emacs
prompts you for information — command names, variable names, filenames, color
names, lists of words — completion is available; it’s also available at Point
in many buffers (e.g., to complete symbols and keywords in programming
languages, as you type).
</p>

<p>
This is not to be confused with the <i>predictive autocompletion</i> or <i>autocorrect</i> for
prose that you’re used to from the text messaging app on your phone, where every
word you enter is automatically turned into a typo for you!<sup><a id="fnr.81" href="#fn.81" role="doc-backlink">81</a></sup>  Instead, you
can autocomplete natural language words via an explicit keystroke; Emacs
calls this <a href="#org844fd88"><i>expanding dynamic abbreviations</i></a>.
</p>

<p>
Neither is it to be confused with <i>template expansion</i>, where an entire
complex piece of text, like say a <code>case</code> statement in a programming
language, is expanded from one word.
</p>

<p>
As completion examples I’ll use <code>M-x</code> commands, because the basic set of them is
common to all Emacs users — filenames and buffer names are going to be unique
to each person — but don’t forget that it works the same for everything.
</p>
</div>

<div id="outline-container-org96b6507">
<h4 id="org96b6507">A Shortcut to Completion <a id="org673c150"></a></h4>
<div id="text-org96b6507">
<p>
Emacs has a number of ways of performing completion that I’ll call <i>completion
frameworks</i>.  The default framework is roughly the way completion has always
worked since about 1985, but you definitely want to use a more modern framework
of the type known as <i>incremental narrowing</i>.  Even here, Emacs has more than one
choice.
</p>

<p>
I’m going to recommend you start right off with <a href="https://github.com/minad/vertico">Vertico</a><sup><a id="fnr.82" href="#fn.82" role="doc-backlink">82</a></sup>, which you can
install from the <a href="#orgc96889a">GNU ELPA Package Repository</a>; see Figure
<a href="#org9ceb120">9</a>.
</p>

<div id="org9ceb120">
<p><a href="https:./images/vertico.png" alt="=M-x switch-to-buffer= via Vertico" title="=M-x switch-to-buffer= via Vertico" width="100%"><img src="https://blog.veitheller.de/images/vertico.png" alt="=M-x switch-to-buffer= via Vertico" title="=M-x switch-to-buffer= via Vertico" width="100%"/></a>
</p>
<p><span>Figure 9: </span><code>M-x switch-to-buffer</code> via Vertico</p>
</div>

<p>
You’ll need to add this to your <a href="#org2af3730">Init File</a> and restart your Emacs<sup><a id="fnr.83" href="#fn.83" role="doc-backlink">83</a></sup>:
</p>
<div>
<pre>(<span>setq</span> completion-styles &#39;(partial-completion substring flex))
(<span>unless</span> (package-installed-p &#39;vertico)
  (<span>with-demoted-errors</span> <span>&#34;%s&#34;</span>
    (<span>unless</span> package-archive-contents
      (package-refresh-contents))
    (package-install &#39;vertico)))
(<span>with-demoted-errors</span> <span>&#34;%s&#34;</span> (vertico-mode +1))
</pre>
</div>
<p>
An incremental narrowing framework (INF) generally lets you complete a string
(whether a <code>M-x</code> command name, file name, buffer name, or anything else) by typing
a pattern consisting of clusters of adjacent letters separated by punctuation.
So to complete the command   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer"><code>switch-to-buffer</code></a>﻿, you can type
<code>sw-to-bu</code> which rapidly narrows the matches down from 20,313
possible commands to a mere 7.
</p>

<p>
The entire line of one of the matches will be highlighted; this is the match
that will be used if you hit <code>RET</code>.  If <code>switch-to-buffer</code> is <i>not</i> highlighted
yet, you’ll need to either narrow it down further, by adding more letters, or,
when the number of matches is small enough, just navigate to it with <code>C-n</code> or the
down-arrow key.
</p>

<p>
If there are more than the default 10 matches, you can scroll through them until
you spot the one you want, or edit your pattern (with the usual Minibuffer
editing commands) to narrow it down further.  The usual Minibuffer history
commands work as well.  See Table <a href="#orga0a7477">4</a>.
</p>
<table id="orga0a7477">
<caption><span>Table 4:</span> The Main Vertico Commands</caption>

<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Type</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>C-n</code>, <code>↓</code></td>
<td>Move</td>
<td>Move down to highlight next match</td>
</tr>

<tr>
<td><code>C-p</code>, <code>↑</code></td>
<td> </td>
<td>Move up to highlight previous match</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>RET</code></td>
<td>Done</td>
<td>Select the highlighted match</td>
</tr>

<tr>
<td><code>C-RET</code></td>
<td> </td>
<td>Use the exact text that you typed</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C-v</code></td>
<td>Scroll</td>
<td>Scroll down to reveal the next 10 matches</td>
</tr>

<tr>
<td><code>M-v</code></td>
<td> </td>
<td>Scroll up to reveal the previous 10 matches</td>
</tr>

<tr>
<td><code>M-&gt;</code></td>
<td> </td>
<td>Scroll to the bottom of the matches</td>
</tr>

<tr>
<td><code>M-&lt;</code></td>
<td> </td>
<td>Scroll to the top of the matches</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>M-p</code></td>
<td>History</td>
<td>Pull up the previous history element</td>
</tr>

<tr>
<td><code>M-n</code></td>
<td> </td>
<td>Pull up the next history element</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org19f68d1">
<h4 id="org19f68d1">Done!</h4>
<p>
When your target is properly highlighted, you’re done.  Hit <code>RET</code> to select it.
If you’re completing a <code>M-x</code> command, the command will be executed.  However, if
you’re entering a filename for, say,   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-file</code></a>﻿ or a buffer
name for   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer"><code>switch-to-buffer</code></a>﻿, you may be intentionally typing
a nonexistent name, to create a new file or buffer, which therefore can’t
possibly have a match!  In this case, you use <code>C-RET</code> to select <i>not</i> the
highlighted match, but the exact text you’ve typed, as is.
</p>
</div>
<div id="outline-container-orgf93a41c">
<h4 id="orgf93a41c">Complementary Packages <a id="org5a7b83a"></a></h4>
<div id="text-orgf93a41c">
<p>
Vertico is designed to be enhanced and customized via a set of complementary
packages.  I also recommend installing <a href="https://github.com/minad/marginalia">Marginalia</a>, which provides <i>annotations</i> in
the Minibuffer adjacent to command names, file names, buffer names, and more.
</p>
<div>
<pre>(<span>unless</span> (package-installed-p &#39;marginalia)
  (<span>with-demoted-errors</span> <span>&#34;%s&#34;</span>
    (<span>unless</span> package-archive-contents
      (package-refresh-contents))
    (package-install &#39;marginalia)))
(<span>with-demoted-errors</span> <span>&#34;%s&#34;</span> (marginalia-mode +1))
</pre>
</div>
<p>
Now <code>M-x sw-to</code> looks like Figure <a href="#org6382bb7">10</a> and <code>C-x C-f</code> looks like Figure
<a href="#orgd002e47">11</a>:
</p>

<div id="org6382bb7">
<p><a href="https:./images/marginalia-m-x.png" alt="=M-x= with Marginalia" title="=M-x= with Marginalia" width="100%"><img src="https://blog.veitheller.de/images/marginalia-m-x.png" alt="=M-x= with Marginalia" title="=M-x= with Marginalia" width="100%"/></a>
</p>
<p><span>Figure 10: </span><code>M-x</code> with Marginalia</p>
</div>


<div id="orgd002e47">
<p><a href="https:./images/marginalia-cx-cf.png" alt="=C-x C-f= with Marginalia" title="=C-x C-f= with Marginalia" width="100%"><img src="https://blog.veitheller.de/images/marginalia-cx-cf.png" alt="=C-x C-f= with Marginalia" title="=C-x C-f= with Marginalia" width="100%"/></a>
</p>
<p><span>Figure 11: </span><code>C-x C-f</code> with Marginalia</p>
</div>
</div>
</div>

<div id="outline-container-orgcd8ef1f">
<h4 id="orgcd8ef1f">Other Incremental Narrowing Frameworks <a id="orgeb3f098"></a></h4>
<div id="text-orgcd8ef1f">
<p>
I think Vertico is one of the best INFs, but Emacs has a few other built-in INFs
to choose from, and more in the <a href="#orgc96889a">Package Manager</a>.  The built-in INFs are
Icomplete (  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Icomplete"><code>icomplete-mode</code></a>﻿), Ido (  <code>M-x</code> <code>ido-mode</code>)
(“Incremental Do”: see <a href="https://www.gnu.org/software/emacs/manual/html_node/ido/Top">the <i>Ido</i> manual</a>) and Fido
(  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Icomplete"><code>fido-mode</code></a>﻿).  Unlike most modern INFs, their interface is
horizontal.  When you hit <code>M-x</code>, you’ll see something like this:
</p>
<pre>M-x {execute-extended-command | enable-theme | dired-at-point | …}
</pre>

<p>
You navigate through the matches with the left- and right-arrow keys.
(I’m showing an abbreviated version; you’ll typically see half-a-dozen
candidates, possibly spread across at most two minibuffer lines.)
Note that you don’t need to hit <code>TAB</code> to see these candidates: that’s a
big part of what makes an INF more efficient.  These will narrow as you type.
</p>

<p>
They all work together, and if you want to use them, you should probably turn
all three of them on in your <a href="#org2af3730">Init File</a>:
</p>
<div>
<pre>(icomplete-mode 1)
(ido-mode 1)
(fido-mode 1)
</pre>
</div>
<p>
Most modern INFs have chosen, like Vertico, to go for a vertical presentation of
the candidates, using a multiple-line expanding Minibuffer; this gives more room
for long command and file names, and in some frameworks, useful extra
information like that provided by Marginalia.
</p>

<p>
The other vertical INF in the GNU package repository is <a href="https://github.com/abo-abo/swiper">Ivy</a>; it has more built-in
features, which are quite powerful, but due to its complexity, it may not
interact as well with some Emacs subsystems.  (Vertico aims for 100%
compatibility and comes very close by being simple.)
</p>
</div>
<div id="outline-container-org39f512b">
<h5 id="org39f512b">Third-Party INFs</h5>
<div id="text-org39f512b">
<p>
The king of Emacs INFs for some time had been <a href="https://emacs-helm.github.io/helm/">Helm</a>, which dramatically remakes
dozens, perhaps hundreds of Emacs commands (though you can configure it to be
more or less intrusive).  Its completion buffer can take up the bulk of your
screen and present scads of additional information.  It allows you to do a
variety of actions (like, deleting files) in mid-completion, and its fans are
very devoted.  I find it to be too bulky, too intrusive, and too complex and
confusing.  It’s also now apparently <a href="https://en.wikipedia.org/wiki/Abandonware">abandonware</a>.
</p>

<p>
For Emacs purists who want to do their editing with mental powers alone, there’s
<a href="https://www.emacswiki.org/emacs/Icicles">Icicles</a>.  It’s amazingly powerful and I used it for some time, but I ultimately
abandoned it because I had trouble getting it to work with <a href="#org2bfdd17">Tramp</a>; in addition,
the author chooses not to make it available via the Package Manager and so
it’s daunting to acquire<sup><a id="fnr.84" href="#fn.84" role="doc-backlink">84</a></sup>.
</p>

<p>
There are other options like Raven, Sallet, and Snails, but I have
recently settled on <a href="https://github.com/raxod502/selectrum">Selectrum</a>, one of the newest (but surely not the
last) Emacs INFs.  For me it combines simplicity and utility
perfectly, and instead of taking a kitchen-sink approach to features,
can use the same optional add-ons (like Marginalia) as Vertico.
</p>
</div>
</div>
</div>

<div id="outline-container-org203daa3">
<h4 id="org203daa3">Completion in Normal Buffers</h4>
<div id="text-org203daa3">
<p>
In this chapter, we’ve discussed completion in the <a href="#orga329460">Minibuffer</a>, but Emacs also
does completion in normal buffers.  It comes in two flavors:
explicitly-activated completion at Point, and implicitly-activated completion
via a popup menu.
</p>

<p>
For the former, when you’re half-finished typing a word, you hit
    <code>M-/</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Dynamic-Abbrevs"><code>dabbrev-expand</code></a>﻿), and Emacs completes the word for you.
This an amazing feature and an essential skill to pickup; see
<a href="#org7206b03"><i>Completion at Point</i></a>.
</p>

<p>
For the latter, you can arrange to have a (lightweight, non-GUI, plain-text)
menu pop up as you’re typing, showing you possible completions, any of which you
can select by quickly navigating to it with the arrow keys.  This popup
completion isn’t typically enabled for ordinary words in prose, but rather in
buffers whose <a href="#org5b21ef0">Major Mode</a> usefully limits the candidates.  In particular, in
programming language modes, where library functions and symbols in the buffer
are presented.  See <a href="#orgb851b48"><i>Pop-up Menu Completion</i></a>.
</p>
</div>
</div>

</div>

<div id="outline-container-org75f9f72">
<h3 id="org75f9f72">What is Text? <a id="org8dcb1a5"></a></h3>
<div id="text-org75f9f72">
<p>
I call Emacs the “Plain Text Computing Environment”, but what exactly is <i>text</i>?
</p>

<p>
The notion of text is fairly intuitive to Unix users, elderly computer users of
any stripe, and programmers, but may actually be puzzling to younger users who
have spent all their lives interacting with GUI desktop applications, or tablets
and smartphones only.
</p>

<p>
Classically, text consists of the <i>printing characters</i> from the <a href="https://en.wikipedia.org/wiki/ASCII">ASCII</a> character
set: that is, upper- and lowercase letters, digits, punctuation marks, and a few
whitespace characters.  These are the characters that make up the bulk of your
keyboard.  Here’s the complete ASCII character set: ignoring whitespace, the
printing characters are those from (decimal) 33 through 126:<sup><a id="fnr.85" href="#fn.85" role="doc-backlink">85</a></sup>
</p>
<pre id="org487c761">Dec Hex    Dec Hex    Dec Hex  Dec Hex  Dec Hex  Dec Hex   Dec Hex   Dec Hex
  0 00 NUL  16 10 DLE  32 20    48 30 0  64 40 @  80 50 P   96 60 `  112 70 p
  1 01 SOH  17 11 DC1  33 21 !  49 31 1  65 41 A  81 51 Q   97 61 a  113 71 q
  2 02 STX  18 12 DC2  34 22 &#34;  50 32 2  66 42 B  82 52 R   98 62 b  114 72 r
  3 03 ETX  19 13 DC3  35 23 #  51 33 3  67 43 C  83 53 S   99 63 c  115 73 s
  4 04 EOT  20 14 DC4  36 24 $  52 34 4  68 44 D  84 54 T  100 64 d  116 74 t
  5 05 ENQ  21 15 NAK  37 25 %  53 35 5  69 45 E  85 55 U  101 65 e  117 75 u
  6 06 ACK  22 16 SYN  38 26 &amp;  54 36 6  70 46 F  86 56 V  102 66 f  118 76 v
  7 07 BEL  23 17 ETB  39 27 &#39;  55 37 7  71 47 G  87 57 W  103 67 g  119 77 w
  8 08 BS   24 18 CAN  40 28 (  56 38 8  72 48 H  88 58 X  104 68 h  120 78 x
  9 09 HT   25 19 EM   41 29 )  57 39 9  73 49 I  89 59 Y  105 69 i  121 79 y
 10 0A LF   26 1A SUB  42 2A *  58 3A :  74 4A J  90 5A Z  106 6A j  122 7A z
 11 0B VT   27 1B ESC  43 2B +  59 3B ;  75 4B K  91 5B [  107 6B k  123 7B {
 12 0C FF   28 1C FS   44 2C ,  60 3C &lt;  76 4C L  92 5C \  108 6C l  124 7C |
 13 0D CR   29 1D GS   45 2D -  61 3D =  77 4D M  93 5D ]  109 6D m  125 7D }
 14 0E SO   30 1E RS   46 2E .  62 3E &gt;  78 4E N  94 5E ^  110 6E n  126 7E ~
 15 0F SI   31 1F US   47 2F /  63 3F ?  79 4F O  95 5F _  111 6F o  127 7F DEL
</pre>
<p>
You’ll notice right away that this 1963 American standard doesn’t really
accommodate non-English speakers, which is why there are so many other character
sets<sup><a id="fnr.86" href="#fn.86" role="doc-backlink">86</a></sup>.  Nowadays, <i>text</i> would be defined to include all the printing
characters, international and specialized, in the enormous standardized <a href="https://en.wikipedia.org/wiki/Unicode">Unicode
character set</a> (Emacs knows 64,414 of them by name) and the
267-odd other character sets Emacs supports.
</p>
</div>
<div id="outline-container-org688c9e8">
<h4 id="org688c9e8">The Structure of Text <a id="org020c947"></a></h4>
<div id="text-org688c9e8">
<p>
Lines are the fundamental unit of organization for most (but not all) text.
Text consists of a sequence of lines, and lines are separated by end-of-line
characters.<sup><a id="fnr.87" href="#fn.87" role="doc-backlink">87</a></sup> We usually loosely call the end-of-line character a <i>newline</i>
(but see <a href="#org5f6b09d"><i>International Character Set Support</i></a> for the gnarly details).  You can
enter a newline, and thus begin a new line, by hitting the key Emacs calls <code>RET</code>
or <code>&lt;return&gt;</code>, which on your keyboard might also be labeled <code>ENTER</code>.
</p>

<p>
The end of a line at the very end of a Buffer is somewhat ambiguous<sup><a id="fnr.88" href="#fn.88" role="doc-backlink">88</a></sup>.
Suppose we have a <a href="#orgc3260f6">Buffer</a> whose text consists of “foo”, a newline, and “bar”;
that’s 7 characters, but how many lines is it?  In your Buffer it looks like:
</p>

<p>
and to me, that’s unquestionably two lines.  Emacs agrees.
    <code>C-x l</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Pages"><code>count-lines-page</code></a>﻿) reports:
</p>
<pre>Page has 2 lines (0 + 2)
</pre>

<p>
and — further confirmation — if we invoke   <code>M-x</code> <code>linum-mode</code>, the
buffer looks like:
</p>

<p>
But there’s no newline after “bar”!  If we add one, the buffer <i>looks</i> the same,
and <code>C-x l</code> and <code>linum-mode</code> both still report two lines.  In other words, the
number of lines is not necessarily exactly the same as the number of newline
characters.
</p>

<p>
Unfortunately, this ambiguity is simply a fact of computing life.  The good news
is, 1. it doesn’t usually cause any problems, and 2. Emacs has extensive
facilities for dealing with it; see <a href="#org521f7e2"><i>Manipulating Plain Text</i></a> for details.
</p>

<p>
When Emacs was fresh and new in the 1970s, people entering prose text would
typically hit <code>RET</code> after typing 72 characters or so, and almost always before
80.<sup><a id="fnr.89" href="#fn.89" role="doc-backlink">89</a></sup> Paragraphs were typically separated by an empty or blank line (i.e.,
a line consisting solely of a newline, or possibly a sequence of whitespace
characters followed by a newline), or by a line with leading indentation (i.e., a
few spaces), or both: exactly how you’d type it on a typewriter.  Emacs’s <a href="#org521f7e2">Text
Mode</a> (see <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Text-Mode">“Text Mode”</a> in the <i>Emacs</i> manual) is designed for this kind of prose text
and has support for automatic wrapping, indenting, and filling of paragraphs.
</p>

<p>
But there’s no limit to the length of a text line, and in fact in the modern
world, the current convention is that each <i>line</i> of typed text is in fact an
entire paragraph, and paragraphs therefore no longer even need to be separated
by blank lines (though they may be).  This convention arose with GUI
applications, whose windows weren’t limited to 80 column lines and whose widths
could be resized at will: single-line paragraphs auto-fill as the screen is
resized, but multi-line paragraphs do not.  Emacs of course supports this
convention but it’s not the default, primarily because Emacs was written by and
for programmers, and both computer programs and computer data files are
typically expressed as lines with explicit newlines, and the lines may have
semantic significance.
</p>

<p>
For details on how long lines are displayed and what you can do to change it,
see <a href="#org818c35e"><i>The Display of Lines</i></a>.
</p>
</div>
</div>

<div id="outline-container-org5843dca">
<h4 id="org5843dca">What <i>Isn’t</i> Text? <a id="org7997c3f"></a></h4>
<div id="text-org5843dca">
<p>
There’s no law that says text can’t include non-printing characters, like, say,
a <code>C-a</code> (which is ASCII 1 decimal).  If a file contains only printing characters,
it clearly deserves the label “text”; if it contains <i>none</i>, it clearly doesn’t
and instead we call it <i>binary data</i>.  But in between, the label is a judgment
call.  Regardless, Emacs needs to show you non-printing characters when they
occur.
</p>

<p>
(I’m afraid this section has to be very nerdy; none of this will surprise a
programmer, but the explanation of it all involves the distant history of
computing, computing Standards (gulp), and a variety of number bases.  Feel free
to skip ahead!)
</p>

<p>
When one of the ASCII <i>control characters</i>—those in the range decimal
0–31<sup><a id="fnr.90" href="#fn.90" role="doc-backlink">90</a></sup>—occurs in a Buffer, Emacs displays it specially, using the traditional
programmer’s notation for control characters: a circumflex followed by an
uppercase letter (or punctuation mark in six cases), for example <code>^A</code>, which is
the same character that Emacs refers to as <code>C-a</code>.  Table <a href="#org70cfb13">5</a> shows these
in the “Control” column.
</p>
<table id="org70cfb13">
<caption><span>Table 5:</span> ASCII Control Characters, Excepting Delete</caption>

<colgroup>
<col/>

<col/>

<col/>

<col/>

<col/>

<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Dec</th>
<th scope="col">Hex</th>
<th scope="col">ASCII</th>
<th scope="col">Control</th>
<th scope="col">Dec</th>
<th scope="col">Hex</th>
<th scope="col">ASCII</th>
<th scope="col">Control</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>00</td>
<td>NUL</td>
<td><code>^@</code></td>
<td>16</td>
<td>10</td>
<td>DLE</td>
<td><code>^P</code></td>
</tr>

<tr>
<td>1</td>
<td>01</td>
<td>SOH</td>
<td><code>^A</code></td>
<td>17</td>
<td>11</td>
<td>DC1</td>
<td><code>^Q</code></td>
</tr>

<tr>
<td>2</td>
<td>02</td>
<td>STX</td>
<td><code>^B</code></td>
<td>18</td>
<td>12</td>
<td>DC2</td>
<td><code>^R</code></td>
</tr>

<tr>
<td>3</td>
<td>03</td>
<td>ETX</td>
<td><code>^C</code></td>
<td>19</td>
<td>13</td>
<td>DC3</td>
<td><code>^S</code></td>
</tr>

<tr>
<td>4</td>
<td>04</td>
<td>EOT</td>
<td><code>^D</code></td>
<td>20</td>
<td>14</td>
<td>DC4</td>
<td><code>^T</code></td>
</tr>

<tr>
<td>5</td>
<td>05</td>
<td>ENQ</td>
<td><code>^E</code></td>
<td>21</td>
<td>15</td>
<td>NAK</td>
<td><code>^U</code></td>
</tr>

<tr>
<td>6</td>
<td>06</td>
<td>ACK</td>
<td><code>^F</code></td>
<td>22</td>
<td>16</td>
<td>SYN</td>
<td><code>^V</code></td>
</tr>

<tr>
<td>7</td>
<td>07</td>
<td>BEL</td>
<td><code>^G</code></td>
<td>23</td>
<td>17</td>
<td>ETB</td>
<td><code>^W</code></td>
</tr>

<tr>
<td>8</td>
<td>08</td>
<td>BS</td>
<td><code>^H</code></td>
<td>24</td>
<td>18</td>
<td>CAN</td>
<td><code>^X</code></td>
</tr>

<tr>
<td>9</td>
<td>09</td>
<td>HT</td>
<td><code>^I</code></td>
<td>25</td>
<td>19</td>
<td>EM</td>
<td><code>^Y</code></td>
</tr>

<tr>
<td>10</td>
<td>0A</td>
<td>LF</td>
<td><code>^J</code></td>
<td>26</td>
<td>1A</td>
<td>SUB</td>
<td><code>^Z</code></td>
</tr>

<tr>
<td>11</td>
<td>0B</td>
<td>VT</td>
<td><code>^K</code></td>
<td>27</td>
<td>1B</td>
<td>ESC</td>
<td><code>^[</code></td>
</tr>

<tr>
<td>12</td>
<td>0C</td>
<td>FF</td>
<td><code>^L</code></td>
<td>28</td>
<td>1C</td>
<td>FS</td>
<td><code>^\</code></td>
</tr>

<tr>
<td>13</td>
<td>0D</td>
<td>CR</td>
<td><code>^M</code></td>
<td>29</td>
<td>1D</td>
<td>GS</td>
<td><code>^]</code></td>
</tr>

<tr>
<td>14</td>
<td>0E</td>
<td>SO</td>
<td><code>^N</code></td>
<td>30</td>
<td>1E</td>
<td>RS</td>
<td><code>^^</code></td>
</tr>

<tr>
<td>15</td>
<td>0F</td>
<td>SI</td>
<td><code>^O</code></td>
<td>31</td>
<td>1F</td>
<td>US</td>
<td><code>^_</code></td>
</tr>
</tbody>
</table>
<p>
Thus, in your Buffer, a single control character displays as a pair of
characters.  This is ambiguous: is that <code>^A</code> one character, ASCII decimal 1 aka
<code>SOH</code>, or is it the two <i>printing</i> characters, <code>^</code> followed by <code>A</code>?  There are two ways
tell:
</p>
<ol>
<li>by movement: your cursor will skip over a control character with a single
    <code>C-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>forward-char</code></a>﻿), where it would take two <code>C-f</code>’s to move
over the pair of printing characters;</li>
<li>by color: the control characters are colored differently than the printing
characters; if your Buffer text is black-on-white, the control characters
will be <i>red</i> e.g.
<code><span>^A</span></code>;
if your Buffer text is white-on-black<sup><a id="fnr.91" href="#fn.91" role="doc-backlink">91</a></sup>, the control
characters will be <i>cyan</i> e.g.
<code><span>^A</span></code>.</li>
</ol>

<p>
There are other characters, which are tricky to classify as printing or
non-printing, that aren’t part of the original ASCII character set: they would
occupy the slots from 128–255 decimal in an expanded table.  If these
characters appear in a Buffer (one using the <code>binary</code> <a href="#org2733d30">Coding System</a>), they are
represented as a backslash followed by a three-digit number e.g. <code>\304</code>.<sup><a id="fnr.92" href="#fn.92" role="doc-backlink">92</a></sup>
Again, your cursor will move over such a character in one step, and they’re
colored the same as the control characters.
</p>
</div>
</div>
<div id="outline-container-org69d53e6">
<h4 id="org69d53e6">Inserting Non-Printing Characters <a id="org244f9ee"></a></h4>
<div id="text-org69d53e6">
<p>
If you’re curious and want to see some of these non-printing characters in a
Buffer, you can just visit a native-code executable file on your
computer.<sup><a id="fnr.93" href="#fn.93" role="doc-backlink">93</a></sup>  But what if you need to insert one?  Obviously you can’t
insert a <code>^A</code> by typing <code>C-a</code>—that will just move your cursor to the beginning of
the line!
</p>

<p>
The basic command for this is     <code>C-q</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Inserting-Text"><code>quoted-insert</code></a>﻿).  Inserting
a control character is easy: to insert a <code>^A</code>, just type <code>C-q C-a</code>.  You can
also needlessly quote printing characters—say, <code>C-q A</code>—which just inserts the
printing character normally.
</p>

<p>
What if you want to insert “international”, non-Latin, characters from Unicode,
or you want to type fancy glyphs like Æ, or ¶?  See <a href="#orgcdb47e9"><i>International Character Set
Support</i></a> for details.
</p>
</div>
</div>
</div>
<div id="outline-container-orgeedc5fe">
<h3 id="orgeedc5fe">Buffers <a id="orgc3260f6"></a></h3>
<div id="text-orgeedc5fe">
<blockquote>
<p>
Just as in Unix “everything is a file”, in Emacs “everything is a buffer”.
[…] In most […] editors (and most other applications, for that matter), we
have things such as dialog windows, non-editable text areas […],
file-selecting widgets, etc.  Not in Emacs: here, all these are buffers.
— Marcin Borkowski, <a href="https://www.tug.org/TUGboat/tb39-1/tb121borkowski-emacs.pdf">“TEXing in Emacs”</a>
</p>
</blockquote>

<p>
A buffer is a very complex data structure.  Most importantly a buffer contains
text, but additionally each buffer keeps track of various locations (where you
are now and where you’ve been recently) and parameters (like how much to indent
lines), maintains an undo history, has a <a href="#org5b21ef0">Major Mode</a> that customizes commands run
in the buffer to work distinctively on the type of text it contains, may have
several <a href="#org5b21ef0">Minor Modes</a> to further tweak behavior to your taste, and has a set of
key bindings that may be different from those in other buffers.  If it’s
visiting a file, the buffer keeps track of its state compared to the file on
disk.<sup><a id="fnr.94" href="#fn.94" role="doc-backlink">94</a></sup>
</p>

<p>
In this chapter we’re mostly going to talk about buffers as unitary objects, as
distinct from what they contain.  The text in the buffer is much more than just
a sequence of alphanumeric characters; how it is entered and displayed is the
subject of <a href="#org146e18d">its own chapter</a>.
</p>

<p>
The maximum buffer size is plenty big enough for most purposes:
2,305,843,009,213,693,951 bytes; that’s about
2.3 exabytes.  Practically
speaking, the maximum buffer size is limited by the amount of memory available
on your system for Emacs to use.
</p>
</div>
<div id="outline-container-org4d6d199">
<h4 id="org4d6d199">Switching Buffers <a id="orgfef4c7a"></a></h4>
<div id="text-org4d6d199">
<p>
To <i>switch buffers</i> means, specifically, to change which buffer is displayed in a
given <a href="#org9409b46">Window</a>.  The basic command to do this is
    <code>C-x b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer"><code>switch-to-buffer</code></a>﻿); it displays a different buffer in
the current window, prompting for the new buffer by name, using <a href="#org75fb6a2">Completion</a>.  You
can also use one of these variant versions:
</p>
<dl>
<dt>    <code>C-x 4 b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer"><code>switch-to-buffer-other-window</code></a>﻿)</dt><dd>Switch to a
different buffer not in <i>this</i> window, but in the “other” window.<sup><a id="fnr.95" href="#fn.95" role="doc-backlink">95</a></sup></dd>
<dt>    <code>C-x 5 b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer"><code>switch-to-buffer-other-frame</code></a>﻿)</dt><dd>Switch to a
different buffer not in <i>this</i> <a href="#org4dd50c2">frame</a>, but in another frame; if the buffer is
already displayed in a window in another frame, switch to that frame and
window; if not, a brand new frame is created and the buffer is displayed in the
window in that frame.</dd>
</dl>

<p>
You can also switch quickly to buffers you’ve recently used without specifying
their names.  Emacs maintains its list of buffers in a ring in recency order.
</p>
<dl>
<dt>    <code>C-x &lt;C-left&gt;</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer"><code>previous-buffer</code></a>﻿)</dt><dd>switch to the previous
buffer you were in (in this frame); repeating this command goes further back
in the buffer-recency timeline</dd>
<dt>    <code>C-x &lt;C-right&gt;</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer"><code>next-buffer</code></a>﻿)</dt><dd>the same, but go forward in
timeline order.</dd>
</dl>

<p>
(You can also use the less <a href="#org38efd5c">felicitous</a> bindings <code>C-x &lt;left&gt;</code> and <code>C-x &lt;right&gt;</code>.)
</p>

<p>
The <a href="#orge6fb506">User Option</a>   <code>switch-to-prev-buffer-skip</code> allows you to
customize which buffers these two commands consider to be candidates.
</p>

<p>
The <a href="#org40be37b">Global Mark Ring</a> provides another way of switching buffers:
    <code>C-x C-SPC</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Global-Mark-Ring"><code>pop-global-mark</code></a>﻿) will jump to previous <a href="#org40fd5a7">Mark</a>
locations in other buffers.
</p>
</div>
</div>
<div id="outline-container-orge971051">
<h4 id="orge971051">The Tab Line <a id="org117b049"></a></h4>
<div id="text-orge971051">
<p>
Outside of Emacs, <a href="https://en.wikipedia.org/wiki/Tab_(interface)"><i>Tabs</i></a> (not to be confused with the ASCII TAB character nor with
tab stops) are a pervasive graphical user interface design element for
navigating between multiple “objects” in an application: whether web pages, word
processor documents, desktop windows, or whatever.  The objects being the subject
matter of the application, they would correspond to <a href="#orgc3260f6">Buffers</a> in Emacs.  Yet Emacs
hasn’t had Tabs until quite recently<sup><a id="fnr.96" href="#fn.96" role="doc-backlink">96</a></sup>: <a href="#org75fb6a2">Completion</a> and the <a href="#org534efa3">Buffer Menus</a>
have sufficed for Emacs users for decades.
</p>

<p>
But now you can turn on the <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Tab-Line"><i>Tab Line</i></a>.  The Tab
Line is a per-Window construct: a special sticky line of tabs at the top of your
Window, each tab shows the name of a buffer that has been displayed in this
particular Window.<sup><a id="fnr.97" href="#fn.97" role="doc-backlink">97</a></sup>  There’s also a <code>+</code>-sign at the right that, when clicked, pops
up a classified GUI menu that allows you to switch to any other buffer, thus
adding another tab to the bar.
</p>

<p>
This is obviously a feature for mouse users, but if you’re a keyboard-only
person like me, I suppose you might still want the Tab Line for its visuals.
Note that the buffers shown in the Tab Line are the same ones you can navigate
through with     <code>C-x &lt;C-left&gt;</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer"><code>previous-buffer</code></a>﻿) and
    <code>C-x &lt;C-right&gt;</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer"><code>next-buffer</code></a>﻿).
</p>

<p>
You can turn the Tab Line on for any Window with   <code>M-x</code> <code>tab-line-mode</code>.
If you want this for all your Windows, say   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Tab-Line"><code>global-tab-line-mode</code></a>﻿;
you can make this your default by adding this to your <a href="#org2af3730">Init File:</a>
</p>
<pre>(global-tab-line-mode 1)
</pre>


<p>
The <a href="#orgc96889a">Package Manager</a> is full of third-party packages for selecting buffers;
pretty much any approach any other program or operating system has used for
something similar can be found as an Emacs package: from a very visual <a href="https://github.com/clemera/buffer-expose">Mac Os
Exposé-like switcher</a>, to my favorite, the very abstract <code>buffer-stack</code>.
</p>
</div>
</div>
<div id="outline-container-org52f9d54">
<h4 id="org52f9d54">Creating Buffers</h4>
<div id="text-org52f9d54">
<p>
Buffers are typically created for you, implicitly, by any number of commands:
the <a href="#org41c8a78">file visiting</a> commands, of course, but also by many of the thousands of
other commands: the <a href="#orge57a011">Help commands</a> create <code>*Help*</code> buffers, for example, and any of
the Emacs “applications” like the <a href="#orgcc42ce0">File Manager (Dired)</a> or the <a href="#orgc4ddf2e">Web Browser (Eww)</a>
create buffers to present their user interfaces.  Buffers are used for almost
everything in Emacs, and you won’t even be aware of most of them; I have 175 in
my Emacs as I write this.
</p>

<p>
You can also just create a new buffer anytime you want.  The command for this is
good old     <code>C-x b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer"><code>switch-to-buffer</code></a>﻿); typically, this command is
used to display a different, existing, buffer in the current window, as
described in the <a href="#orgfef4c7a">previous section</a>.  But when
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer"><code>switch-to-buffer</code></a>﻿ prompts you for the buffer name, if you
enter a new, non-existent, one, it instead creates a brand new, empty, buffer.
This buffer will be in   <code>fundamental-mode</code> unless your chosen
name looks like a filename with an extension (say, <code>foo.org</code>), in which case the
Major Mode will be determined as described in <a href="#org637bdd6"><i>How a Mode Happens to Your
File</i></a>.  Regardless, there will be no file associated with this new buffer.
</p>
</div>
</div>
<div id="outline-container-org937d530">
<h4 id="org937d530">To Save or Not to Save</h4>
<div id="text-org937d530">
<p>
When you exit, Emacs will offer to <a href="#orgf98c057">save</a> modified buffers that are visiting
files, so that you don’t lose your work.  But non-file buffers don’t get this
treatment, no matter how much work you may have done in them!<sup><a id="fnr.98" href="#fn.98" role="doc-backlink">98</a></sup>  You can always
use     <code>C-x C-w</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Save-Commands"><code>write-file</code></a>﻿) to associate a file with such a
buffer after the fact.
</p>

<p>
It may be tempting to create new non-file buffers or use the <code>*scratch*</code> buffer
just to take some transient notes, but such notes have a way of surreptitiously
becoming <i>important</i>, and you will lose them if you exit without saving them
somewhere.  Emacs has <a href="#org7cc7ea9">better ways</a> for you to take notes.
</p>
</div>
</div>
<div id="outline-container-org2993d89">
<h4 id="org2993d89"><a id="orgf6e5f11"></a> <a id="org147636d"></a> Buffer Names</h4>
<div id="text-org2993d89">
<p>
This inspires me to mention the fact that <i>every buffer has a name</i>.  There are no
anonymous buffers.  Not only must every buffer have a name, but that name must
also be <i>unique</i>.  When there are natural name conflicts, Emacs will usually
disambiguate the newer buffer name for you.  Buffers that aren’t visiting a file
typically get numeric suffixes, like <code>*shell*&lt;2&gt;</code> and <code>*shell*&lt;3&gt;</code>, but for files
things are more interesting.
</p>

<p>
The name of a Buffer that’s visiting a file is typically the basename of that
file; for example, if you visit <code>/etc/passwd</code>, the Buffer will be named <code>passwd</code>.
Since there could be any number of files named <code>passwd</code> in various directories, in
order for you to be able to visit more than one of them, Emacs must <i>uniquify</i> the
buffer name.  You can choose from a variety of uniquification algorithms.  Using
the default algorithm, if you visit <code>/tmp/passwd</code>, having already visited
<code>/etc/passwd</code>, the new Buffer will be named <code>passwd&lt;/tmp&gt;</code>.  See
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Uniquify">“Uniquify”</a> in the <i>Emacs</i> manual for details.
</p>

<p>
You can rename buffers at will with   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Misc-Buffer"><code>rename-buffer</code></a>﻿.  Since some
applications manage their buffers by name, renaming them might break the app!
But many, probably most, buffers are perfectly safe to rename.  While uncommon,
you can rename any file-visiting buffer; the buffer name won’t affect the
filename.  It’s quite common to rename the buffers of commands that re-use the
same name.  Although   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Help-Mode"><code>help-mode</code></a>﻿ has commands to navigate
back and forth through your history of Help invocations, you might want to
rename a given <code>*Help*</code> buffer to keep it around and easily accessible.
</p>

<p>
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Interactive-Shell"><code>shell</code></a>﻿ is the opposite: when you run it, if that buffer already
exists, it simply switches to it (kind of like
    <code>C-x C-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-file</code></a>﻿); if you want a second shell, you can
first rename the existing Shell buffer to whatever you like.<sup><a id="fnr.99" href="#fn.99" role="doc-backlink">99</a></sup>
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Misc-Buffer"><code>rename-uniquely</code></a>﻿ will automatically rename any buffer for you,
using a numeric suffix.
</p>
</div>

<div id="outline-container-orgfa4060a">
<h5 id="orgfa4060a">Asterisks</h5>
<p>
It’s conventional that non-file-visiting Buffers created by Emacs commands are
named with <code>*asterisks*</code>; for example, the <a href="#orge57a011">Help</a> commands use (and reuse) the
Buffer name <code>*Help*</code>, and Emacs starts up with a <code>*scratch*</code> Buffer.  When
explicitly creating your own Buffers, you can observe this convention or not, as
you like.
</p>
</div>

<div id="outline-container-org878f400">
<h5 id="org878f400">Hidden Buffers <a id="orgb8574ab"></a></h5>
<div id="text-org878f400">
<p>
Unix users are familiar with the utility of
<a href="https://en.wikipedia.org/wiki/Hidden_file_and_hidden_directory"><i>dot files</i></a>: any file basename that begins with a period is by default excluded
from the directory listing of the <code>ls(1)</code> command.  This reduces clutter in a
directory listing from files that are always present (like <code>.</code> and <code>..</code> in any
directory, or configuration files like <code>.bashrc</code> in a home directory).  Of course,
you can see these “hidden” files when you need to (by passing the <code>-a</code> option to
<code>ls</code>, for example).
</p>

<p>
The same concept applies to buffer names.  Many Emacs applications that present
themselves via a buffer, such as the document viewer <a href="#org8dc49db">Doc View</a> or the web browser
<a href="#orgc4ddf2e">Eww</a>, use hidden buffers to manage their state.  A hidden buffer is any buffer whose
name begins with a space character, and by default, they are not offered for
completion nor listed by the <a href="#org534efa3">buffer listing</a> commands.  Hidden buffers are mainly
created by Elisp programmers and you probably don’t want to use buffer names
that begin with a space for your own purposes.   They’re not really suitable for
interactive use; in particular, <a href="#org3f93c8e">Undo</a> is turned off by default in such buffers.
</p>
</div>
</div>
</div>
<div id="outline-container-org212f59a">
<h4 id="org212f59a">The Default Directory</h4>
<div id="text-org212f59a">
<p>
In addition to a name, every buffer has a <i>default directory</i>.  This is analogous
to the working directory of a process in Unix.  The default directory of a
file-visiting buffer is the directory where the file was located.  If you’re in
a shell in a terminal, and you give a filename to some command via a <a href="https://en.wikipedia.org/wiki/Path_(computing)#Absolute_and_relative_paths"><i>relative
path</i></a>, that filename is interpreted relative to the shell’s current working
directory: Emacs works the same way.  If a command prompts you for a filename,
the prompt will be preset to contain the buffer’s default directory; you can
delete or edit it to name a file in some other directory, of course, but if you
completely delete any directory and just enter a relative path, it will be taken
as relative to the default directory.
</p>

<p>
If you create a non-file buffer, its default directory will generally be
inherited from the buffer you were in when you created it.  But any Emacs
command that creates a buffer is free to set its default directory to whatever
is appropriate.
</p>

<p>
The default directory is just a <a href="#org871902b">buffer-local variable</a> named
  <code>default-directory</code>.  You can check what it is with
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/File-Names"><code>pwd</code></a>﻿, which prints the value of this variable in the <a href="#org7e7133f">Echo
Area</a>,<sup><a id="fnr.100" href="#fn.100" role="doc-backlink">100</a></sup> and you can change a buffer’s default directory with
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/File-Names"><code>cd</code></a>﻿, which sets the variable to whatever directory you specify.
Note that changing the default directory of a file-visiting buffer does <i>not</i>
change the directory of the file you’re editing—not even if you re-save the
buffer.  It only affects prompt defaults and the resolution of relative
pathnames you give to commands while you’re in that buffer.  To change the
directory of a file you’re editing, use <a href="#orgf98c057"><code>C-x C-w</code></a> (this is equivalent to making
a new copy of the file).
</p>
</div>
</div>
<div id="outline-container-org8f19b47">
<h4 id="org8f19b47">Reverting Buffers</h4>
<div id="text-org8f19b47">
<p>
File-visiting buffers can be <i>reverted</i> with   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Reverting"><code>revert-buffer</code></a>﻿ to make
the text in the buffer match the text in its file.  There are two major reasons
for doing this: either to throw away all the unsaved modifications you’ve made
without undergoing a tedious sequence of <a href="#org3f93c8e">Undos</a> (and restore the buffer’s text to
what’s in the file), or because the file has been changed behind Emacs’s back
by some other process and you want the buffer to reflect this.  See <a href="#org652e622"><i>Files: Reverting
Buffers</i></a>, <a href="#org2a1e428"><i>Auto-Reverting (Watching Files)</i></a>, and <a href="#org1ec781b"><i>Files Modified Behind Emacs’s
Back</i></a> for more information.
</p>

<p>
Many non-file buffers implementing Emacs applications can also be reverted; the
exact meaning of “revert” in these buffers depends on the application.  For
example,     <code>C-x C-b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/List-Buffers"><code>list-buffers</code></a>﻿) pops up a buffer containing a
list of all your buffers (see <a href="#org534efa3"><i>Buffer Menus</i></a>), but if a new buffer is created
later, the list won’t (for good reasons, IMHO<sup><a id="fnr.101" href="#fn.101" role="doc-backlink">101</a></sup>) be automatically updated to
show it; reverting the buffer list will do so.  In <a href="#org5b21ef0">Major Modes</a> descended from
<a href="#orgfa25f51">Special Mode</a>, the key <code>g</code> is often bound to   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Reverting"><code>revert-buffer</code></a>﻿,
but check with     <code>C-h m</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Misc-Help"><code>describe-mode</code></a>﻿) first.
</p>
</div>
</div>
<div id="outline-container-orge6d7f6d">
<h4 id="orge6d7f6d"><a id="org634b3b6"></a> Killing Buffers</h4>
<div id="text-orge6d7f6d">
<p>
There are many ways to delete or, as we say in Emacs, <i>kill</i> buffers, but why
would you want to?  There are two main reasons:
</p>
<ul>
<li>Each buffer takes up in memory at least as much space as the file takes up on
disk; when you kill a buffer, you free up that space and Emacs has that much
more to work with.<sup><a id="fnr.102" href="#fn.102" role="doc-backlink">102</a></sup></li>
<li>Lots of old buffers means clutter; more buffers to ignore in <a href="#org534efa3">buffer listings</a>,
more to ignore when doing <a href="#org75fb6a2">buffer-name completion</a>, more buffers to search
through if you ask Emacs to <a href="#org3d7dcc0">do so</a>.  If you run Emacs as a long-running process
in <a href="#org22671bb">Server Mode</a> (as I recommend), you might accumulate many buffers over the
space of weeks or even months!<sup><a id="fnr.103" href="#fn.103" role="doc-backlink">103</a></sup></li>
</ul>

<p>
We’ve <a href="#orgcf558ce">already seen</a> the basic command for killing a single buffer, by name and
with completion:     <code>C-x k</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Kill-Buffer"><code>kill-buffer</code></a>﻿);
    <code>C-x 4 0</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Change-Window"><code>kill-buffer-and-window</code></a>﻿) kills the <i>current</i> buffer and
also deletes the window that was displaying it; it’s especially useful when
popping up hits from a <a href="#orgfdf7146">Grep</a> command.  There are also several commands
to clean up unneeded buffers:
</p>
<dl>
<dt>  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Kill-Buffer"><code>kill-some-buffers</code></a>﻿</dt><dd>asks whether or not to kill each buffer
in your Emacs; it makes it clear whether or not the buffer is modified.  This
command is way too tedious unless you have hardly any buffers, and if you have
a lot, a sort of <a href="https://en.wikipedia.org/wiki/Highway_hypnosis"><i>highway hypnosis</i></a> can set in that might result in you killing
a buffer you didn’t want to.</dd>
<dt>  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Kill-Buffer"><code>kill-matching-buffers</code></a>﻿</dt><dd>This command prompts for a <a href="#org19c6ad0">Regular
Expression</a> and only asks about the buffers whose names match it, so this might
be a little bit better.  I still wouldn’t use this one!</dd>
<dt>  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Kill-Buffer"><code>clean-buffer-list</code></a>﻿</dt><dd>is a totally automatic way to clean up a
lot of buffers, with no prompting and no questions asked.  It will of course
never kill a modified buffer, but it will instantly get rid of buffers that
you haven’t looked at in a while (by default,
3
days).  It’s highly customizable, so you can define certain buffers that it
should never clean up; examine <code>M-x customize-group RET midnight RET</code>.  See also
<a href="#org4584d48"><i>Midnight Mode</i></a>.</dd>
</dl>

<p>
I think the best thoughtful (i.e. not totally automatic) way of cleaning up
buffers is via one of the <a href="#org534efa3">Buffer Menu</a> commands below, which give you a
<a href="#orgcc42ce0">Dired</a>-like interface to the task.
</p>
</div>
</div>
<div id="outline-container-orgabea527">
<h4 id="orgabea527"><a id="org534efa3"></a> Buffer Menus</h4>
<div id="text-orgabea527">
<p>
    <code>C-x &lt;C-left&gt;</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer"><code>previous-buffer</code></a>﻿) and
    <code>C-x &lt;C-right&gt;</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer"><code>next-buffer</code></a>﻿), along with
    <code>C-x b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer"><code>switch-to-buffer</code></a>﻿) (coupled with a good <a href="#org75fb6a2">Completion</a>
framework) will form the vanguard of your buffer navigation.  But sometimes
you’ll need a way to get an overview of all your buffers, and some tools to
manage them.  This is what the <i>Buffer Menus</i> provide.  A Buffer Menu is to
buffers what <a href="#orgcc42ce0">Dired</a> is to files.
</p>

<p>
There are three main choices:
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/List-Buffers"><code>list-buffers</code></a>﻿,   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Buffer-Menus"><code>bs-show</code></a>﻿, and
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Buffer-Menus"><code>ibuffer</code></a>﻿.
</p>

<p>
The most basic command is     <code>C-x C-b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/List-Buffers"><code>list-buffers</code></a>﻿); it pops up
a <code>*Buffer List*</code> buffer that lists all the buffers in your emacs, giving, along
with their names, their sizes, Major Modes, and visited file name (if any):
</p>

<pre id="orgeb41093">CRM Buffer         Size  Mode              File
.%  passwd          1699 Conf[Colon]      /etc/passwd
 %  *Calendar*       531 Calendar
 %  *Help*           554 Help
    *scratch*        145 Lisp Interaction
 %* *Messages*       305 Messages
</pre>
<p>
The cryptic <code>CRM</code> Column shows the current buffer (indicated by a period in the <code>C</code>
column), a <code>%</code> under <code>R</code> if the buffer is read-only, and a <code>*</code> under <code>M</code> if the buffer
is modified.
</p>

<p>
This buffer is in   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>buffer-menu-mode</code></a>﻿, and if you switch into
it, a number of buffer-management commands are available.  Just move to anywhere
within a buffer’s line and the special commands will operate on that buffer.
Some operate immediately, but some only mark the buffers and perform the
operation when indicated.  See table <a href="#org214164e">6</a>.
</p>
<table id="org214164e">
<caption><span>Table 6:</span> <code>buffer-menu-mode</code> Commands</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>RET</code></td>
<td>replace Buffer Menu with this buffer</td>
</tr>

<tr>
<td><code>1</code></td>
<td>like <code>RET C-x 1</code></td>
</tr>

<tr>
<td><code>o</code></td>
<td>select buffer in Other window</td>
</tr>

<tr>
<td><code>V</code></td>
<td>… in <code>view-mode</code>.</td>
</tr>

<tr>
<td><code>C-o</code></td>
<td>display buffer in Other window (without switching)</td>
</tr>

<tr>
<td><code>m</code></td>
<td>mark this buffer for <code>v</code> or <code>M-s a …</code></td>
</tr>

<tr>
<td><code>v</code></td>
<td>display this and all marked buffers</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>u</code></td>
<td>remove all marks from this line</td>
</tr>

<tr>
<td><code>DEL</code></td>
<td>back up a line and remove marks</td>
</tr>

<tr>
<td><code>U</code></td>
<td>remove all marks in the Buffer Menu</td>
</tr>

<tr>
<td><code>M-DEL</code></td>
<td>remove a particular mark from all lines</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>T</code></td>
<td>Toggle display of only file buffers</td>
</tr>

<tr>
<td><code>S</code></td>
<td>Sort lines by the column that contains Point</td>
</tr>

<tr>
<td><code>{</code></td>
<td>narrow this column</td>
</tr>

<tr>
<td><code>}</code></td>
<td>widen this column</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>b</code></td>
<td>Bury the buffer listed on this line</td>
</tr>

<tr>
<td><code>t</code></td>
<td>visit Tags table of this buffer</td>
</tr>

<tr>
<td><code>~</code></td>
<td>clear modified-flag</td>
</tr>

<tr>
<td><code>%</code></td>
<td>make buffer read-only</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>s</code></td>
<td>mark for Save upon <code>x</code></td>
</tr>

<tr>
<td><code>C-k</code></td>
<td>mark for Kill upon <code>x</code>, move down</td>
</tr>

<tr>
<td><code>C-d</code></td>
<td>mark for kill upon <code>x,</code> move up</td>
</tr>

<tr>
<td><code>x</code></td>
<td>eXecute kill or save marks</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>M-s a C-s</code></td>
<td>Incremental Search in the marked buffers</td>
</tr>

<tr>
<td><code>M-s a C-M-s</code></td>
<td>Isearch for regexp in the marked buffers</td>
</tr>

<tr>
<td><code>M-s a C-o</code></td>
<td>Occur in the marked buffers</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>g</code></td>
<td>revert (update) the Buffer Menu</td>
</tr>

<tr>
<td><code>q</code></td>
<td>hide the Buffer Menu</td>
</tr>
</tbody>
</table>

<p>
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Buffer-Menus"><code>bs-show</code></a>﻿ is very similar to
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/List-Buffers"><code>list-buffers</code></a>﻿; it has a very similar command set<sup><a id="fnr.104" href="#fn.104" role="doc-backlink">104</a></sup>,
but is more customizable and, in its default configuration, is a bit more
colorful.  I’d recommend it over <code>list-buffers</code> just for that reason; you can bind
it to <code>C-x C-b</code> with:
</p>
<div>
<pre>(global-set-key (kbd <span>&#34;C-x C-b&#34;</span>) &#39;bs-show)
</pre>
</div>

<p>
The Buffer Menu that I use is   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Buffer-Menus"><code>ibuffer</code></a>﻿.  It’s even more
colorful than <code>bs-show</code>, but it has the largest command set and is more like <a href="#orgcc42ce0">Dired</a>
than the other two.<sup><a id="fnr.105" href="#fn.105" role="doc-backlink">105</a></sup> It has a more extensive set of marking commands, a
much larger, stackable, set of commands to filter the Buffer Menu (e.g., by
Major Mode, by visited directory name, by size), and a much larger set of
sorting commands.  It has so many commands that I won’t attempt to summarize
them here; say <code>C-h f ibuffer-mode</code>.
</p>

<p>
I recommend it, and I bind it to <code>C-x C-b</code> with:
</p>
<div>
<pre>(global-set-key (kbd <span>&#34;C-x C-b&#34;</span>) &#39;ibuffer)
</pre>
</div>

<p>
Note that neither <code>list-buffers</code> nor <code>bs-show</code> will list hidden buffers (those
starting with a space).  <code>ibuffer</code> can do this, however.
</p>
</div>
</div>
<div id="outline-container-orge399863">
<h4 id="orge399863">Narrowing <a id="org39c0e40"></a></h4>
<div id="text-orge399863">
<p>
Many commands that perform repetitive operations (like <a href="#orgb683e7c">Query Replace</a>) will limit
their operation to the active region.  Some (like <a href="#orgd2c3858">Keyboard Macros</a>) do not, but
these recalcitrant commands can be convinced to do so by <i>narrowing</i> the buffer to
the <a href="#org34ab2da">Region</a> (whether active or not).
    <code>C-x n n</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Narrowing"><code>narrow-to-region</code></a>﻿) hides the parts of the buffer
outside the region, making them almost completely inaccessible.  After
narrowing, you can run any command on the entire buffer without worrying that it
will affect the hidden parts.  Narrowing can also be useful just to focus your
attention on a part of your text, say a particular paragraph, or a gnarly
function, with no distractions.
</p>

<p>
Once you’ve narrowed, it’s as if the rest of the buffer is gone.  The buffer
size indicator in the <a href="#org6456ffd">Mode Line</a> will report the size of the narrowed portion as
if it’s the entire buffer, and any displayed line numbers will be reset from 1.
If you <a href="#orgf98c057">save</a> a narrowed file-visiting buffer, you will <i>always</i> save the entire
buffer, including the invisible parts—don’t worry that you might lose data by
saving only the narrowed part to the file!
</p>

<p>
The Mode Line will include the word “Narrow” in the parenthesized list of <a href="#org29e5e5d">Minor
Modes</a> (even though narrowing isn’t, strictly speaking, a Minor Mode).  There <i>are</i>
a few other giveaways.  The value of <a href="#orgba1f634">Point</a>, which you’ll recall is the offset,
in characters, from the beginning of the buffer, remains relative to the entire
unnarrowed Buffer.  One command that reveals the value of Point is
    <code>C-x =</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Position-Info"><code>what-cursor-position</code></a>﻿).  Suppose you narrow your 500K
buffer to one paragraph in the middle of the text; <code>what-cursor-position</code> will
show that Point is something like 254,120 rather than 1.  Go ahead and try it!
</p>

<p>
But wait, first I’d better tell you how to restore your buffer after narrowing
it!      <code>C-x n w</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Narrowing"><code>widen</code></a>﻿) does the job.  Point remains where it
was, and all the hidden parts blossom forth again.
</p>

<p>
If someone new to Emacs accidentally narrows a buffer, the usual assumption is
that, somehow, much text has mysteriously been lost, and the reaction is
dismay.  For this reason,     <code>C-x n n</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Narrowing"><code>narrow-to-region</code></a>﻿) is
<a href="#org46fc1c3"><i>disabled</i></a> by default.  But it’s a very useful command, and I recommend you
enable it after you’ve tried it a couple of times.
</p>
</div>
</div>
</div>
<div id="outline-container-orgc206819">
<h3 id="orgc206819">Modes, Major and Minor <a id="org5b21ef0"></a></h3>
<div id="text-orgc206819">
<table>


<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col"> </th>
<th scope="col">Major Mode</th>
<th scope="col">Minor Modes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Specialization</td>
<td><b>X</b></td>
<td> </td>
</tr>

<tr>
<td>Preferences</td>
<td> </td>
<td><b>X</b></td>
</tr>
</tbody>
</table>

<p>
The main way Emacs specializes different kinds of text — prose, programming
languages, data file formats — is through <i>Major Modes</i>.  Major Modes typically
provide customized fonts, colors, and other styling; layout (indentation and
such); key bindings; templating; integration with compilers, interpreters, and
debuggers; and more.
</p>

<p>
Every buffer <i>always</i> has a single Major Mode, and may have zero or more <i>Minor Modes</i>
enabled.  While Major Modes implement broad sets of features suited to a
particular kind of text or application (an application like, say, a web
browser), Minor Modes are typically independent of any particular kind of text,
and instead implement user preferences and features that are generic
and could enhance many or all Major Modes: things like <a href="#orgda03eba">spell check</a>, <a href="#org77f509a">line
numbers</a>, or folding text.
</p>

<p>
The Major Mode is, by default, shown in the <a href="#org6456ffd">Mode Line</a> as the first word in
parentheses.  If your buffer is in <code>python-mode</code>, the Mode Line will show:
</p>
<pre>(Python)
</pre>

<p>
(the Major Mode indicator may be followed by a list of space-separated Minor
Mode indicators).
</p>

<p>
Many Major Modes are for particular programming languages, but they also exist
for markup languages (TeX and LaTeX, Troff, HTML, Markdown, Org), config file
formats (for INI files, and many application-specific formats like Apache, Git,
Kubernetes, etc), data file formats (Json, CSV, XML, Turtle (RDF), YAML,
BibTex), image files, PDF files, and more.
</p>

<p>
An important role for Major Modes is to implement interfaces to external
programs, like <a href="#org53af7eb">version control systems</a> (Git, Mercurial, etc), databases,
<a href="#org039ef0a">shells</a>, <a href="#orgfdf7146">Grep</a>, and programming language REPLs; more modes implement 100%-Emacs
applications like <a href="#orgcc42ce0">file managers</a>, <a href="#org5e201bd">email systems</a>, <a href="#org4041080">games</a>, and <a href="#orgc4ddf2e">web browsers</a>.
</p>

<p>
At the moment, there are at least
412 more Major Modes
available in the <a href="#orgc96889a">Package Manager</a>, and even more on
<a href="https://github.com/">Github</a> and the like.  Basically, if you’re editing some
kind of structured text, there’s an Emacs mode to make the editing better.
</p>
</div>

<div id="outline-container-org9e3af5e">
<h4 id="org9e3af5e"><a id="org637bdd6"></a> How a Mode Happens to Your File</h4>
<div id="text-org9e3af5e">
<p>
When you visit a file, Emacs chooses a Major Mode for you automatically,
typically based on a file extension.  Files ending in <code>.org</code> will automatically be
in <a href="#org4a851ca"><code>org-mode</code></a>; files ending in <code>.py</code> will automatically be in
  <code>python-mode</code>.
</p>

<p>
But Major Mode selection is really more complex.  Emacs has a decision tree that
proceeds from the file contents, through the file name, to your chosen overall
default.  Here’s the complete sequence.
</p>
</div>

<div id="outline-container-orge81d3a0">
<h5 id="orge81d3a0"><a id="org834988b"></a> Mode via File-Local Variable</h5>
<div id="text-orge81d3a0">
<p>
You can explicitly set the Major Mode by including a string like this:
</p>
<pre>-*- MODE -*-
</pre>

<p>
somewhere on the first non-blank line of the file, where <code>MODE</code> is the name of the
mode, leaving off the trailing <code>-mode</code>.  So this line:
</p>
<pre>-*- python -*-
</pre>

<p>
will cause Emacs to choose <code>python-mode</code> when it visits the file.  Likewise:
</p>
<pre>-*- emacs-lisp -*-
</pre>

<p>
selects <code>emacs-lisp-mode</code>.
</p>

<p>
The mode string can be preceded on its line by any text, and followed by even
more text.  This allows you to put the mode string in a comment; thus:
</p>
<pre>/* -*- c -*- */
</pre>

<p>
selects <code>c-mode</code> and
</p>
<pre># -*- python -*-
</pre>

<p>
selects <code>python-mode</code>.
</p>

<p>
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/File-Variables">File local variables</a>, in their full
glory, are a concept originated by Emacs.<sup><a id="fnr.106" href="#fn.106" role="doc-backlink">106</a></sup>  You can set additional variables this
way:
</p>
<pre>-*- python; python-indent: 4 -*-
</pre>

<p>
and you can also set them at the end of the file, if your language is particular
about the top, or if you just prefer them there (they might be less
distracting).
</p>
</div>
</div>

<div id="outline-container-org8b36c09">
<h5 id="org8b36c09">Mode via Shebang, or Interpreter Directive</h5>
<div id="text-org8b36c09">
<p>
If the Major Mode wasn’t chosen due to a file-local variable, Emacs next looks
to see if the file begins with a <a href="https://en.wikipedia.org/wiki/Shebang_(Unix)"><i>shebang</i></a>, or interpreter directive.  This is a
Unix concept that allows executable text files to be run as scripts by a variety
of programming language interpreters.  So if your file begins with:
</p>
<p>
<code>#!/bin/sh</code>
</p>
<p>
Emacs will select <code>shell-script-mode</code>.  By default, Emacs knows how to map
46 interpreter names to the
right Major Mode; you can customize the variable
  <code>interpreter-mode-alist</code> to tweak these choices or add more.
</p>

<p>
Unix says that the shebang <i>must</i> be the first line of a file, so if you also want
some file-local variables, you’ll need to set them via the
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/File-Variables">end-of-file syntax</a>.
</p>
</div>
</div>

<div id="outline-container-org02c7b3d">
<h5 id="org02c7b3d">Mode via Filename</h5>
<div id="text-org02c7b3d">
<p>
If the Major Mode was chosen neither by a file-local variable nor a shebang,
Emacs next checks to see if the file extension determines the mode.<sup><a id="fnr.107" href="#fn.107" role="doc-backlink">107</a></sup> This
is controlled by the variable   <code>auto-mode-alist</code>, so you can
override the defaults to suit your preference.  Out of the box, <code>auto-mode-alist</code>
encodes 0 different file extension / mode
pairings.
</p>

<p>
This variable actually allows more sophisticated choices than just the file
extension: you can base the choice on the structure of the entire file name,
including the directory (so you can set a default mode for all the files in a
given directory, regardless of their basenames or extensions), and (as is
typically the case in such customizations) you can even base the choice on the
result of a function call.
</p>
</div>
</div>

<div id="outline-container-org10e994f">
<h5 id="org10e994f">Mode via Magic Fallback <a id="orgd08a97a"></a></h5>
<p>
If the Major Mode has <i>still</i> not been chosen, Emacs now checks
  <code>magic-fallback-mode-alist</code>, which examines the content of
the file to determine the mode.  This default value of this variable contains
patterns and functions that recognize image formats and make distinctions about
HTML and XML file formats (which can’t easily be made via file extension).
</p>
</div>

<div id="outline-container-org71ed7cc">
<h5 id="org71ed7cc">The Last Resort</h5>
<div id="text-org71ed7cc">
<p>
Finally, if the Major Mode remains undetermined after this entire process, the
<a href="#org84d9891"><i>default value</i></a> of the variable   <code>major-mode</code> is used.  The
<i>default</i> default (!) is <a href="#org952e909"><code>fundamental-mode</code></a>, the ultra-minimal Major Mode that does
absolutely nothing special.
</p>

<p>
You can change the default Major Mode to something else, like for example:
</p>
<div>
<pre>(<span>setq-default</span> major-mode &#39;text-mode)
</pre>
</div>
<p>
after which you’ll get <code>text-mode</code> as your default.  (If you’re a programmer or system
administrator — one who edits system files — I highly recommend keeping
<code>fundamental-mode</code> as the default value of <code>major-mode</code>; any other choice might
modify a file while you’re editing without your noticing.<sup><a id="fnr.108" href="#fn.108" role="doc-backlink">108</a></sup>)
</p>

<p>
But really there’s one final, ultimate, decision: in the case that <code>major-mode</code>’s
default value is <code>nil</code>, which will only be the case if you choose to make it so,
the Major Mode will be that of the buffer you were in before you switched to a
new buffer (by visiting a file, or creating a new buffer say by giving
    <code>C-x b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer"><code>switch-to-buffer</code></a>﻿) a nonexistent buffer name).
</p>
</div>
</div>
</div>
<div id="outline-container-org7fea640">
<h4 id="org7fea640">Setting the Mode Explicitly <a id="org21a8372"></a></h4>
<div id="text-org7fea640">
<p>
You can always set the Major Mode of a buffer explicitly, either because the
usual process came up with <code>fundamental-mode</code>, or chose the wrong mode (perhaps
due to an unusual or nonexistent file extension), or just because you prefer an
alternative mode at the moment.
</p>

<p>
Conventionally, Major Modes exist as commands named according to the pattern
<i>major-mode-name</i><code>-mode</code>,
so you can switch to Org Mode by invoking   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Org-Mode"><code>org-mode</code></a>﻿ or to Emacs
Lisp Mode with   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Lisp-Eval"><code>emacs-lisp-mode</code></a>﻿.  After switching, there might be
a visual change as the new mode’s syntax colorization takes effect; for example,
after switching to <code>fundamental-mode</code>, any colorization will disappear, since
<code>fundamental-mode</code> doesn’t do any syntax highlighting (this is one of the most
common manual mode changes, because since <code>fundamental-mode</code> does nothing visually
to the characters in the file, you can be sure you’re seeing the precise contents).
</p>

<p>
To restore Emacs’s choice of mode, you could reinvoke the mode’s function by
name, but the simplest way is to say   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Choosing-Modes"><code>normal-mode</code></a>﻿.  <code>normal-mode</code>
is not a Major Mode, but rather just a function that instructs Emacs to go
through the entire Major Mode-choosing process again.
</p>
</div>
</div>
<div id="outline-container-org3b99fd6">
<h4 id="org3b99fd6">Help for Your Mode</h4>
<p>
If you want to know what’s up with the Major Mode Emacs has chosen, just say
    <code>C-h m</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Misc-Help"><code>describe-mode</code></a>﻿).  The <code>*Help*</code> buffer will first list all
the enabled <a href="#org29e5e5d"><i>Minor</i> Modes</a> (because Major Modes often turn on a set of Minor
Modes); these are hyperlinked to complete descriptions later in the buffer.
Then the documentation for the Major Mode will be presented (for some modes,
this is quite extensive), and then typically a complete list of Major
Mode-specific key bindings will be given (there might only be a couple; for some
modes, like   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Org-Mode"><code>org-mode</code></a>﻿, there might be several hundred!).
Finally the documentation and key bindings for all the Minor Modes will be
given.  This can be a lot of documentation; for me, the Org Mode <code>*Help*</code> buffer is
over 900 lines long!
</p>
</div>
<div id="outline-container-org1b4e7dc">
<h4 id="org1b4e7dc">Customizing Modes</h4>
<div id="text-org1b4e7dc">
<p>
It’s very common to want to customize the way a Major Mode<sup><a id="fnr.109" href="#fn.109" role="doc-backlink">109</a></sup> works, and
well-written Major Modes (the majority of them!) provide many ways to do so.
You might want to change the default indentation level or the color of comments
or string literals in a programming language mode.  You might want to change
some of its key bindings to ones that are more mnemonic or easier to type.  You
might want to <a href="#org46fc1c3">disable</a> an annoying command that you find yourself accidentally
invoking (I do a lot of this!).
</p>

<p>
The simplest type of customization is to modify the value of a <i>user option</i>,
i.e. an Emacs variable that’s explicitly intended to be used to tweak a mode’s
behavior. The easiest way to do this is to go to a buffer that has the Major
Mode you’re wanting to tweak and invoke   <code>M-x</code> <code>customize-mode</code>; this
gathers all of the mode’s user options together and you can use the <a href="#org27e6769">Customize</a>
facility to change them.  You can also just set these options in your <a href="#org2af3730">Init File</a>
via Elisp, e.g.:
</p>
<pre>(setq python-indent-offset 2)
</pre>

<p>
see <a href="#orge6fb506"><i>User Options</i></a>.
How do you find out what user options exist to be customized?  Browsing the
<code>customize-mode</code> buffer is a good way; you can also use
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Apropos"><code>apropos-user-option</code></a>﻿ with a query like <code>python indent</code>, and don’t
forget to read the <a href="https://blog.veitheller.de/.html#Top">Info</a> manual for Modes which have one.
</p>

<p>
Customize doesn’t give you a way to change key bindings, so you’ll need to hack
your Init File to do that!  See <a href="#orge0608a1"><i>Modifying Key Bindings</i></a> for instructions.
</p>

<p>
Finally, you may want to customize a mode in a manner that never occurred to the
programmer who wrote the mode, and so there’s no handy user variable to tweak.
A common desire is to turn on several specific <a href="#org29e5e5d">Minor Modes</a> whenever you’re in a
given Major Mode: for example, spell checking.  But that’s just one of any
number of possible Minor Modes.  The programmer of the <i>Foo</i> Major Mode shouldn’t
try to provide user options like <code>foo-enable-spellcheck</code> because even though spell
checking is a common desire, there’s more than one way the user might want to do
it, and more to the point, there is an unlimited number of extant and
not-yet-written potential Minor Modes of interest.  And you may want to enable a
behavior that’s not even a formal Minor Mode<sup><a id="fnr.110" href="#fn.110" role="doc-backlink">110</a></sup>.
</p>

<p>
<a id="orgb03928c"></a>
Fortunately, Emacs has a general purpose mechanism to solve this problem; it’s
pervasive and part of what makes Emacs so malleable: <a href="#orgc54c064"><i>Hooks</i></a>.  Hooks exist to
provide a way for an action of some kind to also perform some other arbitrary
actions at your behest.  Every Major and Minor Mode <code>FOO-mode</code> respects a
variable <code>FOO-mode-hook</code> which is intended to contain a list of functions.  Each
function in this list is executed, in order, after the mode is done initializing
the buffer.  You simply add functions to this list; the functions can do
whatever you want.
</p>

<p>
So, if you want spell checking in Org Mode, and you prefer
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Spelling"><code>flyspell-mode</code></a>﻿ to   <code>ispell-minor-mode</code>,
you can add this line to your <a href="#org2af3730">Init File</a>:
</p>
<pre>(add-hook &#39;org-mode-hook &#39;flyspell-mode)
</pre>

<p>
If you don’t generally want line numbers turned on, but you <i>do</i> want them in
<code>python-mode</code>, add this line:
</p>
<pre>(add-hook &#39;python-mode-hook &#39;linum-mode)
</pre>

<p>
As the name implies, the   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Hooks"><code>add-hook</code></a>﻿ function adds an
additional function to a hook variable, at the front of the list.  <code>add-hook</code> is
clever and only adds the function if it isn’t already present (that way it
doesn’t run twice).
</p>

<p>
<code>flyspell-mode</code> and <code>linum-mode</code> are both Minor Modes, and Minor Modes are designed
to be easy to add to hooks.  But you can add arbitrary functions as long as they
make sense.  Want to give yourself a little encouragement whenever you open an
Elisp buffer?
</p>
<pre>(add-hook &#39;emacs-lisp-mode-hook
  (lambda () (message &#34;Don&#39;t fear the parentheses!&#34;)))
</pre>


<p>
More complex modes will define more than just the default
after-mode-initialization hook, and will run these hooks when certain actions
occur.  <code>org-mode</code>, for example, an especially complex Major Mode, has
80 hooks.
</p>

<p>
Hooks are not really just for modes.  There are many defined for Emacs actions
that occur “globally” — hooks for when Emacs starts up and when it exits, for
example — and individual functions defined outside of any major mode can have
their own hooks so that you can customize their behavior.
</p>
</div>
</div>
<div id="outline-container-org7a63b4b">
<h4 id="org7a63b4b">Derived Modes and Inheritance</h4>
<div id="text-org7a63b4b">
<p>
Almost all Major Modes are derived from some preexisting mode that’s in some way
similar.  This way, the new mode inherits behavior from the parent (which may
have inherited behavior from <i>its</i> parent, and so on).  The new mode inherits the
parent’s keybindings, syntax table, <a href="#orgd0268b2">abbreviations</a>, and Major Mode hook, and can
then change anything it’s inherited, or not.  Note that the new mode’s hook will
run <i>after</i> all the inherited mode hooks.  So if someone invents a new variant of
the Lisp programming language, say “Neolisp”, a new Emacs <code>neolisp-mode</code> might
well be derived from <code>lisp-mode</code>.
</p>

<p>
There are five Major Modes that are commonly used as parent modes:
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Text-Mode"><code>text-mode</code></a>﻿, for a new mode that deals with something similar
to natural-language prose; <code>prog-mode</code>, for new programming language modes;
<code>special-mode</code>, for modes that let you view data more than they let you edit it
(this includes most <a href="#org20384d4">applications</a>); <code>tabulated-list-mode</code>, for modes that present a
view of data in sortable columns (and which is itself derived from
<code>special-mode</code>); and finally, <code>fundamental-mode</code>, the most minimal mode of all.
Note that <code>prog-mode</code>, <code>special-mode</code>, and <code>tabulated-list-mode</code> exist only to be
derived from, whereas <code>text-mode</code> and <code>fundamental-mode</code> are themselves often used
as Major Modes.
</p>
</div>
</div>
<div id="outline-container-org20775fb">
<h4 id="org20775fb">Basic Major Modes</h4>
<p>
Here are a few basic Major Modes that can be useful when Emacs doesn’t have a
better idea for your text.
</p>

<div id="outline-container-org7c881ce">
<h5 id="org7c881ce"><code>fundamental-mode</code> <a id="org952e909"></a></h5>
<div id="text-org7c881ce">
<p>
This is the basic mode in reference to which many other modes are defined.  It’s
perfectly fine for editing any kind of text, it just doesn’t provide any special
features: it has no mode-specific key bindings and no colors to distinguish
different kinds of text.  Every character in the buffer looks exactly like
itself.
</p>

<p>
It’s occasionally useful to turn off the fancy features of a specialized mode by
switching a buffer into   <code>fundamental-mode</code>; see
 <a href="#org21a8372"><i>Setting the Mode Explicitly</i></a>.
</p>
</div>
</div>
<div id="outline-container-orgdc1eb66">
<h5 id="orgdc1eb66"><code>text-mode</code></h5>
<p>
For editing plain, unspecialized, natural language prose, i.e. blank-line
separated paragraphs consisting of sentences.  This is the Mode Agatha Christie
would have used for her books, if she’d had Emacs instead of her typewriter.
Quite minimal.
</p>
</div>
<div id="outline-container-orgc22075c">
<h5 id="orgc22075c"><code>outline-mode</code></h5>
<div id="text-orgc22075c">
<p>
You can add a little more structure to your prose by using
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Outline-Mode"><code>outline-mode</code></a>﻿ (see <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Outline-Mode">“Outline Mode”</a> in the <i>Emacs</i> manual).
Lines that start with an asterisk form the nested headlines of an outline, and
you can fold (hide) and unfold the text of the outline levels, easily reorder
them without cutting and pasting, etc.
</p>
<pre id="orgdb3a737">* My Header
Some text.
** A Nested Sub-Header
* Next Header
</pre>
<p>
In recent years, <code>outline-mode</code> has been largely subsumed under <a href="#org4a851ca">Org Mode</a>, which
includes all its features, with friendlier key bindings,  and adds so much more.
In my opinion you should skip over <code>outline-mode</code> and go direct to Org.
</p>
</div>
</div>
</div>
<div id="outline-container-org954b271">
<h4 id="org954b271">Programming Language Modes</h4>
<div id="text-org954b271">
<p>
As of version 28.2, Emacs ships with Major Modes for at least
Ada, Assembly Language, AWK, C, C++, Common Lisp, Emacs Lisp, Fortran, Icon,
Java, Javascript, M4, Makefiles, Metafont, Modula2, Object Pascal, Objective-C,
Octave, Pascal, Perl, Pike, PostScript, Prolog, Python, Ruby, Scheme, Shell
(Bourne-, C-shell-, and <code>rc</code>-derived flavors), Simula, SQL, Tcl, Verilog, and
VHDL.
</p>

<p>
In such a mode, Emacs does all the sorts of things you expect of an integrated
development environment (IDE): syntax highlighting to colorize and fontify the
different syntactic elements of the code, specialize <a href="#orgee51965">textual objects</a> for the
language (so Emacs’s symbols match the languages identifiers, and its functions
match the languages function definitions), balance parentheses, complete
identifiers, enable commands to insert and delete comments, indent and dedent
the lines appropriately, show documentation of built-in functions, jump from
function and identifier uses to their definitions, expand source code templates,
send function definitions to the language interpreter (REPL), interact with a
debugger, compile code, and jump from compiler error messages to the locations
in question.
</p>

<p>
Some of the common features of IDE’s are handled by independent, orthogonal
Minor Modes.  On-the-fly syntax and style checking (linting) is often handled by
<a href="http://www.flycheck.org">Flycheck</a><sup><a id="fnr.111" href="#fn.111" role="doc-backlink">111</a></sup> or for languages that use the Language Server Protocol, <a href="https://github.com/joaotavora/eglot">Eglot</a> or
<a href="https://github.com/emacs-lsp/lsp-mode"><code>lsp-mode</code></a>.  Spellcheck in comments is handled by
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Spelling"><code>flyspell-prog-mode</code></a>﻿.  Project navigation is the domain of
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Projects">Projects</a> or the much fancier <a href="https://projectile.mx/">Projectile</a>.  Version control has
its own <a href="#org53af7eb">chapter</a>, as do <a href="#org76cafbe">build tools</a>, <a href="#org3fa1f0c">searching</a>, and
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Debuggers">debugging</a>.
</p>
</div>
</div>

<div id="outline-container-org2ae80ff">
<h4 id="org2ae80ff">Minor Modes <a id="org29e5e5d"></a></h4>
<div id="text-org2ae80ff">
<p>
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Minor-Modes">Minor Modes</a> work like mix-ins:
enable as many as you like.  Emacs turns on a dozen by default to implement
things like the automatic handling of compressed or <a href="#orgc045bbb">encrypted files</a>, and I
typically have a couple dozen other Minor Modes enabled too.  At the moment,
there are at least 155 more
minor modes available in the <a href="#orgc96889a">Package Manager</a>, and even more on <a href="https://github.com/">Github</a> and the like.
</p>

<p>
Minor Modes come in two flavors, <i>global</i> and <i>buffer-local</i>, and some come in both.
When you turn on a buffer-local Minor Mode, it’s only enabled in the current buffer;
if you want it on in another buffer too, you need to turn it on there
separately.  This is why we often add Minor Modes to a Major Mode’s <a href="#orgb03928c">startup
hook</a>: so that they’re automatically turned on in all buffers in that Major Mode.
But Minor Modes that are likely to be generally useful in any Major Mode often
come in a global flavor; when you turn on a global Minor Mode, it’ll be on in every
buffer that’s created.  We’ve seen how you turn on line-numbers in a buffer with
  <code>M-x</code> <code>linum-mode</code>; but there’s also   <code>M-x</code> <code>global-linum-mode</code>.
It’s up to the programmer who implements a Minor Mode to decide whether to
provide a global command, a buffer-local command, or both.
</p>

<p>
Some Minor Modes will be listed in the parentheses of the <a href="#org6456ffd">Mode Line</a>, after the
Major Mode.  Right now, my Mode Line shows:
</p>
<pre>(Org Ind Fly PgLn NoMouse! Fill)
</pre>

<p>
<code>org-mode</code> is the Major Mode and all the rest are Minor Modes.  Minor Modes may
shorten their Mode Line indicator<sup><a id="fnr.112" href="#fn.112" role="doc-backlink">112</a></sup> dramatically (“Ind” above is <code>org-indent-mode</code>),
and some choose to provide no indicator at all (global ones tend to use no
indicator).  Minor Modes are used so heavily nowadays they can take up a lot of
Mode Line space.  Each of these indicators provides various actions for mouse
clicks; see the <a href="#org6456ffd">Mode Line</a> chapter.
</p>

<p>
We’ve seen how to <a href="#orgb03928c">add Minor Modes to hooks</a>, but you can also turn them on and
off manually.  Any Minor Mode command, like   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Spelling"><code>flyspell-mode</code></a>﻿, will
toggle that mode: if it’s currently off, it’ll be turned on, and vice versa.
(This is different from Major Mode commands, which only turn the mode on; since
there’s always one and only one Major Mode in a buffer, you can’t simply turn it
off: all you can do is turn on (and thus replace it with) a different one.)
Global Minor Modes work the same way, affecting all buffers.  The only practical
way to turn on buffer-local Minor Modes in your <a href="#org2af3730">Init File</a> is via <a href="#orgb03928c">hooks</a>, but you
can directly turn global Modes on in your Init File like, for example:
</p>

</div>
</div>
</div>
<div id="outline-container-org3a08627">
<h3 id="org3a08627">Application Buffers <a id="orgfa25f51"></a></h3>
<div id="text-org3a08627">
<p>
Broadly speaking, there are two kinds of <a href="#orgc3260f6">Buffers</a> in Emacs: those that are
<a href="#org41c8a78">visiting files</a>, and those that aren’t.  In file-visiting Buffers, we are editing
(or at least viewing) the contents of a file.
</p>

<p>
Non-file-visiting Buffers can be loosely subdivided into two further types.  The
first is <i>temporary Buffers</i>.  When you ask Emacs to display some information with
a command like   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Colors"><code>list-colors-display</code></a>﻿ or   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Calendar/Diary"><code>calendar</code></a>﻿,
the results are displayed in temporary Buffers.  Of course, you can create a
brand-new, empty, non-file-visiting Buffer as simply as
    <code>C-x b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Buffer"><code>switch-to-buffer</code></a>﻿) <code>NEWNAME</code>.  You might even scribble
notes in it, or use it to gather text from other buffers for editing.  Such
Buffers are transitory and thus unimportant: if one becomes important to you,
you save it to a file with     <code>C-x C-s</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Save-Commands"><code>save-buffer</code></a>﻿): now it’s a
file-visiting Buffer.
</p>

<p>
The second type of non-file-visiting Buffer is what I’ll call <i>Emacs
Applications</i>: Buffers that implement the user interfaces of special purpose
programs: Buffers that you <i>interact</i> with.  Such Applications include file
managers, web browsers, shells and terminals, version control programs, mail
user agents, games, and much more.
</p>

<p>
As I write this, my Emacs has 59 <a href="#orgb8574ab">non-hidden Buffers</a>, and 34 of them, the
majority, are Applications: I would say that proportion is completely typical.
Application Buffers are what make Emacs a Lisp Machine: a plain-text computing
environment.  You could turn that around and say that Application Buffers exist
<i>because</i> Emacs is a Lisp Machine: the fact that it’s so readily programmable has
resulted in people using it to create so many Applications.
</p>

<p>
We’ve already discussed a few Applications without emphasizing it: the <a href="">Help</a>,
<a href="#org42f1d6b">Apropos</a>, and <a href="https://blog.veitheller.de/.html#Top">Info</a> subsystems; and the <a href="#orga329460">Minibuffer</a>.  These Applications, and many
more, exist as user interfaces to Emacs itself, but most, as we’ll see soon, are
Emacs front-ends to your computer, to the network (and the web), and to Unix
command-line applications.  And some are completely stand-alone Applications,
rather than front-ends to anything else (for example: the <a href="#orgb2b6b30">Calculator</a>, <a href="#org0c5e670">Calendar</a>, and
various <a href="#org4041080"><i>Games and Amusements</i></a>).
</p>

<p>
(You can also think of the fancier file-visiting Major Modes as applications:
IDE’s for programming languages, <a href="#org8dc49db">document viewers</a>, and the like; in a Lisp
Machine, it’s really hard to make these distinctions.)
</p>

<p>
Every Application is unique, but most of them start out inheriting behavior from
a <a href="#org5b21ef0">Major Mode</a> called   <code>special-mode</code>.  As a result, lots of
Applications share a certain amount of behavior and key bindings, which I’ll
discuss briefly here.
</p>

<p>
But first and foremost, an Application Buffer is just that: <i>a Buffer</i>.  Most of
what you’ve learned about Buffers applies to Applications.  Of course, there
will be differences, but in general in any Application you already know things like:
</p>
<ol>
<li>how to navigate within it (use the motion and search commands)</li>
<li>how to copy text (or data) from it (just <a href="#orgfab3d04">select text</a> and use     <code>M-w</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Kill-Commands"><code>kill-ring-save</code></a>﻿))</li>
<li>how to get help about it (    <code>C-h m</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Misc-Help"><code>describe-mode</code></a>﻿))</li>
<li>how to switch between Applications (<a href="#orgfef4c7a">just switch Buffers</a>)</li>
<li>how to kill an Application (    <code>C-x k</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Kill-Buffer"><code>kill-buffer</code></a>﻿))</li>
</ol>

<p>
This is one of the advantages of Emacs as a computing environment: you have less
to learn because you already know these things.
</p>

<p>
Application Buffers start out and almost always remain <a href="#orgdb8bc3e">read-only</a>, and inherit
the following key bindings from <code>special-mode</code> (see Table <a href="#org57f059b">7</a>), but
remember that any Application will add more bindings, and very often
change some of the inherited ones, in the name of usability.  Almost
all <code>special-mode</code> commands are just handy shorthands for commands you already
know, shown in the “Also” column.
</p>
<table id="org57f059b">
<caption><span>Table 7:</span> <code>special-mode</code> Key Bindings</caption>

<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Also</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SPC</code></td>
<td><code>C-v</code></td>
<td>scroll forward</td>
</tr>

<tr>
<td><code>DEL</code>, <code>S-SPC</code></td>
<td><code>M-v</code></td>
<td>scroll backward</td>
</tr>

<tr>
<td><code>&lt;</code></td>
<td><code>M-&lt;</code></td>
<td>go to beginning-of-buffer</td>
</tr>

<tr>
<td><code>&gt;</code></td>
<td><code>M-&gt;</code></td>
<td>go to end-of-buffer</td>
</tr>

<tr>
<td><code>-</code></td>
<td><code>C-u -</code></td>
<td>give next command a negative arg</td>
</tr>

<tr>
<td><code>0</code>…​<code>9</code></td>
<td><code>C-u 0 ...</code></td>
<td>give next command a numeric arg</td>
</tr>

<tr>
<td><code>?</code>, <code>h</code></td>
<td><code>C-h m</code></td>
<td>show help for mode</td>
</tr>

<tr>
<td><code>g</code></td>
<td><code>C-x x g</code></td>
<td>revert the buffer</td>
</tr>

<tr>
<td><code>q</code></td>
<td><code>C-x 0</code></td>
<td>hide the Application window</td>
</tr>
</tbody>
</table>

<p>
Note that most Applications don’t have a command to stop or terminate them; you
can just switch away from their Window (<code>special-mode</code>’s <code>q</code> command is an easy way)
and never come back.  As usual if, you want to clean up, you can just kill the
Application’s buffer.
</p>
</div>
</div>
<div id="outline-container-org88770b5">
<h3 id="org88770b5"><span>UNFINISHED</span> Windows <a id="org9409b46"></a></h3>
<div id="text-org88770b5">

<div id="org5f35e0c">
<p><img src="https://blog.veitheller.de/images/data-structures.png" alt="data-structures.png" width="100%"/>
</p>
<p><span>Figure 12: </span>Emacs Data Structures</p>
</div>
<p>
<b>Legend:</b>
</p>
<table>


<colgroup>
<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td>*</td>
<td>One or more</td>
</tr>

<tr>
<td>1</td>
<td>Exactly one</td>
</tr>

<tr>
<td>1?</td>
<td>One or none</td>
</tr>
</tbody>
</table>

<p>
When Emacs starts up, it presents a <a href="#org4dd50c2">Frame</a> containing a single <i>window</i>.  This
window displays a <a href="#orgc3260f6">Buffer</a>, and has its own <a href="#orgba1f634">Point</a>.  Optionally, a window (almost
always) has a <a href="#org6456ffd">Mode Line</a>, and (less frequently) any of a <a href="#orgbe2bf62">Header Line</a>, a left
Fringe and a Right <a href="#org2f7933b">Fringe</a>; see Figure <a href="#org88ceb67">13</a>.
</p>

<div id="org88ceb67">
<p><img src="https://blog.veitheller.de/images/parts-of-a-window.png" alt="parts-of-a-window.png"/>
</p>
<p><span>Figure 13: </span>The Parts of a Window</p>
</div>

<p>
The Frame can be <i>tiled</i> into multiple windows in a rectangular grid; that is, any
window can be recursively subdivided into more windows, horizontally or
vertically; see Figure <a href="#orge268f3f">14</a>.
</p>

<div id="orge268f3f">
<p><a href="https:./images/tiling.png" alt="Tiling Windows" title="Tiling Windows" width="100%"><img src="https://blog.veitheller.de/images/tiling.png" alt="Tiling Windows" title="Tiling Windows" width="100%"/></a>
</p>
<p><span>Figure 14: </span>Tiling Windows</p>
</div>

<p>
At any moment, one window is the distinguished <i>selected</i> window<sup><a id="fnr.113" href="#fn.113" role="doc-backlink">113</a></sup>; most
editing commands, including self-inserting commands, take effect in the Buffer
of the selected window.
</p>

<p>
Different windows may display the same Buffer<sup><a id="fnr.114" href="#fn.114" role="doc-backlink">114</a></sup>, and they don’t need to
display the exact same part of the Buffer: one could display the beginning of
the Buffer while another displays the end, and there may or may not be any
overlap.  If you can see the same part of the Buffer in two windows, and you
modify the text there, you will see the modifications in both windows.  Since
each window has its own Point, you can move and <a href="#org7e57cd2">scroll</a> independently in
different windows displaying the same buffer.
</p>
</div>
<div id="outline-container-orgfde58b2">
<h4 id="orgfde58b2">Splitting Windows</h4>
<p>
Since it’s impossible to have a Frame with no windows, there’s no command to
create a window out of thin air.  If you want a new window, you have to pick an
existing window; switch to it, if it’s not the selected window; and <i>split it</i>.
We’ve already discussed this in <a href="#org341aea6"><i>Basic Commands to Manipulate Windows</i></a>.  The
fundamental commands are     <code>C-x 2</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Split-Window"><code>split-window-below</code></a>﻿) and
    <code>C-x 3</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Split-Window"><code>split-window-right</code></a>﻿).
</p>
</div>
<div id="outline-container-org6e199c8">
<h4 id="org6e199c8">Deleting Windows</h4>
<div id="text-org6e199c8">
<p>
There are two basic command for deleting windows:
    <code>C-x 0</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Change-Window"><code>delete-window</code></a>﻿) and
    <code>C-x 1</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Change-Window"><code>delete-other-windows</code></a>﻿): in other words, you either
delete <i>this</i>, the <i>selected</i>, window, keeping all the rest, or you delete <i>all</i> the
other windows, keeping only this one.
</p>

<p>
  <code>M-x</code> <code>delete-windows-on</code> prompts for the name of a buffer and deletes
all the windows that happen to be displaying it.
</p>

<p>
None of these three commands in any way affect the buffer being displayed: in
particular, they do <i>not</i> kill the buffer.
</p>
</div>
</div>
<div id="outline-container-org2f2d7ef">
<h4 id="org2f2d7ef">Switching Windows <a id="orgf6ece5b"></a></h4>
<div id="text-org2f2d7ef">
<p>
To “switch windows” means to change the selected window, without necessarily
changing the number or layout of the windows.  Mouse users can switch windows by
just clicking anywhere in another one.  For those of us that prefer the
keyboard, the most <a href="#org341aea6">basic command</a> to change the selected window is
    <code>C-x o</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Window"><code>other-window</code></a>﻿), which switches to <i>the Other Window</i>;
repeated invocations cycle through all the windows in the current Frame.
</p>

<p>
Which window is the “other” one?  Simple: it’s the next window in a pre-order,
depth-first traversal of the window tree arranged in a cyclic ring!  It’s a
little hard to express in a less-nerdy manner, but if your window configuration
were that in Figure <a href="#org2ddd38b">15</a>, and the selected window was the window labeled
<code>S</code> (for <i>selected</i>), then the Other Window is window <code>1</code>, and repeating <code>C-x o</code> would
cycle through the windows in numeric order, returning to window <code>S</code> after window
<code>6</code>.
</p>

<div id="org2ddd38b">
<p><img src="https://blog.veitheller.de/images/other-window.png" alt="other-window.png"/>
</p>
<p><span>Figure 15: </span>The Mysterious Other Window</p>
</div>

<p>
<code>C-x o</code> is fine when you have only two windows (a very common configuration), and
okay for three, but after that it’s frankly kind of tedious and if you
overshoot, you have to circle all the way around again!<sup><a id="fnr.115" href="#fn.115" role="doc-backlink">115</a></sup>
</p>

<p>
<a href="#orgc96889a">Optional packages</a> to the rescue!  I use the <code>windmove</code> package, which essentially
gives you four new directional versions of <code>C-x o</code>: switch to the window to the
right, the left, the one above, and the one below.  By default these are on the
shifted arrow keys.  So in Figure <a href="#org2ddd38b">15</a>, if you’re at <code>S</code> and want to
switch to <code>5</code>, you can just say <code>&lt;S-right&gt; &lt;S-right&gt; &lt;S-right&gt;</code> (or take another
route, like <code>&lt;S-down&gt; &lt;S-down&gt; &lt;S-right&gt;</code>) rather than six <code>C-x o</code>’s.  <code>windmove</code> is
not so much about minimizing the keystrokes as making them more direct and easy
to think about.
</p>

<p>
Another package that’s well-liked is Oleh Krehel’s <code>ace-window</code>, which gives you
one new function, which you would probably bind to <code>C-x o</code>; when executed, the
windows all display a transient label in their upper-left-hand corners—by
default a digit—and you just type the label of the window to which you want to
switch.  That’s three keystrokes to switch to any window, regardless of how many
windows are in your frame.  It’s also kind of visually sexy.
</p>

<p>
You can choose between either of these, or use both, or search the Packages for
many other possible solutions to the problem.  Here’s a recommended <a href="#org2af3730">Init File</a>
snippet that sets up <code>windmove</code>:
</p>
<div>
<pre>(<span>unless</span> (package-installed-p &#39;windmove)
  (<span>with-demoted-errors</span> <span>&#34;%s&#34;</span>
    (<span>unless</span> package-archive-contents
      (package-refresh-contents))
    (package-install &#39;windmove)))
<span>;; </span><span>&lt;S-{left,right,up,down}&gt; switches windows</span>
(<span>with-demoted-errors</span> <span>&#34;%s&#34;</span> (windmove-default-keybindings))
</pre>
</div>
<p>
If you want <code>ace-window</code>, replace or supplement the snippet above with this one;
feel free to choose a different keystroke if you want to preserve <code>C-x o</code>.
</p>
<div>
<pre>(<span>unless</span> (package-installed-p &#39;ace-window)
  (<span>with-demoted-errors</span> <span>&#34;%s&#34;</span>
    (<span>unless</span> package-archive-contents
      (package-refresh-contents))
    (package-install &#39;ace-window)))
(global-set-key (kbd <span>&#34;C-x o&#34;</span>) &#39;ace-window)
</pre>
</div>

<p>
Finally, there are of course innumerable commands that have the side-effect of
switching windows.  I’ll just mention here the <code>C-x 4</code> family of commands that
switch to the Other Window and then do something in it; these commands are great
when you can think just one step ahead, knowing not only that you want to switch
windows but what you intend to do when you get there; see Table <a href="#orgd56609d">8</a>.
(See <a href="#org634b3b6"><i>KIlling Buffers</i></a> for <code>C-x 4 0</code>, which I think is more of a buffer-killing
command.)
</p>

<table id="orgd56609d">
<caption><span>Table 8:</span> The <code>C-x 4</code> Family of Other-Window Commands</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Action in Other Window</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>C-x 4 C-f</code></td>
<td>Find a file</td>
</tr>

<tr>
<td><code>C-x 4 f</code></td>
<td>… the same</td>
</tr>

<tr>
<td><code>C-x 4 r</code></td>
<td>… the same, but read-only</td>
</tr>

<tr>
<td><code>C-x 4 b</code></td>
<td>switch to a different Buffer (with completion)</td>
</tr>

<tr>
<td><code>C-x 4 C-o</code></td>
<td>… the same</td>
</tr>

<tr>
<td><code>C-x 4 d</code></td>
<td>open Dired on some directory</td>
</tr>

<tr>
<td><code>C-x 4 C-j</code></td>
<td>Jump to this buffer’s directory in Dired</td>
</tr>

<tr>
<td><code>C-x 4 m</code></td>
<td>compose an email</td>
</tr>

<tr>
<td><code>C-x 4 .</code></td>
<td><a href="#orgdd5fd7e">find the definition</a> of the identifier at Point</td>
</tr>

<tr>
<td><code>C-x 4 a</code></td>
<td>find <a href="#orga7fb31f"><code>ChangeLog</code></a> file and Add an entry</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org3784a91">
<h4 id="org3784a91"><span>UNFINISHED</span> Quitting Windows <a id="orgb416722"></a></h4>
</div>
<div id="outline-container-org6dbd37f">
<h4 id="org6dbd37f">Window Configurations <a id="orgb729f11"></a> <a id="orgc6b43c3"></a></h4>
<div id="text-org6dbd37f">
<p>
Often, working in Emacs consists of a fugue-like state of rapidly and almost
automatically switching from Buffer to Buffer, with windows coming and going, as
you multitask between, say, authoring, coding, doing email, managing files, and
browsing the web.  But sometimes you need an exact configuration of windows and
Buffers to stick around (for example, see Figure <a href="#orge7df19e">47</a>).  In this case,
a popped-up window showing <code>*Help*</code> or an email can be an irritant if it means you
have to manually restore your <i>Window Configuration</i>.
</p>

<p>
There are several facilities to cope with this.  The oldest is to use a
<a href="#orgcfc576b">Register</a>: set up your windows and Buffers exactly as you want them and then
store that configuration in a register with
    <code>C-x r w</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Configuration-Registers"><code>window-configuration-to-register</code></a>﻿).  It will prompt
you for a single-character Register name; pick a (preferably) mnemonic letter.
Now, after the usual vicissitudes of the day—popped-up <a href="#org0c5e670">Calendars</a>, <a href="#org039ef0a">Shells</a>, and
<a href="#orgc4ddf2e">Web Browsers</a>—have messed-up your beautiful layout, just restore it with
    <code>C-x r j</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Position-Registers"><code>jump-to-register</code></a>﻿), which will prompt for the
Register name you’ve used.
</p>

<p>
To be precise, a Window Configuration records the exact sizes and relative
positions of all the windows in the current <a href="#org4dd50c2">Frame</a>, and exactly which Buffer was
displayed in each window, and what portion of the Buffer was visible.  (You can
also save and restore all the Window Configurations in all your Frames in one
go; see <a href="#orgc82eded"><i>Frames</i></a>.)
</p>

<p>
Using Registers requires a little forethought, but it does guarantee perfect
restoration of your layout.  A more on-the-fly if less precise method is to use
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Window-Convenience"><i>Winner Mode</i></a>.  This is a <a href="#org29e5e5d">global Minor
Mode</a> that essentially allows you to Undo window configuration changes.  So when
your carefully-arranged layout is messed up because you had to send that email,
and needed to get help while doing it, just use
    <code>C-c &lt;C-left&gt;</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>winner-undo</code></a>﻿) (perhaps repeated a few times)
until you get your configuration back.  If you overshoot, you can undo the undo
with     <code>C-c &lt;C-right&gt;</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>winner-redo</code></a>﻿).
</p>

<p>
I use Winner Mode all day long and consider it essential.  I recommend this <a href="#org2af3730">Init
File</a> snippet (the bindings I describe are my own more <a href="#org38efd5c">felicitous</a> versions
of the defaults):
</p>
<div>
<pre>(winner-mode 1)                       <span>; </span><span>undo window config changes</span>
<span>;; </span><span>add more felicitous bindings</span>
(define-key winner-mode-map [(control c) (control left)] &#39;winner-undo)
(define-key winner-mode-map [(control c) (control right)] &#39;winner-redo)
</pre>
</div>

<p>
There are of course other third-party Packages that deal with window
configurations; I might mention the <a href="#orgd1263eb">Hyperbole</a> package that does that (and also
many other things).
</p>
</div>
</div>
<div id="outline-container-org8f973be">
<h4 id="org8f973be">The Tab Bar <a id="org20c4b0d"></a></h4>
<div id="text-org8f973be">
<p>
Another way to manage Window Configurations is via the very new
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Tab-Bars"><i>Tab Bar</i></a>.  Not to be confused with the <a href="#org117b049">Tab
Line</a>, the Tab Bar is a <a href="#org4dd50c2">Frame</a>-specific set of different transient Window
Configurations.
</p>

<p>
Really, I think the Tab Bar is best thought of as a task-based desktop
organizational framework.  Many people use distinct window manager “desktops” or
“tabs” to separate their applications this way: you’ve got your email
application and its many windows in one desktop, your game’s windows in
another, your word processor in a third, and maybe your web browser in a fourth.
</p>

<p>
The Emacs way is to do all (or most) of these activities in Emacs, and the Tab
Bar gives you that same kind of organization.  A given “task” is not so much a
precise, unchanging window configuration, but rather the set of windows and
buffers as you were last using them when you were working on that task.  The Tab
Bar lets you switch between tasks rather than preserving precise window
configurations.
</p>

<p>
Before the introduction of the Tab Bar, people would often use a dedicated <a href="#org4dd50c2">Frame</a>
for each “task” or “desktop”.  The Tab Bar lets you do it in one Frame.
</p>

<p>
Note the differences between a Tab and a window config in a Register:
</p>
<ul>
<li>Tabs have long names, while Register names are restricted to single
characters.</li>
<li>The set of available configurations is (by default) visible in a Tab Bar at
the top of the Frame, while the Register config is hidden away.</li>
<li>The configuration of Windows and Buffers in a Tab can be changed as you work,
whereas a Register config can only be created from whole cloth once and then
restored, precisely, many times.</li>
</ul>

<p>
Turn on the Tab Bar with   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Tab-Bars"><code>tab-bar-mode</code></a>﻿; this is a <a href="#org29e5e5d">global Minor
Mode</a> and so the Tab Bar will be active in all current and future Frames.  When
you enable the Mode, a single configuration will be created, named for the
current buffer.  You can change the configuration at will: split windows and
change buffers all you like.  So far it doesn’t seem any different from <i>not</i>
using <code>tab-bar-mode</code>.
</p>

<p>
Suppose you’ve laid out a nice configuration for <a href="#orge7df19e">editing your book</a>, but now you
want to <a href="#org5e201bd">read your email</a> for a while.  Since this is a distinct task that will
implicitly use a different set of windows and buffers, you should create a new config
with     <code>C-x t 2</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Tab-Bars"><code>tab-new</code></a>﻿) (or use your mouse to click the
right-hand <code>+</code> sign in the Tab Bar).  Now, in this new, second, config (which
you’ll notice has popped up in the Frame’s Tab Bar), you can open your mailer
and read and compose emails.  To get back to your book, just click on the
book-tab, or switch configs with one of the tab-switching commands in Table
<a href="#org82ecd24">9</a>: your windows and buffers are restored to the way they were right before
you started reading mail.  You can now switch back and forth between tasks, or
add a new task when needed.
</p>

<table id="org82ecd24">
<caption><span>Table 9:</span> The <code>C-x t</code> Family of Tab Bar Commands</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>C-x t 2</code></td>
<td>create a 2nd (really, a new) tab</td>
</tr>

<tr>
<td><code>C-x t C-f</code></td>
<td>… by Finding a File</td>
</tr>

<tr>
<td><code>C-x t f</code></td>
<td>… (the same)</td>
</tr>

<tr>
<td><code>C-x t b</code></td>
<td>… by switching to a Buffer</td>
</tr>

<tr>
<td><code>C-x t d</code></td>
<td>… by Dired</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C-x t o</code></td>
<td>switch to the Other (next) tab</td>
</tr>

<tr>
<td><code>C-x t RET</code></td>
<td>… by name (with completion)</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C-x t 0</code></td>
<td>zero (delete) this tab</td>
</tr>

<tr>
<td><code>C-x t 1</code></td>
<td>make this tab the only 1 (delete all others)</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C-x t r</code></td>
<td>Rename this tab</td>
</tr>

<tr>
<td><code>C-x t m</code></td>
<td>Move this tab to the right</td>
</tr>
</tbody>
</table>

<p>
A Register configuration has one advantage that a Tab Bar config doesn’t have: a
Register config is <i>immutable</i>.  You’ll note that while you’re in a given Tab, you
can change the windows, buffers and their visual relationship at will, so once
you’ve laid out a precise configuration in your Tab, you may still want to store
it in a Register so you can get it back, or use Winner Mode to undo config
changes.
</p>

<p>
If you use <a href="#orgf2e3965"><code>desktop-save-mode</code></a> to save and restore the state of your Emacs between
sessions, using <code>tab-bar-mode</code> will result in all your Tabs being restored as
well.
</p>

<p>
I must admit that before writing this section, I was completely confused about
the Tab Bar and the <a href="#org117b049">Tab Line</a>.  So what <i>is</i> the difference between them?
</p>
<ul>
<li>There’s one Tab Bar per Frame, but there’s one Tab Line per Window</li>
<li>Each tab in the Tab Bar is a (fluid) named window configuration, whereas each
tab in the Tab Line is a Buffer that you’ve displayed in the current Window.</li>
</ul>
</div>
</div>
<div id="outline-container-org266ae82">
<h4 id="org266ae82">Tweaking Window Sizes</h4>
<div id="text-org266ae82">
<p>
Speaking of window configurations with precise layouts, well, how exactly do you
arrive at those precise window sizes?
</p>

<p>
Mouse users can just click and drag with mouse button 1 on a Mode Line to resize
a window in the vertical axis (that is, make a window taller or shorter), or on
the window divider line between two side-by-side windows to make a window
narrower or wider.  Of course, to make one window taller or wider, Emacs will
have to steal space from a neighboring window (because tiling).  And note that when
clicking in a Mode Line, you need to avoid clicking on any of the Mode Line
components that have their own response to mouse clicks—most printed text or
graphics in the Mode Line reacts to mouse clicks.  Find a spot (typically
blanks) where the mouse cursor changes to a double-headed arrow before clicking.
</p>

<p>
For us mouse avoiders, there are key bindings that achieve the same effects; see
Table <a href="#org45d779c">10</a>.
</p>

<table id="org45d779c">
<caption><span>Table 10:</span> Window Resizing Commands</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>C-x ^</code></td>
<td>make selected window one line taller</td>
</tr>

<tr>
<td><code>C-x }</code></td>
<td>make selected window one character wider</td>
</tr>

<tr>
<td><code>C-x {</code></td>
<td>make selected window one character narrower</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C-x -</code></td>
<td>shrink this window if its buffer doesn’t need so many lines</td>
</tr>

<tr>
<td><code>C-x +</code></td>
<td>make all windows the same height (balance windows)</td>
</tr>
</tbody>
</table>
<p>
The first three commands in Table <a href="#org45d779c">10</a> can take a positive numeric
argument \(N\) to operate \(N\) lines (or characters) at a time, and can take a
negative arg to operate in the opposite direction.  But fiddling with window
sizes is tricky and when you want to, say, make a window wider, usually a
precise number of characters doesn’t immediately jump to mind such that you
efficiently utter something like <code>C-u 17 C-x }</code>.  You really want to repeatedly
invoke <code>C-x }</code>, perhaps with your keyboard’s auto-repeat, until it looks exactly
right.  But these two-stroke bindings are <a href="#org38efd5c">infelicitous</a> and can’t be
autorepeated, so I recommend the following felicitous bindings (unassigned in a
stock Emacs) for your <a href="#org2af3730">Init File</a>:
</p>
<div>
<pre>(global-set-key (kbd <span>&#34;C-{&#34;</span>) &#39;shrink-window-horizontally)
(global-set-key (kbd <span>&#34;C-}&#34;</span>) &#39;enlarge-window-horizontally)
(global-set-key (kbd <span>&#34;C-^&#34;</span>) &#39;enlarge-window)
</pre>
</div>
<p>
The <code>windsize</code> package defines four mnemonic key bindings on the control-shifted
arrow keys which by default resize by 8 columns or 4 rows per keystroke; I
include these in the <a href="#org2af3730">Init File</a>:
</p>
<pre id="orgeed5152">(require &#39;windsize)
(windsize-default-keybindings)  # resize windows on C-S-&lt;left&gt; etc
</pre>
<p>
Finally,     <code>C-x -</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Change-Window"><code>shrink-window-if-larger-than-buffer</code></a>﻿) is very
handy when you’re working in a buffer that only has a few lines in it, but whose
Window eats up 50% of your screen real estate, and
    <code>C-x +</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Change-Window"><code>balance-windows</code></a>﻿) divides all the Frame-space evenly
between all the Windows.
</p>
</div>
</div>

<div id="outline-container-org57d5919">
<h4 id="org57d5919">Vertical Scrolling <a id="org7e57cd2"></a></h4>
<div id="text-org57d5919">
<p>
Even though there are often better ways to move, if you just need to move one
character forward, nothing beats     <code>C-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>forward-char</code></a>﻿) or
    <code>&lt;right&gt;</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>right-char</code></a>﻿).  On the other hand, if you know you
need to move <i>somewhere</i>, but don’t really know exactly where, nothing beats
scrolling for an overview of your text.
</p>

<p>
We’ve already met   <code>C-v</code>,   <code>M-v</code>, and
  <code>C-M-v</code> in <a href="#orga7c843b">an earlier chapter</a>, and you can of course also use the
scroll bars and the mouse wheel.
</p>

<p>
Remember that <i>moving</i> means “moving Point”, i.e. changing your position in the
buffer.  Strictly speaking, <i>scrolling</i> isn’t a way of moving Point: it’s a way of
adjusting the portion of the buffer’s text that’s visible in a window; but this
often has the <i>side-effect</i> of moving Point.
</p>

<p>
Here we have a 10-line window.  Imagine that the buffer is hundreds of lines
larger than the window.  The window line numbers are at the left, and the buffer
line numbers are to the right of them.
</p>

<p>
The word “FOO” is in the middle of buffer line 655, which happens to be shown in
window line 5 at the moment, and Point, indicated by <code>|</code>, is at the beginning of
“FOO”.  (Lines 650 and 661, and many more, are outside the window.)
</p>
<pre id="org4b9f520">       650   Lorem ipsum dolor sit amet, consectetuer adipiscing elit
+---------------------------------------------------------------------+
|  1 | 651 | Lorem ipsum dolor sit amet, consectetuer adipiscing elit |
|  2 | 652 | Lorem ipsum dolor sit amet, consectetuer adipiscing elit |
|  3 | 653 | Lorem ipsum dolor sit amet, consectetuer adipiscing elit |
|  4 | 654 | Lorem ipsum dolor sit amet, consectetuer adipiscing elit |
|  5 | 655 | Lorem ipsum dolor sit |FOO, consectetuer adipiscing elit |
|  6 | 656 | Lorem ipsum dolor sit  BAR, consectetuer adipiscing elit |
|  7 | 657 | Lorem ipsum dolor sit amet, consectetuer adipiscing elit |
|  8 | 658 | Lorem ipsum dolor sit amet, consectetuer adipiscing elit |
|  9 | 659 | Lorem ipsum dolor sit amet, consectetuer adipiscing elit |
| 10 | 660 | Lorem ipsum dolor sit amet, consectetuer adipiscing elit |
+---------------------------------------------------------------------+
       661   Lorem ipsum dolor sit amet, consectetuer adipiscing elit
</pre>
<p>
If we <i>scroll up</i> by 4 lines, say with <code>C-u 4 C-v</code>, the line with FOO will now be
displayed in window line 1; Point remains at the beginning of “FOO”.
</p>
<pre id="org0672857">       654   Lorem ipsum dolor sit amet, consectetuer adipiscing elit
+---------------------------------------------------------------------+
|  1 | 655 | Lorem ipsum dolor sit |FOO, consectetuer adipiscing elit |
|  2 | 656 | Lorem ipsum dolor sit  BAR, consectetuer adipiscing elit |
|  3 | 657 | Lorem ipsum dolor sit amet, consectetuer adipiscing elit |
|  4 | 658 | Lorem ipsum dolor sit amet, consectetuer adipiscing elit |
|  5 | 659 | Lorem ipsum dolor sit amet, consectetuer adipiscing elit |
|  6 | 660 | Lorem ipsum dolor sit amet, consectetuer adipiscing elit |
|  7 | 661 | Lorem ipsum dolor sit amet, consectetuer adipiscing elit |
|  8 | 662 | Lorem ipsum dolor sit amet, consectetuer adipiscing elit |
|  9 | 663 | Lorem ipsum dolor sit amet, consectetuer adipiscing elit |
| 10 | 664 | Lorem ipsum dolor sit amet, consectetuer adipiscing elit |
+---------------------------------------------------------------------+
       665   Lorem ipsum dolor sit amet, consectetuer adipiscing elit
</pre>
<p>
This is why Emacs calls <code>C-v</code> “<code>scroll-up-command</code>”, rather than “scroll-down”: the
buffer lines have moved <i>up</i> in the window.  It’s also true that more buffer lines
are suddenly visible at the bottom of the window (lines 661-664).
</p>

<p>
So scrolling isn’t really moving: the position of Point has not changed!
However, it is a rule that Point is <i>always</i> visible in the window, so if we were
to scroll up one more line, Point would <i>have</i> to move to remain in the window.
</p>

<p>
If we scroll by large amounts — bigger than the size of the window, say by a
screen-full at a time — then Point will be moving every time.  But the motion of
Point is really just a side-effect.
</p>

<p>
Conversely, if you move Point off the top or bottom of the window with a true
Point-moving command like     <code>C-p</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>previous-line</code></a>﻿) or
    <code>C-n</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>next-line</code></a>﻿), because Point must remain visible, Emacs
will scroll the window to achieve this!  By how much will it scroll?  The
default is to scroll Point to the center of the window, which I hate – I think
it makes scrolling jumpy and my eyes lose track of Point.
</p>

<p>
Different people simply don’t agree about these things, but Emacs being Emacs,
all aspects of scrolling can be fine-tuned with a variety of variables.  I use:
</p>
<div>
<pre>(<span>setq</span> scroll-conservatively 100000)
</pre>
</div>
<p>
The result of this (just trust me…) is that the window only scrolls by one
line if I move one line off the top or bottom.  (If you read the documentation
for that variable, the number will make sense.)
</p>
</div>
</div>
<div id="outline-container-orga27f788">
<h4 id="orga27f788">Where in the Window is Point?</h4>
<div id="text-orga27f788">
<p>
Sometimes you want Point to stay where it is in the buffer (in front of some
given word, perhaps), but you want it to be on some other window-line.  If Point
is on the bottom line of the window, you might want to center it so that you can
see as many lines before and after it as possible.
</p>

<p>
You can do that by fiddling with numeric arguments for <code>C-v</code> and <code>M-v</code>, but as usual
there are commands to make that easier.      <code>C-l</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Recentering"><code>recenter-top-bottom</code></a>﻿) will scroll the window so that Point is in the center
line; immediately repeating <code>C-l</code> will scroll Point’s line to be at the top of the
window; one more <code>C-l</code> scrolls it to the bottom; yet one more starts the cycle
over<sup><a id="fnr.116" href="#fn.116" role="doc-backlink">116</a></sup>.  I use this command constantly; so much nicer than vaguely yanking
the scroll bar.
</p>

<p>
Conversely<sup><a id="fnr.117" href="#fn.117" role="doc-backlink">117</a></sup>, you might want to really move Point to a particular,
different, window line, without scrolling the lines at all.
    <code>M-r</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>move-to-window-line-top-bottom</code></a>﻿) does that, and it
cycles through the same positions that <code>C-l</code> does when you repeat it; first Point
jumps to the line at the center, then the top and finally the bottom: the
visible lines remain the same, in the same positions.
</p>

<p>
These are easy to understand if you just try them out: pull up some text that’s
significantly bigger than your window (    <code>C-h C-c</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Help-Files"><code>describe-copying</code></a>﻿) will probably do), scroll a few screenfulls in with two
or three <code>C-v</code>’s, and then type several <code>C-l</code>’s in a row until you get the idea.
Now do the same with a sequence of <code>M-r</code>’s.
</p>

<p>
Finally, new to me as I write this paragraph in 2021<sup><a id="fnr.118" href="#fn.118" role="doc-backlink">118</a></sup> is     <code>C-M-l</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Recentering"><code>reposition-window</code></a>﻿), which recenters the window heuristically, trying to
bring useful information into the window, like a complete paragraph or a
complete function definition.
</p>
</div>
</div>
<div id="outline-container-orge230032">
<h4 id="orge230032">The Display of Lines <a id="org818c35e"></a></h4>
<p>
While the size of a Buffer is effectively unlimited
(2.3 exabytes), the size of a
Window definitely is <i>not</i>.  It depends on the resolution of your display, your
chosen font size, the current size of your <a href="#org4dd50c2">Frame</a>, and the sizes of any other
windows in that Frame.  <a href="#org7e57cd2">Scrolling</a> copes well for buffers with many more lines
than the window has room for, but (in my opinion) is basically awful for lines
longer than the window is wide.
</p>
<div id="outline-container-org866cae3">
<h5 id="org866cae3">Continuation Lines</h5>
<div id="text-org866cae3">
<p>
By default, horizontal scrolling is completely avoided by virtue of <i>continuation
lines</i>.  When the actual length of a line in a buffer—i.e., the number of
characters between the beginning of the line and a <a href="#org020c947">newline character</a>—is longer
than the window width, Emacs displays it <i>wrapped</i> on as many window lines as it requires.
So there are two kinds of lines: actual lines (determined by the content of the
buffer), which Emacs calls <i>logical lines</i>, and the <i>screen lines</i> needed to display
the logical line in full.  Any extra screen lines needed for this are called
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Continuation-Lines"><i>continuation lines</i></a>.
</p>

<p>
Continuation lines imply some ambiguity: the additional screen
line-breaks would masquerade as actual newlines in the buffer text.  To solve this
problem, the continuation line-breaks are indicated by bent arrows in the right
and left <a href="#org2f7933b">Fringes</a> of the window<sup><a id="fnr.119" href="#fn.119" role="doc-backlink">119</a></sup>; if you have
  <code>linum-mode</code> turned on, you’ll note that the continuation
lines don’t get line numbers; see Figure <a href="#org91df4e7">16</a>.
</p>

<div id="org91df4e7">
<p><a href="https:./images/continuation-lines.png" alt="Continuation Lines" title="Continuation Lines" width="100%"><img src="https://blog.veitheller.de/images/continuation-lines.png" alt="Continuation Lines" title="Continuation Lines" width="100%"/></a>
</p>
<p><span>Figure 16: </span>Continuation Lines</p>
</div>

<p>
All the line-motion commands work in terms of logical lines, so
getting to the last word in a logical line continued into many screen lines (say
from the cursor in Figure <a href="#org91df4e7">16</a> to the word “estates”) requires
using <i>horizontal</i> motion commands (or, of course, <a href="#org3ffa52a">Incremental Search</a>).
</p>
</div>
</div>
<div id="outline-container-org203b928">
<h5 id="org203b928">Line Truncation</h5>
<div id="text-org203b928">
<p>
The occasional continuation line is no hardship, and if you have many, it may
be because your window is only temporarily too skinny and will soon be
wider.  But when <i>every</i> line in the buffer is too long to fit (as in Figure
<a href="#org91df4e7">16</a>), it can really be annoying.  I use a <a href="https://en.wikipedia.org/wiki/Tiling_window_manager">tiling window manager</a>
and as result, my Emacs frame can often be somewhat narrow, and Emacs itself
tiles its windows, so every     <code>C-x 3</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Split-Window"><code>split-window-right</code></a>﻿) can
mean more continuation lines.  What to do?
</p>

<p>
My solution is to use <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Line-Truncation"><i>line truncation</i></a>
instead of continuation lines, via this <a href="#org2af3730">Init File</a> snippet:
</p>
<div>
<pre>(<span>setq-default</span> truncate-lines t)         <span>; </span><span>good for tiling window managers</span>
</pre>
</div>
<p>
With this setting, there are no continuation lines: the line is (visually)
truncated at the right-hand window boundary and the right fringe shows a
right-pointing arrow to indicate that there’s more of the logical line off to
the right.  This avoids the disconcerting continuation lines, but at the cost of
horizontal scrolling.
</p>

<p>
Since I hinted that I hate horizontal scrolling (especially yanking back and
forth on a horizontal scroll bar), this may sound like a
counterintuitive choice, but of course, if you simply move Point into the
off-screen part of a truncated line, Emacs scrolls automatically; remember,
Point is <i>always</i> visible in the Window, so this means anything that moves Point,
like searching, causes automatic horizontal scrolling as needed.
</p>

<p>
Still, even automatic horizontal scrolling can be annoying, but thanks to <a href="#orgc6b43c3">Winner
Mode</a>, which lets me use     <code>C-x 1</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Change-Window"><code>delete-other-windows</code></a>﻿) to get a
wide window and with one keystroke restore my previous window configuration,
<code>truncated-lines</code> work for me.<sup><a id="fnr.120" href="#fn.120" role="doc-backlink">120</a></sup> See Figure <a href="#org9bf1cef">17</a> (and notice
how many more (partial) lines are visible).
</p>

<div id="org9bf1cef">
<p><a href="https:./images/truncated-lines.png" alt="Truncated Lines" title="Truncated Lines" width="100%"><img src="https://blog.veitheller.de/images/truncated-lines.png" alt="Truncated Lines" title="Truncated Lines" width="100%"/></a>
</p>
<p><span>Figure 17: </span>Truncated Lines</p>
</div>

<p>
You probably don’t want truncated lines as a global default the way I have it,
but you can switch any window back and forth between continuation and truncated
with   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Line-Truncation"><code>toggle-truncate-lines</code></a>﻿.
</p>
</div>
</div>
<div id="outline-container-org869de6f">
<h5 id="org869de6f">Visual Line Mode</h5>
<div id="text-org869de6f">
<p>
Neither truncated lines nor continuation lines are suitable for actually working
with (i.e., editing or reading) the modern style of <a href="#org020c947">single-line paragraphs</a>, or
any other bunch of really long lines.  For this purpose, you want
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visual-Line-Mode"><i>Visual Line Mode</i></a>.
</p>

<p>
Visual Line Mode wraps your lines into continuation lines <i>at word boundaries</i>,
exactly the way your phone does it; Emacs inserts no indication of wrapped lines
at the fringes (though   <code>linum-mode</code> still gives it away).
</p>

<p>
Let’s pretend my copy of <i>War and Peace</i> is formatted with single-line paragraphs.
In Visual Line Mode it would look like Figure <a href="#org52186f1">18</a>.
</p>

<div id="org52186f1">
<p><a href="https:./images/visual-line-mode.png" alt="Visual Line Mode" title="Visual Line Mode" width="100%"><img src="https://blog.veitheller.de/images/visual-line-mode.png" alt="Visual Line Mode" title="Visual Line Mode" width="100%"/></a>
</p>
<p><span>Figure 18: </span>Visual Line Mode</p>
</div>

<p>
The biggest difference is that in Visual Line Mode, the vertical line motion
commands (like     <code>C-n</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>next-line</code></a>﻿) and
    <code>C-p</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>previous-line</code></a>﻿)) move by screen lines, rather than
logical lines.  So this is definitely the natural way to work with single-line
paragraphs.
</p>

<p>
You can use   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visual-Line-Mode"><code>visual-line-mode</code></a>﻿ to switch in and out of this
mode in any window, and if, unlike me, most of your files are structured as
single-line paragraphs, you can make it your default everywhere with this <a href="#org2af3730">Init
File</a> snippet:
</p>

<div>
<pre>(global-visual-line-mode +1)            <span>; </span><span>single-line paragraphs rule</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8445994">
<h5 id="org8445994">The Horizontal Scroll Bar: the Last Resort?</h5>
<div id="text-org8445994">
<p>
With truncated lines, sometimes you actually <i>do</i> need to scroll horizontally.  In
a graphical-mode Emacs, you may have a horizontal scroll bar, which is certainly
one way to do it.  If you don’t have a horizontal scroll bar and you <i>want</i> one,
you can turn it on and off in the current window with
  <code>M-x</code> <code>toggle-horizontal-scroll-bar</code>, or make it a global default with
this <a href="#org2af3730">Init File</a> snippet:
</p>
<div>
<pre>(horizontal-scroll-bar-mode +1)
</pre>
</div>
<p>
You can also scroll horizontally with     <code>C-x &gt;</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Horizontal-Scrolling"><code>scroll-right</code></a>﻿)
and     <code>C-x &lt;</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Horizontal-Scrolling"><code>scroll-left</code></a>﻿), which are the keyboard equivalents
of yanking on the horizontal scroll bar.  By default each invocation scrolls by
the window’s width (with a slight overlap), but of course they take a numeric
argument; multiple <code>C-u</code>’s are useful here.  Naturally you can also change the
default scroll units.
</p>

<p>
The defaults are very <a href="#org38efd5c">infelicitous</a> bindings so I recommend adding this to your
<a href="#org2af3730">Init File</a> and using these instead.
</p>
<div>
<pre>(global-set-key (kbd <span>&#34;C-&lt;&#34;</span>) &#39;scroll-left)
(global-set-key (kbd <span>&#34;C-&gt;&#34;</span>) &#39;scroll-right)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgff9fb74">
<h4 id="orgff9fb74">The Header Line <a id="orgbe2bf62"></a></h4>
<p>
A Window can optionally display a <i>Header Line</i> at the top which is rather like an
additional <a href="#org6456ffd">Mode Line</a>.  Header lines are generally created by certain <a href="#org5b21ef0">Major Modes</a>
and the most common use is to display headers for column-oriented data.  Try
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/List-Buffers"><code>list-buffers</code></a>﻿ to see one in action; like most columnized Header
Lines, you can usually sort the columns by mouse-clicking in the Header.  The
Header is really a display of the contents of the <a href="#org871902b">Buffer-Local Variable</a>
  <code>header-line-format</code>; it’s in no way part of the window’s
Buffer’s text.
</p>
</div>
<div id="outline-container-orgf8a70bd">
<h4 id="orgf8a70bd">The Fringes <a id="org2f7933b"></a></h4>
<div id="text-orgf8a70bd">
<p>
The left and right <i>Fringes</i> are very narrow areas of the window mainly used to
display graphical indicators that are matched to window lines, most commonly
continuation lines and truncated lines (see <a href="#org818c35e"><i>The Display of Lines</i></a>), but also
<i>buffer boundaries</i> that eliminate the ambiguity of the presence of blank lines at
the end of a buffer (see
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Displaying-Boundaries"><i>Displaying Boundaries</i></a> and
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Useless-Whitespace">“Useless Whitespace”</a> in the <i>Emacs</i> manual); to indicate added and deleted lines in
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Diff-Mode"><code>diff-mode</code></a>﻿; and in the special modes for running debuggers
for various programming languages (including, of course, Elisp).
</p>

<p>
If you’d like a see a Fringe in action, try making a new buffer (<code>C-x b
newbuffer</code>), make it the only window in the Frame (<code>C-x 1</code>), and type in one line
of text.  Note all the blank screen lines after your single logical line.  How
do you know those screen lines aren’t actual empty lines in the Buffer
(consisting of many blanks and/or newlines)?  Now say:
</p>
<pre>M-x set-variable RET indicate-empty-lines RET t RET
</pre>

<p>
You should see a change in the left Fringe.  Now actually add a few empty lines
at the end of the Buffer by hitting <code>RET</code> a few times: note how the Fringe makes
clear which lines are really in the Buffer and which are just an artifact of the
display.
</p>
</div>
</div>
<div id="outline-container-org657906c">
<h4 id="org657906c">Follow Mode <a id="orgeccadfd"></a></h4>
<div id="text-org657906c">
<p>
If you have a very wide, high-resolution display, it may seem like you’re
wasting screen real estate when you’re editing a buffer whose lines are
significantly shorter than its window’s width: much of the right-hand side of
the window will just be blank space.  The Unix system dictionary
file---<code>/usr/share/dict/words</code> on my machine—is a particularly skinny example,
since each of its 123,985 lines is a
single word; see Figure <a href="#org3cedf75">19</a>.
</p>

<div id="org3cedf75">
<p><a href="https:./images/wasted-space.png" alt="The Tragedy of Wasted Screen Real Estate" title="The Tragedy of Wasted Screen Real Estate" width="100%"><img src="https://blog.veitheller.de/images/wasted-space.png" alt="The Tragedy of Wasted Screen Real Estate" title="The Tragedy of Wasted Screen Real Estate" width="100%"/></a>
</p>
<p><span>Figure 19: </span>The Tragedy of Wasted Screen Real Estate</p>
</div>

<p>
<i>Follow Mode</i> lets you exploit this empty space to show more lines of your Buffer.  Just
say   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Follow-Mode"><code>follow-mode</code></a>﻿ and now split your Window with
    <code>C-x 3</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Split-Window"><code>split-window-right</code></a>﻿).  Normally, after <code>C-x 3</code>, the new
window initially shows exactly the same text as the old window: the top screen line of
the old window is the top screen line of the new window.  But when Follow Mode
is active, the top line of the new window is the <i>line after the bottom line of
the old window</i>: it’s as if the two windows comprise a single virtual window that’s
twice as tall as the original.  Another <code>C-x 3</code> gives you a virtual window that’s
<i>three</i> times as tall.  You can have as many splits as make sense, given the
lengths of your logical lines.  Figure <a href="#orgfac6c19">20</a> shows the same file after six
<code>C-x 3</code>’s; I’ve turned on   <code>linum-mode</code> to show how the screen
lines are related to the Buffer’s logical lines.
</p>

<div id="orgfac6c19">
<p><a href="https:./images/follow-mode.png" alt="Follow Mode" title="Follow Mode" width="100%"><img src="https://blog.veitheller.de/images/follow-mode.png" alt="Follow Mode" title="Follow Mode" width="100%"/></a>
</p>
<p><span>Figure 20: </span>Follow Mode</p>
</div>

<p>
Follow Mode isn’t just a trick to initialize the positions of the lines in the
windows!  If you move Point off the bottom of one window with some invocations
of     <code>C-n</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>next-line</code></a>﻿), the cursor will appear at the <i>top</i> of the
next window.  If you search for a word that’s visible in one of the other
windows, Point (and the cursor) will just jump there without scrolling any of
the windows.  And if you <i>do</i> scroll, all the other windows scroll in lock-step to
maintain the tall virtual window effect.  You can delete windows and re-split
them at will, and you can have     <code>C-x 2</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Split-Window"><code>split-window-below</code></a>﻿)
splits with different Buffers in the same Frame; Follow Mode will keep all the
windows that are displaying the same buffer in sync.
</p>

<p>
<a id="orgb65dcb8"></a>
There’s a related <a href="#org29e5e5d">Minor Mode</a>,   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Compilation-Mode"><code>next-error-follow-minor-mode</code></a>﻿,
which is typically bound to a keystroke in modes like
  <code>grep-mode</code>,   <code>occur-mode</code>,
  <code>compilation-mode</code>, and the like, which makes motion in the
hits Buffer cause automatic scrolling in the associated target Buffer.
</p>
</div>
</div>
<div id="outline-container-org6c5ec86">
<h4 id="org6c5ec86">Scrolling Many Different Buffers at Once</h4>
<p>
This style of lock-step scrolling can be useful with <i>different</i> Buffers displayed
in separate windows, too.  Suppose you have two Buffers with related data: the
information on line \(N\) of the first Buffer is related to that on line \(N\) of
the second Buffer, and so on.  You can display these two Buffers side by side,
with their lines lined-up, but if you scroll one of them, now you’re out of
sync.    <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Window-Convenience"><code>scroll-all-mode</code></a>﻿ will synchronize all the windows in the
Frame as you scroll one of them.
</p>
</div>
</div>
<div id="outline-container-org9f7e44e">
<h3 id="org9f7e44e">The Mode Line in Detail <a id="org6456ffd"></a></h3>
<div id="text-org9f7e44e">

<div id="org87bc560">
<p><a href="https:images/modeline.png" alt="The Mode Line" title="The Mode Line" width="100%"><img src="https://blog.veitheller.de/images/modeline.png" alt="The Mode Line" title="The Mode Line" width="100%"/></a>
</p>
<p><span>Figure 21: </span>The Mode Line</p>
</div>

<p>
Every <a href="#org9409b46">Window</a> has a <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Mode-Line">Mode Line</a> at its lower
edge<sup><a id="fnr.121" href="#fn.121" role="doc-backlink">121</a></sup>.  If your <a href="#org4dd50c2">Frame</a> only has one Window, its Mode Line is above the Frame’s
<a href="#org7e7133f">Echo Area</a>. The Mode Line displays dynamic information about the Window’s
<a href="#orgc3260f6">Buffer</a>—the Buffer name, its <a href="#org5b21ef0">Major Mode</a>, and more: some of this info is shown
in a terse and even cryptic form.
</p>

<p>
The Mode Line is completely customizable, but out of the box it has the
following main components:<sup><a id="fnr.122" href="#fn.122" role="doc-backlink">122</a></sup>
</p>
<pre>U:@**-  *scratch*    All L1   Hg:94daf  (ELisp ElDoc)
CEFBB-     BUF       POS LINE    VC     (MAJOR MINOR ...)
</pre>

<dl>
<dt><i>C</i></dt><dd>a terse indication of the Buffer’s <a href="#org2733d30"><i>Coding System</i></a> or <a href="https://en.wikipedia.org/wiki/Character_encoding">character set</a></dd>
<dt><i>E</i></dt><dd>the Buffer’s end-of-line convention</dd>
<dt><i>F</i></dt><dd>an <code>@</code> if this is a <a href="#org22671bb">client frame</a></dd>
<dt><i>B</i></dt><dd>the Buffer’s state relative to the file on disk (if it’s <a href="#org41c8a78">visiting</a> a file)</dd>
<dt><i>BUF</i></dt><dd>the Buffer’s name (which is typically also the name of the file it’s
visiting, if any)</dd>
<dt><i>POS</i></dt><dd>the position of the visible Window text vis à vis the Buffer text</dd>
<dt><i>LINE</i></dt><dd>the number of the line Point is in</dd>
<dt><i>VC</i></dt><dd>the Version Control state (if the Buffer is visiting a file under
Version Control)</dd>
<dt><i>MAJOR</i></dt><dd>the Buffer’s Major Mode</dd>
<dt><i>MINOR</i></dt><dd>(some of) the Buffer’s Minor Modes</dd>
</dl>
</div>

<div id="outline-container-org4afe067">
<h4 id="org4afe067"><i>C</i> — Coding Systems</h4>
<div id="text-org4afe067">
<p>
There are about 50 single-character values indicating the most common Coding
Systems that can appear in the <i>C</i> column.  Here are a few of them; how likely you
are to see any of these depends on where you live, what language you speak, and
the kind of files you edit.  The real way to learn a Buffer’s encoding is to
execute   <code>M-x</code> <code>describe-current-coding-system</code> in the Buffer.
</p>
<table>


<colgroup>
<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td><code>U</code></td>
<td>various Unicode UTF encodings</td>
</tr>

<tr>
<td><code>1</code></td>
<td>ISO Latin-1</td>
</tr>

<tr>
<td><code>-</code></td>
<td>US ASCII</td>
</tr>

<tr>
<td><code>=</code></td>
<td>raw, unencoded (binary) data</td>
</tr>

<tr>
<td><code>*</code></td>
<td>Windows 1250</td>
</tr>

<tr>
<td><code>D</code></td>
<td>various DOS code pages</td>
</tr>

<tr>
<td><code>c</code></td>
<td>Chinese GB2312</td>
</tr>

<tr>
<td><code>B</code></td>
<td>Chinese BIG5</td>
</tr>

<tr>
<td><code>J</code></td>
<td>Japanese</td>
</tr>

<tr>
<td><code>K</code></td>
<td>Korean</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgfe22524">
<h4 id="orgfe22524"><i>E</i> — End-of-Line Encodings</h4>
<div id="text-orgfe22524">
<p>
This can be a single character if the Buffer’s end-of-line encoding is the
normal one for your operating system, or else a word in parentheses.
</p>
<table>


<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td><code>:</code></td>
<td><code>(Unix)</code></td>
<td>Unix newlines (line-feeds)</td>
</tr>

<tr>
<td><code>\</code></td>
<td><code>(DOS)</code></td>
<td>MS-DOS (Windows) CRLFs</td>
</tr>

<tr>
<td><code>/</code></td>
<td><code>(Mac)</code></td>
<td>Old Macintosh carriage returns</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org3e6a01c">
<h4 id="org3e6a01c"><i>F</i> — Client Frame Indicator</h4>
<p>
If there is an <code>@</code> in this position it indicates that this Frame was created by
the Emacsclient (and so this Emacs is necessarily an Emacs Server); see <a href="#org22671bb"><i>Client / Server</i></a>.
</p>
</div>
<div id="outline-container-org1eb78f8">
<h4 id="org1eb78f8"><i>B</i> — Buffer State</h4>
<div id="text-org1eb78f8">
<p>
This indicates the Window’s Buffer’s state versus the file it’s visiting, if any.
</p>
<table>


<colgroup>
<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td><code>--</code></td>
<td>Buffer unmodified</td>
</tr>

<tr>
<td><code>**</code></td>
<td>Buffer modified</td>
</tr>

<tr>
<td><code>%%</code></td>
<td>Buffer read-only and unmodified</td>
</tr>

<tr>
<td><code>%*</code></td>
<td>Buffer read-only and modified</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org0e126af">
<h4 id="org0e126af"><i>BUF</i> — Buffer Name</h4>
<p>
This is simply the <a href="#org147636d">Buffer name</a>, which for file-visiting Buffers is usually the
basename of the file, possibly modified for disambiguation.
</p>
</div>
<div id="outline-container-orgcb13fb6">
<h4 id="orgcb13fb6"><i>POS</i> — Visible Text Position</h4>
<div id="text-orgcb13fb6">
<p>
This is a hint of how much of the Buffer is visible in the Window.
</p>
<table>


<colgroup>
<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td><code>Top</code></td>
<td>Beginning of Buffer is visible</td>
</tr>

<tr>
<td><code>Bot</code></td>
<td>End of Buffer is visible</td>
</tr>

<tr>
<td><code>All</code></td>
<td>All of Buffer is visible</td>
</tr>

<tr>
<td><code>NN%</code></td>
<td><i>NN</i> percent of Buffer precedes visible portion</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org340ca86">
<h4 id="org340ca86"><i>LINE</i> — Point’s Line Number</h4>
<p>
Self-explanatory.
</p>
</div>
<div id="outline-container-orgdf69c3a">
<h4 id="orgdf69c3a"><i>VC</i> — Version Control State <a id="orgbcb8372"></a></h4>
<div id="text-orgdf69c3a">
<p>
If the Buffer’s file is under <a href="#org53af7eb">Version Control</a> (<i>VC</i>), the Mode Line will indicate
the file’s VC  state in the form: <i>BE-ID</i> (for example, <code>Hg:94daf</code>):
</p>
<dl>
<dt><i>BE</i></dt><dd>the (abbreviated) name of the VC back-end</dd>
<dt><i>-</i> </dt><dd>the status of the file, indicated by a single character</dd>
<dt><i>ID</i></dt><dd>the version number (or version identifier) of the file</dd>
</dl>

<p>
For the possible values of <i>BE</i>, see the list of version control systems (<i>VCS</i>’s)
in <a href="#org070049c"><i>Version Control</i></a>.  <i>ID</i> is whatever your system uses to identify a version
number; for RCS it might look like <code>1.22</code> whereas for a distributed VCS like
Mercurial or Git it will probably be a hexadecimal number like <code>94daf</code>.
</p>

<p>
The <i>:</i> can actually be any of the following status indicators:
</p>
<table>


<colgroup>
<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td><code>-</code></td>
<td>file is unmodified (or unlocked)</td>
</tr>

<tr>
<td><code>:</code></td>
<td>file is modified (or locked)</td>
</tr>

<tr>
<td><code>!</code></td>
<td>file contains merge conflicts or was removed from VC</td>
</tr>

<tr>
<td><code>?</code></td>
<td>file is in VC but missing from the working directory</td>
</tr>

<tr>
<td><code>@</code></td>
<td>file was added locally but is not committed</td>
</tr>
</tbody>
</table>
<p>
Note that in an old-fashioned lock-based VCS (like RCS), a username may also be
present---<i>e.g.</i>, <code>RCS:jim:1.3</code>—indicating that user <code>jim</code> has the file locked.
</p>
</div>
</div>
<div id="outline-container-org3f6cab7">
<h4 id="org3f6cab7"><i>MAJOR</i> — Major Mode Name</h4>
<p>
The name of the Buffer’s Major Mode, with the <code>-mode</code> elided, so e.g. <code>Fundamental</code>
for <code>fundamental-mode</code>, <code>Org</code> for <code>org-mode</code>.
</p>
</div>
<div id="outline-container-org9e78b85">
<h4 id="org9e78b85"><i>MINOR</i> — Minor Modes</h4>
<p>
This is a space-separated list of strings, called “indicators” or “lighters”,
identifying enabled Minor Modes.  Unlike the Major Mode indicator, these are
optional: a given Minor Mode may choose to use a very abbreviated indicator, or
none at all.  So many Minor Modes are typically in use that many of the ones
that are enabled by default—e.g.   <code>auto-encryption-mode</code>,
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Compressed-Files"><code>auto-compression-mode</code></a>﻿—use no indicator just to save space
in the Mode Line.
</p>
</div>
<div id="outline-container-org4c1a662">
<h4 id="org4c1a662">The Mode Line and the Mouse</h4>
<div id="text-org4c1a662">
<p>
The Mode Line, being one of the few things in Emacs that’s inaccessible to the
keyboard, has a small number of mouse bindings.  They come in two flavors:
</p>
<ol>
<li>mouse clicks on Mode Line text (or images) (e.g. the Buffer name, a Mode
indicator, the Coding System character (class <i>C</i> above)), and</li>
<li>mouse clicks in any of the blank space between the textual elements; these
clicks allow you to select, resize, or delete windows.</li>
</ol>

<p>
Taking the latter category first, we have the following:
</p>
<table>


<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Mouse Button</th>
<th scope="col">Mouse Action</th>
<th scope="col">Effect</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mouse-1</code></td>
<td>click</td>
<td>select the Mode Line’s Window</td>
</tr>

<tr>
<td> </td>
<td>drag</td>
<td>resize Windows vertically</td>
</tr>

<tr>
<td><code>mouse-2</code></td>
<td>click</td>
<td>like <code>C-x 1</code> in the Mode Line’s Window</td>
</tr>

<tr>
<td><code>C-mouse-2</code></td>
<td>click</td>
<td>like <code>C-x 3</code> in the Mode Line’s Window</td>
</tr>

<tr>
<td><code>mouse-3</code></td>
<td>click</td>
<td>like <code>C-x 0</code> in the Mode Line’s Window</td>
</tr>
</tbody>
</table>

<p>
As for mouse clicks in the textual or graphical elements, they vary to suit: just hover the
mouse over the element and, in the Echo Area, you’ll see a brief description of
the element and what various clicks will do.
</p>
</div>
</div>
<div id="outline-container-orga9b8918">
<h4 id="orga9b8918">Optional Mode Line Features <a id="org3384d09"></a></h4>
<div id="text-orga9b8918">
<p>
There are several optional Mode Line features that you can turn on, and you can
customize the appearance with a variety of formats and <a href="#orgb1883e1">Faces</a>.  The best way to
do this is via   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-group</code></a>﻿ <code>RET mode-line</code>.
</p>
<dl>
<dt>  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Optional-Mode-Line"><code>size-indication-mode</code></a>﻿</dt><dd>displays the total size of the
Buffer after <i>POS</i>, in a form like <code>74% of 712k</code>.</dd>
<dt>  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Optional-Mode-Line"><code>column-number-mode</code></a>﻿</dt><dd>displays Point’s column number next
to the line number</dd>
<dt>  <code>display-time-mode</code></dt><dd>displays the current time, <a href="https://en.wikipedia.org/wiki/Load_(computing)">load
average</a>, and an indicator when you have new mail.<sup><a id="fnr.123" href="#fn.123" role="doc-backlink">123</a></sup></dd>
<dt>  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Optional-Mode-Line"><code>display-battery-mode</code></a>﻿</dt><dd>displays the percentage remaining
of your laptop’s battery charge.</dd>
</dl>

<p>
There are also at least 56
<a href="#orgc96889a">third-party packages</a> to enhance your Mode Line, including popular theming to
make your Emacs look a little less Emacs-like.
</p>
</div>
</div>
</div>
<div id="outline-container-org5cc0ca4">
<h3 id="org5cc0ca4">Frames <a id="org4dd50c2"></a> <a id="orgc82eded"></a></h3>
<div id="text-org5cc0ca4">

<div id="org2786e14">
<p><img src="https://blog.veitheller.de/images/data-structures.png" alt="data-structures.png" width="100%"/>
</p>
<p><span>Figure 22: </span>Emacs Data Structures</p>
</div>
<p>
<b>Legend:</b>
</p>
<table>


<colgroup>
<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td>*</td>
<td>One or more</td>
</tr>

<tr>
<td>1</td>
<td>Exactly one</td>
</tr>

<tr>
<td>1?</td>
<td>One or none</td>
</tr>
</tbody>
</table>

<p>
When you fire up Emacs, a new “window” pops up: not an Emacs <a href="#org9409b46">Window</a>, but
an operating system or desktop window.  Earlier I mentioned that, since Emacs
had multiple windows two years before Graphical User Interfaces were
commercially available, it needed a new term for this object: a <i>Frame</i>.
</p>

<p>
A Frame consists of at least one <a href="#org9409b46">Window</a>, and has a Menu Bar, Tool Bar, Scroll
Bars (vertical and horizontal)<sup><a id="fnr.124" href="#fn.124" role="doc-backlink">124</a></sup>, and an <a href="#org7e7133f">Echo Area</a>, as in Figure <a href="#orgea5162a">23</a>.
</p>


<div id="orgea5162a">
<p><a href="https:./images/frame.png" alt="A Frame with Two Windows" title="A Frame with Two Windows" width="100%"><img src="https://blog.veitheller.de/images/frame.png" alt="A Frame with Two Windows" title="A Frame with Two Windows" width="100%"/></a>
</p>
<p><span>Figure 23: </span>A Frame with Two Windows</p>
</div>

<p>
You can create as many additional Frames as you like, and use them as another
way to organize your work, as you can with the <a href="#orgc6b43c3">Tab Bar</a> for example.
</p>

<p>
You can of course delete any Frames you create; deleting a Frame <i>does</i> necessarily
delete all the Windows in it, but as usual in no way kills the Buffers in those
Windows.  Deleting the last and only Frame is the same thing as exiting Emacs
with     <code>C-x C-c</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Exiting"><code>save-buffers-kill-terminal</code></a>﻿);<sup><a id="fnr.125" href="#fn.125" role="doc-backlink">125</a></sup> as always, Emacs
will ask for confirmation if you have any unsaved Files.
</p>
</div>
<div id="outline-container-orgf9e2ed2">
<h4 id="orgf9e2ed2">Frame Commands</h4>
<div id="text-orgf9e2ed2">
<p>
The main commands for working with Frames are all on the <code>C-x 5</code> prefix (see Table
<a href="#org9433a85">11</a>); they’re completely analogous to the <code>C-x 4</code> family
of <a href="#orgf6ece5b">Other Window</a> commands: where a <code>C-x 4</code> command is a shortcut to something in
another Window, the corresponding <code>C-x 5</code> command does the same thing in a new
Frame.
</p>
<table id="org9433a85">
<caption><span>Table 11:</span> Frame Manipulation Commands</caption>

<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Type</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>C-x 5 2</code></td>
<td>Create</td>
<td>create a 2nd Frame</td>
</tr>

<tr>
<td><code>C-x 5 C-f</code></td>
<td> </td>
<td>Find a file in a new Frame</td>
</tr>

<tr>
<td><code>C-x 5 f</code></td>
<td> </td>
<td>… the same</td>
</tr>

<tr>
<td><code>C-x 5 r</code></td>
<td> </td>
<td>… the same, but read-only</td>
</tr>

<tr>
<td><code>C-x 5 b</code></td>
<td> </td>
<td>switch to a Buffer in a new Frame</td>
</tr>

<tr>
<td><code>C-x 5 C-o</code></td>
<td> </td>
<td>Open a buffer in another frame</td>
</tr>

<tr>
<td><code>C-x 5 m</code></td>
<td> </td>
<td>compose an eMail in another Frame</td>
</tr>

<tr>
<td><code>C-x 5 d</code></td>
<td> </td>
<td>open a Dired in another Frame</td>
</tr>

<tr>
<td><code>C-x 5 .</code></td>
<td> </td>
<td><a href="#orgdd5fd7e">find the definition</a> of the identifier at Point</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C-x 5 0</code></td>
<td>Delete</td>
<td>zero-out (delete) the current Frame</td>
</tr>

<tr>
<td><code>C-x 5 1</code></td>
<td> </td>
<td>make the current Frame the 1 and only Frame</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C-x 5 o</code></td>
<td>Switch</td>
<td>switch to the Other Frame</td>
</tr>
</tbody>
</table>
<p>
The fundamental Frame-creation command is
    <code>C-x 5 2</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Creating-Frames"><code>make-frame-command</code></a>﻿) (mnemonic: makes a 2nd Frame);
you can also make a new Frame initialized with some file, Buffer, or the like.
</p>

<p>
    <code>C-x 5 0</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Frame-Commands"><code>delete-frame</code></a>﻿) deletes the current Frame; as
mentioned above, if the current Frame is the <i>only</i> Frame, this is equivalent to
exiting Emacs.      <code>C-x 5 1</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Frame-Commands"><code>delete-other-frames</code></a>﻿) deletes
all your Frames <i>except</i> for the current one.  These two commands are analogous
to     <code>C-x 0</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Change-Window"><code>delete-window</code></a>﻿) and
    <code>C-x 1</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Change-Window"><code>delete-other-windows</code></a>﻿).
</p>

<p>
Finally,     <code>C-x 5 o</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Frame-Commands"><code>other-frame</code></a>﻿) is like
    <code>C-x o</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Window"><code>other-window</code></a>﻿), but it always switches to another
Window in a Frame other than the current one (so it has no effect if you only
have one Frame).  If you repeat this command, it cycles through all the Frames
you have open.  Note that Emacs has to delegate this action to your window
manager (WM) or operating system (the WM is in charge!), so you may have to
tweak your WM or Emacs itself to make this work the way you want; see
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Frame-Commands">“Frame Commands”</a> in the <i>Emacs</i> manual for details.
</p>
</div>
</div>
<div id="outline-container-org4601457">
<h4 id="org4601457">Frames and Monitors</h4>
<p>
Some lucky people have more than one <a href="https://en.wikipedia.org/wiki/Computer_monitor">monitor</a> connected to their desktop computer
(especially in an office situation).  You can pop up a Frame on a particular
monitor with   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Multiple-Displays"><code>make-frame-on-monitor</code></a>﻿; you’ll be able to use
<a href="#org75fb6a2">Completion</a> on whatever monitor names your operating system has assigned.<sup><a id="fnr.126" href="#fn.126" role="doc-backlink">126</a></sup>
</p>
</div>
<div id="outline-container-orgb17b652">
<h4 id="orgb17b652">Controlling Graphical Window Elements</h4>
<div id="text-orgb17b652">
<p>
Some people find the various GUI elements of Frames to be an annoyance.  While I
recommend that you exploit the Menu Bar and Tool Bar while you’re getting
comfortable with Emacs, here’s how to disable any of these elements if and when
you want to (I disable all of these).
</p>

<p>
Best is to use <a href="#org27e6769">Customize</a> via   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-group</code></a>﻿ <code>RET frames</code>.  If
you’re inclined to disable any of these elements, you may also want to disable
GUI dialog boxes and tool tips (and use Emacs Completion instead)<sup><a id="fnr.127" href="#fn.127" role="doc-backlink">127</a></sup>; use
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-group</code></a>﻿ <code>RET menu</code>.  You can also just add one or more of
these snippets to your <a href="#org2af3730">Init File</a>:
</p>
<div>
<pre>(menu-bar-mode -1) <span>;</span><span>turn off menu bar</span>
(tool-bar-mode -1) <span>;</span><span>turn off tool bar</span>
(scroll-bar-mode -1) <span>;</span><span>turn off vertical scroll bar</span>
(horizontal-scroll-bar-mode -1) <span>;</span><span>turn off horizontal scroll bar</span>
(tooltip-mode -1) <span>; </span><span>turn off GUI tooltips</span>
(<span>setq</span> use-file-dialog nil use-dialog-box nil) <span>; </span><span>turn off GUI dialogs</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org8756525">
<h4 id="org8756525">Customizing Frame Appearance</h4>
<div id="text-org8756525">
<p>
You can extensively customize the appearance of your Frames: things like size,
position on your monitor, fonts, colors, cursors, and much, much more.  Many of
these can’t be done via Customize; see <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Frame-Parameters">“Frame Parameters”</a> in the <i>Emacs</i> manual.
</p>

<p>
If you use <code>desktop-save-mode</code>, it will remember any changes to your Frame
parameters, including implicit changes: if you <a href="#orgb1883e1">embiggen the font</a> or screen
position of a Frame, the next time you start up Emacs, that Frame will be
restored at its last screen position and font size (assuming your window manager
is okay with this).
</p>
</div>
</div>
<div id="outline-container-orgef64a25">
<h4 id="orgef64a25">Saving Frame Configurations</h4>
<p>
We discussed how you can save your <a href="#orgb729f11">Window configuration</a> in a <a href="#orgcfc576b">Register</a> with
    <code>C-x r w</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Configuration-Registers"><code>window-configuration-to-register</code></a>﻿) so that you can
restore it with a keystroke.  That Window configuration is merely the set of
Windows in your current Frame.  But you can also save your entire configuration
of <i>all</i> Frames with all their Windows in one step with
    <code>C-x r f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Configuration-Registers"><code>frameset-to-register</code></a>﻿).
</p>
</div>
<div id="outline-container-orge4cd298">
<h4 id="orge4cd298">Frames in Non-Graphical Mode</h4>
<p>
Even a non-graphical Emacs supports multiple Frames, but in a very limited
manner: each Frame always uses the full screen of the terminal it’s running in,
so you can only see one at a time, and elaborate Frame parameters aren’t
supported (just because terminals can only do so much compared to what Emacs can
do in graphical mode).
</p>
</div>
</div>
<div id="outline-container-org4c5bcc5">
<h3 id="org4c5bcc5">Files <a id="orgeabd905"></a></h3>
<p>
Most of what we think of as “editing files” really consists of editing <a href="#orgc3260f6"><i>Buffers</i></a>,
but there are a number of topics that apply specifically to files and how they
relate to Buffers.  For files as the contents of directories, and performing
file maintenance operations like copying, renaming, and the like, see
<a href="#orgcc42ce0"><i>Directories</i></a>.
</p>
<div id="outline-container-org707496a">
<h4 id="org707496a">Visiting Files <a id="org41c8a78"></a></h4>
<div id="text-org707496a">
<p>
As <a href="#org12c0a40">already mentioned</a>, the usual way to <i>visit</i> a file (i.e., load it into Emacs
for editing) is     <code>C-x C-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-file</code></a>﻿), but there are a few
other useful variants.  First, we have variants for finding files in specific ways:
</p>
<dl>
<dt>    <code>C-x C-r</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-file-read-only</code></a>﻿)</dt><dd>This is just like <code>C-x C-f</code>
followed by     <code>C-x C-q</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Misc-Buffer"><code>read-only-mode</code></a>﻿); you can use this
when you want to make sure you don’t forget and start editing a file you only
want to look at.</dd>
<dt>  <code>M-x</code> <code>find-file-existing</code></dt><dd>This is just like <code>C-x C-f</code> but it won’t
let you create a new file.  I’ve never used it; it’s probably most useful if you’re
trying to pull up a file whose name contains wild cards (<a href="https://en.wikipedia.org/wiki/Glob_(programming)"><i>glob</i> characters</a>),
like <code>*</code> or <code>?</code>, because it won’t expand them.  It’s a little-known (and by me,
little used) feature of   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-file</code></a>﻿ that if you use wild
cards in the file name, it will load all the matching files into multiple
Buffers.</dd>
</dl>

<p>
Let’s talk about neatness.  Some people accumulate dozens of file Buffers in
their Emacs (even hundreds, for users of <a href="#org22671bb"><code>server-mode</code></a>), but others like to keep
a lean and mean Emacs by killing Buffers ASAP when they’re done with them.
    <code>C-x C-v</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-alternate-file</code></a>﻿) is designed for the ASAPers.
It replaces the file you’re editing with a different file, whereas <code>C-x C-f</code> adds
an additional file to your Emacs.  It’s just like doing     <code>C-x k</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Kill-Buffer"><code>kill-buffer</code></a>﻿) immediately followed by   <code>C-x C-f</code>, except it
also reuses the window of the killed Buffer, so your window layout doesn’t
change at all.  This is also often used when you visit a file and immediately
realize that it wasn’t the file you meant: <code>C-x C-v</code> let’s you correct the
mistake.  Note that this is a brand-new Buffer, so if you’ve made any
<a href="#org871902b">Buffer-local</a> changes to the previous file’s Buffer, like say turning on a Minor
Mode, they are lost.
</p>

<p>
Then we have a family of convenience commands that simply open a file in a
different window.    <code>C-x C-f</code>,   <code>C-x C-r</code>, and
  <code>find-file-existing</code> all open the file in the current window;
these commands save you the effort of splitting windows and rearranging Buffers:
</p>

<ul>
<li><code>C-x 4 f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-file-other-window</code></a>﻿)</li>
<li><code>C-x 4 r</code> (<code>find-file-read-only-other-window</code>)</li>
<li><code>C-x 5 f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-file-other-frame</code></a>﻿)</li>
<li><code>C-x 5 r</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Creating-Frames"><code>find-file-read-only-other-frame</code></a>﻿)</li>
</ul>

<p>
Finally,   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-file-literally</code></a>﻿ visits a file but shows you the
literal contents of the file.  This means that the <a href="#org5b21ef0">Major Mode</a> will be
  <code>fundamental-mode</code>, regardless of what it would normally be
(so no syntax highlighting); line ending- and character set-conversion will not
be done, and multi-byte characters (as in Unicode) will be shown as individual
bytes.  Normally helpful features like automatic handling of compressed,
encrypted, and archive files (see below) will not be done.
</p>

<p>
When visiting a non-existent file (to create it), you might want to specify a
path that contains one or more non-existent directories.  Suppose the directory
<code>~/txt</code> exists, but contains only plain files—no subdirectories—and you say
<code>C-x C-f ~/txt/emacs/how-to.org</code>.  Emacs will happily open up a new Buffer for
you, but you’ll see this message in the <a href="#org7e7133f">Echo Area</a>:
</p>
<pre>Use M-x make-directory RET RET to create the directory and its parents
</pre>

<p>
You should take the advice.  You don’t <i>have</i> to do it immediately, but as soon as
you start typing in this Buffer, you’ll start getting <a href="#orge724ca4">warning messages</a> as Emacs
repeatedly tries, but fails, to create the Buffer’s <a href="#orgd3c522d">checkpoint file</a> in the
non-existent directory:<sup><a id="fnr.128" href="#fn.128" role="doc-backlink">128</a></sup>
</p>
<pre id="org9a14b02">Error (auto-save): Auto-saving how-to.org: Opening output file:
  No such file or directory, ~/txt/emacs/#how-to.org#
</pre>
<p>
You can also use   <code>M-x</code> <code>make-directory</code> anytime you need a new
directory, just as with <code>mkdir</code> in the shell; note that <code>make-directory</code> always acts
like <code>mkdir -p</code> and makes all necessary intermediate directories for you.
</p>
</div>
</div>
<div id="outline-container-orgb7414c0">
<h4 id="orgb7414c0">Find File at Point <a id="org557005c"></a></h4>
<div id="text-orgb7414c0">
<p>
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/FFAP"><code>find-file-at-point</code></a>﻿ is extremely useful for when you’re looking
at the name of a file in some Buffer, and want to open that file<sup><a id="fnr.129" href="#fn.129" role="doc-backlink">129</a></sup>.  Just
move Point to immediately before, within, or immediately after the file name,
and issue the command (it’ll give you a chance to tweak the name in the
<a href="#orga329460">Minibuffer</a>).  In addition to filenames, it also handles URLs at Point via the
<a href="#orgab8b7dc">Browse URL</a> subsystem.
</p>

<p>
The command   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/FFAP"><code>ffap-menu</code></a>﻿ will offer up for completion <i>all</i> the files
and URLs mentioned in the current Buffer<sup><a id="fnr.130" href="#fn.130" role="doc-backlink">130</a></sup>.
</p>

<p>
If you <i>really</i> like <code>ffap</code>, you can invoke   <code>ffap-bindings</code> in your Init
File and it will remap 18 file-visiting
commands (e.g.   <code>C-x C-r</code> or   <code>C-x 4 C-f</code>) to use
<code>ffap</code>.
</p>
</div>
</div>
<div id="outline-container-org3047448">
<h4 id="org3047448">Persisting Files Across Sessions</h4>
<p>
You can arrange for the complete set of files you’re currently editing to be
restored when you exit and then restart Emacs.  See <a href="#orgf2e3965"><i>The Desktop</i></a>.
</p>
</div>
<div id="outline-container-org385a1cd">
<h4 id="org385a1cd">Large Files <a id="orgb82fecf"></a></h4>
<div id="text-org385a1cd">
<p>
When you visit a file, the entire contents of the file is loaded into memory.
Modern computers have so much memory available that this is rarely an issue, but
disk is still bigger than RAM, and you don’t want your Emacs to slow down, much
less be terminated by the operating system, because it uses too much memory.
</p>

<p>
When you visit a <i>large</i> file, Emacs will ask you to confirm that you really want
to open it:
</p>
<pre>File Delicate Friction.zip is large (106.1 MiB), really open? (y)es or (n)o or (l)iterally
</pre>

<p>
If you choose “(l)iterally”, the file will be opened with
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-file-literally</code></a>﻿.  One of the problems with huge files
is that syntax-highlighting may be slow; visiting the file literally will use
fundamental mode and there won’t be any syntax-highlighting to slow you down.
</p>

<p>
So what defines a “large” file?  The variable
  <code>large-file-warning-threshold</code>.  It’s default value is a
conservative
10,000,000 bytes; I
recommend setting it to at least 100MB.
</p>
<div>
<pre>(<span>setq</span> large-file-warning-threshold (* 100 1024 1024)) <span>; </span><span>100MB</span>
</pre>
</div>

<p>
If you need to edit <i>truly</i> large files that won’t fit in memory (say multiple
gigabytes in size), you can do it with the VLF package.  See <a href="#orgc96889a"><i>The Package
Manager</i></a> for more information.
</p>

<p>
A related issue is files with extremely long lines, which can cause certain
<a href="#org5b21ef0">Major Modes</a> to struggle.  Files with such lines are typically computer-generated
and aren’t usually intended to be edited by humans: things like <a href="https://en.wikipedia.org/wiki/Minify">minified</a>
Javascript or byte-code.<sup><a id="fnr.131" href="#fn.131" role="doc-backlink">131</a></sup> The solution to this problem is
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Long-Lines"><code>global-so-long-mode</code></a>﻿; it automatically switches buffers
visiting files with long lines to   <code>so-long-mode</code>, which
handles them with no problem.  I recommend it for your <a href="#org2af3730">Init File</a>:
</p>
<div>
<pre>(<span>when</span> (version&lt;= <span>&#34;27.1&#34;</span> emacs-version)  <span>; </span><span>only available recently...</span>
  (global-so-long-mode +1))    <span>; </span><span>speed up long lines</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org998a2d0">
<h4 id="org998a2d0">Saving Files <a id="orgf98c057"></a></h4>
<div id="text-org998a2d0">
<p>
We’ve <a href="#org12c0a40">already mentioned</a> the basic commands for saving files (really, saving
Buffers):     <code>C-x C-s</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Save-Commands"><code>save-buffer</code></a>﻿) and
    <code>C-x s</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Save-Commands"><code>save-some-buffers</code></a>﻿).  You can additionally save an
edited Buffer under a different file name with
    <code>C-x C-w</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Save-Commands"><code>write-file</code></a>﻿) (this effect is sticky: if you continue
editing and save again, it will use the new name you chose).  If you want to
make a modified version of an existing file, rather than copying it first to a
new name, you can just do <code>C-x C-f</code> and then immediately do <code>C-x C-w</code> to save it
under the new name.
</p>

<p>
You can also tell Emacs to ignore any modifications you’ve made to a Buffer, so
that you don’t accidentally save them to the file with a <code>C-x s</code> or an impulsive
<code>C-x C-s</code>.  Just use     <code>M-~</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Save-Commands"><code>not-modified</code></a>﻿); after doing it,
you’ll notice that the modification asterisks <code>**</code> in the <a href="#org6456ffd">Mode Line</a> have changed
back to <code>--</code>, indicating the unmodified state, and Emacs won’t ask you about
saving this Buffer (until you modify it again).
</p>
</div>
</div>
<div id="outline-container-orgaa35628">
<h4 id="orgaa35628">Read-Only Buffers, or, Emacs is More <a id="org34c6961"></a> <a id="orgdb8bc3e"></a></h4>
<div id="text-orgaa35628">
<p>
Emacs makes an excellent pager—i.e., a replacement for programs like <code>more(1)</code>
and <code>less(1)</code>.  Just do     <code>C-x C-r</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-file-read-only</code></a>﻿) (so that
you don’t accidentally modify the file) and now you can view the file and scroll
and search through it.
</p>

<p>
Even better is to turn on the <a href="#org29e5e5d">Minor Mode</a>   <code>view-mode</code>, which
makes the Buffer read-only (if it isn’t already) and let’s you page through it
with <code>SPC</code> and backwards with <code>DEL</code>; it also redefines many printing characters to
scroll by half-screenfuls, by lines, set marks and jump back to them, and many
other things handy for browsing.
</p>

<p>
You can arrange to have <code>view-mode</code> turned on automatically whenever you make your
Buffer read-only (which also happens if you visit a file that you don’t have
permission to edit).  I recommend turning this on in your <a href="#org76237ea">init file</a>:
</p>

</div>
</div>
<div id="outline-container-orge054767">
<h4 id="orge054767">Reverting Buffers <a id="org652e622"></a></h4>
<div id="text-orge054767">
<p>
We’ve all experienced the regret of making extensive changes to a Buffer, and
then wishing we hadn’t!  If you change your mind about all the edits you’ve done
since your last save, you might think you need to enter upon a long, tedious
sequence of <a href="#org3f93c8e">Undos</a> until you get back to the unmodified version, or use
    <code>C-x k</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Kill-Buffer"><code>kill-buffer</code></a>﻿) and then revisit the file<sup><a id="fnr.132" href="#fn.132" role="doc-backlink">132</a></sup>.  But
really, all you need to do is ask Emacs to
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Reverting">revert the buffer</a> with
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Reverting"><code>revert-buffer</code></a>﻿ or the new command
    <code>C-x x g</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Reverting"><code>revert-buffer-quick</code></a>﻿): this means that Emacs will
refresh the Buffer contents from the file on disk (you’ll be asked for
confirmation), and you can then start over with your editing.  Remember that if
you made changes and <i>saved</i> them, then reverting can’t undo the changes you
saved; you need <a href="#org53af7eb"><i>Version Control</i></a> for that.  Note that, when you revert, this is
the same exact Buffer, so if you’ve made any <a href="#org871902b">Buffer-local</a> changes, they are
preserved.
</p>

<p>
You naturally can’t revert Buffers that aren’t visiting files.  Or can you?
Actually, many dynamic <a href="#orgfa25f51">Application Buffers</a> <i>can</i> be reverted!  Examples include Buffers
viewing web pages in the <a href="#orgc4ddf2e">Web Browser</a> (reverting reloads the page), <a href="#orgcc42ce0">Dired</a> Buffers
(reverting updates the Buffer to match the directory on disk), the <a href="#org534efa3">Buffer Menu</a>, and
many more.  You’ll commonly find   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Reverting"><code>revert-buffer</code></a>﻿ bound to <code>g</code>
in Application Buffers.
</p>
</div>
</div>
<div id="outline-container-orgfb086ab">
<h4 id="orgfb086ab">Auto-Reverting (Watching Files) <a id="org2a1e428"></a></h4>
<div id="text-orgfb086ab">
<p>
Sometimes you want to visit a file that’s regularly changing on disk.  In
  <code>view-mode</code>, you can use <code>F</code>
(  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>View-revert-buffer-scroll-page-forward</code></a>﻿) to manually revert
the Buffer from disk to see any updates, but you can also put a Buffer into
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Auto-Revert"><code>auto-revert-mode</code></a>﻿, and it will watch the file and
automatically revert the Buffer whenever there’s a change.
</p>

<p>
This is very handy when you’re editing a LaTeX or <a href="#org4a851ca">Org Mode</a> document and
periodically generating a new PDF which you’re viewing in
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Document-View"><code>doc-view-mode</code></a>﻿ as you work (see <a href="#org8dc49db"><i>PDFs and Image Files</i></a>).
</p>

<p>
Log files are notable in that they are only appended to.  You can use
<code>auto-revert-mode</code> here, but a better choice is
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Auto-Revert"><code>auto-revert-tail-mode</code></a>﻿, since it doesn’t reload the entire
(possibly huge) file every time: it just loads new lines from the end.  (This is
like the shell’s <code>tail -f</code> command.)
</p>
</div>
</div>
<div id="outline-container-org6b89c4a">
<h4 id="org6b89c4a">Backup Files <a id="org0c51c8b"></a></h4>
<div id="text-org6b89c4a">
<p>
Emacs never modifies your file on disk until you tell it to, but it’s very
careful about saving your work for you in a number of ways.
</p>

<dl>
<dt>Backup files</dt><dd><p>
Emacs preserves the previous version of your file when you save.
If your file is named <code>foo</code>, the backup will be called <code>foo~</code> (note the tilde).
</p>

<p>
Backup files are, by default, stored in the same directory as the file being
backed up, but you can arrange for the backups to go in a subdirectory, or in
a completely different location, by <a href="#org27e6769">Customizing</a>
  <code>backup-directory-alist</code>.
</p>

<p>
Note that, by default, if your file is under version control, Emacs won’t
bother to make any kind of backup files, unless you tell it to (see
  <code>vc-make-backup-files</code>).<sup><a id="fnr.133" href="#fn.133" role="doc-backlink">133</a></sup>
</p></dd>
</dl>

<dl>
<dt>Numbered Backups</dt><dd><p>
You can also have Emacs make <i>numbered backups</i>, so that you
can keep more than just the previous version.  The oldest numbered backup file
of the file <code>foo</code> would be named <code>foo~1~</code>; <code>foo~2~</code> would be newer, and the most
recent is the one with the highest number (there’s no limit to the number
kept!).  Numbered backups are off by default; you can set them as your
default, but you can also manually rename any one backup file to it’s numeric
form:
</p>
<pre>M-x rename-file RET foo~ RET foo~1~ RET
</pre>

<p>
and from that point on, Emacs will make numbered backups of that file (that
is, until you delete all the backups; then it would start over with simple
backups).
</p>

<p>
I don’t recommend numbered backups; in general using your preferred <a href="#org53af7eb">version
control system</a> is much better practice, and Emacs has excellent VCS support.
</p></dd>
</dl>
</div>
</div>

<div id="outline-container-org5e873e9">
<h4 id="org5e873e9">Auto-Save Files <a id="orgd3c522d"></a></h4>
<div id="text-org5e873e9">
<p>
Emacs also, by default, auto-saves your file while you’re editing
it<sup><a id="fnr.134" href="#fn.134" role="doc-backlink">134</a></sup>; I think of these as <i>checkpoint</i> files.  The auto-save file for a file
<code>foo</code> is called <code>#foo#</code>.  If Emacs (or the system) were to crash before you could
save your edits, you could recover almost all of them from this file.
Auto-saving happens (by default) every 300 characters you type, or every 30 seconds that
you’ve been idle, or when a system error is encountered, whichever comes first.
You can of course tweak these parameters if you’re either more paranoid or
over-confident.
</p>

<p>
You can recover lost data by manually fiddling with the file and its contents
from the auto-save file, but the simplest approach is just to visit the file you
were editing and then say:
</p>
<pre>M-x recover-file
</pre>

<p>
and, after a cautious confirmation dialog, Emacs will replace the contents of
the Buffer with the auto-save file contents.  In fact, if you visit a file
which has an auto-save file which is newer than the file itself, Emacs will
offer to do this recovery automatically.
</p>

<p>
If your entire session crashes (dropped connection to a remote host, laptop
battery runs down) and you’ve been lazy about saving your work, you can fire
up Emacs again and say:
</p>
<pre>M-x recover-session
</pre>

<p>
and Emacs will walk you through the <code>recover-file</code> process for each file that
needs it.
</p>

<p>
If you like to live dangerously, you can turn auto-saving off, but I really
discourage this; there’s no noticeable overhead and the auto-save file is
deleted every time you do an explicit save with <code>C-x C-s</code>, so they don’t clutter
up your directories.  I would also discourage the micro-management of exactly
how auto-saving works which Emacs allows (EIPNIF).  But see
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Auto-Save">“Auto Save”</a> in the <i>Emacs</i> manual for the gory details.
</p>
</div>
</div>

<div id="outline-container-orgaffd2cc">
<h4 id="orgaffd2cc">Lock Files</h4>
<div id="text-orgaffd2cc">
<p>
You can’t (normally) edit two copies of the same file in the same Emacs, because
of the way   <code>C-x C-f</code> works.<sup><a id="fnr.135" href="#fn.135" role="doc-backlink">135</a></sup>  But what if you fire up two Emacsen
and edit the same file in both?  A recipe for disaster?  Well, there’s no need
to worry as the two Emacsen will detect the conflict and notify you (but only if
you try to modify the file when the other Emacs already has it modified).  Emacs
will ask:
</p>
<pre>FILENAME locked by keith@krampus... (pid 290502): (s, q,p,?)?
</pre>

<p>
If you type <code>s</code> you can “steal” the file from the other Emacs—this is safe; it
just flips the roles of the two participants, and now if the other Emacs user
tries to modify <i>their</i> Buffer, <i>they</i> will be the intruder and be asked the same
question.
</p>

<p>
You can also type <code>q</code> to abandon the attempt, or type <code>p</code> to proceed into danger
with no protection, if you insist.
</p>

<p>
Lock files are implemented (on Unix systems) as symbolic links and look
something like this example (I mention this only in case you stumble upon one,
and wonder what it is):
</p>
<p>
<code>.#emacs-tutorial.org -&gt; keith@krampus.1173283:1613350748</code>
</p>
</div>
</div>
<div id="outline-container-org3323fc2">
<h4 id="org3323fc2">Files Modified Behind Emacs’s Back <a id="org1ec781b"></a></h4>
<div id="text-org3323fc2">
<p>
Sometimes a file in your Emacs will be modified by some other process, behind
Emacs’s back.  For example, you might synchronize files across multiple
computers with an application like <a href="https://syncthing.net/">Syncthing</a>, and thus you might change a file
on your phone or desktop when you also have the file loaded in the Emacs on your
laptop.<sup><a id="fnr.136" href="#fn.136" role="doc-backlink">136</a></sup>  If you start to modify the Buffer (say, by typing in it), when the file
has changed on disk, Emacs will ask:
</p>
<pre>FILENAME changed on disk; really edit the buffer? (y, n, r or C-h)
</pre>

<p>
If you’re not surprised at this (in the file synchronization case above, you
probably won’t be), you can type <code>r</code> to revert the Buffer.
</p>

<p>
If you <i>are</i> surprised, you can type <code>n</code> and your attempt to edit will be aborted;
now you can investigate the situation.  If you’re lucky, you’ll discover that
you do indeed want the changes that were made on disk, and you can say
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Reverting"><code>revert-buffer</code></a>﻿ to refresh the contents of the Buffer and get back
to work.  (If you type <code>C-h</code> at the prompt, all these options will be summarized.)
</p>

<p>
If your Buffer was <i>already</i> modified in Emacs when the disk file got changed<sup><a id="fnr.137" href="#fn.137" role="doc-backlink">137</a></sup>,
then the question will be:
</p>
<pre>FILENAME has changed since visited or saved.  Save anyway? (yes or no)
</pre>

<p>
This is a much more annoying situation.  If you proceed with your save, you will
lose the changes on disk, but if you revert, you will lose the changes in your
Buffer!  If you don’t care about one of the two, you’re okay: you can revert,
throwing away your Buffer changes, or else save and allow the text currently in
the Buffer to trump the contents on disk.  But as Emacs says, “you risk ruining
the work of whoever rewrote the file”.<sup><a id="fnr.138" href="#fn.138" role="doc-backlink">138</a></sup>
</p>

<p>
If you want the best of both worlds, you’ll need to combine the two versions.
The solution in that case is   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/ediff/Major-Entry-Points"><code>ediff-current-file</code></a>﻿, which uses the
very powerful Ediff subsystem to let you merge changes in the disk file into
your Buffer, and vice versa; see <a href="#org4d9b857"><i>Diffing and Merging</i></a>.
</p>

<p>
The cryptic Table <a href="#org1bec921">12</a> summarizes your options when your
Buffer and your file are at odds.  As in the <a href="#org6456ffd">Mode Line</a>, <code>--</code> indicates <i>unmodified</i>
and <code>**</code> indicates <i>modified</i>; <code>:-)</code> means we <i>want</i> the modifications, and <code>:-(</code> means we
don’t.
</p>
<table id="org1bec921">
<caption><span>Table 12:</span> Resolving Modified Buffer vs File Conflicts</caption>

<colgroup>
<col/>

<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Buffer \ Disk</th>
<th scope="col"><code>--</code></th>
<th scope="col"><code>** :-(</code></th>
<th scope="col"><code>** :-)</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--</code></td>
<td> </td>
<td><code>C-x C-w¹</code></td>
<td><code>M-x revert-buffer</code></td>
</tr>

<tr>
<td><code>** :-)</code></td>
<td><code>C-x C-s</code></td>
<td><code>C-x C-s²</code></td>
<td><code>M-x ediff-current-file</code></td>
</tr>

<tr>
<td><code>** :-(</code></td>
<td><code>M-x revert-buffer</code></td>
<td><code>C-x k³</code></td>
<td><code>M-x revert-buffer</code></td>
</tr>
</tbody>
</table>
<p>
Notes:
</p>
<ol>
<li>We don’t want the disk file content; since the Buffer’s not modified, <code>C-x C-s</code>
has nothing to save, but <code>C-x C-w</code> will write the Buffer out: just use the same
filename.</li>
<li>Since the Buffer <i>is</i> modified, <code>C-x C-s</code> will write it out, but you’ll have to
confirm that you really mean to clobber the modified disk file.</li>
<li>In this case, you should kill your unwanted modified Buffer, and use <a href="#org53af7eb">Version
Control</a> to recover the version of the file that you want.</li>
</ol>
</div>
</div>
<div id="outline-container-org018d07b">
<h4 id="org018d07b">Compressed Files <a id="org9732371"></a></h4>
<div id="text-org018d07b">
<p>
Emacs handles compressed files transparently.  If you visit a file that’s been
compressed by any of the common Unix compression tools
(compress, bzip2, gzip, lzip, lzma, xz, and zstd), it will be automatically uncompressed into the Buffer, and when you
save it, the changed Buffer will be recompressed.<sup><a id="fnr.139" href="#fn.139" role="doc-backlink">139</a></sup>
</p>

<p>
The Major Mode for a compressed file will be chosen in the <a href="#org637bdd6">usual way</a>; the file
extension used to <a href="#org637bdd6">choose the mode</a> will be the one “underneath” the compression
extension (e.g., a file <code>foo.org.bz2</code> will use <code>bzip2(1)</code> for the compression, but
the Buffer will be in   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Org-Mode"><code>org-mode</code></a>﻿).
</p>

<p>
This is all actually handled by the Minor Mode
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Compressed-Files"><code>auto-compression-mode</code></a>﻿, which is on globally (i.e. in all
Buffers) by default.  If you don’t like this behavior, you can toggle the mode
off <a href="#org5b21ef0">as usual</a>.
</p>
</div>
</div>
<div id="outline-container-org62a3867">
<h4 id="org62a3867">Encrypted Files <a id="orgc045bbb"></a></h4>
<div id="text-org62a3867">
<p>
Emacs handles encrypted files in the same transparent manner that it handles
compressed files.  Unlike compression, there are not that many general-purpose
encryption tools; Emacs only directly supports <a href="https://www.gnupg.org/">GNU Privacy Guard (GnuPG)</a><sup><a id="fnr.140" href="#fn.140" role="doc-backlink">140</a></sup>
— see <a href="https://www.gnu.org/software/emacs/manual/html_node/gnupg/Top">its manual</a> in Info.  The default file
extension is <code>.gpg</code>; if you visit an encrypted file with that extension, it will
be decrypted into the Buffer, and when you save, it will be encrypted back to the
file on disk.
</p>

<p>
The Major Mode for an encrypted file Buffer will be chosen in the <a href="#org637bdd6">usual way</a>
based on the underlying file extension, if any, so <code>foo.org.gpg</code> will come up in
<a href="#org4a851ca"><code>org-mode</code></a>.
</p>

<p>
This is all actually handled by the Minor Mode
  <code>auto-encryption-mode</code>, which is on globally (i.e. in all
Buffers) by default.  If you don’t like this behavior, you can toggle the mode
off <a href="#org5b21ef0">as usual</a>.
</p>

<p>
There are some differences compared to compressed files, of course.  Emacs turns
off <a href="#orgd3c522d"><code>auto-save-mode</code></a> for the Buffer of an encrypted file, to avoid exposing your
unencrypted text in a <a href="#orgd3c522d">checkpoint file</a>.  Additionally, encrypting and decrypting
a file requires you to specify a passphrase or key of some kind, for which
you’ll be prompted.
</p>

<p>
GnuPG is a complex program and you’ll have to do some studying to really
understand it.  The most important concept is the distinction between <i>symmetric</i>
and <i>public key</i> encryption.  Public key requires some setup and preparation, but
you can easily do symmetric encryption without any.
See <a href="#orga76f459"><i>EasyPG Assistant</i></a> for more information on Emacs GnuPG integration.
</p>
</div>
</div>
<div id="outline-container-org48098c0">
<h4 id="org48098c0">Archive Files <a id="org648e64d"></a></h4>
<div id="text-org48098c0">
<p>
You can also directly edit <a href="https://en.wikipedia.org/wiki/Archive_file">archive files</a>, like <a href="https://en.wikipedia.org/wiki/Tar_(computing)">tar files</a>; 7z, ar, arc, lzh, lzh-exe, rar, rar-exe, squashfs, squashfs, zip, and zoo
archives; and all types of OpenDocument files (word processing, spreadsheet,
presentation, graphics, and formula files, which are stored as <a href="https://en.wikipedia.org/wiki/ZIP_(file_format)">ZIP archives</a>
containing multiple parts).  The interface has many similarities to <a href="#orgcc42ce0">Dired</a>.
</p>

<p>
When you visit an archive, you are shown what looks like the table of contents
listing of that archive format.  Here’s the Buffer contents I see when I visit
the tar archive for one of my Emacs <a href="#orgc96889a">packages</a> via   <code>C-x C-f</code>
<code>refer-mode-1.18.0.tar</code>:
</p>
<pre id="org464d5a0">drwxr-xr-x   keith/keith         0 refer-mode-1.18.0/
-rw-r--r--   keith/keith        72 refer-mode-1.18.0/refer-mode-pkg.el
-rw-r--r--   keith/keith       612 refer-mode-1.18.0/dir
-rw-r--r--   keith/keith     50555 refer-mode-1.18.0/refer-mode.el
-rw-r--r--   keith/keith     30243 refer-mode-1.18.0/refer-mode.info
-rw-r--r--   keith/keith       437 refer-mode-1.18.0/README
</pre>
<p>
Note that the <a href="#org6456ffd">Mode Line</a> will show the size of visible Buffer text, which is what
it always does (see, for example, <a href="#org39c0e40">Narrowing</a>), but this is deceiving.  For the
above tar file, the Mode Line says the Buffer contains 384 <i>bytes</i>, but Emacs
really has loaded the entire tar file into memory, and its size is actually
92K.  I mention this just because it’s not unusual for archive files to be very
large.  If you try to visit a really big archive, you’ll get the <a href="#orgb82fecf"><i>large file
warning</i></a>, to make sure you really want to do it.
</p>

<p>
Via the Buffer of an archive file, you can edit any of the component files
transparently.  Just position Point on the desired file’s line and hit <code>e</code>, <code>f</code>, or
<code>RET</code><sup><a id="fnr.141" href="#fn.141" role="doc-backlink">141</a></sup> You’ll now be in a Buffer containing the contents of that file; the
Buffer name in the Mode Line will be something like <code>refer-mode.info (refer-mode-1.18.0.tar)</code>.
</p>

<p>
You can edit at will using all the features of Emacs; when you save the Buffer,
the edited contents will replace that file in the archive---<i>but only in the
archive Buffer</i>: the archive file on disk won’t be modified until you save the
archive Buffer itself.  So fully saving a file from an archive is a two step
process: save the file, then save the archive containing it.  When you save the
Buffer of the component file, you’ll see a message like this one in the <a href="#org7e7133f">Echo
Area</a>:
</p>
<pre>Saved into tar-buffer ‘refer-mode-1.18.0.tar’.  Be sure to save that buffer!
</pre>

<p>
In addition to editing the archive contents, you can manipulate the archive
itself.  You can delete, rename, or change the owner, group, or mode of any of
the component files.  You can copy a file out of the archive to the disk, and
you can add a new file to the archive (you’ll get a new empty Buffer to which you
can add content).  In the archive Buffer, just do the usual     <code>C-h m</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Misc-Help"><code>describe-mode</code></a>﻿) or hit <code>?</code> for help; see <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/File-Archives">“File Archives”</a> in the <i>Emacs</i> manual.
</p>

<p>
Many archive formats implement their own compression scheme, but tar archives
don’t; they are usually compressed by any of the standard Unix compression
programs (like <code>gzip(1)</code> or <code>bzip(1)</code>); <code>tar-mode</code> works on compressed tar archives,
too.
</p>

<p>
Most of the other archive formats support the same kinds of operations, with the
same key bindings, but there are a few lacunae (in particular, not all the other
archive formats support changing owner, group, or mode—probably because these
are Unix concepts and the other archive formats were developed on MS Windows).
</p>

<p>
Emacs’s support for tar files is fully implemented in Elisp, so you don’t need
to have a <code>tar(1)</code> program installed, but the other archive formats require the
appropriate program to be installed as a helper.
</p>
</div>
</div>
<div id="outline-container-orgf605164">
<h4 id="orgf605164">Document Files (PDFs and the Like) <a id="org8dc49db"></a></h4>
<div id="text-orgf605164">
<p>
Emacs can display various types of formatted documents, in particular,
PDFs<sup><a id="fnr.142" href="#fn.142" role="doc-backlink">142</a></sup>, OpenDocument (and older Microsoft Office) files, EPUB e-books,
PostScript, and DVI files.  (Since most of these documents aren’t plain text, Emacs
needs to be running in <a href="#org6444e1f">graphical mode</a> to display them; otherwise it will
necessarily fall back to a degraded view.)
</p>

<p>
All of these file types require some supporting non-Emacs software to be
installed via your operating system’s package manager, and EPUB files also
require a <a href="#org660cffc">3rd-party Emacs package</a>; see Table <a href="#orgfa46d49">13</a>.
</p>
<table id="orgfa46d49">
<caption><span>Table 13:</span> Prerequisite Software for Document Viewing</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Format</th>
<th scope="col">Requires</th>
</tr>
</thead>
<tbody>
<tr>
<td>PDF</td>
<td><a href="https://mupdf.com/">MuPDF</a><sup><a id="fnr.143" href="#fn.143" role="doc-backlink">143</a></sup> or <a href="https://www.ghostscript.com/">GhostScript</a></td>
</tr>

<tr>
<td>EPUB</td>
<td><a href="https://www.info-zip.org/UnZip.html">UnZip</a> <i>and</i> <code>nov</code><sup><a id="fnr.144" href="#fn.144" role="doc-backlink">144</a></sup></td>
</tr>

<tr>
<td>OpenDocument, <code>.docx</code></td>
<td><a href="https://www.info-zip.org/UnZip.html">UnZip</a>, <a href="http://dag.wiee.rs/home-made/unoconv">unoconv</a> <i>and</i> <a href="https://www.ghostscript.com/">GhostScript</a></td>
</tr>

<tr>
<td>PostScript</td>
<td><a href="https://www.ghostscript.com/">GhostScript</a></td>
</tr>

<tr>
<td>DVI</td>
<td><a href="https://www.ghostscript.com/">GhostScript</a> or  <a href="https://tug.org/texlive/">TeX Live</a></td>
</tr>

<tr>
<td>Microsoft <code>.doc</code></td>
<td><a href="http://dag.wiee.rs/home-made/unoconv">unoconv</a></td>
</tr>
</tbody>
</table>

<p>
All of these document types (except EPUB) are handled by
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Document-View"><code>doc-view-mode</code></a>﻿,
which provides scrolling and paging commands (somewhat similar to
  <code>view-mode</code>); see Table <a href="#org9d9370e">14</a>.
</p>

<table id="org9d9370e">
<caption><span>Table 14:</span> <code>doc-view-mode</code> Scrolling and Paging Commands</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>RET</code>, <code>C-n</code>, <code>&lt;down&gt;</code></td>
<td>Scroll one line forward (or next page)</td>
</tr>

<tr>
<td><code>C-p</code>, <code>&lt;up&gt;</code></td>
<td>Scroll one line backward (or previous page)</td>
</tr>

<tr>
<td><code>SPC</code></td>
<td>Scroll one window forward (or next page)</td>
</tr>

<tr>
<td><code>DEL</code>, <code>S-SPC</code></td>
<td>Scroll one window backward (or previous page)</td>
</tr>

<tr>
<td><code>n</code>, <code>&lt;next&gt;</code></td>
<td>Go to next page</td>
</tr>

<tr>
<td><code>p</code>, <code>&lt;prior&gt;</code></td>
<td>Go to previous page</td>
</tr>

<tr>
<td><code>&lt;</code></td>
<td>Go to top of page</td>
</tr>

<tr>
<td><code>&gt;</code></td>
<td>Go to bottom of page</td>
</tr>

<tr>
<td><code>M-&lt;</code></td>
<td>Go to beginning of document</td>
</tr>

<tr>
<td><code>M-&gt;</code></td>
<td>Go to end of document</td>
</tr>
</tbody>
</table>

<p>
There are six commands to change the size of the page text:
</p>
<table>


<colgroup>
<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td><code>P</code></td>
<td>assure full page is visible in window</td>
</tr>

<tr>
<td><code>H</code></td>
<td>assure full height is visible in window</td>
</tr>

<tr>
<td><code>W</code></td>
<td>assure full width is visible in window</td>
</tr>

<tr>
<td><code>+</code></td>
<td>enlarge the page text</td>
</tr>

<tr>
<td><code>-</code></td>
<td>shrink the page text</td>
</tr>

<tr>
<td><code>0</code></td>
<td>reset the page text size</td>
</tr>
</tbody>
</table>

<p>
If the document you’re viewing is one that you’re also authoring (say in LaTeX,
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Org-Mode"><code>org-mode</code></a>﻿, or some other markup language), you can update it
after you’ve made changes by <a href="#org652e622">reverting the Buffer</a> with the <code>g</code>
(  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Reverting"><code>revert-buffer</code></a>﻿) command (or equivalently, <code>r</code>).  But I recommend
using   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Auto-Revert"><code>auto-revert-mode</code></a>﻿ (see <a href="#org652e622"><i>Reverting Buffers</i></a>); you can add this
snippet to your <a href="#org2af3730">init file</a> to make it your default for <code>doc-view-mode</code>:
</p>
<div>
<pre>(add-hook &#39;doc-view-mode-hook &#39;auto-revert-mode)
</pre>
</div>
</div>
<div id="outline-container-org02c655d">
<h5 id="org02c655d">Toggling the Display Mode</h5>
<p>
All these document formats have an underlying encoding.  PostScript and PDF
files really have a plain-text encoding; DVIs have a binary encoding, and EPUBs
and OpenDocument files are Zip archives that contain several files in a variety
of formats.  The point being, you might want to view the underlying encoding,
the <i>raw</i> data, rather than view the document.  The command
    <code>C-c C-c</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Document-View"><code>doc-view-toggle-display</code></a>﻿) will toggle back and forth
between the two views.<sup><a id="fnr.145" href="#fn.145" role="doc-backlink">145</a></sup>
</p>
</div>
<div id="outline-container-org6c3210d">
<h5 id="org6c3210d">Just the Text, Please</h5>
<p>
Viewing “documents” may sometimes be necessary, and even superficially
attractive, but it clashes with the very nature of Emacs as a plain-text engine.
These documents are basically images, and the more you have to deal with them,
the more you’ll miss the ability to use keyboard macros, powerful searching,
textual objects, and all the rest of the synergistic power that Emacs provides.
This can be mitigated somewhat with     <code>C-c C-t</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Document-View"><code>doc-view-open-text</code></a>﻿),
which toggles the Buffer to a plain-text version of the document, where you can
use all your powers.      <code>C-c C-c</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Document-View"><code>doc-view-toggle-display</code></a>﻿) will
toggle back to the graphical view.
</p>
</div>
<div id="outline-container-org516ce5f">
<h5 id="org516ce5f">Searching</h5>
<div id="text-org516ce5f">
<p>
Searching in <code>doc-view-mode</code> is awkward compared to searching in plain text
Buffers because it can’t highlight the matched hits the way
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Basic-Isearch"><code>isearch-forward</code></a>﻿ does<sup><a id="fnr.146" href="#fn.146" role="doc-backlink">146</a></sup>.
    <code>C-s</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/DocView-Searching"><code>doc-view-search</code></a>﻿) does a <a href="#org19c6ad0">regular expression search</a>
forward, but since it can’t highlight the hits, it simply reports the number of
hits in the <a href="#orga329460">Minibuffer</a> with a message like “DocView: search yielded 5 matches.”
Now hit <code>C-s</code> again to jump to the page with the first hit.  Subsequent <code>C-s</code>’s
advance to further pages with hits.  To initiate a brand new search (with a
prompt for a new regexp), use <code>C-u C-s</code>.  The same procedure works backwards with
    <code>C-r</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/DocView-Searching"><code>doc-view-search-backward</code></a>﻿).
</p>

<p>
This is obviously a little sad, as it can be tricky to spot matches in a page.
One  solution for arbitrary document formats is to switch to text mode with
<code>C-c C-t</code> and do your search there.  I find this pretty satisfactory, really.
</p>

<p>
Additionally, after you’ve initiated a search and moved to a given page of hits,
you can pop up a GUI <i>tooltip</i> window that lists all the hits on the page with
some context by hitting     <code>C-t</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/DocView-Searching"><code>doc-view-show-tooltip</code></a>﻿).
</p>

<p>
But for PDFs, <a href="#org7c9a938">PDF Tools</a> implements incremental search in a completely normal
manner, with highlighting of the hits in the graphical view.  Highly
recommended.
</p>
</div>
</div>
<div id="outline-container-org5d9b1ef">
<h5 id="org5d9b1ef">Slicing</h5>
<p>
Since graphical documents are fundamentally designed with print in mind, they
often have a large amount of whitespace around their edges, sometimes excessive
amounts (I’m looking at you, default LaTeX format…).  A more compact
view with minimal borders can be achieved with the <i>slicing</i> commands.  Easiest to
use is <code>s b</code>   <code>doc-view-set-slice-from-bounding-box</code> which does
the slice automatically; you can also manually set the slice with the mouse
after executing <code>s m</code>   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/DocView-Slicing"><code>doc-view-set-slice-using-mouse</code></a>﻿.  To
restore the whitespace, invoke <code>s r</code>   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/DocView-Slicing"><code>doc-view-reset-slice</code></a>﻿.
</p>
</div>
<div id="outline-container-org1b65907">
<h5 id="org1b65907">Better PDF Handling with PDF Tools <a id="org7c9a938"></a></h5>
<div id="text-org1b65907">
<p>
If you install the <a href="#org660cffc">3rd-party package</a> <code>pdf-tools</code>, you will have a much-enhanced
version of <code>doc-view-mode</code> for PDFs (only).  It requires you to install the
external package <a href="https://poppler.freedesktop.org/"><code>poppler</code></a> from your OS package manager.
</p>

<p>
Some of its advantages are that pages are rendered into memory on the fly<sup><a id="fnr.147" href="#fn.147" role="doc-backlink">147</a></sup>; it
has a true incremental search with highlighted hits in the graphical view and
even has <a href="#org3c07b32"><code>M-x occur</code></a>; you can follow links; make and view annotations;
manipulate attachments; and display a document outline (table of contents).
</p>

<p>
<code>C-c C-c</code> will toggle between <code>pdf-view-mode</code> and <code>doc-view-mode</code>; there are a few
things PDF Tools can’t do that <code>doc-view-mode</code> can.
</p>

<p>
I recommend   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Auto-Revert"><code>auto-revert-mode</code></a>﻿ for <code>pdf-view-mode</code> also:
</p>
<div>
<pre>(add-hook &#39;pdf-view-mode-hook &#39;auto-revert-mode)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org049bf33">
<h4 id="org049bf33">Image Files <a id="orgd9f78fb"></a></h4>
<p>
You can view image files (Emacs knows dozens of formats) as well as document
files.  Just visit an image file and it will be displayed (only in a <a href="#org6444e1f">graphical
mode</a> Emacs, of course).  There are two non-graphical displays:
    <code>C-c C-c</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Image-Mode"><code>image-toggle-display</code></a>﻿) toggles between graphical and
the raw underlying bytes (you’ll be in   <code>fundamental-mode</code>),
while     <code>C-c C-x</code> (<code>image-toggle-hex-display</code>) will switch to a
hex-dump display of the raw data (see <a href="#orgca85f55"><i>Binary Data Files</i></a>).
</p>
<div id="outline-container-org938f2c4">
<h5 id="org938f2c4">Browsing Images</h5>
<div id="text-org938f2c4">
<p>
You can visit the next image file in the same directory with
<code>n</code> (  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Image-Mode"><code>image-next-file</code></a>﻿);
<code>p</code> (  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Image-Mode"><code>image-previous-file</code></a>﻿) goes the other way.
<code>w</code> (  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Image-Mode"><code>image-mode-copy-file-name-as-kill</code></a>﻿) will copy the absolute
pathname of the file to the <a href="#orgee263e4">Kill Ring</a>.
</p>

<p>
You can also mark images with <code>m</code> (  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Image-Mode"><code>image-mode-mark-file</code></a>﻿) so
that you can define a collection of files for later manipulation.  This works by
setting marks in a <a href="#orgcc42ce0">Dired</a> Buffer; when you’re done, you can switch to the Dired
Buffer and do, well, anything: change permissions, tar or zip up the files into
an archive, copy or mass rename the files, or use <a href="#org2bfdd17">Tramp</a> to upload the files to
another machine.  Dired also has a mode for viewing <a href="#org316ab70">thumbnails</a> of image files.
</p>
</div>
</div>
<div id="outline-container-org840f53f">
<h5 id="org840f53f">Resizing Images and Animations</h5>
<div id="text-org840f53f">
<p>
When you visit a file it will be resized to fit the window.  If you resize the
window, by default the image will be resized with it.  There are several
commands for explicitly scaling the image; if you do this, the automatic
resizing when the window size changes will be disabled until you reset the image
with <code>s 0</code>; see Table <a href="#org4b7e20f">15</a>.
</p>

<table id="org4b7e20f">
<caption><span>Table 15:</span> <code>image-mode</code> Scaling Commands</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Keys</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>s h</code></td>
<td>Show full Height in window</td>
</tr>

<tr>
<td><code>s w</code></td>
<td>Show full Width  in window</td>
</tr>

<tr>
<td><code>s b</code></td>
<td>Show Both full height and width in window</td>
</tr>

<tr>
<td><code>s o</code></td>
<td>Show image unscaled at Original size</td>
</tr>

<tr>
<td><code>s 0</code></td>
<td>reset image scaling to auto</td>
</tr>

<tr>
<td><code>RET</code></td>
<td>start or stop animating the current image</td>
</tr>
</tbody>
</table>
<p>
If you set the image to its original, unscaled, size, you can scroll it in the
window with most of the usual   <code>view-mode</code> motion and
scrolling commands; see Table <a href="#orgfbfbb1c">16</a>.
</p>

<table id="orgfbfbb1c">
<caption><span>Table 16:</span> <code>image-mode</code> Scrolling Commands</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>SPC</td>
<td>scroll image up</td>
</tr>

<tr>
<td>DEL, S-SPC</td>
<td>scroll image down</td>
</tr>

<tr>
<td>C-b, &lt;left&gt;</td>
<td>scroll image left</td>
</tr>

<tr>
<td>C-f, &lt;right&gt;</td>
<td>scroll image right</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="outline-container-org15c9d7c">
<h4 id="org15c9d7c">Binary Data Files <a id="orgca85f55"></a></h4>
<div id="text-org15c9d7c">
<p>
We’ve just seen that, while Emacs is primarily a plain-text engine, it has
helpful modes for displaying graphical data files like <a href="#orgd9f78fb">images</a> and <a href="#org8dc49db">formatted
documents</a>.  Most graphical data files are actually <a href="https://en.wikipedia.org/wiki/Binary_file"><i>binary data</i></a><sup><a id="fnr.148" href="#fn.148" role="doc-backlink">148</a></sup>, i.e., a
sequence of arbitrary bytes not intended to be interpreted as characters —
letters, digits, punctuation — in any <a href="https://en.wikipedia.org/wiki/Character_encoding">character set</a><sup><a id="fnr.149" href="#fn.149" role="doc-backlink">149</a></sup>.  There are many
other types of binary data files, including compiled executable programs,
database files, audio files, and so on.  You may never need to view this raw
data (unless you’re a programmer or system administrator), but if you do, Emacs
is ready.
</p>

<p>
If you visit a binary data file for which Emacs doesn’t have a special Major
Mode defined, it will come up in <a href="#org952e909"><code>fundamental-mode</code></a>, and you’ll be looking at
the raw bytes.  Here’s what the beginning of an <a href="https://en.wikipedia.org/wiki/MP3">MP3</a> file from my collection
looks like:
</p>

<div id="orgfb49c46">
<p><a href="https:./images/binary-file.png" alt="The Mae Shi&#39;s /Heartbeeps/ in =fundamental-mode=" title="The Mae Shi&#39;s /Heartbeeps/ in =fundamental-mode=" width="100%"><img src="https://blog.veitheller.de/images/binary-file.png" alt="The Mae Shi&#39;s /Heartbeeps/ in =fundamental-mode=" title="The Mae Shi&#39;s /Heartbeeps/ in =fundamental-mode=" width="100%"/></a>
</p>
<p><span>Figure 24: </span>The Mae Shi’s <i>Heartbeeps</i> in <code>fundamental-mode</code></p>
</div>

<p>
(See <a href="#org8dcb1a5"><i>What Is Text?</i></a> for an explanation of the cyan characters.)
You can see, for example, that the MP3 format allows for text in the audio file
(these are <a href="https://en.wikipedia.org/wiki/ID3">ID3 tags</a> for metadata).  Emacs supports a friendlier or at least more
traditional format for displaying binary data, called a <a href="https://en.wikipedia.org/wiki/Hex_dump"><i>hex dump</i></a>, via
  <code>M-x</code> <code>hexl-mode</code>—Figure <a href="#orgb2418f9">25</a> shows the beginning of the
same file in <code>hexl-mode</code>:
</p>

<div id="orgb2418f9">
<p><a href="https:./images/hexl-mode.png" alt="The Mae Shi&#39;s /Heartbeeps/ in =hexl-mode=" title="The Mae Shi&#39;s /Heartbeeps/ in =hexl-mode=" width="100%"><img src="https://blog.veitheller.de/images/hexl-mode.png" alt="The Mae Shi&#39;s /Heartbeeps/ in =hexl-mode=" title="The Mae Shi&#39;s /Heartbeeps/ in =hexl-mode=" width="100%"/></a>
</p>
<p><span>Figure 25: </span>The Mae Shi’s <i>Heartbeeps</i> in <code>hexl-mode</code></p>
</div>

<p>
(If you know you’re visiting a binary file you can skip the mode-change via the
shortcut   <code>M-x</code> <code>hexl-find-file</code>.)  As with many alternative-display
modes, you can switch back to the previous Major Mode with <code>C-c C-c</code>.
</p>

<p>
All the usual motion commands work appropriately in <code>hexl-mode</code>, and you can
modify the Buffer by typing self-inserting characters (<code>hexl-mode</code> also has a
number of other ways to insert bytes — but either way, make sure you know what
you’re doing).
</p>

<p>
Note that because many binary data formats contain fixed-length sections and
have alignment restrictions<sup><a id="fnr.150" href="#fn.150" role="doc-backlink">150</a></sup>, <code>hexl-mode</code> puts the Buffer in
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Minor-Modes"><code>overwrite-mode</code></a>﻿ (you can change that if you know what you’re
doing).  If you’re going to edit binary data in <code>fundamental-mode</code>, you probably
want to turn on   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Minor-Modes"><code>binary-overwrite-mode</code></a>﻿ for the same reason.
</p>

<p>
Editing binary files is only for <a href="https://en.wikipedia.org/wiki/Real_Programmers_Don&#39;t_Use_Pascal">Real Programmers</a> and not the faint of heart,
but if you have to do it, it actually <i>works</i> in Emacs: which is to say, it <i>won’t</i>
work in many other editors, which may corrupt the file when you save it (say by
deleting or adding white space or helpfully converting assumed-character sets).
What you see in the Buffer in <code>fundamental-mode</code> or <code>hexl-mode</code> in Emacs is exactly
what will get written to disk.
</p>
</div>
</div>
<div id="outline-container-org7684aa5">
<h4 id="org7684aa5"><span>UNFINISHED</span> Quoting File Names <a id="org3f2ba6f"></a></h4>

</div>


</div>


<div id="outline-container-org2daaa5a">
<h3 id="org2daaa5a">Directory Editing with Dired <a id="orgcc42ce0"></a></h3>
<div id="text-org2daaa5a">
<p>
Emacs is thought by the uninitiated to be a (mere) text editor, so of course it
can edit files.  But it can also edit directories (“folders” to some).  What
does it mean to “edit” a directory?  It means to do the sorts of things that are
normally done with Unix shell commands (like <code>cp(1)</code>, <code>rm(1)</code>, or <code>chmod(1)</code>) or a
<a href="https://en.wikipedia.org/wiki/File_manager">file manager</a>, like <a href="https://en.wikipedia.org/wiki/File_Explorer">Windows Explorer</a> (File Explorer), Apple’s macOS <a href="https://en.wikipedia.org/wiki/Finder_(software)">Finder</a>,
or the venerable <a href="https://en.wikipedia.org/wiki/Norton_Commander">Norton Commander</a> and its Unix clone, <a href="https://en.wikipedia.org/wiki/Midnight_Commander">Midnight Commander</a>.
</p>

<p>
Emacs handles directories via a special <a href="#org5b21ef0">Major Mode</a>,
  <code>dired-mode</code> (Dired for short).  Dired was one the first file
managers, having existed in <a href="#orgf0a0641">ITS TECO Emacs</a> since at least 1978.  <a href="#orgcc42ce0">Dired</a> is to
files what <a href="#org534efa3">Buffer Menu</a> is to buffers.
</p>

<p>
To invoke Dired, just visit a directory, rather than a file, with
    <code>C-x C-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-file</code></a>﻿) or any other <a href="#org41c8a78">file-visiting command</a>.
(Make sure your <a href="#org75fb6a2">completion system</a> doesn’t instead helpfully choose a filename
within that directory.)  You can also invoke Dired directly with
    <code>C-x d</code> (<code>dired</code>).  The result will be a buffer that looks like
the output of the Unix <code>ls(1)</code> command with its <code>-l</code> option<sup><a id="fnr.151" href="#fn.151" role="doc-backlink">151</a></sup>.  Here’s the
source code directory of one of my Emacs packages:
</p>

<div id="org52f4fe9">
<p><a href="https:./images/dired.png" alt="=C-x d= (M-x dired)" title="=C-x d= (M-x dired)" width="100%"><img src="https://blog.veitheller.de/images/dired.png" alt="=C-x d= (M-x dired)" title="=C-x d= (M-x dired)" width="100%"/></a>
</p>
<p><span>Figure 26: </span><code>C-x d</code> (M-x dired)</p>
</div>

<p>
This is <i>not</i> the same as the result of   <code>M-!</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Single-Shell"><code>shell-command</code></a>﻿) <code>ls
-l ~/src/refer-mode</code> which would look superficially similar; nor is it the same
as   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Directories"><code>list-directory</code></a>﻿.  For one thing Dired has colorized some of
the filenames, but most importantly, rather than being in
  <code>fundamental-mode</code>, the Dired buffer is in
  <code>dired-mode</code>.
</p>

<p>
In <code>dired-mode</code> you can of course move around in and search the buffer with all
the usual commands you already know, but the buffer is read-only so you can’t
modify it<sup><a id="fnr.152" href="#fn.152" role="doc-backlink">152</a></sup>, and many printing characters are bound to useful commands for
manipulating the files.  For example, if you move Point to any of the lines
representing a file, then hitting <code>RET</code> invokes
  <code>dired-find-file</code> and visits that file in a new buffer.
</p>

<p>
Dired is even more useful with the many enhancements from the
<a href="https://www.gnu.org/software/emacs/manual/html_node/dired-x/Top">Dired Extra</a> package.  I recommend adding
this to your <a href="#org2af3730">Init File</a>:
</p>

<div>
<pre>(add-hook &#39;dired-load-hook (<span>lambda</span> () (<span>require</span> &#39;<span>dired-x</span>)))
</pre>
</div>
<p>
and this chapter will assume you have done so.
</p>
</div>
<div id="outline-container-org4251264">
<h4 id="org4251264">Basic File Operations</h4>
<div id="text-org4251264">
<table id="org7eddca1">
<caption><span>Table 17:</span> Basic <code>dired</code> File Operations</caption>

<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Unix</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>RET</code>, <code>e</code>, <code>f</code></td>
<td><code>cat</code></td>
<td>visit (Edit, Find) this line’s file</td>
</tr>

<tr>
<td><code>a</code></td>
<td> </td>
<td>… and clobber Dired buffer</td>
</tr>

<tr>
<td><code>o</code></td>
<td> </td>
<td>… in other window</td>
</tr>

<tr>
<td><code>v</code></td>
<td><code>more</code>, <code>less</code></td>
<td>… in <a href="#orgdb8bc3e"><code>view-mode</code></a></td>
</tr>

<tr>
<td><code>^</code></td>
<td><code>ls ..</code></td>
<td>open Dired on the parent of this directory</td>
</tr>

<tr>
<td><code>F</code></td>
<td> </td>
<td>visit <i>all</i> <a href="#org65308d7">marked files</a></td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C</code></td>
<td><code>cp</code></td>
<td>Copy file</td>
</tr>

<tr>
<td><code>c</code></td>
<td><code>tar -cZ</code></td>
<td>Compress  files into a <code>tar</code> archive</td>
</tr>

<tr>
<td><code>D</code></td>
<td><code>rm</code></td>
<td>Delete file</td>
</tr>

<tr>
<td><code>G</code></td>
<td><code>chgrp</code></td>
<td>change Group</td>
</tr>

<tr>
<td><code>H</code></td>
<td><code>ln</code></td>
<td>make Hardlink to this file</td>
</tr>

<tr>
<td><code>i</code></td>
<td> </td>
<td>insert this subdirectory into Dired</td>
</tr>

<tr>
<td><code>M</code></td>
<td><code>chmod</code></td>
<td>change Mode (permissions)</td>
</tr>

<tr>
<td><code>O</code></td>
<td><code>chown</code></td>
<td>change Ownership</td>
</tr>

<tr>
<td><code>P</code></td>
<td><code>lpr</code></td>
<td>Print file</td>
</tr>

<tr>
<td><code>R</code></td>
<td><code>mv</code></td>
<td>Rename file</td>
</tr>

<tr>
<td><code>S</code></td>
<td><code>ln -s</code></td>
<td>make <i>absolute</i> Symlink to this file</td>
</tr>

<tr>
<td><code>T</code></td>
<td><code>touch</code></td>
<td>update file’s Timestamp</td>
</tr>

<tr>
<td><code>Y</code></td>
<td><code>ln -s</code></td>
<td>make <i>relative</i> symlink to this file</td>
</tr>

<tr>
<td><code>w</code></td>
<td> </td>
<td>copy this file’s basename to the kill ring</td>
</tr>

<tr>
<td><code>0 w</code></td>
<td> </td>
<td>… absolute pathname</td>
</tr>

<tr>
<td><code>C-u w</code></td>
<td> </td>
<td>… relative filename</td>
</tr>

<tr>
<td><code>W</code></td>
<td><code>firefox</code></td>
<td>view this presumably HTML file in your <a href="#orgab8b7dc">Web browser</a></td>
</tr>

<tr>
<td><code>Z</code></td>
<td><code>gzip</code>, <code>tar</code></td>
<td>(un)compress and/or (un)tar this file</td>
</tr>

<tr>
<td><code>=</code></td>
<td><code>diff</code></td>
<td>compare this file to another</td>
</tr>

<tr>
<td><code>+</code></td>
<td><code>mkdir -p</code></td>
<td>create a new subdirectory</td>
</tr>

<tr>
<td><code>!</code>, <code>X</code>, <code>&amp;</code></td>
<td> </td>
<td>run shell command on file (see <a href="#org55c7f09">below</a>)</td>
</tr>

<tr>
<td><code>?</code></td>
<td> </td>
<td>1-line help or describe errors</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>B</code></td>
<td> </td>
<td>Byte-compile elisp files</td>
</tr>

<tr>
<td><code>L</code></td>
<td> </td>
<td>Load elisp files into Emacs</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>: d</code></td>
<td> </td>
<td>Decrypt file</td>
</tr>

<tr>
<td><code>: e</code></td>
<td> </td>
<td>Encrypt file</td>
</tr>

<tr>
<td><code>: s</code></td>
<td> </td>
<td>Sign file</td>
</tr>

<tr>
<td><code>: v</code></td>
<td> </td>
<td>Verify signature</td>
</tr>
</tbody>
</table>
<p>
Table <a href="#org7eddca1">17</a> lists some of the basic Dired file operations; the Unix column
gives roughly analogous shell commands.  All the commands operate on the file
named on the current line — you don’t have to have Point precisely on the
filename part of the line.  Some of the commands operate immediately (e.g., the
file visiting commands), but most will either ask for confirmation or for
additional information.  <code>C</code> will ask for the name of the new, copied, file; <code>M</code>
will ask for the new file mode; <code>D</code> will ask if you’re sure you want to delete the
file, and so on.
</p>

<p>
Most of these commands can be applied to multiple files; see <a href="#org65308d7">below</a>.
</p>
</div>
</div>

<div id="outline-container-orgb3a35b7">
<h4 id="orgb3a35b7"><a id="org5d57b45"></a> Subdirectories</h4>
<div id="text-orgb3a35b7">
<p>
Inevitably some of the files in your Dired buffer will be directories
themselves (initially at least, every Dired buffer will contain the standard
Unix <code>.</code> and <code>..</code> directories).  There are two ways to work with the contents of a
subdirectory:
</p>
<ul>
<li>open it in its own Dired buffer (just use any of the Dired file visiting
commands such as <code>RET</code>, <code>e</code> <code>f</code>, <code>o</code>, or <code>a</code>), or</li>
<li>insert (expand) its contents into the current Dired buffer with <code>i</code>
(  <code>dired-maybe-insert-subdir</code>).</li>
</ul>

<p>
Both approaches have merit.  I usually prefer inserting unless I want to start
working in two-panel mode with <a href="#org34be85c">Dired DWIM</a>.
</p>

<p>
When you insert a subdir, it looks much like it does when you run <code>ls -lR</code>.
Here I’ve issued the <code>i</code> command from the <code>makefiles</code> line:
</p>
<pre id="org924d197">-rw-r--r--   1 keith keith  231 Oct 16  2008 Makefile
drwxr-xr-x   2 keith keith 4.0K Jun 29 13:29 makefiles
-rw-r--r--   1 keith keith  437 Feb  7 17:34 README.ascii

/home/keith/src/refer-mode/makefiles:
total used in directory 28K available 93.5 GiB
drwxr-xr-x 2 keith keith 4.0K Jun 29 13:29 .
drwxr-xr-x 4 keith keith 4.0K Jun 30 13:07 ..
-rw-r--r-- 1 keith keith  290 Jan 19 17:15 Makefile.gnumake
-rw-r--r-- 1 keith keith 1.2K Jan 19 17:18 Makefile.help
-rw-r--r-- 1 keith keith 1.2K Feb  7 17:35 Makefile.org
</pre>
<p>
(If you type <code>i</code> on a non-directory, it’s an error; if you type it on a directory
that’s already inserted, Point will jump to the first file in that
subdirectory.)
</p>

<p>
The subdirectory header lines — e.g. <code>/home/keith/src/refer-mode/makefiles:</code> in
the above — support some special actions.  Typing <code>l</code>
(  <code>dired-do-redisplay</code>) on one of these lines updates the
contents, so that a file newly created (by some other program) in the
subdirectory will appear, deleted files disappear, and any changes to file
sizes, permissions, etc, will also be updated.  <code>$</code>
(  <code>dired-hide-subdir</code>) will toggle the visibility of the
contents of the subdir, leaving the header line.
</p>

<p>
<code>&lt;</code> and <code>&gt;</code> move Point from directory file to directory file in the buffer, and the
usual <a href="#orge30bd19">list-motion</a> key bindings (<code>C-M-n</code>, <code>C-M-p</code>, <code>C-M-u</code>, <code>C-M-d</code>) move in terms of
inserted directory header lines.
</p>

<p>
When any subdirectories are inserted, all the files visible in them can be
manipulated along with all the files in the directory proper; this includes all
the <a href="#org65308d7">file marking</a> commands discussed below.
</p>
</div>
</div>

<div id="outline-container-org0db6c6e">
<h4 id="org0db6c6e">Compressing and Archiving Files</h4>
<div id="text-org0db6c6e">
<p>
<code>Z</code> (  <code>dired-do-compress</code>) is somewhat special.  If applied to a
single regular file, or several <a href="#org65308d7">marked files</a>, it compresses or uncompresses
them, based on the file extension<sup><a id="fnr.153" href="#fn.153" role="doc-backlink">153</a></sup>.
</p>

<p>
If applied to a directory (a subdirectory of the Dired buffer, which includes
the <code>.</code> and <code>..</code> entries), <code>Z</code> creates a compressed <a href="https://en.wikipedia.org/wiki/Tar_(computing)">tar archive</a> of all the files in
that directory<sup><a id="fnr.154" href="#fn.154" role="doc-backlink">154</a></sup>.  If applied to an archive file, the <code>Z</code> command will
extract its contents.  Dired knows some
17
compression and archive types.
</p>

<p>
Dired is the easiest way I know to create a tar archive containing a precise and
arbitrary set of files.  It’s easy to tar up a directory of files from the shell
with <code>tar cvzf archive.tar.gz some-directory</code>.  But what if you only want a subset
of the files in <code>some-directory</code>?  Maybe just the <code>.mp3</code> files but not the <code>.jpg</code> and
<code>.pdf</code> files, but including the <code>README.txt</code>?  You can carefully list all the files
to be included on the command line: pretty tedious!  Or use tar’s <code>--exclude</code> option,
but that’s going to be even more tedious if there are lots of files to exclude.
</p>

<p>
With Dired, it’s easy.  Just use the powerful <a href="#org65308d7">file marking commands</a> to select
exactly the files you want, and then invoke
    <code>c</code> (<code>dired-do-compress-to</code>), and the tar file will contain
exactly the files you marked.
</p>
</div>
</div>
<div id="outline-container-orgdb9a4a3">
<h4 id="orgdb9a4a3">Deleting Files by <i>Flagging</i></h4>
<div id="text-orgdb9a4a3">
<p>
In addition to <code>D</code> (  <code>dired-do-delete</code>), which deletes the
current file, you can take a more
thoughtful approach to cleaning up a directory by <i>flagging</i> a set of files for
deletion, and then, after suitable contemplation, delete them all.  The command
<code>d</code> (  <code>dired-flag-file-deletion</code>), rather than deleting a file,
sets the <code>D</code> flag in the Dired buffer; here I’ve typed <code>d</code> on all the squiggle-file
lines:
</p>
<pre id="orge834617">D -rw-r--r--   1 keith keith  436 Jan 19 16:49 README.org~
  -rw-r--r--   1 keith keith  50K May  1 15:47 refer-mode.el
D -rw-r--r--   1 keith keith 1.2K Dec 22  2017 refer-mode.el~
  -rw-r--r--   1 keith keith  21K Jun 28 15:30 refer-mode.org
D -rw-r--r--   1 keith keith 1.6K Sep  7  2020 refer-mode.org~
</pre>
<p>
If you change your mind about any of them, you can undo the flag with
<code>u</code> (  <code>dired-unmark</code>).  When you’re ready, you can actually
<i>execute</i> all the deletions with <code>x</code> (  <code>dired-do-flagged-delete</code>).
The confirmation prompt will clearly list all the files about to be deleted to
help avoid tragic mistakes.<sup><a id="fnr.155" href="#fn.155" role="doc-backlink">155</a></sup>
</p>

<p>
For more convenience in cleanup, the command
    <code>% &amp;</code> (<code>dired-flag-garbage-files</code>) will add <code>D</code> flags to all the
files that look like “garbage”<sup><a id="fnr.156" href="#fn.156" role="doc-backlink">156</a></sup> and
    <code>% d</code> (<code>dired-flag-files-regexp</code>) will flag all files whose names
match a <a href="#org19c6ad0">regular expression</a>.
</p>

<p>
The flagging commands---<code>d</code> and its friends—are actually a special case of the general Dired
concept of <i>marking</i>.
</p>
</div>
</div>
<div id="outline-container-org863debf">
<h4 id="org863debf">Marking Files <a id="org65308d7"></a></h4>
<div id="text-org863debf">
<p>
When manipulating files in the shell, you can use wildcards (<a href="https://en.wikipedia.org/wiki/Glob_(programming)"><i>glob</i> characters</a>)
to handle multiple files at once.  Dired itself doesn’t support wildcards, but
it has a few (superior) tricks up its sleeve.
</p>

<p>
Most of the basic commands in Table <a href="#org7eddca1">17</a> take a <a href="#orgb0f6ffd">numeric argument</a>; given
an argument of \(N\), the command will be applied to the next \(N\) files.  So <code>C-u 2
D</code> will delete the file on the current line and the file on the line after it.
<code>dired-mode</code> is descended from   <code>special-mode</code> and like most
<a href="#orgfa25f51">Special Modes</a>, you can use the digits alone as numeric arguments, so just plain
<code>2 D</code> is equivalent.
</p>

<p>
However, this is really only ever used for a very small number of files, like
two or three, because having to count is both annoying and error-prone.  On top
of that, the files you want to operate on might not be contiguous!  The
solution is to <i>mark</i> the set of files of interest.
</p>

<p>
We saw above how the <code>d</code> command <i>flags</i> files for deletion, but Dired also has a
general purpose mark, spelled <code>*</code>.  You can apply this mark to any file or
directory (and advance Point to the next file) with <code>m</code> (  <code>dired-mark</code>);
<code>u</code> (  <code>dired-unmark</code>) will remove the mark on the current line
and advance (<code>DEL</code> unmarks and moves in reverse), and <code>U</code>
(  <code>dired-unmark-all-marks</code>) will remove all the marks in the
Dired buffer.  <code>m</code> itself takes a numeric argument; or, if the <a href="#org34ab2da">Region is
activated</a>, will mark all the files within it.  Finally, if you hit <code>m</code> on an
<a href="#org5d57b45">expanded subdirectory header line</a>, it will mark all the files within that
directory (if you hit <code>m</code> on a directory proper, it only marks that directory
filename).  Here I’ve marked two <code>README</code> files; in addition to the <code>*</code> mark, the
filenames are colored a bold orange:
</p>

<pre id="orge788c45">  drwxr-xr-x   2 keith keith 4.0K Jun 29 13:29 makefiles
* -rw-r--r--   1 keith keith  437 Feb  7 17:34 README.ascii
* -rw-r--r--   1 keith keith  455 Jan 19 19:26 README.org
  -rw-r--r--   1 keith keith  436 Jan 19 16:49 README.org~
</pre>
<p>
Sometimes it would be easier to mark the files you’re <i>not</i> interested in, rather
than those you are.  Just mark the uninteresting files and hit <code>t</code>
(  <code>dired-toggle-marks</code>), and the marks will all flip.  The
easiest way to mark <i>all</i> the files in the Dired buffer is to hit <code>t</code> when no files
are marked (you can always achieve that state with <code>U</code>, or can memorize the
sequence <code>U t</code> as “mark all files”).
</p>

<p>
You can move from marked file to marked file with
<code>M-}</code> (  <code>dired-next-marked-file</code>)
and <code>M-{</code> (  <code>dired-prev-marked-file</code>).
</p>

<p>
When there are <code>*</code> marks in the buffer, most of the basic Dired commands will
operate on all the marked files, instead of on the current line.<sup><a id="fnr.157" href="#fn.157" role="doc-backlink">157</a></sup> So to
copy 10 files to a different directory, just mark the files and say <code>C</code>.  Some
commands have to make specific interpretations in the presence of marks,
or may ignore them if they just don’t make sense.
</p>

<p>
Some Dired commands will add their own special marks to files.  The <code>C</code> command
adds a <code>C</code> mark to the new file that just got created by the copy; the <code>H</code> command
will likewise add an <code>H</code> mark and the <code>S</code> and <code>Y</code> commands an <code>S</code> mark to the new files
they create<sup><a id="fnr.158" href="#fn.158" role="doc-backlink">158</a></sup>.  Here’s part of my Dired buffer after I’ve copied (with the
<code>C</code> command) the <code>upload.el</code> file to the name <code>Y</code>, hard-linked it to <code>X</code> with the <code>H</code>
command, and relatively-symlinked it to <code>Z</code> (with the <code>Y</code> command).  That’s three
new files that weren’t in the directory (and hence weren’t in the Dired buffer)
previously.
</p>
<pre id="org39a2b4f">  -rw-r--r--   1 keith keith 3.6K Jun 26 13:44 TODO
H -rw-r--r--   2 keith keith  251 Jan 19 16:40 X
S lrwxrwxrwx   1 keith keith    9 Jun 28 15:02 Z -&gt; upload.el
C -rw-r--r--   1 keith keith  251 Jan 19 16:40 Y
  -rw-r--r--   2 keith keith  251 Jan 19 16:40 upload.el
</pre>
<p>
These marks serve as an indicator that the operations were done and these files
won’t be affected by any commands operating on the standard <code>*</code> or <code>D</code> marks that
may be in the buffer.  But they aren’t just cosmetic.
</p>

<p>
Suppose you make copies of 10 files.  All the copies will be marked
with the <code>C</code> mark.  Now perhaps you want to change the file permissions of the
copied files to read-only.  Just change the <code>C</code> marks to <code>*</code> marks with
<code>* c</code> (  <code>dired-change-marks</code>) and now
<code>M</code> (  <code>dired-do-chmod</code>) will change the modes of the 10 copied
files.
</p>
</div>
</div>

<div id="outline-container-orgdc01d52">
<h4 id="orgdc01d52">The Mark Keymap</h4>
<div id="text-orgdc01d52">
<p>
Manually marking files with <code>m</code> may not seem like any competition for shell glob
patterns, so Dired has a whole slew of commands to make marking multiple files
easier; they can be found on the <code>*</code>-prefix key in <code>dired-mode</code>; see Table
<a href="#org4ecf157">18</a>.
</p>

<table id="org4ecf157">
<caption><span>Table 18:</span> The Dired Mark Keymap</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>* *</code></td>
<td>mark all executable files</td>
</tr>

<tr>
<td><code>* /</code></td>
<td>mark all directories</td>
</tr>

<tr>
<td><code>* @</code></td>
<td>mark all files that are symlinks</td>
</tr>

<tr>
<td><code>* .</code></td>
<td>mark all files with a given file extension</td>
</tr>

<tr>
<td><code>* %</code></td>
<td>mark all files matching a <a href="#org19c6ad0">regexp</a></td>
</tr>

<tr>
<td><code>* s</code></td>
<td>mark all files in the current Subdirectory</td>
</tr>

<tr>
<td><code>* O</code></td>
<td>mark all <a href="#org8f196ef">Omitted files</a></td>
</tr>

<tr>
<td><code>* c</code></td>
<td>Change all given marks to some other mark</td>
</tr>

<tr>
<td><code>* N</code></td>
<td>display Number of marked files</td>
</tr>
</tbody>
</table>
<p>
If you’re familiar with the <code>ls(1)</code> command’s <code>-F</code> (<code>--classify</code>) option, the
mnemonics for <code>* *</code>, <code>* /</code> and <code>* @</code> will be obvious.  <code>* %</code>’s mnemonic is that Dired has
a <a href="#orgfc82062"><code>%</code> prefix full of regexp operations</a>.
</p>

<p>
Issue any of these marking commands and the matching files will be marked with
<code>*</code>’s.  You can combine several of them, and also mix in <code>t</code>, <code>m</code> and <code>u</code> commands until
you’ve got exactly the combination of files you want.
</p>

<p>
All of these marking commands will instead <i>unmark</i> if given a prefix argument via
    <code>C-u</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Arguments"><code>universal-argument</code></a>﻿).
</p>

<p>
Why is there no command to mark plain files, i.e., non-directory files?  That
seems like an oversight!  The reason is that you can achieve that effect in
several ways: you can mark <i>all</i> the files with <code>U t</code> and then say <code>C-u * /</code> to unmark the
directories, or you can unmark all with <code>U</code>, mark the directories with <code>* /</code>, and
then toggle the marks with <code>t</code>.
</p>

<p>
<code>* N</code> (  <code>dired-number-of-marked-files</code>) is a little out of place
in the <code>*</code> Keymap, in that it doesn’t mark any files, but it’s a handy command
that will display in the <a href="#org7e7133f">Echo Area</a> the number of marked files and their total
size.
</p>
</div>
</div>
<div id="outline-container-org51aa8f7">
<h4 id="org51aa8f7">Mass Name Changes by Regular Expression <a id="orgfc82062"></a></h4>
<div id="text-org51aa8f7">
<p>
A classic file management problem that was left unsolved by the founding fathers
of Unix (Ken, Dennis, Brian, <i>et al</i>.) is operating on many files while changing
their names according to some pattern: for example, copying a bunch of files but
adding a <code>.bak</code> extension, renaming files to their lowercase equivalents, and the
like.  People used to resort to verbose and error-prone shell for-loops or scripts involving <code>sed(1)</code> or
<code>perl(1)</code>, and a number of special-purpose utilities have appeared over the years
to address this need (such as <code>rename(1)</code>, <code>mmv(1)</code>, <code>zsh(1)</code>’s <code>zmv</code>), but how to do it
is still a popular query in the search engines.
</p>

<p>
Dired provides a suite of commands to handle this, on the <code>%</code> prefix (mnemonic:
kind of like     <code>C-M-%</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Query-Replace"><code>query-replace-regexp</code></a>﻿)); see Table <a href="#org8f44234">19</a>.
</p>

<table id="org8f44234">
<caption><span>Table 19:</span> Dired by Regular Expression</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>% R</code>,  <code>% r</code></td>
<td>Rename files with new names</td>
</tr>

<tr>
<td><code>% l</code></td>
<td>rename files to Lowercase equivalents</td>
</tr>

<tr>
<td><code>% u</code></td>
<td>rename files to Uppercase equivalents</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>% C</code></td>
<td>Copy files with new names</td>
</tr>

<tr>
<td><code>% H</code></td>
<td>Hardlink files with new names</td>
</tr>

<tr>
<td><code>% S</code></td>
<td>Symlink files with new names</td>
</tr>

<tr>
<td><code>% Y</code></td>
<td>symlink files relatively with new names</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>% m</code></td>
<td>Mark files that Match regexp</td>
</tr>

<tr>
<td><code>% g</code></td>
<td>mark files <i>containing</i> regexp matches</td>
</tr>
</tbody>
</table>
<p>
Note that for all these commands, we are using Emacs <a href="#org19c6ad0">regular expressions</a>, <i>not</i>
shell wildcard (glob) patterns!
</p>

<p>
The exemplar for all these commands is <code>% R</code>
(  <code>dired-do-rename-regexp</code>).  Suppose we want to rename the
two files <code>README.ascii</code> and <code>README.org</code> to <code>about.ascii</code> and <code>about.org</code> — in other
words, we want to change the <code>README</code> part of each filename to <code>about</code>, preserving
any other parts of the filenames (such as, the extensions).
</p>

<p>
First, we have to mark the two <code>README</code> files, and then invoke <code>% R</code>.<sup><a id="fnr.159" href="#fn.159" role="doc-backlink">159</a></sup>  The
prompts go as follows:
</p>
<pre>Rename from (regexp): README
Rename README to: about
</pre>

<p>
and now we start renaming:
</p>
<pre>Rename ‘README.ascii’ to ‘about.ascii’? [Type yn!q or C-h]
</pre>

<p>
This prompt is similar in spirit to the way   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Query-Replace"><code>query-replace-regexp</code></a>﻿
works:
</p>
<table>


<colgroup>
<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td><code>y</code> or <code>SPC</code></td>
<td>to perform this renaming</td>
</tr>

<tr>
<td><code>n</code> or <code>DEL</code></td>
<td>to skip to the next renaming</td>
</tr>

<tr>
<td><code>!</code></td>
<td>to perform this and all renamings with no questions</td>
</tr>

<tr>
<td><code>q</code></td>
<td>skip this renaming and quit</td>
</tr>

<tr>
<td><code>C-h</code></td>
<td>explain these options</td>
</tr>
</tbody>
</table>
<p>
If we don’t choose <code>!</code> or <code>q</code>, then we’ll be asked the same question about each of
the remaining files:
</p>
<pre>Rename ‘README.org’   to ‘about.org’?   [Type yn!q or C-h]
</pre>

<p>
You need to be familiar with <a href="#org19c6ad0">regular expressions</a> to do fancier stuff<sup><a id="fnr.160" href="#fn.160" role="doc-backlink">160</a></sup>;
for example, we can add a <code>.bak</code> extension to a set of files by specifying <code>$</code> as
the from regexp and <code>.bak</code> as the replacement (because <code>$</code> is the regexp that
matches the end of any filename).
</p>

<p>
Note that the regexp is only applied to the <i>basename</i> of the file —
e.g. <code>README.org</code> not <code>/home/keith/src/refer-mode/README.org</code>.  If you give any of
these commands a <code>0</code> numeric argument, then the regexp <i>is</i> applied to the absolute
pathname, and you can then modify the directory structure as well.
</p>

<p>
<code>% l</code> and <code>% u</code> are convenient ways to do a simple case transformation on the entire
basename of the file (including the extension if any).
</p>

<p>
The <code>% C</code>, <code>% H</code>, <code>% S</code>, and <code>% Y</code> commands work like <code>% R</code>, <i>mutatis mutandis</i>.
</p>

<p>
Finally, we have two commands that merely mark files (with no action) based on
regular expressions.  They consider all the files in the buffer and mark the
ones that match.  <code>% m</code> (also available as <code>* %</code>) just does the match based on the
file basename, so <code>% m x</code> would mark all files whose names contain the letter <code>x</code>.
</p>

<p>
<code>% g</code> is just like <code>% m</code> except that it applies the regexp to the <i>complete contents</i>
of the files, rather than to their names.  It marks all the files that contain a
match for the regexp.  Think of it as the <a href="#orgfdf7146">Grep</a> of marking commands.
</p>

<p>
If you give either of these last two commands a <a href="#orgb0f6ffd">prefix argument</a>, they <i>unmark</i>,
instead of marking.
</p>
</div>
</div>

<div id="outline-container-orge752a09">
<h4 id="orge752a09">What Went Wrong? <a id="org2ca9fbe"></a></h4>
<div id="text-orge752a09">
<p>
We’ve learned a number of useful file manipulation commands, but we have to
face the fact that sometimes, some of them are going to fail.  Errors in Emacs
are usually simple: you hear a beep and there’s a message in the <a href="#org7e7133f">Echo Area</a>
telling you what went wrong.  But if you’re having Dired act on several, even
hundreds, of files in one stroke, you neither want to miss an error, nor be swamped
by too many.
</p>

<p>
Suppose we try to copy a bunch of files to a different directory, but it turns
out we don’t have permission.  Dired will display a message like this:
</p>
<pre>Copy: 17 of 17 files failed--type ? for details ((refer-mode.org README.org ...))
</pre>

<p>
and we can use <code>?</code> to pop up the <code>*Dired log*</code> buffer for a complete record of which
operations failed (and why); in this case we’d see lines like:
</p>
<pre id="org00fb25a">Thu Jul  1 11:58:13 2021	Buffer ‘refer-mode’

Copy: ‘/home/keith/src/refer-mode/GNUmakefile’ to ‘/etc/GNUmakefile’ failed:
(file-error Opening output file Permission denied /etc/GNUmakefile)
</pre>
</div>
</div>

<div id="outline-container-org0a08813">
<h4 id="org0a08813">Writable Dired <a id="org97d8442"></a></h4>
<div id="text-org0a08813">
<p>
Dired buffers are read-only buffers, so that you can’t accidentally corrupt the
contents and confuse Dired.  What if you edited the name of one of the files and
then tried to operate on it?  You’d get errors.
</p>

<p>
On the other hand, what if, when you edited the name of a file, it magically
renamed the file to the new name?  That would be an easy and natural way to
rename files.  More importantly, it would allow you to rename files using all
your Emacs skills: use     <code>M-l</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Case"><code>downcase-word</code></a>﻿) to change part of
a filename to lowercase; use     <code>M-%</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Query-Replace"><code>query-replace</code></a>﻿),
    <code>C-M-%</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Query-Replace"><code>query-replace-regexp</code></a>﻿), or <a href="#orgf8d8a5e">Rectangle</a> commands to
mass-rename a set of files without needing to mark them: even use a <a href="#orgd2c3858">Keyboard
Macro</a>!
</p>

<p>
This is exactly what Wdired allows.  You simply switch the Dired buffer from the
default read-only mode with the natural keystroke
    <code>C-x C-q</code> (<code>dired-toggle-read-only</code>) which <a href="#orgdb8bc3e">you’ll recall</a> normally
toggles <code>read-only-mode</code> on and off.  The mode indicator in the <a href="#org6456ffd">Modeline</a> will
change to <code>Editable Dired</code>, and now you can change filenames via whatever means
you like.  You can even change a file name like <code>foo.org</code> to <code>/tmp/foo.org</code> to move
it to a different directory; you can use relative or absolute paths for this,
and Dired will create new subdirectories as needed!
</p>

<p>
The changes don’t happen instantly, so you can take your time; edit one
filename, think about things, and edit another.  Maybe then change one of them
back (with <a href="#org3f93c8e">Undo</a> if you like!).  When you’re done with your changes, you <i>commit</i>
them with <code>C-c C-c</code> and then all your renames happen at once<sup><a id="fnr.161" href="#fn.161" role="doc-backlink">161</a></sup>; the buffer is
then restored to the normal read-only <code>dired-mode</code>.  If you experience Renamer’s
Remorse, you can instead cancel all your changes with <code>C-c ESC</code>.<sup><a id="fnr.162" href="#fn.162" role="doc-backlink">162</a></sup>
</p>

<p>
But there’s more.  If you have a symlink, you can edit either the symlink name,
its target, or both.  If you kill or delete a filename completely, the file
will be deleted.<sup><a id="fnr.163" href="#fn.163" role="doc-backlink">163</a></sup> And if you edit the permission string of a file, it
will be <code>chmod</code>’ed (so you could remove the write permissions on a file by editing
<code>-rw-r--r--</code> into <code>-r--r--r--</code>).<sup><a id="fnr.164" href="#fn.164" role="doc-backlink">164</a></sup> Any of these changes only take effect when
you commit.
</p>

<p>
This trick of editing a read-only buffer to effect real, but indirect, changes
is used elsewhere in Emacs.
</p>
</div>
</div>

<div id="outline-container-orgc0aac34">
<h4 id="orgc0aac34">Two-Panel Dired <a id="org34be85c"></a></h4>
<div id="text-orgc0aac34">
<p>
Many file managers use a two-panel design: they divide a window into two
(usually side-by-side), to make it easy to copy or move files from one directory
to another.  It’s useful to run Dired this way as well.  I recommend adding this
to your <a href="#org2af3730">Init File</a>:
</p>
<div>
<pre>(<span>setq</span> dired-dwim-target t)  <span>; </span><span>suggest other visible dired buffer</span>
</pre>
</div>
<p>
With this setting, you can just arrange for two Dired buffers to be visible, and
when you give any command that needs a target directory (like <code>C</code> (copy) or <code>R</code>
(rename)), the default will be the directory of the other Dired.  You don’t <i>have</i>
to accept this new default destination when prompted—you can override it in
any individual case—and this setting only has an effect when you have two
visible Dired Buffers.
</p>

<p>
DWIM, by the way, stands for “Do What I Mean”, and is named for an
error-correcting feature in an old Lisp system dating from 1966.
</p>
</div>
</div>

<div id="outline-container-org2b6a3c8">
<h4 id="org2b6a3c8">Searching and Replacing</h4>
<div id="text-org2b6a3c8">
<p>
Normally, if you want to search through all the files in a directory you use
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Grep-Searching"><code>grep</code></a>﻿,   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Grep-Searching"><code>lgrep</code></a>﻿, or   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Grep-Searching"><code>rgrep</code></a>﻿ (see <a href="#orgfdf7146">Meet
the Greps</a>).  But you can also use the power of <a href="#org65308d7">Dired marks</a> to limit your search
to a possibly idiosyncratic selection of the files in your Dired buffer.
</p>

<p>
Just set your marks and run <code>A</code> (  <code>dired-do-find-regexp</code>); any
marked directories will be searched recursively, and if you don’t have any
marks, the file or directory at Point will be searched.
</p>

<p>
A <a href="#orgdd5fd7e">Xref</a> buffer containing all the hits will pop up and you can navigate through
them; see Figure <a href="#org340dabc">27</a>.
</p>

<div id="org340dabc">
<p><a href="https:./images/dired-A.png" alt="Search for &#34;keys&#34; within files in Dired" title="Search for &#34;keys&#34; within files in Dired" width="100%"><img src="https://blog.veitheller.de/images/dired-A.png" alt="Search for &#34;keys&#34; within files in Dired" title="Search for &#34;keys&#34; within files in Dired" width="100%"/></a>
</p>
<p><span>Figure 27: </span>Search for “keys” within files in Dired</p>
</div>

<p>
This search is really more of an <a href="#org3c07b32">Occur</a>.  You can also do an <a href="#org3fa1f0c">Incremental Search</a>
through the marked files.  This is done with <code>M-s a C-s</code>
(  <code>dired-do-isearch</code>) or <code>M-s a C-M-s</code>
(  <code>dired-do-isearch-regexp</code>)<sup><a id="fnr.165" href="#fn.165" role="doc-backlink">165</a></sup>.  These are basically
entry points to   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Repeating-Search"><code>multi-isearch-files</code></a>﻿, with the marked files
eliminating the need to enter a bunch of filenames; see <a href="#org3d7dcc0"><i>Multi-Isearch</i></a> for details
</p>

<p>
You can also do a search and replace across your marked files with <code>Q</code>
(  <code>dired-do-find-regexp-and-replace</code>).  This pulls up all the
files with hits, one at a time, and in each runs a
    <code>M-%</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Query-Replace"><code>query-replace</code></a>﻿) for you.  There are other ways (which I prefer) to do a
search and replace across multiple files; see <a href="#orgdd5fd7e"><i>Xref</i></a> and <a href="#org8b8111c"><i>Writable Grep</i></a>.
</p>
</div>
</div>

<div id="outline-container-orgc990384">
<h4 id="orgc990384">Diffing and Comparing</h4>
<div id="text-orgc990384">
<p>
You can compare (“diff”) the file at Point with another file with <code>=</code>
(  <code>dired-diff</code>).  You’ll be prompted for the second file; if
the first file has a backup file, that will be the default (and vice versa).  If
the Region is <a href="#org34ab2da">active</a>, the files at Point and Mark are the ones compared.  A
prefix argument will let you specify the options given to <code>diff(1)</code>.
</p>

<p>
You can also compare two <i>directories</i> in an interesting manner.  Open two Dired
buffers on two different directories<sup><a id="fnr.166" href="#fn.166" role="doc-backlink">166</a></sup>; for the best demonstration, the
directories should be similar but not identical, e.g. one might be an older
version of the other.  Then, in either buffer, say
  <code>M-x</code> <code>dired-compare-directories</code>.  Hit <code>RET</code> at the prompt:
</p>
<pre>Mark if (lisp expr or RET):
</pre>

<p>
Now you’ll (most likely) see that there are marked files in both directories:
these are the files in each directory with unique names.  So in directory \(A\),
if the file <code>foo</code> is marked, it means that there is no file named <code>foo</code> in directory
\(B\), and so on.  Or, equivalently, the unmarked files in each directory are
those that also exist (with the same names) in the other directory.  Keep in
mind that this comparison is done purely at the level of the file <i>names</i>; the
contents do not enter into it.
</p>

<p>
Even just as a visual aid, this is useful for eyeballing the differences between
the two directories.  You can make use of the marks in either or both
directories to do further comparisons (with <code>=</code>), deletions, or copying.
</p>

<p>
If you know a little <a href="#org36dd556">Elisp</a>, you can mark the files more precisely than by
comparing their names; you can mark them based on their sizes, modification
times, owner, permission, etc.  Do:
</p>
<pre>C-h f dired-compare-directories
</pre>

<p>
for more information.
</p>
</div>
</div>

<div id="outline-container-org5cbc411">
<h4 id="org5cbc411">Reverting and Sorting the Dired Buffer</h4>
<div id="text-org5cbc411">
<p>
The contents of a directory can change out from under Emacs, so you can refresh
Dired’s notion of the directory contents with <code>g</code>, which is bound to
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Reverting"><code>revert-buffer</code></a>﻿ (as you might expect).  This will reveal any
new files, omit any files that were deleted outside of Emacs, and make the
displayed file sizes, permissions, etc reflect the current state.
</p>

<p>
The <code>l</code> command (  <code>dired-do-redisplay</code>) is a less broad version
of this: it only redisplays the info for the marked files (or next \(N\) files, if
given a numeric argument), or the files in a subdirectory, if issued on a subdir
headline.
</p>

<p>
You can also sort the Dired buffer by modification time (most recent files
first), rather than the default alphabetical order, with <code>s</code>
(  <code>dired-sort-toggle-or-edit</code>).  With a prefix arg, you’ll be
prompted to set the options for the <code>ls(1)</code> command that lists the files; the
default options are <code>-al</code><sup><a id="fnr.167" href="#fn.167" role="doc-backlink">167</a></sup>; the <code>-a</code> option causes files whose names begin
with <code>.</code> to be included.  If you don’t want to see dot files, do <code>C-u s -l RET</code>
(removing the <code>a</code> option) and the buffer will be refreshed to exclude them.  You
can also throw in other <code>ls(1)</code> sorting options, like <code>-r</code>, <code>-S</code>, <code>-t</code>; see the <code>ls(1)</code>
man page with   <code>M-x</code> <code>manual-entry</code>.  New options given in this manner
are <i>sticky</i> in that they persist through subsequent <code>g</code>’s.
</p>

<p>
While the <code>-l</code> option is mandatory, you can hide everything but the filename with
<code>(</code> (  <code>dired-hide-details-mode</code>).  That gives you a minimalist
skinny Dired buffer.  Another <code>(</code> brings the details back.
</p>

<p>
You can customize the default <code>ls</code> options by setting
  <code>dired-listing-switches</code> in your <a href="#org2af3730">Init File</a>; I add <code>-h</code>
(<code>--human-readable</code>) to print file sizes in a friendlier format (like 1K, 234M, 2G),
for example.  But check the variable’s documentation for details; some <code>ls</code>
options can break Dired.
</p>

<p>
Finally, the Dired buffer supports a limited version of <a href="#org3f93c8e">Undo</a>, bound to the usual
keys (e.g.   <code>C-/</code>).  This command can’t magically undelete files,
but it can revert changes to the buffer itself.  You can use it to recover
changed marks, killed lines, or hidden subdirectories.
</p>
</div>
</div>
<div id="outline-container-org6554940">
<h4 id="org6554940">Omitting Uninteresting Files <a id="org8f196ef"></a></h4>
<div id="text-org6554940">
<p>
Certain files can be considered uninteresting because you rarely want to
manipulate them (except perhaps to delete them): you typically don’t want to
visit them, copy them, or anything else.  These files include build artifacts;
checkpoint, lock and backup files; and the <code>.</code> and <code>..</code> directories.  The problem
with these files in Dired is that they take up screen real estate (requiring
more scrolling), and often have to be unmarked after you’ve marked, say, all
directories, or all the files that match a regexp.
</p>

<p>
You can <i>omit</i> these files from your Dired listing with <code>C-x M-o</code>
(  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/dired-x/Omitting-Variables"><code>dired-omit-mode</code></a>﻿), which toggles Omit Mode on and off.
You can also mark all the files that Omit Mode would omit with <code>* O</code>
(  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>dired-mark-omitted</code></a>﻿).
</p>

<p>
If you’d like to have these files omitted from your Dired buffers by default, as
soon as you open up any Dired buffer, add this to your <a href="#org2af3730">Init File</a>:
</p>
<pre>(add-hook &#39;dired-mode-hook &#39;dired-omit-mode)
</pre>

<p>
You can un-omit them after that with <code>C-x M-o</code>.
</p>

<p>
The precise definition of which files are omittable is controlled by the
variables   <code>dired-omit-files</code> and
  <code>dired-omit-extensions</code>.  See
<a href="https://www.gnu.org/software/emacs/manual/html_node/dired-x/Top">the Dired Extra manual</a> for details and
examples.
</p>
</div>
</div>
<div id="outline-container-org9905c06">
<h4 id="org9905c06">Running External Commands <a id="org55c7f09"></a></h4>
<div id="text-org9905c06">
<p>
If Point is on a file line in a Dired buffer, then <code>!</code>
(  <code>dired-do-shell-command</code>) prompts for a command and runs it
synchronously on that file; <code>&amp;</code>
(  <code>dired-do-async-shell-command</code>) does the same thing
asynchronously.  So if Point is on a file <code>foo.sh</code>, and you want to know how many
lines or words are in that file, you just type <code>! wc</code>, and the result is displayed in
the <a href="#org7e7133f">Echo Area</a>; this is equivalent to <code>M-! wc foo.sh</code> (except you didn’t have to
type the filename), and the output is handled in the same way.  You won’t be
surprised that <code>&amp; wc</code> is equivalent to <code>M-&amp; wc foo.sh</code>, and runs the <code>wc</code> command
asynchronously.
</p>

<p>
But these commands are not <i>exact</i> equivalents.  When you type <code>!</code> the prompt looks
like this:
</p>
<pre>! on foo.sh [sh]:
</pre>

<p>
The <code>sh</code> in the brackets is the suggested default command, so if you wanted to run
this shell script rather than count its lines, you could just hit return.  There
may be more suggestions than just the one shown; you can use <code>M-n</code>
(  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Minibuffer-History"><code>next-history-element</code></a>﻿) to scroll through them in the usual
way; see <a href="#org1fb87bb"><i>Future History</i></a>.  Emacs has commands to suggest for
55
possible files types and you can of course add your own via the
<code>dired-guess-shell-alist-user</code> variable.
</p>

<p>
<code>!</code> and <code>&amp;</code> operate on multiple files in the <a href="#org65308d7">standard Dired ways</a>, via numeric
arguments and marks.  When you run a command on multiple files, a window will
open above the prompt listing all the files that will be affected—a nice
reassurance.
</p>
</div>
<div id="outline-container-org2a21bc1">
<h5 id="org2a21bc1">What is the nature of the <i>command</i>?</h5>
<div id="text-org2a21bc1">
<p>
Dired’s <code>!</code> and <code>&amp;</code> actually take an arbitrary shell command, so you can add options
to the command (e.g. <code>! wc -l</code>) and it can even contain pipes and other
shell-specific stuff, with the filename appended to the end of the command.
</p>

<p>
Emacs quotes all the filenames for you and the command is run once for each
file.  So if you mark the files <code>bar</code>, <code>baz</code>, and <code>foo</code>, and say <code>! wc</code>, Emacs will run
<code>wc bar</code>, <code>wc baz</code>, and then <code>wc foo</code>, synchronously.
</p>

<p>
You can run just one <code>wc</code> command for all the files by saying <code>! wc *</code>; this
wildcard is interpreted by Emacs and <i>NOT</i> given to the shell.<sup><a id="fnr.168" href="#fn.168" role="doc-backlink">168</a></sup> Instead of
expanding to <i>all the files in the directory</i> as it would in the shell, Emacs will
put the list of filenames being operated on at the location of the <code>*</code>, so <code>cp *
some-directory</code> will work correctly<sup><a id="fnr.169" href="#fn.169" role="doc-backlink">169</a></sup>.  The filenames being operated on are
the marked files, or the file at Point, or the \(N\) files at Point if you uses a
numeric argument of \(N\), in the usual Dired interpretation.  The order of the
files in the expanded file list will match the order in which they occur in the
Dired buffer.
</p>

<p>
If you use <code>?</code> instead of <code>*</code>, Emacs will run a separate invocation of the command
for each of the multiple files, just like in the no-<code>*</code> case.<sup><a id="fnr.170" href="#fn.170" role="doc-backlink">170</a></sup> What’s the
point of this, then?  Well, you can repeat the <code>?</code> in the command and Emacs
replaces each <code>?</code> with the same filename.  The silly command <code>! mv ? /tmp/ &amp;&amp; touch ?</code>
will move each file to <code>/tmp/</code> and then replace it (in the original directory)
with a new empty file of the same name.
</p>

<p>
Again, this special interpretation of <code>?</code> only applies if it’s surrounded by
whitespace.  But there’s one more special wildcard:
<code>`?`</code>,
which is interpreted exactly as <code>?</code> except for the surrounded-by-whitespace
requirement.  This means you can make backup files with a command like
<code>! cp ? `?`.bak</code>.<sup><a id="fnr.171" href="#fn.171" role="doc-backlink">171</a></sup>
</p>
</div>
</div>

<div id="outline-container-org2df35f2">
<h5 id="org2df35f2">You mentioned running commands in parallel?</h5>
<p>
The <code>&amp;</code> command operates exactly like the <code>!</code> command, except that it runs
asynchronously.  So if you want to run your external PDF viewer on that Dired
file, you probably want <code>&amp;</code>.  If you use <code>&amp;</code> with \(N\) files, <i>without</i> using <code>*</code> in the
command, it will run \(N\) separate commands in parallel.
</p>
</div>
</div>
<div id="outline-container-org78ec9b9">
<h4 id="org78ec9b9">Image-Dired <a id="org316ab70"></a></h4>
<div id="text-org78ec9b9">
<p>
Dired can also be used as an image gallery, displaying thumbnails of image
files.  Just mark the files you’re interested in<sup><a id="fnr.172" href="#fn.172" role="doc-backlink">172</a></sup> and say <code>C-t C-t</code>
(  <code>image-dired-dired-toggle-marked-thumbs</code>); see Figure
<a href="#orga266ed9">28</a>.  If no files are marked, <code>C-t C-t</code> will display the thumbnail
for the file at Point.
</p>

<div id="orga266ed9">
<p><a href="https:./images/dired-inline.png" alt="Inline thumbnails in =dired-mode=" title="Inline thumbnails in =dired-mode=" width="100%"><img src="https://blog.veitheller.de/images/dired-inline.png" alt="Inline thumbnails in =dired-mode=" title="Inline thumbnails in =dired-mode=" width="100%"/></a>
</p>
<p><span>Figure 28: </span>Inline thumbnails in <code>dired-mode</code></p>
</div>

<p>
You can of course see any image full-size by visiting its file, which will
naturally come up in <a href="#orgd9f78fb"><code>image-mode</code></a>, but doing this will eventually clutter your
Emacs with many image buffers.  If you just want to view some images more
transiently, rather than <code>RET</code>, use <code>C-t i</code> (  <code>image-dired-dired-display-image</code>),
which will repeatedly use a single buffer called <code>*image-dired-display-image*</code>;
within this buffer <code>f</code> will full-size the image and <code>s</code> will resize it back to the
window size.  <code>C-t x</code> (  <code>image-dired-dired-display-external</code>)
will display the image with an external image viewer, outside of Emacs.
</p>

<p>
A limitation of Dired is that it can only list files one per line, so you may
have to do a lot of scrolling.  Instead of inline thumbnails you can pop up an
additional window containing a new buffer of thumbnails only.  Again, mark the
files of interest (or all of them) but this time invoke  <code>C-t d</code> to display the
thumbnails buffer; see Figure <a href="#org0ddd52b">29</a>.
</p>

<div id="org0ddd52b">
<p><a href="https:./images/image-dired.png" alt="Image-Dired Thumbnails Buffer" title="Image-Dired Thumbnails Buffer" width="100%"><img src="https://blog.veitheller.de/images/image-dired.png" alt="Image-Dired Thumbnails Buffer" title="Image-Dired Thumbnails Buffer" width="100%"/></a>
</p>
<p><span>Figure 29: </span>Image-Dired Thumbnails Buffer</p>
</div>

<p>
In the thumbnails buffer, you can move around with the usual motion commands;
<code>RET</code> pops up the <code>*image-dired-display-image*</code> buffer with a view of the image
corresponding to the current thumbnail, and <code>SPC</code> and <code>DEL</code> page the display buffer
forward and backwards through the images.  The Dired buffer is linked to your
motion through the thumbnails, so if you navigate to a thumbnail and then jump
to the Dired buffer, Point will be on the file corresponding to the thumbnail.
You can also mark, unmark, and flag files from the thumbnail buffer.
</p>
</div>
</div>

<div id="outline-container-orgbf7bdce">
<h4 id="orgbf7bdce">Tagging and Commenting Images</h4>
<div id="text-orgbf7bdce">
<p>
Images can be tagged and commented from the Dired buffer.  The image files
themselves are not altered by this process; the tags and comments live in a
metadata file in your   <code>user-emacs-directory</code>.  This allows
you to set Dired marks on all the files with a given tag; after you’ve done some
tagging perhaps <code>C-t f cat</code> would mark all your cat images.
</p>
<table>
<caption><span>Table 20:</span> <code>dired-mode</code> Image Tagging and Commenting Commands</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>C-t t</code></td>
<td>add a Tag to all the marked files</td>
</tr>

<tr>
<td><code>C-t c</code></td>
<td>add a Comment to all the marked files</td>
</tr>

<tr>
<td><code>C-t e</code></td>
<td>Edit both</td>
</tr>

<tr>
<td><code>C-t r</code></td>
<td>Remove the given tag from marked files</td>
</tr>

<tr>
<td><code>C-t f</code></td>
<td>mark all Files with given tag</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orga9acffc">
<h4 id="orga9acffc">Remote Directories</h4>
<p>
In addition to opening a directory on your local disk, Dired can also open a
directory on a remote computer, perhaps your office desktop at work.  I almost
didn’t think to mention this, because it’s in no way a special feature of Dired,
but just falls out of Emacs’s ability to manipulate remote files via <a href="#org2bfdd17">Tramp</a>.  So
when you run Dired, if you name a directory using Tramp’s remote file syntax,
then naturally the Dired buffer is remote, and all the Dired operations—file
copies, renames, deletions, visits, even shell commands via
  <code>!</code> (<code>dired-do-shell-command</code>)—run on the remote host.  Just as
naturally, in a local Dired, you can copy or rename a file <i>to</i> a remote host:
when prompted for the target filename, just use Tramp syntax.  This even works
with the <a href="#orgfc82062">mass name-changing</a> functions, and works seamlessly in <a href="#org34be85c">two-panel DWIM</a>
mode.  See <a href="#org2bfdd17"><i>Tramp</i></a> for details.
</p>
</div>
<div id="outline-container-org168b8d6">
<h4 id="org168b8d6">More Dired Entry Points</h4>
<div id="text-org168b8d6">
<p>
Normally     <code>C-x d</code> (<code>dired</code>) is invoked with a directory name, but
you can also invoke it with a glob pattern: <code>C-x d *.el</code> will bring up a Dired
Buffer with all, and only, the Elisp files in the default directory.
</p>

<p>
And there are more ways to get a Dired buffer than just
  <code>C-x d</code>.      <code>C-x C-j</code> (<code>dired-jump</code>) or
    <code>C-x 4 C-j</code> (<code>dired-jump-other-window</code>) from within a file buffer
will open Dired on that file’s directory.    <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Dired-and-Find"><code>find-name-dired</code></a>﻿ will
prompt you for a directory, and then for a filename, possibly containing Unix
wild cards (<a href="https://en.wikipedia.org/wiki/Glob_(programming)"><i>glob</i> characters</a>); it will generate a Dired buffer containing all
the matching files under the named directory, recursively.  So you might want to
run Dired on all your Elisp source files under your source code directory with:
</p>
<pre>M-x find-name-dired RET ~/src RET *.el
</pre>

<p>
This command is a convenient interface to the Unix <code>find(1)</code> command;
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Dired-and-Find"><code>find-dired</code></a>﻿ is a more full-featured version that let’s you
specify any <code>find</code> options you like.  <code>find-grep-dired</code> is much the same, but limits
the files to those that <i>contain</i> a <a href="#org19c6ad0">Regular Expression</a> as for <code>grep(1)</code>.
</p>

<p>
You can use <code>find-name-dired</code> to find files from <i>anywhere</i> on your system if you
give <code>/</code> (the top-level <i>root</i> directory) as the starting directory, but if you have
a large disk with many thousands of files, this can be slow.
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Dired-and-Find"><code>locate</code></a>﻿ is the Emacs interface to the Unix <code>locate(1)</code> command that
uses a database of filenames and so runs much faster.<sup><a id="fnr.173" href="#fn.173" role="doc-backlink">173</a></sup>
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Dired-and-Find"><code>locate-with-filter</code></a>﻿ has an additional prompt for a <a href="#org19c6ad0">Regular
Expression</a> that’s used to filter (limit) the hits.
</p>

<p>
You shouldn’t try to quote any of the arguments to any of the <code>find-</code> and <code>locate-</code>
commands—Emacs takes care of that for you—with the exception of <code>find-dired</code>
(because that one requires you to enter a raw <code>find</code> command).
</p>

<p>
Many Major Modes provide custom entry points to Dired.  For example,
<a href="#org8dc49db"><code>doc-view-mode</code></a> can pop up a Dired on its cache directory, <a href="#org7fd78c3">EMMS</a> will open Dired
on the music files in your playlist, and <a href="#orga12fa37">Projectile</a> will open Dired on your
current project.
</p>
</div>
</div>
<div id="outline-container-org35a21b2">
<h4 id="org35a21b2">Third-Party Directory Tools</h4>
<div id="text-org35a21b2">
<p>
There are some 60 packages in <a href="#org660cffc">MELPA</a> that provide
various enhancements to Dired, like fancy multi-panel layouts, sidebars,
displaying icons next to the files, cleaning up duplicate files, and more.  One of the
most useful is Pierre Neidhardt’s <code>disk-usage</code> package, which finds the files and
directories that are taking up the most space; see Figure <a href="#org68c0c9e">30</a>.
</p>

<div id="org68c0c9e">
<p><a href="https:./images/disk-usage.png" alt="=M-x disk-usage= and Dired" title="=M-x disk-usage= and Dired" width="100%"><img src="https://blog.veitheller.de/images/disk-usage.png" alt="=M-x disk-usage= and Dired" title="=M-x disk-usage= and Dired" width="100%"/></a>
</p>
<p><span>Figure 30: </span><code>M-x disk-usage</code> and Dired</p>
</div>
</div>
</div>
<div id="outline-container-orgcd82ef0">
<h4 id="orgcd82ef0">References</h4>
<div id="text-orgcd82ef0">
<ul>
<li>See <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Dired">“Dired”</a> in the <i>Emacs</i> manual.</li>
</ul>
<ul>
<li>Kremer, Sebastian and Free Software Foundation. 2022. <i>Dired Extra.</i> Cambridge, MA: Free Software Foundation..
Read in Emacs with <code>M-x info-display-manual RET dired-x RET</code>.</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgfbe307e">
<h3 id="orgfbe307e">Searching <a id="org3fa1f0c"></a> …</h3>
<div id="text-orgfbe307e">
<p>
Searching is one of the most important Emacs skills.  It’s pervasive: since it
works in (and across) your Buffers, it works, identically, not only within a
file you’re editing, but within the user interfaces (UIs) of Emacs and its many
subsystems—the <a href="#orge57a011">Help system</a>, <a href="#orgcc42ce0">Dired the file manager</a>, the Emacs <a href="#orga6bbd55">documentation</a>,
your <a href="#org039ef0a">shells and terminals</a>, your <a href="#org5e201bd">mail</a>, your <a href="#org0c5e670">calendar and diary</a>, your <a href="#org5138d90">web browser</a>,
your <a href="#orgcbc7d14">music player</a>—everything.  Imagine if you could explore and find your way
around the UI—the menus and toolbar—of a GUI application like your web
browser the same way you can search the text of one of its web pages.  And to
top it off, Emacs’s search facility is far more powerful than that of any GUI
application.
</p>

<p>
Searching can be divided into two major flavors: <i>incremental search style</i> and
<i>occurrences style</i>.  Incremental Search, which you may think of as “find as you
type” — a now common user interface feature invented in Emacs in the 1970s —
is probably the most important.  It takes you hit-by-hit through all the match
locations in that Buffer (with highlighting).
</p>

<div id="orgeaa60e2">
<p><a href="https:./images/incremental-search.png" alt="Incremental Search in Action" title="Incremental Search in Action" width="100%"><img src="https://blog.veitheller.de/images/incremental-search.png" alt="Incremental Search in Action" title="Incremental Search in Action" width="100%"/></a>
</p>
<p><span>Figure 31: </span>Incremental Search in Action</p>
</div>

<p>
Occurrences-style search works more like a web search engine: you type in your
query and Emacs pops up a <i>new</i> Buffer full of hits, from any of which you can
jump to the actual occurrence.  There are many forms of this, exemplified by
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Repeating-Search"><code>occur</code></a>﻿, which presents the matches from your current Buffer.
</p>

<div id="orgcda19be">
<p><a href="https:./images/occur.png" alt="... Transformed to Occur with a Keystroke" title="... Transformed to Occur with a Keystroke" width="100%"><img src="https://blog.veitheller.de/images/occur.png" alt="... Transformed to Occur with a Keystroke" title="... Transformed to Occur with a Keystroke" width="100%"/></a>
</p>
<p><span>Figure 32: </span>… Transformed to Occur with a Keystroke</p>
</div>

<p>
Occur also resembles the output of the Unix <code>grep(1)</code> command (especially with the
<code>--color</code> option turned on): the Buffer of hits is like the lines of <code>grep</code> output,
except you typically can’t click on a hit in the terminal and be taken to that
line of the matching file.  That is, unless you run <code>grep</code> under Emacs; see <a href="#orgfdf7146"><i>Meet the Greps</i></a>.
</p>
</div>
<div id="outline-container-org07445cb">
<h4 id="org07445cb">Incremental Search <a id="org3ffa52a"></a></h4>
<div id="text-org07445cb">
<p>
Incremental Search (<i>Isearch</i>) is a commonly used way to move around when you’re
editing text: it’s so fast and easy, I’ll even use it just to move to a spot in
the same line.  As befits one of the most heavily used features of Emacs,
Isearch is very powerful and thus very complex.  But if you have an idea of
what’s possible, you can start out easy and add fancy features as you gain
experience.  I would say I use most of these features, but not all, and a few
were surprises when I delved deep into the manual in order to write this
chapter.
</p>

<p>
The command     <code>C-s</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Basic-Isearch"><code>isearch-forward</code></a>﻿) starts a search and prompts
in the <a href="#orga329460">Minibuffer</a> for a search string:
</p>
<pre>I-search:
</pre>

<p>
Suppose you’re looking for occurrences of the word “and”: just start typing it.
As soon as you type the letter “a”, all the “a”’s visible in the current window
will be highlighted a light blue, except the very next “a” after Point, which
will be violet-red<sup><a id="fnr.174" href="#fn.174" role="doc-backlink">174</a></sup>; in fact, Point has been moved to this location.  Now the
prompt looks like:
</p>
<pre>Pending I-search: a
</pre>

<p>
Add “n” to your search, and all the highlights will be updated: now only
occurrences of “an” will be highlighted, and if necessary, Point will be moved
ahead to the first match.  Add your final “d” and now only “and”’s are
highlighted.
</p>
<pre>Pending I-search: and
</pre>

<p>
If the first “and” after Point isn’t the one you want, just type <code>C-s</code> again, and
Point will advance to the next “and”; you can keep <code>C-s</code>’ing through the hits.  If
the next hit is off-screen, the window will scroll.  When you’ve reached the
“and” you wanted, just hit <code>RET</code> to terminate the search; Point is now at the end
of the chosen “and”.
</p>

<p>
The whole point of the <i>incremental</i> part of Isearch is that you often don’t need
to type the entire string that you’re searching for: once Point reaches the
right spot, just hit <code>RET</code> and you’re done.  You can also start <code>C-s</code>’ing ahead at
any point. If you’re searching for the word
“Pneumonoultramicroscopicsilicovolcanoconiosis” command, there’s a good chance
you’ll have found it after “pn”; at any rate, you probably won’t have to type in
all 45 characters.
</p>
</div>
<div id="outline-container-orge699ef6">
<h5 id="orge699ef6">Failing Searches and Making Corrections</h5>
<div id="text-orge699ef6">
<p>
If the string you’re searching for isn’t present in the Buffer, Emacs will beep
and you’ll see in the Minibuffer something like:
</p>
<pre>Failing char-fold I-search: zq
</pre>

<p>
It’s likely that a prefix of your search string (here, “z”) is in the Buffer,
but the complete string (“zq”) is not.  Perhaps you <i>meant</i> to search for “zap”:
just use     <code>DEL</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Basic-Isearch"><code>isearch-delete-char</code></a>﻿) to delete the “q” and
make your correction.
</p>

<p>
If you’re typing quickly, you might get in a whole bunch of non-matching
characters at the prompt; that’s okay: you can delete them all one at a time
with <code>DEL</code>, but hitting <code>C-g</code> will delete all the non-matching characters in one
go.
</p>

<p>
When moving from hit to hit with additional <code>C-s</code>’s, you may overshoot
the hit you want.  <code>DEL</code> will “correct” this mistake too, taking you back to the
previous hit.
</p>

<p>
If you hit the end of the Buffer during a search, Emacs will likewise beep and
indicate search failure; but if you hit another <code>C-s</code>, your search will wrap
around to the <i>beginning</i> of the Buffer and continue searching from there.  The word
“Wrapped” will appear in the prompt to indicate this; if you go all the way
around, returning to your starting point, and keep going, the prompt will change
to “Overwrapped” to make it clear that you’ve seen all these hits already, and
there are no more new ones.
</p>
</div>
</div>
<div id="outline-container-org6b3a411">
<h5 id="org6b3a411">Editing Your Search</h5>
<p>
Suppose you’ve started Isearching for the word “stolidity” and only then
noticed that you really meant “solidity”.  You don’t have to do eight <code>DEL</code>’s and
then type a “t” and then retype “olidity”: you can put your Isearch into edit
mode with <code>M-e</code> (equivalently, <code>M-s e</code>); now you can use all the usual editing
features of Emacs, as you usually can in the Minibuffer, to go back and just
delete that “t”.  When your edit is done, restart your Isearch with any of <code>RET</code>,
<code>C-s</code>, or <code>C-r</code><sup><a id="fnr.175" href="#fn.175" role="doc-backlink">175</a></sup> and continue from there.
</p>
</div>
<div id="outline-container-orge714116">
<h5 id="orge714116">Aborting Your Search</h5>
<p>
Because <code>C-g</code>, usually   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Quitting"><code>keyboard-quit</code></a>﻿, in Isearch has the
handy use of zapping non-matching search characters, you need to use <i>two</i> <code>C-g</code>’s to
abort your search, leaving Point where you started.
</p>
</div>
<div id="outline-container-org1f9dc3d">
<h5 id="org1f9dc3d">Quick Search Exit</h5>
<p>
For the sake of editing speed, any other non-Isearch Emacs command will also end
the search successfully, and be immediately executed.  You could exit with
    <code>M-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Words"><code>forward-word</code></a>﻿), for example: <code>C-s zap M-f</code> is equivalent to
<code>C-s zap RET M-f</code>: both will leave Point at the end of the word following “zap”.
</p>
</div>
<div id="outline-container-org11c931d">
<h5 id="org11c931d">Scrolling</h5>
<div id="text-org11c931d">
<p>
Scrolling commands normally terminate the search and then scroll, as per above,
but I like to be able to scroll the window in mid-search, to see what’s coming
up (or what’s behind me).  This <a href="#org2af3730">Init File</a> snippet allows most scrolling commands
(like     <code>C-v</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Scrolling"><code>scroll-up-command</code></a>﻿),
    <code>M-v</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Scrolling"><code>scroll-down-command</code></a>﻿), and
    <code>C-l</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Recentering"><code>recenter-top-bottom</code></a>﻿)) to work this way.
</p>
<div>
<pre>(<span>setq</span> isearch-allow-scroll t)           <span>; </span><span>scroll while searching</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9e3d96f">
<h5 id="org9e3d96f">The Region is Set for Free</h5>
<div id="text-org9e3d96f">
<p>
When you end a search successfully, you’ll notice this message in the Minibuffer:
</p>
<pre>Mark saved where search started
</pre>

<p>
This means that <a href="#org34ab2da">the Region</a> (though inactive) is now around the text, from where
you started the search to where you are now, and you can do whatever you like to
the region (kill, copy, or modify it).  You can jump back to where you came from
with     <code>C-x C-x</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Setting-Mark"><code>exchange-point-and-mark</code></a>﻿) or <code>C-u C-SPC</code>
(  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Setting-Mark"><code>set-mark-command</code></a>﻿).
</p>
</div>
</div>
<div id="outline-container-org84c0256">
<h5 id="org84c0256">Changing Directions</h5>
<p>
If you know the string you’re looking for precedes Point, you can instead start
your search with     <code>C-r</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Basic-Isearch"><code>isearch-backward</code></a>﻿).  You can reverse
direction at any time with <code>C-r</code>, and change back to going forwards again with a
<code>C-s</code>, as needed.  The commands   <code>M-s M-&lt;</code> and
  <code>M-s M-&gt;</code>, which jump to the first match or last match
respectively, <i>without</i> terminating your search, can be useful for fine-tuning
your position before or after changing directions.
</p>
</div>
<div id="outline-container-orgf7b7de5">
<h5 id="orgf7b7de5">Restarting Your Last Search</h5>
<div id="text-orgf7b7de5">
<p>
Immediately after starting a search with <code>C-s</code>, if you type another <code>C-s</code>, it will
search for the last search string you used (the same is true if you start with
<code>C-r</code>—an immediate <code>C-r</code> reinvokes your previous search).  Think of the sequence
<code>C-s C-s</code> as “redo my last search” (same for <code>C-r C-r</code>).
</p>

<p>
Isearch maintains a history of your last
16 search strings in the usual
ring structure.  Just use <code>M-p</code> and <code>M-n</code> as usual to navigate through your
searches; when you’ve pulled up the one you want, you can edit it before
starting the search with another <code>C-s</code> or <code>C-r</code>.  There are separate histories for
simple string search and for <a href="#orgdb5b42f">regular expression</a> search.
</p>
</div>
</div>
<div id="outline-container-orgb5a1ee4">
<h5 id="orgb5a1ee4">Searching for Funny Characters</h5>
<p>
If you need to search for a non-printing character (which would normally
terminate your search), you can do so by <i>quoting</i> it with <code>C-q</code>.<sup><a id="fnr.176" href="#fn.176" role="doc-backlink">176</a></sup>  So you can search
for a <code>C-g</code> (ASCII 007) with <code>C-s C-q C-g</code>.  To include an explicit newline in your
search string, just use a simple <code>C-j</code> (the ASCII linefeed or newline character),
which you don’t have to quote.
</p>
</div>
<div id="outline-container-orgef652ca">
<h5 id="orgef652ca">Case Sensitivity and Whitespace <a id="orgd6159de"></a> <a id="org5b46b82"></a></h5>
<div id="text-orgef652ca">
<p>
Searches are case-insensitive<sup><a id="fnr.177" href="#fn.177" role="doc-backlink">177</a></sup> by default, so “and” will also find “And”
and “AND”, etc.  But if you include an uppercase letter anywhere in your search
string, then the search is performed case-<i>sensitively</i>.
</p>

<p>
Whitespace is treated abstractly: by default, a single space will match a
sequence of any whitespace characters (space, tab, formfeed, and newline in most
<a href="#org5b21ef0">Major Modes</a>).  This is called <i>lax space matching</i>.
</p>
</div>
</div>
<div id="outline-container-orgf2fd102">
<h5 id="orgf2fd102">Varieties of Isearch</h5>
<div id="text-orgf2fd102">
<p>
The cases just described are just defaults; you can toggle any of them on or off
in mid-search with the following special <code>isearch-mode</code> commands, any of which
only affects the current search and doesn’t “stick” for future searches (but you
can set your preference of default for each in your <a href="#org2af3730">Init File</a>; see
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Special-Isearch">“Special Isearch”</a> in the <i>Emacs</i> manual).
</p>

<dl>
<dt><code>M-s c</code></dt><dd><i>Case Folding</i>
Toggle case folding on and off; this command is also on <code>M-c</code>.  <i>On</i> by default.</dd>
<dt><code>M-s SPC</code></dt><dd><i>Lax Space Matching</i>
Toggle lax space matching on and off; when off, one space character matches only
a single space and not a run of spaces or a combination of other whitespace
characters.  <i>On</i> by default.</dd>
<dt><code>M-s &#39;</code></dt><dd><p>
<i>Diacritic Folding</i>
Toggle diacritic folding<sup><a id="fnr.178" href="#fn.178" role="doc-backlink">178</a></sup> on and off.  (Mnemonic: the apostrophe <code>&#39;</code> is like an acute
accent.)  When on, an unadorned letter will match that same letter with any
<a href="#org5f6b09d">diacritical mark</a>.  So, searching for “cafe” will also find “café”.  <i>Off</i> by
default.  I recommend turning this on by default with this <a href="#org2af3730">Init File</a> snippet:
</p>
<div>
<pre>(<span>setq</span> search-default-mode &#39;char-fold-to-regexp) <span>; </span><span>cafe = café</span>
</pre>
</div></dd>
<dt><code>M-s w</code></dt><dd><p>
<i>Word Search</i> <a id="org895b162"></a>
Toggle <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Word-Search">word search</a> on and off.
When on, the search string will only match complete words (so “an” will match
neither “any” nor “man” nor “pants”).  Your search string can be a sequence of
space-separated words and those complete words will match with any amount or
combination of whitespace and punctuation between them.  <i>Off</i> by default.
</p>

<p>
<code>M-s w</code> also has a global binding to   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Word-Search"><code>isearch-forward-word</code></a>﻿,
which initiates an incremental word search.
</p></dd>
<dt><code>M-s _</code></dt><dd><i>Symbol Search</i>
Toggle Symbol Search on and off.  Symbol search is exactly like word search,
except it deals with <i>symbols</i> rather than words, according to the current <a href="#org5b21ef0">Major
Mode</a>.  In programming language modes especially, Emacs symbols represent
variable and function names, which can contain punctuation characters which
aren’t typically allowed in Emacs <i>words</i>.  An example is that most languages
allow <code>_</code> in symbols, but <code>_</code> is usually not considered part of a word.<sup><a id="fnr.179" href="#fn.179" role="doc-backlink">179</a></sup>
(Hence the <code>M-s _</code> mnemonic.)  <i>Off</i> by default.</dd>
<dt><code>M-s i</code></dt><dd><p>
<i>Search Invisible Text</i>
</p>

<p>
Emacs has the ability to make text invisible; <code>M-s i</code> toggles whether or not an
incremental search will match text that’s currently invisible.  For example,
<a href="#org707bf87">Outline Mode</a> and <a href="#org4a851ca">Org Mode</a> let you hide (“fold”) the text within nested subheadings, so
you can focus on the outer text; <a href="#org707bf87">Selective Display</a> hides indented text (say in
programming language modes) for the same reason.  <i>Off</i> by default.
</p></dd>
<dt><code>M-s r</code></dt><dd><p>
<i>Regular Expression Search</i> <a id="orgdb5b42f"></a>
</p>

<p>
I’ve saved the best (perhaps) for last.  <code>M-s r</code> (also on <code>M-r</code>) toggles between
simple string search, which we’ve been discussing, and <i>regexp search</i>, which uses
the powerful pattern matching language of <a href="#org19c6ad0"><i>regular expressions</i></a>.  This is so
important and so heavily used that you can start out in a regexp search via the
global bindings     <code>C-M-s</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Regexp-Search"><code>isearch-forward-regexp</code></a>﻿) and
    <code>C-M-r</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Regexp-Search"><code>isearch-backward-regexp</code></a>﻿).  <i>Off</i> by default.
</p>

<p>
Other than searching for complex patterns rather than simple strings,
incremental regexp search is almost identical to Isearch, supporting all the
features described in this section.  The main exceptions are that lax spacing is
<i>not</i> on by default (you can toggle it on with <code>M-s SPC</code>) and that diacritic folding
is not available.
</p>

<p>
Why does Emacs have both simple string search and regular expression search?  In
editors that only have regexp search, you have to do a lot of quoting of the
regexp metacharacters (like a simple <code>.</code> or <code>$</code>); on the other hand, if you only have string search you
can’t do powerful searching.  So we have to have both, equally easy to use.
</p></dd>
</dl>
</div>
</div>
<div id="outline-container-org6a5931d">
<h5 id="org6a5931d">Nonincremental Search <a id="org151de6c"></a></h5>
<div id="text-org6a5931d">
<p>
Emacs’s incremental search is now the standard way to search; almost all
editors and many other applications (e.g. web browsers, shells) have adopted the idea<sup><a id="fnr.180" href="#fn.180" role="doc-backlink">180</a></sup>.
But I suppose you may occasionally want to do a non-incremental search, and you
can do that with <code>C-s RET</code> or <code>C-r RET</code> — in other words, begin your search by
hitting return and the prompt will change from <code>I-search</code> to <code>Search</code>, and now you
have to type your complete search string without seeing any intermediate
matches.  When you’ve typed it in, hit <code>RET</code> to do the search and you’ll be taken
to the first match.  Period.  Your search is over.  To find the next hit, you
have to do <code>C-s RET RET</code>, which will reuse the previous search string.
</p>

<p>
So disappointing.  This is the way all searches used to work before the
invention of incremental search.
</p>

<p>
Why would you want to do this?  I guess you can think of it as equivalent to <code>C-s</code>
followed by an immediate <code>M-e</code> to edit the search string.  Perhaps nonincremental
search is for people who haven’t yet learned how to yank.
</p>
</div>
</div>
<div id="outline-container-orgef8b9de">
<h5 id="orgef8b9de">Yanking Into the Search</h5>
<div id="text-orgef8b9de">
<table id="org9615d70">
<caption><span>Table 21:</span> Isearch Yank Commands</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>C-w</code></td>
<td>Yank next word from buffer</td>
</tr>

<tr>
<td><code>C-M-w</code></td>
<td>Yank next symbol from buffer</td>
</tr>

<tr>
<td><code>M-s C-e</code></td>
<td>Yank remainder of line from buffer</td>
</tr>

<tr>
<td><code>C-M-z</code></td>
<td>Yank string up to given character</td>
</tr>

<tr>
<td><code>C-M-y</code></td>
<td>Yank character at Point</td>
</tr>
</tbody>
</table>
<p>
Frequently you want to search for some text that is right in front of you in
the current Buffer, and the properly lazy Emacser never wants to type in text
unnecessarily.  Instead, you can yank text at Point right into your Isearch.  You
can do this right after starting a search, or after you’ve typed part of your
search string.  You can also yank in text from the <a href="#orgee263e4">Kill Ring</a> in the usual
manner with <code>C-y</code> and <code>M-y</code>.  See Table <a href="#org9615d70">21</a>.
</p>
</div>
</div>
<div id="outline-container-org5993c2c">
<h5 id="org5993c2c">Transitioning to Other Search Types</h5>
<div id="text-org5993c2c">
<table>


<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>M-r</code></td>
<td>Switch to regexp search</td>
</tr>

<tr>
<td><code>M-s o</code></td>
<td>Switch to <code>occur</code></td>
</tr>

<tr>
<td><code>M-%</code></td>
<td>Switch to <code>query-replace</code></td>
</tr>

<tr>
<td><code>M-s h r</code></td>
<td>Terminate search, leave highlights</td>
</tr>
</tbody>
</table>
<p>
You’ll find that Isearch is your goto-search—the one you automatically reach
for—but <code>isearch-mode</code> provides shortcuts to transition to other searches, so
that you don’t have to abort your Isearch and start over.
</p>

<p>
You can switch from simple string search to <a href="#org19c6ad0">regular expression</a> search with
<code>M-r</code>— perhaps your simple search isn’t finding enough matches; you may need to
use <code>M-e</code> to convert your search string to a more complex regexp.
</p>

<p>
I use the <code>M-s o</code> transition a lot: without terminating your Isearch, it pops up a
Buffer of hits, <a href="#org3c07b32">search-engine style</a>, as if you had done   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Repeating-Search"><code>occur</code></a>﻿.
</p>

<p>
You might decide in the middle of your search that you want to convert all the
matches to something else; <code>M-%</code> will switch to a <a href="#orgb683e7c"><code>query-replace</code></a>, using your
search string as the text to replace.  If you’re doing a regexp search when you
hit <code>M-%</code>, it will switch to   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Query-Replace"><code>query-replace-regexp</code></a>﻿ instead.
</p>

<p>
Finally, while it’s not really a transition to a different kind of <i>search</i>,
<code>M-s h r</code> will terminate your search, leaving all the hits in the Buffer
highlighted in a color of your choice; see <a href="#orgde73944"><i>Highlighting</i></a>.
</p>
</div>
</div>
<div id="outline-container-orgbb54cef">
<h5 id="orgbb54cef">Help</h5>
<p>
With <code>isearch-mode</code> having 80-odd key bindings, you might have trouble remembering
them all, so just try to remember <code>C-h C-h</code>, which will pop up a special Isearch
help Buffer.  For another perspectives on all this, see
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Incremental-Search">“Incremental Search”</a> in the <i>Emacs</i> manual.
</p>
</div>
</div>
<div id="outline-container-org57fc613">
<h4 id="org57fc613">Occurrences <a id="org3c07b32"></a></h4>
<div id="text-org57fc613">
<p>
Incremental Search gives you an overview of the matches for your search string
(via colorization), but if your Buffer is large and your matches are spread out,
you won’t be able to see very many of them without stepping through them all
</p>

<p>
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Repeating-Search"><code>occur</code></a>﻿ (also on the global binding   <code>M-s o</code>) gives you a more compact
overview of the matches in a separate Buffer named <code>*Occur*</code>.  It might look like
this (partial view of the <code>*Occur*</code> Buffer):
</p>

<pre id="orgfe1fcd1">29 matches for &#34;^#\+name:&#34; in buffer: use-emacs.org
   125:#+NAME: info-nodes
   209:#+name: age-in-years
   4277:#+name: image-mode-scaling-commands
   4290:#+name: image-mode-scroll-keys
   4404:#+name: basic-dired
   6218:#+NAME: shell-commands
   6695:#+NAME: face-count
</pre>
<p>
This is rather like a results page from a web search engine.  It tells you how
many total matches there were, and each hit shows the complete line it occurred
on, preceded by its line number; you remain in the Buffer from which you issued
the <code>occur</code> command.
</p>

<p>
This gives you a nice overview, and you can jump directly from match to match
with     <code>C-x `</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Compilation-Mode"><code>next-error</code></a>﻿) or its more mnemonic binding, <code>M-g M-n</code>
(Go to Next hit).<sup><a id="fnr.181" href="#fn.181" role="doc-backlink">181</a></sup>  Each <code>M-g M-n</code> moves Point to the next matching line in
the original Buffer—the Point in the <code>*Occur*</code> Buffer follows along—so you can
step through all the hits.
</p>

<p>
(Why “<code>next-error</code>”?  These search hits don’t seem like errors!  The reason is that
this is just one of many use cases for a command that originated to step through
the error messages from a compiler for a programming language; see <a href="#org76cafbe"><i>Compiling Code</i></a>.)
</p>

<p>
Instead of staying in the original Buffer and stepping though <i>all</i> the hits, you
can switch to the <code>*Occur*</code> Buffer and navigate to the lines of interest, where
you can hit <code>RET</code> to jump to that line in the original Buffer or <code>C-o</code> to stay in
the <code>*Occur*</code> Buffer but scroll the original Buffer to show that line in context.
</p>

<p>
Of course you might use an Isearch to navigate in the <code>*Occur*</code> Buffer, and in a
big <code>*Occur*</code> Buffer, I actually sometimes use… <code>M-x occur</code>!  Yes, an <code>occur</code> within
an <code>*Occur*</code> Buffer is a way to <i>narrow</i> the occurrences to a more precise list.
This all just works because, well, buffers are buffers and text is text, even
though <code>*Occur*</code> is the user interface of the <code>M-x occur</code> application!
</p>
</div>

<div id="outline-container-org1c71479">
<h5 id="org1c71479">Writable Occur, or <code>occur-edit-mode</code> <a id="orgee2aacf"></a></h5>
<p>
One of the more amazing features of <code>occur</code> is <code>occur-edit-mode</code>, bound to <code>e</code> in the
<code>*Occur*</code> Buffer.  This one of Emacs’s Indirect Editing features.  Normally, the
<code>*Occur*</code> Buffer is read-only, but typing <code>e</code> allows you to edit the Buffer.  The
amazing part is that when you’re done editing, give the command <code>C-c C-c</code><sup><a id="fnr.182" href="#fn.182" role="doc-backlink">182</a></sup>
(  <code>occur-cease-edit</code>) and all your edits are applied to the
matching lines in the <i>original</i> Buffer!  You can use any techniques to make these
changes: not just manual slogging, but things like
    <code>M-%</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Query-Replace"><code>query-replace</code></a>﻿) or a <a href="#orgd2c3858">Keyboard Macro</a>.
</p>
</div>
</div>
<div id="outline-container-orgbed46de">
<h4 id="orgbed46de">Multi-Buffer Searching <a id="org3d7dcc0"></a></h4>
<div id="text-orgbed46de">
<p>
With a long-running Emacs server, I typically have fifty or more buffers going
at any given time — files, shells, emails, web pages, directories, etc.  How
on earth do you find anything?
</p>

<p>
The best way to search <i>all</i> of your Emacs is to say <code>C-u</code>
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Repeating-Search"><code>multi-occur-in-matching-buffers</code></a>﻿.  You’ll be prompted for a
<a href="#org19c6ad0">regular expression</a> to target the buffers you want to search; just hit return:<sup><a id="fnr.183" href="#fn.183" role="doc-backlink">183</a></sup>
</p>
<pre>List lines in buffers whose names match regexp:
</pre>

<p>
Then you’ll be prompted for your search string (actually another regexp); we
should get lots of hits for “the”:
</p>
<pre>Collect strings matching regexp: the
</pre>

<p>
Normally this command only searches buffers that are visiting files, and the
first regexp is matched against the buffer’s visited filename, but with the
prefix argument (<code>C-u</code>), it searches <i>all</i> buffers, so that will include Dired
buffers, music player buffers, Help and Apropos buffers, shell and terminal
buffers: everything.
</p>

<p>
I just did such a search for the word “the”: in about one second, a new <code>*Occur*</code>
Buffer popped up showing “3518 matches in 2609 lines total across 108 buffers”.
The Buffer looks mostly like a normal <code>*Occur*</code>, but the matches are
grouped by Buffer; here’s an incomplete, edited example (all the occurrences of
“the” will be colorized):
</p>
<pre id="orge82ded2">3518 matches in 2609 lines total for &#34;the&#34;:
24 matches in 17 lines in buffer: sittin-on-the-dock-of-the-bay
      1:{title:Sittin&#39; On the Dock of the Bay}
      6:[G]Sittin&#39; in the mornin&#39; [B]sun
      7:I&#39;ll be [C]sittin&#39; when the ev - [B]en - [Bb]in&#39; [A]comes
6 matches in buffer: captain-beefheart
      4:*  The GREAT essential records
      7:- Doc at the Radar Station (1980)
     10:* The Good
     13:- The Spotlight Kid (1972)
241 matches in 185 lines in buffer: texmf.cnf
      9:% (Below, we use YYYY in place of the specific year.)
</pre>
<p>
All the usual <a href="#org3c07b32">Occur</a> commands work in this Buffer, including <code>e</code> (<code>occur-edit-mode</code>).
</p>

<p>
Instead of <code>multi-occur-in-matching-buffers</code>, you can instead use plain old
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Repeating-Search"><code>multi-occur</code></a>﻿, which prompts you, one at a time, for the set of
Buffers to search; you can use completion on the Buffer names.
</p>

<p>
You can also do a multi-incremental-search.  Personally, I think this is more
awkward than Multi-Occur, but your mileage may vary.  It’s just like a regular
Isearch except, when you hit the end of a Buffer, a <code>C-s</code>, instead of wrapping
around to the beginning of that Buffer, advances to the next Buffer that
contains a match.    <code>M-s M-&lt;</code> and   <code>M-s M-&gt;</code> are
especially useful here to skip over entire buffers and keep searching.
</p>

<p>
There are several entry points.  In Table <a href="#orgd969152">22</a>, “listed”
means you’ll be prompted to list the targets (buffers or files), and “regexp”
means you’ll enter a regular expression to match the targets.
</p>
<table id="orgd969152">
<caption><span>Table 22:</span> Multi-Isearch Entry Points</caption>

<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Targets</th>
<th scope="col">String Search</th>
<th scope="col">Regexp Search</th>
</tr>
</thead>
<tbody>
<tr>
<td>Buffers, listed</td>
<td><code>M-x multi-isearch-buffers</code></td>
<td><code>M-x multi-isearch-buffers-regexp</code></td>
</tr>

<tr>
<td>Buffers, regexp</td>
<td><code>C-u M-x multi-isearch-buffers</code></td>
<td><code>C-u M-x multi-isearch-buffers-regexp</code></td>
</tr>

<tr>
<td>Files, listed</td>
<td><code>M-x multi-isearch-files</code></td>
<td><code>M-x multi-isearch-files-regexp</code></td>
</tr>

<tr>
<td>Files, regexp</td>
<td><code>C-u M-x multi-isearch-files</code></td>
<td><code>C-u M-x multi-isearch-files-regexp</code></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="outline-container-org6a0c607">
<h3 id="org6a0c607">… and Replacing <a id="orgb683e7c"></a></h3>
<div id="text-org6a0c607">
<p>
One of the main reasons to search is in order to move to a new location.  The
other is to replace text.
</p>

<p>
The most important find-and-replace command is
    <code>M-%</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Query-Replace"><code>query-replace</code></a>﻿).  It prompts for a string to replace
(we’ll use “vim”):
</p>
<pre>Query replace (default foo → bar): vim
</pre>

<p>
and then the replacement text (we’ll use the obvious):
</p>
<pre>Query replace vim with: emacs
</pre>

<p>
Emacs then finds the first match for “vim” after Point, highlighting it (and all
the upcoming matches) in the manner of <a href="#org3ffa52a">Isearch</a>, and then asks what to do with
this match:
</p>
<pre>Query replacing vim with emacs: (? for help)
</pre>

<p>
Basically you type <code>y</code> to do this replacement or <code>n</code> <i>not</i> to do so, and Emacs then
jumps to the next match, and we repeat the process until we finish with the
final match in the Buffer.
</p>

<p>
To do the entire Buffer, first jump to the beginning with
    <code>M-&lt;</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>beginning-of-buffer</code></a>﻿).  With a negative <a href="#orgb0f6ffd">prefix
argument</a><sup><a id="fnr.184" href="#fn.184" role="doc-backlink">184</a></sup>, the replacements can be done backwards from Point.
</p>

<p>
With a simple prefix arg—just <code>C-u</code>—the search string is matched as a
whole-word as if for <a href="#org895b162"><code>M-s w</code></a> (  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Word-Search"><code>isearch-forward-word</code></a>﻿).
</p>

<p>
There are many more valid answers to the replacement question than just yes and
no; see Table <a href="#orgb750e4f">23</a>.<sup><a id="fnr.185" href="#fn.185" role="doc-backlink">185</a></sup>
</p>
<table id="orgb750e4f">
<caption><span>Table 23:</span> Query Replace Actions</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SPC</code>, <code>y</code></td>
<td>replace this match and proceed</td>
</tr>

<tr>
<td><code>DEL</code>, <code>n</code></td>
<td>skip this match and proceed</td>
</tr>

<tr>
<td><code>!</code></td>
<td>replace all remaining matches without asking</td>
</tr>

<tr>
<td><code>^</code></td>
<td>jump back to previous match</td>
</tr>

<tr>
<td><code>,</code></td>
<td>replace this match but don’t proceed yet (stay here)</td>
</tr>

<tr>
<td><code>u</code></td>
<td>undo previous replacement</td>
</tr>

<tr>
<td><code>U</code></td>
<td>undo all replacements</td>
</tr>

<tr>
<td><code>e</code>, <code>E</code></td>
<td>edit the replacement string</td>
</tr>

<tr>
<td><code>RET</code>, <code>q</code></td>
<td>Quit without replacing this one</td>
</tr>

<tr>
<td><code>.</code></td>
<td>replace this match, then quit</td>
</tr>

<tr>
<td><code>C-r</code></td>
<td>enter Recursive Edit</td>
</tr>

<tr>
<td><code>C-w</code></td>
<td>delete match and enter Recursive Edit</td>
</tr>
</tbody>
</table>
<p>
Most important is <code>!</code> which replaces all the remaining matches in one go, no
questions asked.  It’s typical that you <i>intend</i> to do all the replacements, but
want to see the first few in context before committing yourself with <code>!</code>.  Sometimes you
don’t have time to see the effect of the replacement because Emacs has jumped to
the next match and scrolled the replacement off-screen; in this case, just hit <code>^</code>
to jump back to where you were and take a look (more <code>^</code>’s will step back through
more replacements).  When you’re happy, just hit <code>SPC</code> to continue replacing where
you left off.
</p>

<p>
If you’re <i>not</i> happy with the replacement you’ve just done (maybe you hit <code>y</code> on
autopilot when you meant <code>n</code>), you can undo it with <code>u</code>; Point will jump back to
that spot, undo the change, and you can think again; any action is possible
here.  You can even undo <i>all</i> the replacements you’ve done so far with <code>U</code>, after
which you might want to edit your replacement text with <code>E</code> and then start over,
all without quitting the <code>query-replace</code>.
</p>

<p>
Sometimes you <i>do</i> want to quit early; <code>q</code> or <code>.</code> will do the job<sup><a id="fnr.186" href="#fn.186" role="doc-backlink">186</a></sup>: perhaps you only
wanted to do your <code>query-replace</code> in the current paragraph.
</p>

<p>
Actually, in that case you’d be wiser to set the <a href="#org34ab2da">active region</a> around the text
you want to replace within; if the Region is active, <code>query-replace</code> will only
operate on matches within it, and so you can safely use the convenient <code>!</code> without
affecting anything outside the Region.
</p>

<p>
Sometimes you’re stepping through replacements and find a spot where you want to
use a completely different replacement string—but just this once.  You could
quit with <code>q</code>, manually do the replacement, and then reinvoke <code>M-%</code> from that
location to continue—Emacs helpfully offers your previous search string and
replacement as the default.  The disadvantage of this is that you can no longer
use <code>^</code> to go back to locations from the preceding <code>M-%</code>, since it was terminated;
nor will <code>U</code> undo any of those changes.  Not a big deal, but there’s a fancier
way: instead of quitting, use <code>C-r</code> to enter a <a href="#orgbcf0f80">Recursive Edit</a>, make your anomalous
change, and use the usual     <code>C-M-c</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Recursive-Edit"><code>exit-recursive-edit</code></a>﻿) to exit
the Recursive Edit and continue your <code>query-replace</code> session.  <code>C-w</code> is a handy
shortcut.
</p>

<p>
Once you’ve done a few Query Replaces, you’ll notice that it’s <i>case-smart</i>.
Firstly, if your search string is entered in all lowercase letters, it is
matched in a case-insensitive mode (just as with <a href="#org3ffa52a">Isearch</a>).
In our “vim” → “emacs” example, if
one of the vims in the Buffer is capitalized (“Vim”) then you’ll see this
prompt:
</p>
<pre>Query replacing vim with Emacs: (? for help)
</pre>

<p>
Note that instead of replacing with “emacs”, it’s going to use “Emacs”,
to match the case of the “Vim”.  Likewise, if there’s a “VIM” the replacement
will be “EMACS”.
</p>

<p>
If your search string contains any uppercase letters, the searches will be done
case-<i>sensitively</i>, and likewise your replacement text will be used without
modification.  So <code>M-%</code> “Vim” → “emacs” will only match “Vim” and will replace it
with your all-lowercase “emacs”.  If your search string is all lowercase but
your replacement string contains any uppercase letters, the search is
case-insensitive but the replacement will be done exactly as given every time.
In Table <a href="#org429c864">24</a>, we summarize the three cases: the String column is the
text in your Buffer, and the Replacement column shows the result of responding
with <code>y</code>; an empty Replacement means that the particular String wasn’t considered a
match.
</p>
<table id="org429c864">
<caption><span>Table 24:</span> Case-smart <code>M-%</code> examples</caption>

<colgroup>
<col/>

<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Search</th>
<th scope="col">Replace</th>
<th scope="col">String</th>
<th scope="col">Replacement</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>vim</code></td>
<td><code>emacs</code></td>
<td><code>vim</code></td>
<td><code>emacs</code></td>
</tr>

<tr>
<td> </td>
<td> </td>
<td><code>Vim</code></td>
<td><code>Emacs</code></td>
</tr>

<tr>
<td> </td>
<td> </td>
<td><code>VIM</code></td>
<td><code>EMACS</code></td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>Vim</code></td>
<td><code>emacs</code></td>
<td><code>vim</code></td>
<td> </td>
</tr>

<tr>
<td> </td>
<td> </td>
<td><code>Vim</code></td>
<td><code>emacs</code></td>
</tr>

<tr>
<td> </td>
<td> </td>
<td><code>VIM</code></td>
<td> </td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>vim</code></td>
<td><code>Emacs</code></td>
<td><code>vim</code></td>
<td><code>Emacs</code></td>
</tr>

<tr>
<td> </td>
<td> </td>
<td><code>Vim</code></td>
<td><code>Emacs</code></td>
</tr>

<tr>
<td> </td>
<td> </td>
<td><code>VIM</code></td>
<td><code>Emacs</code></td>
</tr>
</tbody>
</table>

<p>
You’ll notice in the initial prompt that there’s a default search and
replacement pair which is your previous invocation (in the example above, it’s
to replace “foo” with “bar”).  Just hit <code>RET</code> to accept it and begin the process.
Alternately, you can use the <a href="#orga329460">familiar</a> <code>M-p</code> and <code>M-n</code> to cycle through your history
of Query Replace invocations.  At any point you can edit either the search
string part or the replacement part.
</p>

<p>
Some other Emacs commands—such as <a href="#orgcc42ce0">Dired’s</a> <code>Q</code> command,
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Identifier-Search"><code>xref-query-replace-in-results</code></a>﻿, or
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Identifier-Search"><code>tags-query-replace</code></a>﻿— will invoke a Query Replace for you on
multiple buffers.  In these multi-Buffer replacements, <code>!</code> will do unconditional
replacement <i>just</i> in the current Buffer; use <code>Y</code> (note the caps) to replace all of
the remaining matches in <i>all</i> the remaining buffers, or <code>N</code> to skip to the next
Buffer without replacing the remaining matches in the current Buffer.
</p>
</div>
<div id="outline-container-orge59c295">
<h4 id="orge59c295">Query Replace with a Regular Expression <a id="org9ebde75"></a></h4>
<div id="text-orge59c295">
<p>
If Query Replace isn’t powerful enough for you, you can try
    <code>C-M-%</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Query-Replace"><code>query-replace-regexp</code></a>﻿), where instead of a simple
search string, you use a Regular Expression.  It works much like <code>M-%</code>, but your
regexp search pattern can match much more flexibly.  For example, we might want
to go beyond just replacing “vim” with “emacs” via this regexp:
</p>
<pre>\&lt;\(\(neo\)?vim\|vi\|ed\|\(vs\)?code\|sublime\( *text\)?\|atom\)\&gt;
</pre>

<p>
which allows us to replace a whole collection of apostate editors with Emacs.
</p>

<p>
In addition to supporting a fancier search string, <code>query-replace-regexp</code> also
supports special features in the replacement string.  In order to start using
these very handy features, as long as you stick to letters, digits, and
whitespace—all of which, as regexps, work as you’d expect—you can start
using <code>query-replace-regexp</code> without waiting to become an expert in Regular
Expressions.  But if you want to use any other characters in your regexp, even
just the humble period (<code>.</code>), you’ll have to <a href="#org19c6ad0">learn how to <i>escape</i> them</a> first.
</p>

<p>
If you include <code>\#</code> in the replacement text, that pair of characters is replaced
by the number of replacements that have already been performed, so if our Buffer
contains:
</p>
<pre>foo foo foo foo foo foo
</pre>

<p>
and we execute <code>C-M-% foo RET foo\#</code> at the beginning of the Buffer, the resulting
Buffer is:<sup><a id="fnr.187" href="#fn.187" role="doc-backlink">187</a></sup>
</p>
<pre>foo0 foo1 foo2 foo3 foo4 foo5
</pre>


<p>
The sequence <code>\?</code> in the replacement text will result in a prompt for a string, so
that you can replace each <code>\?</code> with whatever you like.  Consider this command:
<code>C-M-x foo RET foo\?</code>.  First you’ll need to decide whether or not to perform this
replacement, as usual, by responding <code>y</code> or <code>n</code>; if you choose to do the
replacement, you’ll now get an additional prompt:
</p>
<pre>Edit replacement string: foo
</pre>

<p>
Now you can edit the replacement to be <code>foobar</code>, <code>barfoo</code>, <code>antiparticle</code>, the empty
string (to delete the match), or anything else.  For the next replacement, you’ll be
prompted anew, and can respond with a completely different string (or use <code>M-p</code>’s
to pull up replacements from the history).  You can use more than one <code>\?</code> if you
like.
</p>

<p>
Almost the most powerful feature of <code>query-replace-regexp</code>, though, is that you
can refer to the text matched by the regexp, and the text matched by any
<i>capturing parentheses</i> within it, in the replacement text via <i>back references</i>.  In
the replacement string, <code>\&amp;</code> stands for the entire match.  Even if you aren’t
using any of the pattern-matching features of regexps, this can save you some
typing.  <code>C-M-% emacs RET the amazing \&amp; RET</code> replaces each “emacs” with “the
amazing emacs”; since “emacs” is all lowercase, this replacement is case-smart.
</p>

<p>
When your regexp matches more than just a literal string, then a back reference
is the only way to include the match in the replacement.  Suppose you want to
put quotes around all the numbers in your Buffer.  The regexp <code>[0-9]+</code> matches any
number, so you can do this with <code>C-M-% [0-9]+ RET &#34;\&amp;&#34; RET</code>.<sup><a id="fnr.188" href="#fn.188" role="doc-backlink">188</a></sup>
</p>

<p>
Capturing parentheses let you refer to just a part of the match.  Suppose you
have a number of strings of the form “foo56”, “foo765”, “foo3” and the like, and
you need to change all the “foo”’s to “bar”’s, yielding “bar56”, “bar765”, and
“bar3”, but <i>not</i> change any standalone “foo”’s that don’t have an attached
number.  You can do it this way: <code>C-M-% foo\([0-9]+\) RET bar\1 RET</code>.  The <code>\1</code>
refers to the <i>first</i> parenthesized subexpression; if you have two sets of parens,
you can use <code>\2</code> as well.  This means you can change all numbers like “10K”, “542M”,
and “2.3G” to “10 K”, “542 M”, and “2.3 G” with <code>C-M-% \([0-9.]+\)\([KMGTPEZY]\) RET \1 \2 RET</code>.
</p>

<p>
You could also change all the <code>foo[0-9]+</code> matches to just plain “foo” with the
command <code>C-M-% foo[0-9]+ RET foo RET</code> or in fact delete <i>all</i> trailing numbers
from <i>any</i> words with <code>C-M-% \([a-z]+\)[0-9]+ RET \1 RET</code>.
</p>

<p>
Because of back references and the other handy backslash-sequences, if you
actually want to include a backslash in your replacement, you’ll need to double
it.  That is, <code>\\</code> is replaced with a single <code>\</code>.
</p>
<table id="org0e2be68">
<caption><span>Table 25:</span> <code>query-replace-regexp</code> Examples</caption>

<colgroup>
<col/>

<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Regexp</th>
<th scope="col">Replacement</th>
<th scope="col">Example Match</th>
<th scope="col">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>emacs</code></td>
<td><code>the amazing \&amp;</code></td>
<td>Emacs</td>
<td>The Amazing Emacs</td>
</tr>

<tr>
<td><code>[0-9]+</code></td>
<td><code>&#34;\&amp;&#34;</code></td>
<td>3645</td>
<td>“3645”</td>
</tr>

<tr>
<td><code>foo\([0-9]+\)</code></td>
<td><code>bar\1</code></td>
<td>foo765</td>
<td>bar765</td>
</tr>

<tr>
<td><code>\([0-9.]+\)\([KMGTPEZY]\)</code></td>
<td><code>\1 \2</code></td>
<td>10K</td>
<td>10 K</td>
</tr>

<tr>
<td><code>foo[0-9]+</code></td>
<td><code>foo</code></td>
<td>foo765</td>
<td>foo</td>
</tr>

<tr>
<td><code>\([a-z]+\)[0-9]+</code></td>
<td><code>\1</code></td>
<td>xyz123</td>
<td>xyz</td>
</tr>
</tbody>
</table>
</div>
<div id="outline-container-org51be2a2">
<h5 id="org51be2a2">Elisp Replacement Strings</h5>
<div id="text-org51be2a2">
<p>
Above, I said back references were <i>almost</i> the most powerful <code>query-replace-regexp</code>
feature.  Undoubtedly the most powerful feature is the ability to apply an
arbitrary Elisp expression to the matched string and use the result as the
replacement: that is, to <i>compute</i> a replacement from each match.  <code>\,</code>
(backslash-comma) followed by an Elisp expression can be used anywhere in the
replacement, including more than once.  Within the expression, you can use all
the backslash sequences we’ve discussed above.
</p>

<p>
To use the feature you need to be pretty well-informed about both Regular
Expressions and Emacs Lisp, so I won’t go into this any further after giving a
trivial example.  Note that the Elisp expression:
</p>
<pre>(1+ x)
</pre>

<p>
where <code>x</code> is some number, returns the successor of that number, so <code>(1+ 6)</code>
evaluates to <code>7</code>.  Remember that <code>\#</code> can be used to number your replacements, but
that the numbering starts at zero.  We can arrange for the numbering to start at
one with the replacement string:
</p>
<pre>foo\,(1+ \#)
</pre>

<p>
so our example above would yield:
</p>
<pre>foo1 foo2 foo3 foo4 foo5 foo6
</pre>


<p>
See <a href="#org19c6ad0"><i>Regular Expressions</i></a> and <a href="#org36dd556"><i>Programming the Lisp Machine</i></a> for more information.
</p>
</div>
</div>
</div>
<div id="outline-container-org608922a">
<h4 id="org608922a">Other Entry Points</h4>
<p>
There are two other string replacement commands that you can use:
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Unconditional-Replace"><code>replace-string</code></a>﻿ and   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Regexp-Replace"><code>replace-regexp</code></a>﻿.  They are
non-interactive versions of <code>M-%</code> and <code>C-M-%</code> respectively.  They work exactly the
same, including their interpretation of prefix arguments and of replacement
strings, they just run in “batch mode”: they do all the replacements without
any questions.  I literally <i>never</i> use these commands, because the interactive
versions are just as fast as soon as you decide it’s okay to hit <code>!</code>, and I always
like to see the first one or two replacements before I commit.  That said, a
single <a href="#org3f93c8e">Undo</a> will undo all the changes in one go (also true of the interactive
versions).
</p>
</div>
</div>
<div id="outline-container-org96ce5d7">
<h3 id="org96ce5d7">Meet the Greps <a id="orgfdf7146"></a></h3>
<div id="text-org96ce5d7">

<div id="orgc2a1890">
<p><a href="https:./images/grep.png" alt="=M-x grep=" title="=M-x grep=" width="100%"><img src="https://blog.veitheller.de/images/grep.png" alt="=M-x grep=" title="=M-x grep=" width="100%"/></a>
</p>
<p><span>Figure 33: </span><code>M-x grep</code></p>
</div>

<p>
Emacs also has its own interfaces to <code>grep(1)</code> for searching across files outside
of Emacs, whether (1) a set of specific files, (2) some or all of the files in some
directory, or (3) some or all of the files under some directory, recursively.
These searches pop up a <code>*grep*</code> Buffer of clickable hits (each of which pulls up
the file and takes you to that location).
</p>

<p>
Before we explain how to invoke the Greps, let’s take a look at the workings of
the <code>*grep*</code> Buffer; it works the same regardless of how it was invoked.
</p>
</div>

<div id="outline-container-org80d2c22">
<h4 id="org80d2c22">The <code>*grep*</code> Buffer and Grep Mode <a id="org23c47a7"></a></h4>
<div id="text-org80d2c22">
<p>
You can see from the <a href="#orgc2a1890">screenshot</a> above that a <code>*grep*</code> Buffer looks just like an
<a href="#orgcda19be"><code>*Occur*</code></a> Buffer—lines of hits prefixed with line numbers—except that the
<code>*grep*</code> Buffer also includes file names; the format looks exactly like the output
of <code>grep(1)</code>.  Table <a href="#org4fe6d04">26</a> summarizes the buffer’s key bindings.  It
shouldn’t be surprising that the Buffer’s <i>Grep Mode</i> has many key bindings and
actions in common with <a href="#org3c07b32">Occur Mode</a>; for historical reasons, there are some
discrepancies in the key bindings, and Grep Mode also has some actions that
don’t make sense in Occur Mode.  See <a href="#orga92f8d1"><i>Compilation Mode and its Many Descendants</i></a>
for a side-by-side comparison.
</p>

<p>
Grep Mode is enabled in the <i>hits Buffer</i> (<code>*grep*</code>) and some of its actions affect
one or more <i>target buffers</i> that it pops up for you.
</p>
<table id="org4fe6d04">
<caption><span>Table 26:</span> <code>grep-mode</code> Bindings</caption>

<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col"> </th>
<th scope="col">Key</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><code>RET</code>, <code>C-c C-c</code></td>
<td>jump to hit in target file</td>
</tr>

<tr>
<td> </td>
<td><code>C-o</code></td>
<td>display hit …</td>
</tr>

<tr>
<td> </td>
<td><code>n</code></td>
<td>jump to Next hit in target file</td>
</tr>

<tr>
<td> </td>
<td><code>p</code></td>
<td>… Previous …</td>
</tr>
</tbody>
<tbody>
<tr>
<td>2</td>
<td><code>M-n</code>, <code>TAB</code></td>
<td>move point to Next hit in <code>*grep*</code></td>
</tr>

<tr>
<td> </td>
<td><code>M-p</code>, <code>&lt;backtab&gt;</code></td>
<td>… Previous hit …</td>
</tr>

<tr>
<td> </td>
<td><code>}</code>, <code>M-}</code></td>
<td>move point to next file in <code>*grep*</code></td>
</tr>

<tr>
<td> </td>
<td><code>{</code>, <code>M-{</code></td>
<td>… previous …</td>
</tr>

<tr>
<td> </td>
<td><code>C-c C-f</code></td>
<td>toggle <code>next-error-follow-minor-mode</code> Mode</td>
</tr>
</tbody>
<tbody>
<tr>
<td>3</td>
<td><code>SPC</code>, <code>S-SPC</code></td>
<td>scroll target buffer up</td>
</tr>

<tr>
<td> </td>
<td><code>DEL</code></td>
<td>scroll target buffer down</td>
</tr>

<tr>
<td> </td>
<td><code>&lt;</code></td>
<td>scroll target buffer to top</td>
</tr>

<tr>
<td> </td>
<td><code>&gt;</code></td>
<td>scroll target buffer to bottom</td>
</tr>
</tbody>
<tbody>
<tr>
<td>4</td>
<td><code>g</code></td>
<td>revert buffer</td>
</tr>

<tr>
<td> </td>
<td><code>C-c C-k</code></td>
<td>Kill running <code>grep</code></td>
</tr>

<tr>
<td> </td>
<td><code>C-c C-p</code></td>
<td>writable <code>grep</code></td>
</tr>
</tbody>
<tbody>
<tr>
<td>5</td>
<td><code>0 … 9</code></td>
<td>digit argument</td>
</tr>

<tr>
<td> </td>
<td><code>q</code></td>
<td>Quit hits buffer</td>
</tr>

<tr>
<td> </td>
<td><code>h</code>, <code>?</code></td>
<td>help for mode</td>
</tr>
</tbody>
</table>

<p>
The Grep Mode commands come in several groups:
</p>
<ol>
<li>Commands that visit the file containing the hit at Point in a pop-up Window,
scroll the Window to the hit, and make this the selected Buffer so you’re
ready to edit.  There’s also a <i>display command</i>, <code>C-o</code>, to do all that but stay
in the <code>*grep*</code> Buffer.</li>
<li>Commands that just move from hit to hit in the <code>*grep*</code> Buffer; you could of
course use plain old     <code>C-n</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>next-line</code></a>﻿) and
    <code>C-p</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>previous-line</code></a>﻿), but depending on your search, a hit
might comprise more than one line.  There are also handy commands to move
from file to file, and a command to toggle <a href="#orgb65dcb8"><code>next-error-follow-minor-mode</code></a>.</li>
<li>Commands that scroll the target Buffer from within the <code>*grep*</code> Buffer; very
handy when you’ve used <code>C-o</code>.</li>
<li>Commands to revert the <code>*grep*</code> Buffer (to re-run the <code>grep</code> command and update
the Buffer); kill the running <code>grep</code> command<sup><a id="fnr.189" href="#fn.189" role="doc-backlink">189</a></sup>; or do an <a href="#org8b8111c"><i>Indirect Edit</i></a>.</li>
<li>The usual <a href="#orgfa25f51">Special Mode</a> conveniences: easy digit arguments, Mode help, and a
quit command.</li>
</ol>
</div>
</div>
<div id="outline-container-org5a44822">
<h4 id="org5a44822"><code>next-error</code> Integration</h4>
<p>
You can navigate from hit to hit from wherever you started your Grep <i>without</i>
switching to the <code>*grep*</code> Buffer via
    <code>C-x `</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Compilation-Mode"><code>next-error</code></a>﻿) <sup><a id="fnr.190" href="#fn.190" role="doc-backlink">190</a></sup> or equivalently
  <code>M-g M-n</code> (it also works inside the <code>*grep*</code> Buffer).  This works
even when the <code>*grep*</code> Buffer is no longer visible.
</p>
</div>
<div id="outline-container-org5278bce">
<h4 id="org5278bce">Indirect Editing with Writable Grep <a id="org8b8111c"></a></h4>
<div id="text-org5278bce">
<p>
One of the Grep facility’s most amazing features is that you can edit the text
of the hits in the <code>*grep*</code> Buffer and then, with a keystroke, write your edits
back to the original files.  This “indirect editing” feature works the same way
as <a href="#orgee2aacf">Writable Occur</a>; unfortunately the keystroke to invoke it---<code>C-c C-p</code>— from a
<code>*grep*</code> Buffer isn’t the same as for an <code>*Occur*</code> Buffer.<sup><a id="fnr.191" href="#fn.191" role="doc-backlink">191</a></sup>
</p>

<p>
This requires the optional <code>wgrep</code> <a href="#orgc96889a">Package</a> from the GNU repository.  I recommend
this snippet for your <a href="#org2af3730">Init File</a>:
</p>
<div>
<pre>(<span>unless</span> (package-installed-p &#39;wgrep)
  (<span>with-demoted-errors</span> <span>&#34;%s&#34;</span>
    (<span>unless</span> package-archive-contents
      (package-refresh-contents))
    (package-install &#39;wgrep)))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgdcaab17">
<h4 id="orgdcaab17">Plain Old <code>M-x grep</code></h4>
<div id="text-orgdcaab17">
<p>
How do we acquire one of these wonderful <code>*grep*</code> Buffers?  The fundamental way is
with   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Grep-Searching"><code>grep</code></a>﻿, which will prompt you for a <code>grep</code> command line; so,
this obviously assumes you’re familiar with the Unix <a href="https://en.wikipedia.org/wiki/Grep"><code>grep(1)</code></a> command, <i>and</i>
familiar with <a href="#org19c6ad0">Regular Expressions</a> (Regexps) as well.  The default command line
(on Linux) is:
</p>
<pre>grep --color -nH --null -e
</pre>

<p>
You’re expected to fill in your Regexp and the paths of the files you want to
search on the right.  Don’t forget to quote both appropriately, just as in the shell.  You’re
free to change the options (perhaps adding a <code>-i</code> to do a case-insensitive
search), but see <a href="#orgba4e491">below</a> for details.  You can also use something fancier than a
single <code>grep</code> command, like a pipeline of <code>grep</code>’s, or anything else that meets the
<a href="#orgba4e491">output requirements</a> of the <code>*grep*</code> Buffer.
</p>

<p>
If you’re unfamiliar with Regexps, you can change <code>grep</code> to <code>fgrep</code> and do a plain
text search, but you still need to be familiar with Unix shell quoting; if you
aren’t, skip ahead to <a href="#org3260c54"><code>lgrep</code></a>.
</p>

<p>
With a <a href="#orgb0f6ffd">prefix argument</a>, <code>M-x grep</code> will fill in the complete <code>grep</code> command to
search for the Symbol at Point in the selected Buffer’s file, and of course
Emacs keeps a history of the <code>grep</code> commands you’ve used in this session, which
you can access in the <a href="#orgee992bc">usual ways</a>.
</p>
</div>
</div>
<div id="outline-container-org5ebc6d9">
<h4 id="org5ebc6d9">Local Directory Grep with <code>M-x lgrep</code> <a id="org3260c54"></a></h4>
<div id="text-org5ebc6d9">
<p>
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Grep-Searching"><code>lgrep</code></a>﻿ is a convenient front-end that composes a Grep command for
you that searches all the files in a given directory; it’s especially
convenient for Emacs users who aren’t yet <i>au courant</i> with Unix concepts like
Regexps, shell quoting, and file globbing.  When invoked, it prompts you for
three things: a Regexp, a filename or glob pattern, and finally a directory, and
it constructs and immediately runs a <code>grep</code> command for you.  Let’s use <code>M-x lgrep</code>
to search for “foo” in all the files in our default directory.  The Minibuffer
prompts look like this:
</p>
<pre>Search for: foo
</pre>

<p>
Now specify the files to search in:
</p>
<pre>Search for &#34;foo&#34; in files matching wildcard (default all):
</pre>

<p>
Just hit <code>RET</code> for all (significant) files, but it’s also totally fine to enter
one or more filenames separated by spaces (your <a href="#org75fb6a2">Completion system</a> can help you),
or use one or more space-separated glob patterns (wildcards).
</p>

<p>
Finally we have to say which directory contains the files:
</p>
<pre>In directory:
</pre>

<p>
Hit <code>RET</code> to search the selected Buffer’s default directory.
</p>

<p>
This will be a case-insensitive search by default.  Don’t try to quote any of
these values; <code>lgrep</code> will quote them for you.
</p>

<p>
With a <a href="#orgb0f6ffd">prefix argument</a>, <code>C-u M-x lgrep</code>, you’ll be able to edit the composed <code>grep</code> command before
Emacs runs it; so you could change <code>grep</code> to <code>fgrep</code> here if you don’t want to use a
Regexp, for example.  If you do this, you’ll see that the composed command is
<i>very</i> complex, because Emacs adds a boatload of options to ignore the types of
files you don’t usually want to include in a search (such as Emacs
<a href="#org0c51c8b">backup and auto-save files</a>).
</p>

<p>
<code>lgrep</code> shares histories for each of the three prompts with <code>rgrep</code>.
</p>
</div>
</div>
<div id="outline-container-org54c5df0">
<h4 id="org54c5df0">Recursive Grep with <code>M-x rgrep</code></h4>
<div id="text-org54c5df0">
<p>
<code>lgrep</code> does a flat search of files in one directory, but you can search an entire
directory hierarchy recursively with   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Grep-Searching"><code>rgrep</code></a>﻿.  It has the same
three prompts as <code>lgrep</code> and the only difference is it also searches the starting
directory’s subdirectories, and so on, recursively.  You can for example search
your entire home directory by entering <code>~</code> as the starting directory.
</p>

<p>
  <code>M-x</code> <code>rzgrep</code> is a variation that will search gzipped files<sup><a id="fnr.192" href="#fn.192" role="doc-backlink">192</a></sup>.
You can specify them at the “files matching wildcard” prompt with the glob
pattern <code>*.gz</code>, or be more specific with something like <code>*.org.gz</code>, or search both
compressed and uncompressed files with multiple space-separated glob patterns
(e.g., <code>*.org *.org.gz</code>).  This command requires that you have <code>zgrep(1)</code> installed
on your system.  Since <code>rzgrep</code> is a confusing name, you can also invoke it by the
alias <code>zrgrep</code>.
</p>

<p>
As for <code>lgrep</code>, with a <a href="#orgb0f6ffd">prefix argument</a>, you’ll be able to edit the composed <code>grep</code>
command before Emacs runs it.
</p>
</div>
</div>
<div id="outline-container-org3c4ce56">
<h4 id="org3c4ce56">Just the Skeleton with <code>M-x grep-find</code></h4>
<p>
<code>rgrep</code> composes a complex shell command that uses <code>find(1)</code> (the Unix directory
hierarchy tool) to run the appropriate <code>grep</code> command for you.  Like <code>lgrep</code>, the
composed command ignores many files such as backup files.  Occasionally you might
not want this assistance; <code>C-u M-x rgrep</code> will let you edit the command, but it
can be annoying to have to delete most of the over 1,500 characters to customize
it.    <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Grep-Searching"><code>grep-find</code></a>﻿ gives the bare-bones, 57-character version of an
<code>rgrep</code> command that you can edit to do precisely what you want.  Needless to say,
you’ll need to be familiar with the very hairy (but essential) <code>find(1)</code> command
for this.
</p>
</div>
<div id="outline-container-org34caea8">
<h4 id="org34caea8">Grep Files Aliases</h4>
<div id="text-org34caea8">
<p>
When entering file names or glob patterns at the “files matching wildcard”
prompt for any of <code>lgrep</code>, <code>rgrep</code>, or <code>rzgrep</code>, you can type any of a set of handy
aliases that stand for more or less complex glob patterns.  You can <a href="#org27e6769">customize</a>
the variable   <code>grep-files-aliases</code> to add your own shortcuts.
</p>
<table>


<colgroup>
<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td>Alias</td>
<td>Generated Glob Patterns</td>
</tr>

<tr>
<td> </td>
<td> </td>
</tr>

<tr>
<td><code>all</code></td>
<td><code>* .*</code></td>
</tr>

<tr>
<td><code>asm</code></td>
<td><code>*.[sS]</code></td>
</tr>

<tr>
<td><code>c</code></td>
<td><code>*.c</code></td>
</tr>

<tr>
<td><code>cc</code></td>
<td><code>*.cc *.cxx *.cpp *.C *.CC *.c++</code></td>
</tr>

<tr>
<td><code>cchh</code></td>
<td><code>*.cc *.[ch]xx *.[ch]pp *.[CHh] *.CC *.HH *.[ch]++</code></td>
</tr>

<tr>
<td><code>ch</code></td>
<td><code>*.[ch]</code></td>
</tr>

<tr>
<td><code>el</code></td>
<td><code>*.el</code></td>
</tr>

<tr>
<td><code>h</code></td>
<td><code>*.h</code></td>
</tr>

<tr>
<td><code>hh</code></td>
<td><code>*.hxx *.hpp *.[Hh] *.HH *.h++</code></td>
</tr>

<tr>
<td><code>l</code></td>
<td><code>[Cc]hange[Ll]og*</code></td>
</tr>

<tr>
<td><code>m</code></td>
<td><code>[Mm]akefile*</code></td>
</tr>

<tr>
<td><code>tex</code></td>
<td><code>*.tex</code></td>
</tr>

<tr>
<td><code>texi</code></td>
<td><code>*.texi</code></td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgf2b590d">
<h4 id="orgf2b590d">Grepping from Dired</h4>
<p>
You can enlist <a href="#orgcc42ce0">Dired</a>’s help when you need to grep a very specific set of files
that can’t be specified by a compact glob pattern.  Just <a href="#org65308d7">mark</a> the files via
Dired’s powerful marking commands, and then invoke
    <code>A</code> (<code>dired-do-find-regexp</code>).<sup><a id="fnr.193" href="#fn.193" role="doc-backlink">193</a></sup>
</p>
</div>
<div id="outline-container-org5963a3f">
<h4 id="org5963a3f">Which <code>grep</code> Is It, Really? <a id="orgba4e491"></a></h4>
<div id="text-org5963a3f">
<p>
Any compatible program can be used with any of the Grep-family commands instead
of plain old <code>grep</code>: in particular, you can use <code>egrep</code> or <code>fgrep</code> instead.  What
exactly makes a compatible command?
</p>

<p>
For <code>M-x grep</code>, where you specify the command invocation yourself, any command is compatible
if it produces the standard grep output format, i.e. lines that look like:
</p>
<pre>FILENAME:LN:text
</pre>

<p>
where <code>FILENAME</code> is the path to the file containing <code>text</code>, and <code>LN</code> is the number of
the matching line.  <code>grep(1)</code>, <code>egrep(1)</code>, and <code>fgrep(1)</code> are all capable of producing
this output format.<sup><a id="fnr.194" href="#fn.194" role="doc-backlink">194</a></sup>  Version control systems all support a <code>grep</code>
subcommand and have options to produce a compatible format, like <a href="https://en.wikipedia.org/wiki/Git"><code>git grep</code></a> or
<a href="https://en.wikipedia.org/wiki/Mercurial"><code>hg grep</code></a>; these commands can be invoked via <code>M-x grep</code>, though there are also
more specific ways to use them via <a href="#orgc96889a">third-party packages</a> like Magit and
<a href="#orga12fa37">Projectile</a>.
</p>

<p>
Some popular grep replacements like <code>ag</code>, <code>ripgrep</code>, <code>ack</code>, and the like, can be used
as drop-in replacements, but they may be better used via <a href="#orgc96889a">third-party
packages</a> specifically designed for them.
</p>

<p>
The <code>lgrep</code> and <code>rgrep</code> commands also require this output format, but they
additionally make assumptions about the availability of certain command line
options, which is much more complex; to customize which <code>grep</code> program is used by
these commands, <a href="#org27e6769">Customize</a> the variable   <code>grep-template</code>.
</p>
</div>
</div>
</div>
<div id="outline-container-org1b6c266">
<h3 id="org1b6c266">Regular Expressions <a id="org19c6ad0"></a></h3>
<div id="text-org1b6c266">
<blockquote>
<p>
Some people, when confronted with a problem, think “I know, I’ll use regular
expressions.”  Now they have two problems. — Jamie Zawinski (comp.lang.emacs)
</p>
</blockquote>
<p>
<i>Regular Expressions</i> (<i>Regexps</i>) have already come up several times in this book.
Much as I’ve tried to avoid mentioning them up to this point, the fact is that
they’re used everywhere in Emacs: in <a href="#orgdb5b42f">Incremental Search</a>, <a href="#org9ebde75">Query Replace</a>, <a href="#orgfdf7146">Grep</a>,
<a href="#orgcc42ce0">Dired</a>, <a href="#org42f1d6b">Apropos</a>, and more.
</p>

<p>
If you’re a programmer, an apostate from any other programmer’s editor, or just
a Unix user familiar with the standard command line tools, you’ll already be
familiar with the concept, and can <a href="#org351ef62">skip ahead</a> to see how Emacs Regexps differ
from what you may be used to.  If you’re keen to learn and add Regexps to your
tool kit (it’ll be worth it, never mind Zawinski’s cheeky remark), check out the
<a href="#org183a9a2">References</a> at the end of the chapter.  But here I’ll try to give an explanation
of what they even are, and the minimum you need to know to make use of some
Emacs Regexp-based commands.
</p>
</div>
<div id="outline-container-org8e808c1">
<h4 id="org8e808c1">Powerful Pattern Matching</h4>
<div id="text-org8e808c1">
<p>
The job of Regexps in Emacs is to enable more powerful searching and matching.
Regexps are a mini-language for expressing patterns that describe, or match, sets
of strings<sup><a id="fnr.195" href="#fn.195" role="doc-backlink">195</a></sup>.  When you search for the word “Emacs” with the non-Regexp
    <code>C-s</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Basic-Isearch"><code>isearch-forward</code></a>﻿), you’re actually using a pattern that
happens to only match exactly one string: “Emacs”.  But you’ll recall that, due
to <a href="#orgd6159de">Case Folding</a>, if you search for “emacs”, you’re using a pattern that matches
a larger set of strings, including not just “Emacs” but also “emacs”, “EMACS”,
“eMacS”, etc.  Thanks to <a href="#org5b46b82">Lax Space Matching</a>, if you search for “GNU Emacs”,
it will also match strings like “GNU      Emacs” or “GNU”, a newline, and
“Emacs” at the beginning of the next line.  But that’s about it for the pattern
language of Isearch.
</p>

<p>
You’re probably familiar with the common notation, or <i>syntax</i>, where a
<code>*</code>-character or <code>?</code> is a <i>wildcard</i>, as in Unix shell <a href="https://en.wikipedia.org/wiki/Glob_(programming)"><i>file globbing</i></a> patterns: you
might write <code>*ing</code> to match files ending in “ing” or <code>c?t</code> to
match files named “cat” or “cot”.  This means that you can’t readily try to match
strings that include asterisks or question marks, because of their
interpretation as wildcards: they are not plain old characters, but what we call
<i>metacharacters</i>, because they’re functioning on a level above the literal.
</p>

<p>
Regexps are a <i>much</i> more powerful pattern language than that.  They were
formalized in 1951 by the mathematician <a href="https://en.wikipedia.org/wiki/Stephen_Cole_Kleene">Stephen Kleene</a> and were probably first
implemented in a text editor by <a href="https://en.wikipedia.org/wiki/Ken_Thompson">Ken Thompson</a> in <a href="https://www.bell-labs.com/usr/dmr/www/qed.html">QED</a> sometime between 1967 and
1970<sup><a id="fnr.196" href="#fn.196" role="doc-backlink">196</a></sup>.  From there they appeared in the original Unix editor <a href="https://en.wikipedia.org/wiki/Ed_(text_editor)"><code>ed(1)</code></a>
circa 1973; then, because of their general utility, in other tools like
<a href="https://en.wikipedia.org/wiki/Grep"><code>grep(1)</code></a>; and then spread rapidly into every editor that’s worthy of the name;
they were in GNU Emacs from the beginning.
</p>

<p>
Regexps let you write compact, expressive, patterns that specify matches in
terms of:
</p>
<ul>
<li>beginnings and endings of lines</li>
<li>beginnings and endings of words</li>
<li>sets of characters (e.g. alphanumerics, vowels, whitespace)</li>
<li>repetitions of Regexps (e.g. zero or more, between 3 and 12)</li>
<li>grouping of sub-matches with the ability to refer back to them</li>
</ul>

<p>
In order to express these things, our notation needs to have eight
metacharacters; here are the first seven (the Regexp <code>*</code> and <code>?</code> metacharacters do
<i>not</i> have the same meaning they have as glob metacharacters):
</p>
<pre>. * + ? [ ^ $
</pre>

<p>
In your Regexp you may well need to match one of these metacharacters <i>literally</i>:
you can do this by <i>quoting</i> or <i>escaping</i> the metacharacter with the eighth
metacharacter: the backslash,
<code>\</code>.  So
<code>\*</code> is the Regexp that
matches an asterisk, and a backslash can be used to quote itself by doubling it.
But don’t use backslash to quote plain, non-metacharacters, like <code>1</code>, <code>b</code>, or <code>w</code>, for
example, where it may have a special interpretation; see <a href="#org351ef62"><i>Backslash Constructs</i></a> below.
</p>

<p>
Knowing this, you can make use of Emacs commands that ask you to enter a Regexp,
many of which are useful with plain non-meta, characters: just add a backslash
to any of the eight metacharacters that you want to search for literally.  Keep
in mind that all characters except the eight metacharacters stand for themselves
in a Regexp, so <code>Emacs</code> is indeed the Regexp that matches “Emacs” and
<code>\*grep\*</code>
matches “‍*grep*”.
</p>

<p>
Here’s how to translate file globbing patterns into equivalent Regexps:
</p>
<table>


<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Glob</th>
<th scope="col">Regexp</th>
<th scope="col">Interpretation</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>*</code></td>
<td><code>.*</code></td>
<td>zero or more of any characters</td>
</tr>

<tr>
<td><code>?</code></td>
<td><code>.</code></td>
<td>any single character</td>
</tr>

<tr>
<td><code>[a-z]</code></td>
<td><code>[a-z]</code></td>
<td>any one of the characters from <code>a</code> to <code>z</code></td>
</tr>

<tr>
<td><code>{a,b,c}</code></td>
<td><code>\(a\❘b\❘c\)</code></td>
<td>either <code>a</code> or <code>b</code> or <code>c</code></td>
</tr>
</tbody>
</table>
<p>
Note that <code>.</code>—I’ll call that “dot” for clarity— “matches any character” just
like <code>?</code> in file globbing, including punctuation and whitespace, for example.
Other handy Regexps for matching text include <code>\b</code>, which matches a word <i>boundary</i>
i.e. the beginning or the end of a word, and <code>\w</code>, which matches only <i>word
constituents</i> (typically alphanumerics, though it depends on the <a href="#org5b21ef0">Major Mode</a>).  So
the Regexp to match words that start with an “e” and end with an “s” would be
<code>\be\w*s\b</code>, which will match “Emacs”, “editors”, “examples”, “es”, and many
others.  That regexp translates to: match the strings which
</p>

<ol>
<li>at a word boundary (<code>\b</code>)</li>
<li>have an <code>e</code></li>
<li>followed by zero or more word constituents (<code>\w*</code>)</li>
<li>followed by an <code>s</code></li>
<li>at another word boundary (<code>\b</code>).</li>
</ol>
</div>
</div>

<div id="outline-container-org8d15d2e">
<h4 id="org8d15d2e">Unique Aspects of Emacs Regexps <a id="org351ef62"></a></h4>
<div id="text-org8d15d2e">
<p>
If you’re familiar with Regexps from non-Emacs contexts, you probably already
know that there are several distinct Regexp syntaxes out there.  Every
application and programming language seems to have its own flavor with subtle
differences from the others: there are the <i>basic</i> Regexps of <code>grep(1)</code>, the
<i>extended</i> Regexps of <code>egrep(1)</code>, the heavily enhanced Regexps of <code>perl(1)</code> and the
PCRE library, and so on.
</p>

<p>
You’ve probably guessed that I’m going to tell you that Emacs’s Regexps are of
yet another flavor.  In the fundamentals, Emacs Regexps are more like <code>grep(1)</code> Regexps,
in that <code>(</code>, <code>|</code>, <code>)</code>, <code>{</code>, and <code>}</code> and are ordinary characters and the backslashified
versions are metacharacters.  So in Emacs you do grouping (which captures) with <code>\(</code> and
<code>\)</code>, alternation with <code>\|</code>, and counted repetition with <code>\{</code> and <code>\}</code>,
</p>

<p>
Emacs supports the non-greedy repetition operators <code>*?</code>, <code>+?</code>, and <code>??</code>, and the POSIX
character classes (such as <code>[[:blank:]]</code>).
</p>

<p>
Emacs’s <code>.</code> matches any character <i>excepting</i> a newline.  To search for a newline,
insert one literally with <code>C-j</code> (its <a href="#org7997c3f">ASCII</a> value).  You can also use the POSIX
space character class (<code>[[:space:]]</code>) or the whitespace syntax class (<code>\s-</code>), when
appropriate.
</p>
</div>
<div id="outline-container-org7869422">
<h5 id="org7869422">Backslash Constructs</h5>
<div id="text-org7869422">
<p>
Our Regexp notation, like most others, also includes a lot of <i>backslash
constructs</i>, including many that are unique to Emacs, supporting purely Emacs
concepts like the <a href="#orgc3260f6">Buffer</a>, <a href="#orgba1f634">Point</a>, syntax classes, character categories, and
symbols.
</p>

<p>
We have non-capturing (“shy”) groups with <code>\(?: ...\)</code> and explicitly-numbered
groups with <code>\(?NUM: ...\)</code>.  <code>\sCODE</code> matches a character whose
<a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Syntax-Descriptors"><i>syntax class</i></a> is <code>CODE</code>.  So,
for example, <code>\s-</code> matches any whitespace character, while <code>\sw</code> matches a
word-character.  <code>\SCODE</code> (note the uppercase “S”) matches any character whose
syntax class is <i>NOT</i> <code>CODE</code>.
</p>

<p>
The point of <code>\s</code> and <code>\S</code> is that the characters that comprise a given syntax class
can differ from <a href="#org5b21ef0">Major Mode</a> to Major Mode<sup><a id="fnr.197" href="#fn.197" role="doc-backlink">197</a></sup>.  So the word-class might
include the apostrophe or it might not.  Syntax classes let you write Regexps
that work in any Mode.  Table <a href="#orgf55c6ec">27</a> lists the class codes.
</p>

<table id="orgf55c6ec">
<caption><span>Table 27:</span> Regular Expression Syntax Classes</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">CODE</th>
<th scope="col">Syntax Class</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-</code></td>
<td>Whitespace characters</td>
</tr>

<tr>
<td><code>w</code></td>
<td>Word constituents</td>
</tr>

<tr>
<td><code>_</code></td>
<td>Symbol constituents</td>
</tr>

<tr>
<td><code>.</code></td>
<td>Punctuation characters</td>
</tr>

<tr>
<td><code>(</code></td>
<td>Open parenthesis characters</td>
</tr>

<tr>
<td><code>)</code></td>
<td>Close parenthesis characters</td>
</tr>

<tr>
<td><code>&#34;</code></td>
<td>String quotes</td>
</tr>

<tr>
<td><code>\</code></td>
<td>Escape-syntax characters</td>
</tr>

<tr>
<td><code>/</code></td>
<td>Character quotes</td>
</tr>

<tr>
<td><code>$</code></td>
<td>Paired delimiters</td>
</tr>

<tr>
<td><code>&#39;</code></td>
<td>Expression prefixes</td>
</tr>

<tr>
<td><code>&lt;</code></td>
<td>Comment starters</td>
</tr>

<tr>
<td><code>&gt;</code></td>
<td>Comment enders</td>
</tr>

<tr>
<td><code>@</code></td>
<td>Inherit standard syntax</td>
</tr>

<tr>
<td><code>!</code></td>
<td>Generic comment delimiters</td>
</tr>
</tbody>
</table>
<p>
Some other unique Regexp metacharacters include <code>\`</code> and <code>\&#39;</code> (that’s backtick and
apostrophe) to match at the beginning and end of the Buffer, respectively, and <code>\=</code>
to match at Point.  In addition to the common <code>\&lt;</code> and <code>\&gt;</code> to match the beginning
and end of words, we also have <code>\_&lt;</code> and <code>\_&gt;</code> to do the same for symbols.
</p>
</div>
</div>
</div>

<div id="outline-container-orgb73c956">
<h4 id="orgb73c956">References <a id="org183a9a2"></a></h4>
<div id="text-orgb73c956">
<ul>
<li>See <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Regexps">“Regexps”</a> in the <i>Emacs</i> manual.</li>
</ul>
<ul>
<li>Friedl, Jeffrey E. F. 2002. <i>Mastering Regular Expressions.</i> Sebastopol, CA: O’Reilly..</li>
</ul>
</div>
</div>
</div>


<div id="outline-container-org8bb0469">
<h3 id="org8bb0469">Unlimited Undo with Redo <a id="org3f93c8e"></a></h3>
<p>
The ability to undo editing changes is fundamental.  GNU Emacs had “unlimited”
undo when it was released in 1985, a time when most editors had at most the
ability to undo the single most recent change.
</p>
<div id="outline-container-orgea92a67">
<h4 id="orgea92a67">Just Undo It</h4>
<div id="text-orgea92a67">
<p>
It’s very simple to just undo the last thing you did — whether inserting,
modifying, or killing some text.  Just hit     <code>C-/</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Undo"><code>undo</code></a>﻿), and
your change is undone.  Point is always moved the location where the Undo
occurred (which is why people use Undo to <a href="#orgbcb1a3b">move around</a>).  After undoing, just
continue with your editing.
</p>

<p>
If you invoke <code>undo</code> several times in a row, you’ll see that it keeps undoing back
in time.  You can undo all the way back to the first change you made to the
Buffer.  If you <a href="#org41c8a78">visit a file</a>, make changes, and then decide you don’t like <i>any</i>
of the editing you’ve done, you can Undo them all away (though this could be
tedious and you’d be better off <a href="#org652e622">reverting</a> the Buffer instead).  You can Undo
back through <a href="#orgf98c057">file saves</a>, and you can even Undo your Undo’s (see <a href="#orgff1af41"><i>Redo</i></a>, below).
</p>

<p>
To make undoing less tedious, Emacs groups long sequences of uninterrupted
insertion into undoable chunks.  So if you type “uninterrupted”, and then hit
<code>C-/</code>, the whole word is undone in one step, rather than requiring 13 invocations
of <code>C-/</code>, one for each letter.  This is called <i>amalgamation</i> and by default the
chunk size is 20, so, if you type
“antidisestablishmentarianism” you’ll have to type two <code>C-/</code>’s to undo it.
</p>

<p>
Emacs puts <code>undo</code> on two additional keystrokes:   <code>C-_</code> and
  <code>C-x u</code>, and of course you could always say <code>M-x undo</code>.  <code>C-_</code> is the
oldest of these key bindings (and is the one that’s hardwired into my brain),
but <code>C-/</code> is admittedly easier to type (<code>C-x u</code> is mnemonic, but highly
<a href="#org38efd5c">unfelicitous</a>).
</p>
</div>
</div>
<div id="outline-container-org4cec3d8">
<h4 id="org4cec3d8">What, When, and Where Can You Undo?</h4>
<div id="text-org4cec3d8">
<p>
If you delete a word (“foo”) in Buffer A, then delete a word (“bar”) in Buffer
B, and then, back in Buffer A, you hit <code>C-/</code>, the word “foo” comes back, even though
the deletion in Buffer B was more recent.  If you now change to Buffer B and
Undo, “bar” comes back: each Buffer’s undo history is independent.
</p>

<p>
Only changes to the <i>contents</i> of a Buffer are undoable.  It doesn’t matter what
command caused a change: entering text by typing is undoable but so is any other
command that enters text: yanking from the Kill Ring, inserting the result of
running an external command with <code>C-u</code>   <code>M-!</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Single-Shell"><code>shell-command</code></a>﻿),
inserting a file with     <code>C-x i</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Misc-File-Ops"><code>insert-file</code></a>﻿): it’s all undoable.
</p>

<p>
Any command that <a href="#orge04d5e2">kills Buffer text</a> is undoable, as is any <a href="#orgee51965">textual object</a> kill
command like     <code>M-DEL</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Words"><code>backward-kill-word</code></a>﻿).  It makes no
difference if you killed text with a keystroke, a mouse action, or a
    <code>M-x</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/M-x"><code>execute-extended-command</code></a>﻿) command.
</p>

<p>
All commands that modify text are undoable, like
    <code>M-t</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Transpose"><code>transpose-words</code></a>﻿) or
    <code>C-x C-u</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Case"><code>upcase-region</code></a>﻿).  A command like
    <code>M-%</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Query-Replace"><code>query-replace</code></a>﻿) that makes mass changes is also undoable.
</p>

<p>
The <i>scale</i> of any of the above changes has no effect on their undoability.  If
you kill the entire Buffer contents with, say,
    <code>C-x h</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Marking-Objects"><code>mark-whole-buffer</code></a>﻿) followed by
    <code>C-w</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Kill-Commands"><code>kill-region</code></a>﻿), or change the whole Buffer to uppercase with
<code>C-x C-u</code><sup><a id="fnr.198" href="#fn.198" role="doc-backlink">198</a></sup>, or insert the contents of a 3-megabyte file, a single Undo will
happily undo the change.
</p>

<p>
It also doesn’t matter how long ago you made a change; if you made a change to a
Buffer a week ago, and your Emacs has been running all that time, you can still
undo it.  However, once you’ve killed a Buffer, its undo history is gone, and
exiting Emacs of course kills <i>all</i> your Buffers.<sup><a id="fnr.199" href="#fn.199" role="doc-backlink">199</a></sup>
</p>
</div>
</div>
<div id="outline-container-org3df65a2">
<h4 id="org3df65a2">How Unlimited is Unlimited?</h4>
<div id="text-org3df65a2">
<p>
Actually, there <i>are</i> limits, changeable, to the Undo facility.  The defaults are
so big that Undo is <i>effectively</i> unlimited.<sup><a id="fnr.200" href="#fn.200" role="doc-backlink">200</a></sup>
</p>

<p>
How far back you can Undo is controlled by two <a href="#orge6fb506">User Options</a>; there’s also a hard
limit on the maximum size of any single change (see
  <code>undo-outer-limit</code>).  You can <a href="#org27e6769">Customize</a> all of these.  See
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Undo">“Undo”</a> in the <i>Emacs</i> manual for details.
</p>
</div>
</div>
<div id="outline-container-orgaf886b2">
<h4 id="orgaf886b2">Undo in the Region (Selective Undo)</h4>
<div id="text-orgaf886b2">
<p>
The most amazing feature of Undo is that you can limit your Undoing to a subset
of the Buffer.  Imagine that you’ve been editing for an hour, and then decide
that you don’t like the changes you made to one paragraph thirty minutes ago —
but you <i>do</i> like all the rest of your changes.  It would be awful to have to Undo
everything you’ve done in the last twenty-nine minutes just to restore that one
paragraph.
</p>

<p>
No problem: all you need to do is set the <a href="#org34ab2da">Active Region</a> around that paragraph
and start Undoing.  None of the work you’ve done outside of that paragraph will
be Undone, and Undo will stop if you go all the way back to the first change you
made to that paragraph.
</p>
</div>
</div>
<div id="outline-container-org18a782a">
<h4 id="org18a782a">Redo, or Undo the Undos <a id="orgff1af41"></a></h4>
<div id="text-org18a782a">
<p>
It’s very easy to overshoot when you’re Undoing.  You’re typing at speed, notice
a mistake, and hit a few <code>C-/</code>’s to correct it.  But you hit one too many!  You
can’t just immediately type <code>C-/</code> again: that would just Undo one step further.
What to do?
</p>

<p>
You just have to <i>stop Undoing</i>.  Not for a length of time, but just by issuing
<i>any</i> Emacs command that isn’t <code>undo</code>.  You could invoke
    <code>C-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>forward-char</code></a>﻿), a nice harmless command, or
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Calendar/Diary"><code>calendar</code></a>﻿, or anything else, but
    <code>C-g</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Quitting"><code>keyboard-quit</code></a>﻿) is a perfectly fine way to stop Undoing
(and by now it’s probably wired into your lizard brain as the “oops” command).
</p>

<p>
So after <code>C-g</code> just Undo again with <code>C-/</code> and it does the same thing as always:
undoes the last change to the Buffer, which happens to be your superfluous
Undo.  The distinction between Undo and Redo may take a little getting used to,
so play around with it.  (If you can’t get used to it, see <a href="#org4e4bc68"><code>undo-tree</code></a>.)
</p>
</div>
</div>
<div id="outline-container-orgea2a34f">
<h4 id="orgea2a34f">What Can’t You Undo?</h4>
<div id="text-orgea2a34f">
<p>
You can’t Undo anything that’s not a change to the <i>contents</i> of a Buffer.  So you
can’t Undo changes to the <a href="#org9409b46">layout of your Windows</a>, like a
    <code>C-x 0</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Change-Window"><code>delete-window</code></a>﻿) or a
    <code>C-x 2</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Split-Window"><code>split-window-below</code></a>﻿), or a switch from one window to
another.  (But a recommended <a href="#orgb729f11">separate facility</a> allows you to undo those changes.)
</p>

<p>
You also can’t Undo <a href="#org634b3b6">killing a Buffer</a>, which is another reason Emacs is careful
to ask for confirmation if you try to kill an unsaved <a href="#org41c8a78">file-visiting</a>
Buffer.<sup><a id="fnr.201" href="#fn.201" role="doc-backlink">201</a></sup>
</p>

<p>
Don’t confuse the contents of the Buffer with how it’s presented: if you
<a href="#orgde73944">highlight</a> a word with     <code>M-s h .</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Highlight-Interactively"><code>highlight-symbol-at-point</code></a>﻿),
changing it’s color to yellow, that doesn’t change the actual text at all, and
so is not undoable with the Undo facility (of course, you can “undo” the
highlight manually).
</p>

<p>
You can’t Undo the deletion of a file with   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Misc-File-Ops"><code>delete-file</code></a>﻿ or
<a href="#orgcc42ce0">Dired’s</a>     <code>D</code> (<code>dired-do-delete</code>) command, or anything else like
that.
</p>

<p>
Certain Buffers don’t have Undo turned on; any Buffer whose name starts with a
space (see <a href="#orgb8574ab"><i>Hidden Buffers</i></a>) has Undo turned off.  You can turn Undo off in any
Buffer if you like, but why would you?
</p>

<p>
<a href="#orgfa25f51"><code>special-mode</code></a> Buffers (and Buffers in Modes that inherit from <code>special-mode</code>),
which are read-only by default and usually implement applications, may or may
not implement Undo.
</p>

<p>
Finally, you can’t Undo non-Emacs actions that Emacs takes for you, like sending
an email, an instant message, or a tweet!
</p>
</div>
</div>
<div id="outline-container-orgdd571b8">
<h4 id="orgdd571b8"><code>undo-tree</code> <a id="org4e4bc68"></a></h4>
<div id="text-orgdd571b8">
<p>
A fair number of people think that the way Undo works is one of the most
confusing things about Emacs, right up there with the workings of the <a href="#orgee263e4">Kill Ring</a>.
And just like the latter, there are alternatives available (thanks to the
extensible nature of Emacs).
</p>

<p>
The <code>undo-tree</code> package is the most popular alternative.  Instead of a linear list
of changes that (confusingly?) includes undos, it organizes the undo history as
a branching tree, which makes it easier to understand.  The author cheekily
asserts:
</p>
<blockquote>
<p>
The only downside to this more advanced yet simpler undo system is that it was
inspired by Vim. — <a href="https://www.dr-qubit.org/undo-tree.html">Toby Cubitt</a>
</p>
</blockquote>
<p>
It’s an impressive package and it can coexist with standard Undo (you can switch
back and forth, or set up separate key bindings) but I find it to be more
intrusive than the default Undo, especially if you turn on its visualizer and
integrated diff (which is what makes it especially easy to understand).  See the
screenshot at the <a href="https://www.emacswiki.org/emacs/UndoTree">Emacs Wiki</a>.  Personally, I think with a little practice you
can get completely comfortable with standard Undo.  But if you want <code>undo-tree</code>
just add the following snippet to your <a href="#org2af3730">Init File</a>:
</p>
<div>
<pre>(<span>unless</span> (package-installed-p &#39;undo-tree)
  (<span>with-demoted-errors</span> <span>&#34;%s&#34;</span>
    (<span>unless</span> package-archive-contents
      (package-refresh-contents))
    (package-install &#39;undo-tree)))
<span>;; </span><span>to replace standard Undo everywhere</span>
(<span>with-demoted-errors</span> <span>&#34;%s&#34;</span> (global-undo-tree-mode))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org77efab3">
<h3 id="org77efab3">Approaching Programming: Keyboard Macros <a id="orgd2c3858"></a></h3>
<div id="text-org77efab3">
<blockquote>
<p>
I believe I can state without the slightest hint of exaggeration that Emacs
keyboard macros are the coolest thing in the entire universe.  — <a href="https://sites.google.com/site/steveyegge2/effective-emacs">Steve Yegge</a>
</p>
</blockquote>
<p>
Thanks to its nature as a Lisp Machine, Emacs is probably the most completely
customizable and extensible piece of software in existence.  Emacs is written in
Emacs Lisp (Elisp) running in a Lisp interpreter that you can modify in real
time, as it runs, to change almost anything, and any brand new code you write
can run immediately, and interact with all the rest of Emacs itself.
</p>

<p>
This is fantastic and amazingly powerful.  The only problem is, you need to be
an Elisp programmer to do it!  We’ll address the goal of becoming an Elisp
programmer in in <a href="#org36dd556"><i>Programming the Lisp Machine</i></a>, but in this chapter, we’ll talk
about how you can do some programming with no Elisp skills.
</p>

<p>
Nothing is more tedious than manually making repetitious mass edits to a file or
files.    <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Query-Replace"><code>query-replace</code></a>﻿ and especially
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Query-Replace"><code>query-replace-regexp</code></a>﻿ can handle relatively simple cases,
especially if coupled with any of the <a href="#orgfdf7146">Greps</a> and <a href="#org8b8111c">Writable Grep</a>, or <a href="#orgee2aacf">Writable
Occur</a>; Dired’s     <code>Q</code> (<code>dired-do-find-regexp-and-replace</code>) command
is also available, and the <a href="#orgdd5fd7e">Xref</a> facility can do mass renames of identifiers in
your program source code.<sup><a id="fnr.202" href="#fn.202" role="doc-backlink">202</a></sup>
</p>

<p>
But some mass edits are too complicated for any of those solutions.
</p>

<p>
A <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Keyboard-Macros"><i>Keyboard Macro</i></a> (hereafter, a
<i>Macro</i>) is a shorthand way of re-executing a longer sequence of commands.  A
function in a programming language (like Elisp) can be thought of in exactly the
same terms, but to write one you have to compose the function in a Buffer, and
evaluate it (assuming you know the syntax and semantics of the language).
</p>

<p>
Instead, a Macro is quickly defined at the point where it’s needed: you tell
Emacs to start recording, embark on a sequence of commands (key strokes) to
perform one instance of your task, and then stop recording.  Now you can
immediately re-run those steps, whether once or twice or by telling Emacs to run
the Macro as many times as it takes to do all the repetitions.  Then you just
forget about it.
</p>

<p>
Or instead, you might re-run the macro hours (or days) later, assuming you
haven’t exited Emacs, and if the Macro has turned out to be generally useful,
you can save it for future sessions, optionally giving it a name and possibly
binding it to a key.  You can have several anonymous Macros defined in your
session and switch between them, and you can edit any of them to fix a bug or
make an enhancement.
</p>

<p>
Note that Macros are defined <i>globally</i> and are not Buffer-local.  You can define
a Macro in one Buffer, and then switch to a different Buffer to execute it.
</p>
</div>
<div id="outline-container-org07cc622">
<h4 id="org07cc622">Your First Macro <a id="org6910afe"></a></h4>
<div id="text-org07cc622">
<p>
Suppose you have a list of author names in inverted form and want to change them
all to a different format:
</p>
<pre id="orgf7ed716">Brackett, Leigh
Durrell, Gerald
O&#39;Brian, Patrick
Ambler, Eric
Fleming, Fergus
Mundy, Talbot
</pre>
<p>
Instead of “Brackett, Leigh” you want “Leigh BRACKETT”, and so on.
</p>

<p>
In order to make these changes with a Macro, you just have to do the first one
while recording, and then all rest can be done automatically.
</p>

<p>
Here’s my algorithm.  I have to start by positioning Point at the beginning of
the list.  Now I perform these steps:<sup><a id="fnr.203" href="#fn.203" role="doc-backlink">203</a></sup>
</p>

<dl>
<dt>    <code>M-u</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Case"><code>upcase-word</code></a>﻿)</dt><dd>giving “BRACKETT”</dd>
<dt>    <code>C-d</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Deletion"><code>delete-char</code></a>﻿)</dt><dd>eliminating the comma</dd>
<dt>    <code>M-t</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Transpose"><code>transpose-words</code></a>﻿)</dt><dd>flip the two parts</dd>
<dt>    <code>C-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>forward-char</code></a>﻿)</dt><dd>move to the beginning of the next line</dd>
</dl>

<p>
To turn this algorithm into a Macro and apply it, you only need to learn three
things:
</p>
<ol>
<li>how to start recording,</li>
<li>how to stop recording, and</li>
<li>how to invoke the Macro you just defined.</li>
</ol>

<p>
You start recording with <code>C-x (</code>; you’ll
see the message “Defining kbd macro…” in the <a href="#org7e7133f">Echo Area</a> and the indicator “Def”
will light-up in the <a href="#org6456ffd">Mode Line</a> until you’re done.  Now you perform the actions
that comprise your Macro, any sequence of commands of any length; now you’ve done
the first of presumably many repetitions of your task.
</p>

<p>
You stop recording with <code>C-x )</code>; you’ll see
“Keyboard macro defined” and the “Def” indicator will go away.
</p>

<p>
Now you can invoke the macro with
    <code>C-x e</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Basic-Keyboard-Macro"><code>kmacro-end-and-call-macro</code></a>﻿): it re-executes your
sequence of commands.  Since we ended the Macro by moving to the beginning of
the next line, we’re ready to invoke it immediately without having to move into
position.  We’ll call <code>C-x e</code> five more times, and the result will be:
</p>
<pre id="org26624eb">Leigh BRACKETT
Gerald DURRELL
Patrick O&#39;BRIAN
Eric AMBLER
Fergus FLEMING
Talbot MUNDY
</pre>
</div>
</div>
<div id="outline-container-orgc1c7f7b">
<h4 id="orgc1c7f7b">Repeating a Macro</h4>
<div id="text-orgc1c7f7b">
<p>
Perhaps you noticed this message in the Echo Area after your first <code>C-x e</code>:
</p>
<pre>(Type e to repeat macro)
</pre>

<p>
After any <code>C-x e</code> you can immediately rerun the Macro by just typing <code>e</code>.
</p>

<p>
You can also have Emacs repeat the Macro for you.  You can give <code>C-x e</code> a numeric
argument, and Emacs will repeat it that many times.  Occasionally it’s obvious
how many times you need to invoke a Macro, but it’s much more common that you
just know you need to invoke the Macro <i>a lot</i>.  It’s very common to want to
reapply the Macro as many times as possible, all the way to the end of the
Buffer.
</p>

<p>
You can auto-repeat the Macro by giving <code>C-x e</code> a numeric argument of zero
(standing for infinity) as in  <code>C-u 0 C-x e</code>.  The Macro will just repeat over
and over until it gets an error (which will usually happen at the end of the
Buffer) or until interrupted with     <code>C-g</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Quitting"><code>keyboard-quit</code></a>﻿).
</p>

<p>
If you want to apply a Macro to a big chunk of text, but not the whole Buffer,
just <a href="#org39c0e40">Narrow the Buffer</a> with   <code>C-x n n</code>, go to the beginning of the
narrowed region and invoke the Macro infinity times.  When it beeps,
having hit the end of the (narrowed) Buffer, you’re done, and you can widen it
again with   <code>C-x n w</code>.
</p>

<p>
It <i>is</i> possible to define a Macro that loops infinitely!  A simple example is:
</p>
<pre>C-x ( foo C-x )
</pre>

<p>
In other words, a Macro that just inserts “foo”.  If you <code>C-u 0 C-x e</code> this Macro,
it will just insert “foo ” forever, until you fill up all of memory and maybe
crash your Emacs — welcome to Computer Programming!  Best only to use <code>C-u 0</code>
with a Macro that can fail (like a Macro that includes a search).
</p>
</div>
</div>
<div id="outline-container-orgb460141">
<h4 id="orgb460141">Aborting a Macro Definition</h4>
<p>
If you need to abort the definition of your Macro, perhaps because you realize
your algorithm isn’t exactly right, all you need to do is hit
    <code>C-g</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Quitting"><code>keyboard-quit</code></a>﻿).  This terminates the Macro definition
mode and discards all the steps you just recorded.  It does <i>not</i> undo all the
commands you invoked however, so if you want to start your definition over from
scratch, you’ll have to <a href="#org3f93c8e">Undo</a>.  If you want to pick up your aborted Macro
definition and fix it without having to redo the whole thing, see
    <code>C-x C-k l</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Edit-Keyboard-Macro"><code>kmacro-edit-lossage</code></a>﻿) below in <a href="#org43b6b9a"><i>Editing Your Macro</i></a>.
</p>
</div>
<div id="outline-container-orgb029f24">
<h4 id="orgb029f24">Line-by-Line Macros</h4>
<div id="text-orgb029f24">
<p>
Many Macros, like our example, are intended to be applied to a line at a time;
that’s why we used <code>C-f</code> at the end, to advance to the beginning of the next
line.  But there’s a special command to simplify both the definition and
execution of this kind of Macro.
</p>

<p>
You just define your Macro, starting at the beginning of the first line, without
worrying about ending up at the beginning of the next line; then, definition
finished, you set the <a href="#org34ab2da">Region</a> around any sequence of target lines, and invoke
    <code>C-x C-k r</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Basic-Keyboard-Macro"><code>apply-macro-to-region-lines</code></a>﻿).  This invokes your
Macro exactly once on each line of the Region; it automatically positions Point
at the beginning of each line before each repetition.  So with <code>C-x C-k r</code> our
Macro could be as simple as <code>M-u C-d M-t</code>.
</p>
</div>
</div>
<div id="outline-container-org8b578f5">
<h4 id="org8b578f5">What Happens If You Make a Mistake?</h4>
<div id="text-org8b578f5">
<p>
As you’re defining, if any command you invoke raises an error, the definition
will be aborted.  The steps that comprise your Macro have to be error-free.  By
far the most common such error must be searching for some text that doesn’t
actually exist.
</p>

<p>
Searches are a very common part of many Macros; often you use a search to get to
the next place in the Buffer that you want to change.  The natural effect of
this is to terminate automatic repetitions of your Macro when there are no more
matches, so that kind of error is not only okay, but a key part of Macro
design.  But often you’ll discover that your search is perhaps too specific and
the resulting error will blow up your Macro early; you’ll just have to come up
with a better search.
</p>

<p>
Remember that Undoing is just another Emacs command, so you if make a
non-error-raising mistake while defining, you might be able to just Undo it
rather than starting over!  In our example above, what if instead of upcasing
the name I accidentally downcased it?  Instead of aborting and starting over I
could just immediately Undo and then do the upcasing I intended.  The Macro would
now be: <code>M-l C-/ M-u C-d M-t C-f</code>, which is, I suppose, less efficient, but it
will work just as well.
</p>

<p>
Speaking of mistakes, while you <i>can</i> (technically) use the mouse in defining a
Macro, I think it’s a bad idea.  The mouse is a very complex device, its effect
depending on exactly where the mouse cursor is at the moment, so replaying mouse
events is very unreliable.
</p>
</div>
</div>
<div id="outline-container-orgcf87f0a">
<h4 id="orgcf87f0a">Minibuffer Prompts</h4>
<div id="text-orgcf87f0a">
<p>
If in defining your Macro you invoke a command that prompts you for input via
the <a href="#orga329460">Minibuffer</a>, then when the Macro is run, you will <i>not</i> be prompted again: the
command will use the same text you entered during definition.  This is usually
what you want.  For example, suppose your Macro is gathering text from the
current Buffer and saving it in another Buffer via
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Accumulating-Text"><code>append-to-buffer</code></a>﻿, which prompts you for the name of the other
Buffer: if you need to run that Macro a hundred times, you don’t want to have to
retype the Buffer name each time!
</p>

<p>
Because of this behavior, it’s also common to just define a Macro that invokes a
single <code>M-x</code> command that you are about to use several times; defining:
</p>
<pre>C-x ( M-x append-to-buffer RET stuff RET C-x )
</pre>

<p>
means you can just say <code>C-x e</code> to gather some text, rather than the long-winded
<code>M-x append-to-buffer</code> plus at least a <code>M-p</code> to pull up the Buffer name you’re using.
</p>

<p>
There’s one thing to keep in mind though: in entering something like a Buffer
name, you should be conservative in exploiting the conveniences of your
<a href="#org75fb6a2">Completion</a> framework!  In normal Emacsing, you might enter a Buffer name by
typing only a few letters and hitting return when Completion presents the right
name.  If you do this in a Macro definition, the next time you run the Macro you
might get a different, unintended, Buffer name!  This is most likely to happen
with a Macro that you run intermittently throughout a sesssion: perhaps your
Completion framework offers up matching Buffer names in a different order
depending on how recently you used them.  It’s good Macro practice to type out
the whole name explicitly in this scenario.
</p>
</div>
</div>
<div id="outline-container-org95046b2">
<h4 id="org95046b2">The Keyboard Macro Map</h4>
<div id="text-org95046b2">
<table id="orge897739">
<caption><span>Table 28:</span> Keyboard Macro Commands</caption>

<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Keystrokes</th>
<th scope="col">Category</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>C-x (</code></td>
<td>Define</td>
<td>start defining a Macro</td>
</tr>

<tr>
<td><code>C-x C-k s</code></td>
<td> </td>
<td>… the same</td>
</tr>

<tr>
<td><code>C-x C-k C-s</code></td>
<td> </td>
<td>… the same</td>
</tr>

<tr>
<td><code>&lt;F3&gt;</code></td>
<td> </td>
<td>… the same</td>
</tr>

<tr>
<td><code>C-x )</code></td>
<td> </td>
<td>end Macro definition</td>
</tr>

<tr>
<td><code>&lt;F4&gt;</code></td>
<td> </td>
<td>… the same (if defining)</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C-x e</code></td>
<td>Execute</td>
<td>Execute latest Macro</td>
</tr>

<tr>
<td><code>&lt;F4&gt;</code></td>
<td> </td>
<td>… the same (if not currently defining)</td>
</tr>

<tr>
<td><code>C-u &lt;F3&gt;</code></td>
<td> </td>
<td>execute latest Macro and append new commands</td>
</tr>

<tr>
<td><code>C-x C-k r</code></td>
<td> </td>
<td>apply Macro line-by-line in Region</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C-x C-k C-n</code></td>
<td>Ring</td>
<td>make earlier Macro the current Macro</td>
</tr>

<tr>
<td><code>C-x C-k C-p</code></td>
<td> </td>
<td>… reverse direction</td>
</tr>

<tr>
<td><code>C-x C-k C-d</code></td>
<td> </td>
<td>Delete the current Macro from the Ring</td>
</tr>

<tr>
<td><code>C-x C-k C-v</code></td>
<td> </td>
<td>View current Macro definition</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C-x q</code></td>
<td>Query</td>
<td>Query the user</td>
</tr>

<tr>
<td><code>C-x C-k q</code></td>
<td> </td>
<td>… the same</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>&lt;F3&gt;</code></td>
<td>Count</td>
<td>Insert Macro counter value at Point</td>
</tr>

<tr>
<td><code>C-x C-k C-i</code></td>
<td> </td>
<td>… the same</td>
</tr>

<tr>
<td><code>C-x C-k C-c</code></td>
<td> </td>
<td>set the Counter’s value</td>
</tr>

<tr>
<td><code>C-x C-k C-f</code></td>
<td> </td>
<td>define the counter’s Format</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C-x C-k C-e</code></td>
<td>Edit</td>
<td>Edit the current Macro definition</td>
</tr>

<tr>
<td><code>C-x C-k RET</code></td>
<td> </td>
<td>… the same</td>
</tr>

<tr>
<td><code>C-x C-k e</code></td>
<td> </td>
<td>Edit a Macro by its <i>name</i> or <i>binding</i></td>
</tr>

<tr>
<td><code>C-x C-k l</code></td>
<td> </td>
<td>turn the Last few commands into a Macro</td>
</tr>

<tr>
<td><code>C-x C-k SPC</code></td>
<td> </td>
<td>edit (debug) the current Macro step-by-step</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C-x C-k b</code></td>
<td>Bind</td>
<td>kmacro-bind-to-key</td>
</tr>

<tr>
<td><code>C-x C-k n</code></td>
<td> </td>
<td>kmacro-name-last-macro</td>
</tr>

<tr>
<td><code>C-x C-k x</code></td>
<td> </td>
<td>kmacro-to-register</td>
</tr>
</tbody>
</table>
<p>
There’s a whole family of Macro commands on the <code>C-x C-k</code> prefix, and a few other
handy key bindings as well.  In Table <a href="#orge897739">28</a> I’ve gathered
them in several groups.  Let’s take a look.
</p>
</div>
<div id="outline-container-org2c4937a">
<h5 id="org2c4937a">Macro Definition Commands</h5>
<div id="text-org2c4937a">
<p>
Instead of the <code>C-x (</code> and <code>C-x )</code> commands I’ve been using above, you should
probably use the quicker and cleverer <code>&lt;F3&gt;</code> and <code>&lt;F4&gt;</code>.<sup><a id="fnr.204" href="#fn.204" role="doc-backlink">204</a></sup> These two commands
are context-sensitive.  <code>&lt;F3&gt;</code> begins a Macro definition just like <code>C-x (</code> and <code>&lt;F4&gt;</code>
terminates a Macro definition just like <code>C-x )</code>, but if you’re <i>not</i> in the middle of
defining a Macro, <code>&lt;F4&gt;</code> instead <i>executes</i> the Macro like <code>C-x e</code> does, and since
it’s a single keystroke, you can <a href="#org38efd5c">felicitously</a> re-invoke it several times in row;
hence, it doesn’t need the “(Type e to repeat macro)” trick.  So with these
keys, whipping up and executing a Macro is as simple as: <code>&lt;F3&gt;</code> <i>defining commands</i>
<code>&lt;F4&gt; &lt;F4&gt; &lt;F4&gt; ...</code>.
</p>

<p>
If you give <code>&lt;F3&gt;</code> a <code>C-u</code> prefix i.e. <code>C-u &lt;F3&gt;</code>, it allows you to <i>extend</i> the
definition of your current Macro: it executes the Macro once but then reenters
definition mode, allowing you to add more commands to the end of definition.
Terminate this extension with <code>&lt;F4&gt;</code> as usual and the next time you execute it, your
added commands will be included.
</p>

<p>
This is a simple way of <i>editing</i> your Macro (for more elaborate editing see
<a href="#org43b6b9a"><i>Editing Your Macro</i></a> below).
</p>

<p>
You can also think of it as allowing <i>incremental definition</i>: define your Macro
in stages.  Going back to our author-name-reformatting Macro <a href="#org6910afe">above</a>, we could
have defined as before:
</p>
<dl>
<dt><code>&lt;F3&gt;</code></dt><dd>start defining</dd>
<dt><code>M-u</code></dt><dd>upcase last name</dd>
<dt><code>C-d</code></dt><dd>delete comma</dd>
<dt><code>M-t</code></dt><dd>transpose words</dd>
<dt><code>&lt;F4&gt;</code></dt><dd>done!</dd>
</dl>
<p>
But now after trying it a couple times, we might decide that we really want to
add a “bullet” at the beginning of the line, so we can extend the definition:
</p>
<dl>
<dt><code>C-u &lt;F3&gt;</code></dt><dd>append commands to Macro definition</dd>
<dt><code>C-a</code></dt><dd>go to beginning of line</dd>
<dt><code>+ SPC</code></dt><dd>add a “bullet”<sup><a id="fnr.205" href="#fn.205" role="doc-backlink">205</a></sup></dd>
<dt><code>&lt;F4&gt;</code></dt><dd>done!</dd>
</dl>
<p>
Now our remaining author names will come out like this:
</p>
<pre id="org50c18e2">+ Lynda BARRY
+ Ian FLEMING
</pre>
</div>
</div>
<div id="outline-container-org1ceda92">
<h5 id="org1ceda92">The Macro Ring <a id="org9b8e264"></a></h5>
<div id="text-org1ceda92">
<p>
You can have any number of Macros defined simultaneously.<sup><a id="fnr.206" href="#fn.206" role="doc-backlink">206</a></sup>  They are
stored in a typical Emacs ring structure, so if you define a second Macro in
your session, it’s pushed onto the front of the Macro Ring, eclipsing your
previous definition.  From now on, all Macro invocations via <code>&lt;F4&gt;</code> and friends
execute the new one.
</p>

<p>
Unless you rotate the Macro Ring of course!  To execute your previous Macro, do
    <code>C-x C-k C-n</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Keyboard-Macro-Ring"><code>kmacro-cycle-ring-next</code></a>﻿).<sup><a id="fnr.207" href="#fn.207" role="doc-backlink">207</a></sup>  The previous Macro’s
definition will be shown in the <a href="#org7e7133f">Echo Area</a>; it’s a mite cryptic, but you should
be able to recognize it since you defined it recently!  Here’s our extended
author-name-reformatting Macro appears:
</p>
<pre>Macro: M-u C-d SPC M-t C-a + SPC
</pre>

<p>
Repeating <code>C-x C-k C-n</code> will cycle around the Ring; just stop when you’ve found
the Macro you want and now <code>&lt;F4&gt;</code> will execute <i>that</i> one instead, and keep
executing that one until you rotate again or define a newer one.
</p>

<p>
If you overshoot in your cycling,
    <code>C-x C-k C-p</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Keyboard-Macro-Ring"><code>kmacro-cycle-ring-previous</code></a>﻿) will reverse
direction.  You can quickly delete the current Macro with
    <code>C-x C-k C-d</code> (<code>kmacro-delete-ring-head</code>), and there are a few
more Macro Ring commands and a mechanism for shorthand keystrokes, but these are
for real professionals: I’ve never had a complex-enough set of Macros to have
needed them; see <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Keyboard-Macro-Ring">“Keyboard Macro Ring”</a> in the <i>Emacs</i> manual.
</p>

<p>
You can review the Macros in the Ring with
    <code>C-x C-k C-v</code> (<code>kmacro-view-macro-repeat</code>); it displays the
definition in the Echo Area without actually rotating the Ring; an immediate <code>C-v</code>
cycles to show the next.  While you’re cycling, you can execute the
currently-displayed Macro by immediately typing <code>C-k</code>, without having rotated it
to the front of the Ring.<sup><a id="fnr.208" href="#fn.208" role="doc-backlink">208</a></sup>
</p>

<p>
If you really need to use several different Macros at a time, you might find it
easier to just bind them explicitly to keys, or give them names; see <a href="#org3b954e5"><i>Naming and
Binding Your Macros</i></a>.
</p>
</div>
</div>
<div id="outline-container-org680744f">
<h5 id="org680744f">Macro Query</h5>
<div id="text-org680744f">
<p>
Keyboard Macros really are a programming language, but they do seem like they’re
not a <a href="https://en.wikipedia.org/wiki/Turing_completeness">Turing Complete</a> one, since they’re lacking the necessary <a href="https://en.wikipedia.org/wiki/Conditional_(computer_programming)">conditional
statement</a>.<sup><a id="fnr.209" href="#fn.209" role="doc-backlink">209</a></sup> However, the handy     <code>C-x q</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Keyboard-Macro-Query"><code>kbd-macro-query</code></a>﻿)
command directly supports a limited amount of conditional or dynamic action
within your Macro.
</p>

<p>
The most basic function of <code>C-x q</code> is to stop at a certain point and ask you if
you want to continue with the Macro.  Suppose we’re about to define our
author-name-reformatting Macro, but we know in advance that we only want to
apply it to <i>some</i> of the lines in the Region.  We could just live with not being
able to run it over the whole Buffer automatically (via
    <code>C-x C-k r</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Basic-Keyboard-Macro"><code>apply-macro-to-region-lines</code></a>﻿)) and invoke it
manually one line at a time.  But we could instead begin the Macro with <code>C-x q</code>
i.e. <code>C-x q M-u C-d M-t</code>.
</p>

<p>
Each time we run the Macro, <code>C-x q</code> will ask in the Minibuffer:
</p>
<pre>Proceed with macro? (Y, N, RET, C-l, C-r)
</pre>

<p>
and wait for a response, which can be any of the following:
</p>
<table>


<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Y</code></td>
<td>Finish this iteration normally and continue with the next.</td>
</tr>

<tr>
<td><code>N</code></td>
<td>Skip the rest of this iteration, and start the next.</td>
</tr>

<tr>
<td><code>RET</code></td>
<td>Stop the macro entirely right now.</td>
</tr>

<tr>
<td><code>C-l</code></td>
<td>Redisplay the screen, then ask again.</td>
</tr>

<tr>
<td><code>C-r</code></td>
<td>Enter recursive edit; ask again when you exit from that.</td>
</tr>
</tbody>
</table>
<p>
If we’re running the Macro with <code>C-x C-k r</code>, We can respond <code>Y</code> on the lines where
we want to apply the Macro, and <code>N</code> where we don’t.
</p>

<p>
Most powerful is that we can enter a <a href="#orgbcf0f80">Recursive Edit</a>, which would allow us to
make a local, manual, tweak in each execution.
</p>
</div>
</div>
<div id="outline-container-org43b672a">
<h5 id="org43b672a">Macro Counters <a id="org4e40ec5"></a></h5>
<div id="text-org43b672a">
<p>
Every Macro has its own <i>counter</i> which you can use to number things while it
executes.  Perhaps instead of a bullet list of reformatted authors, we want to
make a numbered list.  All we need to do is use <code>C-x C-k C-i</code> (or <code>&lt;F3&gt;</code>, which is
equivalent when you’re already defining) at the appropriate spot in our
definition: <code>C-x C-k C-i . SPC M-u C-d M-t</code>.  Now when we run our Macro with <code>C-x
C-k r</code> the result is:
</p>
<pre id="org7435dc8">0. Gerald DURRELL
1. Patrick O&#39;BRIAN
2. Eric AMBLER
3. Fergus FLEMING
4. Talbot MUNDY
</pre>
<p>
If you move around or do other things and then <code>&lt;F4&gt;</code> your Macro again, it will
continue with number 5.  You can reset the count with
    <code>C-x C-k C-c</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Keyboard-Macro-Counter"><code>kmacro-set-counter</code></a>﻿).<sup><a id="fnr.210" href="#fn.210" role="doc-backlink">210</a></sup>
</p>

<p>
I’m sure you’ve noticed that the Macro Counter starts at zero… That’s because
<a href="https://en.wikipedia.org/wiki/Zero-based_numbering">programmers count from zero</a>.  If you’re not a programmer, or you’re a programmer
who wants to act like a normal human at this moment, just set the Counter to 1
before you invoke the Macro for the first time: <code>C-u 1 C-x C-k C-c</code>.
</p>

<p>
In addition to its Counter, each Macro also has it’s own Counter Format.  You
can change it by calling     <code>C-x C-k C-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Keyboard-Macro-Counter"><code>kmacro-set-format</code></a>﻿) at
the beginning of your definition.<sup><a id="fnr.211" href="#fn.211" role="doc-backlink">211</a></sup>  This allows you to get leading zeros
or spaces for a fixed-width number column:
</p>
<pre>0013. Eric AMBLER
</pre>

<p>
or even number your list in hexadecimal.  If you’re a programmer, you’ll have
guessed that this uses a <a href="https://en.wikipedia.org/wiki/Printf_format_string"><code>printf</code> format string</a>; see
<a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Formatting-Strings">“Formatting Strings”</a> in the <i>Elisp</i> manual.
</p>
</div>
</div>
<div id="outline-container-org3d64727">
<h5 id="org3d64727">Editing Your Macro <a id="org43b6b9a"></a></h5>
<div id="text-org3d64727">
<p>
In the old days, it was inevitable that after (or during) the definition of an
elaborate Macro, you would discover a mistake; there was nothing to do but start
over from scratch.  But we 21st century Emacsers have
    <code>C-x C-k C-e</code> (<code>kmacro-edit-macro-repeat</code>) and can <i>edit</i> our
definition to correct it, or further enhance a working Macro.
</p>

<p>
We’ve seen <code>C-u &lt;F3&gt;</code>, but that’s just a poor man’s approximation<sup><a id="fnr.212" href="#fn.212" role="doc-backlink">212</a></sup> that
only allows you to append new commands to the end.  <code>C-x C-k C-e</code> pops up a
special Buffer <code>*Edit Macro*</code> that displays the definition line-by-line with
explanatory comments, and you can delete steps, rearrange them, and add new commands
at will.  Let’s edit our author-name-reformatting Macro.  <code>C-x C-k C-e</code> edits the
current Macro (at the front of the Ring), so if the one you want to edit isn’t
there, rotate the Ring appropriately,
</p>
<pre id="orgf14f96e">;; Keyboard Macro Editor.  Press C-c C-c to finish; press C-x k RET to cancel.
;; Original keys: C-x C-k C-i . SPC M-u C-d M-t

Command: last-kbd-macro
Key: none

Macro:

C-x C-k C-i           ;; kmacro-start-macro-or-insert-counter
.                     ;; self-insert-command
SPC                   ;; self-insert-command
M-u                   ;; upcase-word
C-d                   ;; delete-char
M-t                   ;; transpose-words
</pre>
<p>
Note that there are several Elisp comments in this Buffer: everything from a
semicolon to the end of the line is a comment.  These comments are insignificant
to your Macro editing; nothing you might change in a comment here (including
deleting it entirely) has any effect.  In general, differences in whitespace are
also insignificant.
</p>

<p>
The defining parts of the Buffer are the non-whitespace characters following the
word <code>Macro:</code> (and ignoring the comments).  Each command in the definition
consists of the keystrokes used to invoke it, spelled the way Emacs spells them
when you use     <code>C-h c</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Key-Help"><code>describe-key-briefly</code></a>﻿) (which is the way
you see these keys spelled throughout this book).  So <code>SPC</code> for the Space key, <code>RET</code>
for Return, etc.  Remember, amounts of whitespace (including line breaks) make no
difference: the definition could be all on one line like:
</p>
<pre>C-x C-k C-i . SPC M-u C-d M-t
</pre>

<p>
the three keystrokes <code>C-x C-k C-i</code> could be split across three lines, etc.
</p>

<p>
If you repeat a command several times in a row, you might see this format:
</p>
<pre>4*M-u			;; upcase-word
</pre>

<p>
which means you typed four <code>M-u</code>’s here; you can use this notation yourself.
</p>

<p>
Suppose you want to change your Macro to merely capitalize the author’s last
name instead of uppercasing all of it.  Just change <code>M-u</code> to
    <code>M-c</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Case"><code>capitalize-word</code></a>﻿) and hit <code>C-c C-c</code> to save your change.
Simple as that: now instead of “Eric AMBLER” you’ll get “Eric Ambler”.
</p>

<p>
Note that the <code>Original keys</code> section at top preserves the original definition in
a comment; you can grab bits of it if needed.  Additionally, the <code>*Edit Macro*</code>
Buffer is a Buffer like any other you might edit, so of course you can use <a href="#org3f93c8e">Undo</a>
within it.  But if you do mess up or change your mind, you can always just bury
or kill the Buffer and your Macro remains unchanged.
</p>

<p>
If you’ve named or bound your Macro to a key (see <a href="#org3b954e5">below</a>), you can edit it with
    <code>C-x C-k e</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Edit-Keyboard-Macro"><code>edit-kbd-macro</code></a>﻿).  And you can also turn a sequence
of editing commands you just happened to type into a Macro after the fact with
    <code>C-x C-k l</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Edit-Keyboard-Macro"><code>kmacro-edit-lossage</code></a>﻿), which pops up an <code>*Edit
Macro*</code> Buffer loaded with the last 300 keystrokes you typed (you’ll almost
certainly delete a lot of them).
</p>
</div>
</div>
<div id="outline-container-orgde526af">
<h5 id="orgde526af">Debugging Your Macro</h5>
<div id="text-orgde526af">
<p>
Real programming languages have <a href="https://en.wikipedia.org/wiki/Debugger">interactive debuggers</a> to help you find bugs in
your programs<sup><a id="fnr.213" href="#fn.213" role="doc-backlink">213</a></sup>, typically by <i>single-stepping</i> through the code: that is,
running the program one instruction at a time so you can see the effect of each
one clearly and incrementally.
</p>

<p>
Surprisingly, Emacs also has a debugger for Macros!<sup><a id="fnr.214" href="#fn.214" role="doc-backlink">214</a></sup> Position yourself
for the execution of your Macro but instead of <code>&lt;F4&gt;</code> or <code>C-x e</code>, run it with
    <code>C-x C-k SPC</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Keyboard-Macro-Step-Edit"><code>kmacro-step-edit-macro</code></a>﻿), Emacs will pop up a
small Window showing the definition of your Macro, and give you a prompt.  If
you type <code>SPC</code> at the prompt, it will execute the first command of your Macro —
you’ll see the effect in the original Buffer — and prompt you again.  If you
type <code>SPC</code> for every command in the definition, you will have executed the Macro
just as if you had typed <code>&lt;F4&gt;</code>: only much more slowly!
</p>

<p>
This slow stepwise execution can reveal to you a bug in your Macro, which you
could then fix with the Macro editor (<code>C-x C-k e</code>).  But at each step, you can
instead skip the current command, or insert a new series of commands before or
after it: any such changes you make are saved and become part of the Macro’s
definition, so this is also a more interactive and perhaps intuitive way of
<i>editing</i> your Macro.  See <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Keyboard-Macro-Step-Edit">“Keyboard Macro Step-Edit”</a> in the <i>Emacs</i> manual for
detailed instructions.
</p>
</div>
</div>
<div id="outline-container-orgef55d7c">
<h5 id="orgef55d7c">Naming and Binding Your Macros <a id="org3b954e5"></a></h5>
<div id="text-orgef55d7c">
<p>
If the <a href="#org9b8e264">Macro Ring</a> seems a little too ascetic to you, you can easily bind your
latest Macro to a key with     <code>C-x C-k b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Save-Keyboard-Macro"><code>kmacro-bind-to-key</code></a>﻿).
This cautious command will prompt you for a keystroke; if you choose one that’s
already in use, it will ask you if you’re sure you want to replace that binding
with your Macro.
</p>

<p>
Since there are something between 200 and 1,000 active key bindings in a typical
Emacs, you might have trouble coming up with an unused keystroke!  As a
convenience, if you type any of the digits 0-9 or the capital letters A-Z, your
Macro will be bound to that key in the <code>C-x C-k</code> keymap.  So if you type <code>C-x C-k b</code>
and repond <code>Q</code>, your Macro will be bound to <code>C-x C-k Q</code>.
</p>

<p>
With     <code>C-x C-k n</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Save-Keyboard-Macro"><code>kmacro-name-last-macro</code></a>﻿) you can instead, or
also, give your Macro a long name that you can use with
    <code>M-x</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/M-x"><code>execute-extended-command</code></a>﻿).
</p>

<p>
Both of these binding commands only last until the end of this Emacs session.
If you want to save your Macro permanently, pull up your <a href="#org2af3730">Init File</a>, jump to the
end of it, and invoke   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Save-Keyboard-Macro"><code>insert-kbd-macro</code></a>﻿; this command will prompt
for the name of your Macro<sup><a id="fnr.215" href="#fn.215" role="doc-backlink">215</a></sup> and convert it to Elisp, which it will insert
into the current Buffer at <a href="#orgba1f634">Point</a>.  It might look a little cryptic; here’s one
possible form for our author-name-reformatting Macro:
</p>
<div>
<pre>(fset &#39;reformat-author-name
   (kmacro-lambda-form [escape ?u ?\C-d escape ?t] 0 <span>&#34;%d&#34;</span>))
</pre>
</div>
<p>
If you gave your Macro a key binding as well as a name, you can use
<code>C-u M-x insert-kbd-macro</code> instead, which will also save your key binding:
</p>
<div>
<pre>(fset &#39;reformat-author-name
   (kmacro-lambda-form [escape ?u ?\C-d escape ?t] 0 <span>&#34;%d&#34;</span>))
(global-set-key [24 11 81] &#39;reformat-author-name)
</pre>
</div>
<p>
With this code in your Init File, your Macro will be available every time you
begin an Emacs session.
</p>
</div>
</div>
</div>

<div id="outline-container-org33f1e0e">
<h4 id="org33f1e0e">A Musical Example</h4>
<div id="text-org33f1e0e">
<p>
Let’s finish up with one more example.  I play the ukulele and guitar and have
hundreds of files of <a href="https://en.wikipedia.org/wiki/Lead_sheet"><i>lead sheets</i></a>.  I usually write them out in this format:
song lyrics with the chords written above the lines, like so:<sup><a id="fnr.216" href="#fn.216" role="doc-backlink">216</a></sup>
</p>
<pre id="org1228d08">        A             D             A7        Gbdim
And she said, &#34;By the time that you open your eyes
           G        D7          G
There will not be a shoulder in sight.&#34;
</pre>
<p>
This is convenient for editing, but when I’m done with a song, I want to convert
it into the de facto standard <a href="https://www.chordpro.org/chordpro/chordpro-file-format-specification/">ChordPro format</a> (which is harder to edit):
</p>
<pre id="orge14562a">And she [A]said, &#34;By the [D]time that you [A7]open your [Gbdim]eyes
There will [G]not be a [D7]shoulder in [G]sight.&#34;
</pre>
<p>
Obviously converting from the former to the latter calls for a Macro;
here’s the one I whipped up:
</p>
<pre id="orge3c082b">C-e      ;; move-end-of-line
M-\      ;; delete-horizontal-space
C-u -    ;; self-insert-command
M-C-k    ;; kill-sexp
C-n      ;; next-line
[        ;; self-insert-command
C-y      ;; yank
]        ;; self-insert-command
C-p      ;; previous-line
</pre>
<p>
After using this for a while, I made some tweaks to it; then I turned it into an
Elisp function to make it more robust; and ultimately it grew into a <a href="#org5b21ef0">Major Mode</a>
for editing ChordPro files.
</p>
</div>
</div>
</div>
<div id="outline-container-orgae24bc9">
<h3 id="orgae24bc9">The Customize Facility <a id="org27e6769"></a></h3>
<div id="text-orgae24bc9">
<p>
The simplest kind of Emacs customization is to change the value of any of the
2,910 <a href="#orge6fb506">User Options</a> or <a href="#orgb1883e1">Faces</a>.  While an Elisp
programmer might choose to do this via an Elisp expression in the <a href="#org2af3730">Init File</a>,
it’s very easy for the non-programmer to do via the interactive <i>Customize</i>
facility, which presents the variable’s default value, its current value, its
legal <i>possible</i> values, its documentation, links to related variables, and an easy
interactive way to modify the value.
</p>

<p>
One of the big advantages of Customize over customization via Elisp, even for
experienced Elisp programmers, is the amount of bookkeeping that Customize does
for you.  It keeps track of what you’ve customized, allowing you to restore or
further tweak the value of something you changed and now regret.
</p>
</div>
<div id="outline-container-org1d232b7">
<h4 id="org1d232b7">Entry Points</h4>
<div id="text-org1d232b7">
<p>
The entry points to the Customize facility range from customizing one single
Variable or Face, up to high-level browsing of everything customizable;
Table <a href="#orgab0fada">29</a> summarizes most of them.
</p>

<table id="orgab0fada">
<caption><span>Table 29:</span> Customization Commands</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td><code>M-x customize-variable</code></td>
<td>Customize a single named User Option</td>
</tr>

<tr>
<td><code>M-x customize-variable-other-window</code></td>
<td>… in the other Window</td>
</tr>

<tr>
<td><code>M-x customize-face</code></td>
<td>Customize a single named Face</td>
</tr>

<tr>
<td><code>M-x customize-face-other-window</code></td>
<td>… in the other Window</td>
</tr>

<tr>
<td><code>M-x customize-mode</code></td>
<td>Customize all Variables related to a major or minor mode</td>
</tr>

<tr>
<td> </td>
<td> </td>
</tr>

<tr>
<td><code>M-x customize-group</code></td>
<td>Customize <i>GROUP</i>, which must be a <i>customization group</i></td>
</tr>

<tr>
<td><code>M-x customize-group-other-window</code></td>
<td>… in the other window</td>
</tr>

<tr>
<td> </td>
<td> </td>
</tr>

<tr>
<td><code>M-x customize</code></td>
<td>Customize anything or everything</td>
</tr>

<tr>
<td><code>M-x customize-browse</code></td>
<td>… same, via a tree-structured interface</td>
</tr>

<tr>
<td> </td>
<td> </td>
</tr>

<tr>
<td><code>M-x customize-apropos-options</code></td>
<td>Customize all loaded Options matching a <i>REGEXP</i></td>
</tr>

<tr>
<td><code>M-x customize-apropos-faces</code></td>
<td>Customize all loaded Faces matching a <i>REGEXP</i></td>
</tr>

<tr>
<td><code>M-x customize-apropos-groups</code></td>
<td>Customize all loaded groups matching a <i>REGEXP</i></td>
</tr>

<tr>
<td><code>M-x customize-apropos</code></td>
<td>Customize loaded Options, Faces and groups matching a <i>PATTERN</i></td>
</tr>
</tbody>
</table>
<p>
(<code>customize-variable</code> also goes by the name <code>customize-option</code>, and
<code>customize-variable-other-window</code> is also known as <code>customize-option-other-window</code>.)
</p>

<p>
To aid browsing and navigation, customization Variables are organized in <i>groups</i>;
often each Emacs package in the <a href="#orgc96889a">Package Manager</a> defines its own group, but there
are also broader groups defined.    <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-group</code></a>﻿ let’s you see
all the Variables and Faces for such a group; <code>M-x customize-group RET isearch</code> will
show you everything you can change about <a href="#org3ffa52a">Incremental Search</a>, for example: around
40 Options
.
While you can discover the Customization groups via <a href="#org75fb6a2">Completion</a> on
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-group</code></a>﻿, if exploration is your goal you can use
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Easy-Customization"><code>customize</code></a>﻿ and navigate through all the groups and subgroups in a
leisurely manner.
</p>

<p>
You can also enter the facility via <a href="#org42f1d6b">Apropos</a>.  Suppose you want to tweak the
options relating to how sentences are recognized, but you don’t know the name of
the appropriate group.    <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-apropos</code></a>﻿ with the keyword
“sentence” will bring up five pertinent Variables.
</p>
</div>
</div>
<div id="outline-container-org5f5fce8">
<h4 id="org5f5fce8">Experiment Without Fear</h4>
<p>
You don’t have to worry very much about entering the Customize facility and
messing things up.  All the changes you make happen in three steps: first
<i>editing</i> a value, then <i>setting</i> it (which causes it to take effect in this
session), and finally <i>saving</i> the change for future sessions.  You can feel free
to edit a value just to see what it looks like: doing so won’t have any effect
unless you also <i>set</i> it.  If you’ve edited a value and it looks undesirable to
you, you don’t even have to restore it if you haven’t set it yet.  You can
simply kill the Buffer, or bury it and never come back; it will be as if you
were never there.  And if you <i>have</i> set it, Customize remembers the previous
value and makes it easy to restore it.  It’s even easy to find changes you’ve
saved for all future sessions and restore them, if it turns out you don’t like
something you’ve done.
</p>
</div>

<div id="outline-container-org63291be">
<h4 id="org63291be">Changing the Value of a Variable</h4>
<div id="text-org63291be">
<p>
Depending on which entry point you’ve chosen, the Customize Buffer will have one
or possibly many Variables or Faces you can change.
</p>

<p>
Let’s consider doing <code>M-x customize-variable RET list-command-history-max</code> (see
<a href="#orga329460"><i>The Minibuffer</i></a>).  In the Customize Buffer, we’ll see something like:
</p>
<pre id="orgbfaefea">List Command History Max: [Value Menu] Integer: 32
   [State] : STANDARD.
   If non-nil, maximum length of the listing produced by ‘list-command-history’.
</pre>
<p>
We can see the name of the Variable<sup><a id="fnr.217" href="#fn.217" role="doc-backlink">217</a></sup>, its current value (here 32), its
customization <i>state</i> (here “STANDARD”), and its documentation.
</p>

<p>
You can change the value by editing the current value in the Buffer (just change
the 32 to something else) or by <i>clicking<sup><a id="fnr.218" href="#fn.218" role="doc-backlink">218</a></sup></i> the “Value Menu” button.
</p>

<p>
Some Variables are simple and only accept a single sort of value (say, a number
or a string), but others have more complex possibilities, and the Value button
gives you a way of unambiguously entering them: Boolean variables can toggled on
or off, for example, and it’s very common for Variables to allow an out-of-band
<i>nil</i> option that can be interpreted in a variety of ways (described in the
Variables’s documentation).
</p>

<p>
It’s also very common for a Variable to take a complex value, like a list of
things; in this case, there will be additional buttons to add or delete
individual elements of the list.  See
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Changing-a-Variable">“Changing a Variable”</a> in the <i>Emacs</i> manual for complete details.
</p>

<p>
When you change the value, whether by clicking or editing, the State button will
change from “STANDARD” to “EDITED”.  To actually apply your edit you need to <i>set</i>
the value.  Click on the State button and you’ll see a menu of options:
</p>
<table>


<colgroup>
<col/>
</colgroup>
<tbody>
<tr>
<td>Set for Current Session</td>
</tr>

<tr>
<td>Save for Future Sessions</td>
</tr>

<tr>
<td>Undo Edits</td>
</tr>

<tr>
<td>Revert This Session’s Customization</td>
</tr>

<tr>
<td>Erase Customization</td>
</tr>

<tr>
<td>Add Comment</td>
</tr>
</tbody>
</table>
<p>
The first two should be self-explanatory; “Undo Edits” restores this Variable to
the value it had when you entered the customization Buffer; “Revert” restores
the value to the last saved value (or restores the default Emacs value if you’ve
never saved it), and “Erase” restores the standard value (what the Option would
be if you started up an uncustomized Emacs).  “Add Comment” let’s
you document your changes and saves a comment that will be displayed along with
this value in future Customize sessions.
</p>
</div>
</div>

<div id="outline-container-org5e7172c">
<h4 id="org5e7172c">Customizing Multiple Options</h4>
<div id="text-org5e7172c">
<p>
While <code>customize-variable</code> and <code>customize-face</code> present one value at a time, most of
the other Customize entry points let you view and change multiple values in one
go.  So each Customize Buffer has three extra buttons at the top:
</p>
<pre id="org9a24b71">Operate on all settings in this buffer:
 [Revert...]   [Apply]   [Apply and Save]
</pre>
<p>
These buttons let you finish up multiple edits in one stroke: “Apply” will <i>set</i>
all the Variables in this Buffer whose values you’ve changed; “Apply and Save”
also saves them for future sessions; and “Revert” will undo any sets you’ve done.
</p>
</div>
</div>

<div id="outline-container-org6ed53be">
<h4 id="org6ed53be">Customizing a Face <a id="org4c5ad38"></a></h4>
<div id="text-org6ed53be">
<p>
Customizing a Face is much the same as customizing a Variable; it’s mostly just
a little more colorful.
</p>

<p>
Let’s say you don’t like the look of string literals in your favorite
programming language.  Just pull up a file, position Point on one of the
offending strings, and say   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-face</code></a>﻿.  The prompt will look
something like:
</p>
<pre>Customize face (default ‘font-lock-string-face’):
</pre>

<p>
(The default Face is that of the character where point is.)  Hit return and
you’ll be given a Customize form:
</p>

<div id="orgee80888">
<p><a href="https:./images/customize-face.png" alt="Customizing a Face." title="Customizing a Face." width="100%"><img src="https://blog.veitheller.de/images/customize-face.png" alt="Customizing a Face." title="Customizing a Face." width="100%"/></a>
</p>
<p><span>Figure 34: </span>Customizing a Face.</p>
</div>

<p>
(This Face only defines a “Foreground” color so the other attributes aren’t
shown; click <code>Show All Attributes</code> to change others.)  If you click on the
“Choose” button, the colorful <code>*Colors*</code> Buffer will pop up; browse it, and click
the color you like (you can instead just type a color name<sup><a id="fnr.219" href="#fn.219" role="doc-backlink">219</a></sup> or RGB triplet
<code>#RRGGBB</code> into the form where it says “LightSalmon”<sup><a id="fnr.220" href="#fn.220" role="doc-backlink">220</a></sup>).
</p>

<p>
Note that if you customize a Face this way starting from, say, a <code>python-mode</code>
Buffer, it will affect all Modes and Buffers that use this exact, named, Face.
A given Major Mode may define its own Faces, but <code>font-lock-string-face</code> is a
standard Emacs Face and is used by many, perhaps most, Major Modes for
syntax-highlighting string literals.  The good news is, if you hate that Face in
one Mode you probably hate it everywhere, so a sweeping change is appropriate!  But if
you only hate it for strings in <code>python-mode</code>, you’ll have to get fancier to only
change it there — I won’t go into this here, but such is the power of Emacs
that this is completely doable.
</p>
</div>
</div>
<div id="outline-container-org23a1865">
<h4 id="org23a1865">Customize Buffers Are Non-Modal</h4>
<div id="text-org23a1865">
<p>
Like almost all of Emacs, Customize Buffers are not <i>modal</i>.  That is, when
you fire up a Customize Buffer, you don’t have to commit to finishing the
job <i>right now</i>.  Take your time.  The Buffer keeps track of your state.  You can
set one or more new values without saving them.  This allows you to spend some
time seeing how you like the changes you made.  If you like them, you can just
switch back to this Buffer later and then click “Apply and Save” (bound to
  <code>C-x C-s</code> in Customize Buffers).  If you kill the Buffer after
“Apply” but later (in the same session) reinvoke Customize with the same
Variable or Face, you’ll see that Emacs has remembered your changes, and you can
now save them, revert them, or make further changes.
</p>

<p>
If you’re really casual about your customizations, you might forget to save the
ones you set for future sessions.  I recommend this setting for your <a href="#org2af3730">Init File</a>,
which causes Emacs to check with you when you exit—you’ll be able to pull up a
special Customize Buffer that contains all the values you’ve set but haven’t yet
saved, and you can take care of it.
</p>
<div>
<pre>(add-hook &#39;kill-emacs-query-functions
          &#39;custom-prompt-customize-unsaved-options)
</pre>
</div>
</div>
</div>
<div id="outline-container-org4ae6f20">
<h4 id="org4ae6f20">Long-Term Customization Management</h4>
<div id="text-org4ae6f20">
<p>
There are some convenient commands for the long-term management of your
customizations.    <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-unsaved</code></a>﻿ (also known as
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>customize-customized</code></a>﻿) will pull up a Customize Buffer that
pulls together all the customizations you’ve made in this session but haven’t
yet saved, which makes it easy to review, possibly change, and then save them
all.
</p>

<p>
From an even longer-term perspective,   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-saved</code></a>﻿ will give
you a Customize Buffer containing all the customizations you’ve <i>ever</i> saved,
across all sessions; this is very handy if, after a month or so, you figure out
you’re unhappy with something you’ve changed, and want to undo or tweak it.
</p>

<p>
While we’re thinking in the long term…  GNU Emacs has been around for
38 years already, and I’m confident that it will
be around for many more years to come; there have been 2.5 new <a href="https://www.gnu.org/software/emacs/history.html">Emacs releases</a>
every year, on average.  That means it won’t be long before your OS package manager
presents you with a fresh new Emacs in which some User Options will inevitably
have been changed.    <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-changed</code></a>﻿ (a.k.a
  <code>M-x</code> <code>customize-changed-options</code>) will present a Customize Buffer
containing all these changed variables for you to consider.
</p>

<p>
Finally, if, like me, you’ve changed some User Options directly via Elisp in
your Init File,   <code>M-x</code> <code>customize-rogue</code> will let you see all of these in
a Customize Buffer.
</p>
</div>
</div>
<div id="outline-container-org2df481a">
<h4 id="org2df481a">Where Are Customizations Saved?</h4>
<div id="text-org2df481a">
<p>
The Customize Facility saves your customizations at the end of your <a href="#org2af3730">Init File</a> in
two sections, one for User Options that looks like this:
</p>
<pre id="orga6970c5">(custom-set-variables
 ;; custom-set-variables was added by Custom.
 ;; If you edit it by hand, you could mess it up, so be careful.
 ;; Your init file should contain only one such instance.
 ;; If there is more than one, they won&#39;t work right.
 ...)
</pre>
<p>
and one for Faces:
</p>
<pre id="org454577d">(custom-set-faces
 ;; custom-set-faces was added by Custom.
 ;; If you edit it by hand, you could mess it up, so be careful.
 ;; Your init file should contain only one such instance.
 ;; If there is more than one, they won&#39;t work right.
 ...)
</pre>
<p>
As the warning indicates, you should avoid editing these special sections.  If
you notice something there that you want to fix, do it via   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-saved</code></a>﻿.
</p>

<p>
It’s also possible to tell Emacs to store these Customization sections in a
different file entirely; this is only necessary if you’re doing something fancy
with your Init File, like generating it programmatically for example.
</p>
</div>
</div>
<div id="outline-container-orgd55a240">
<h4 id="orgd55a240">Customizing Key Bindings</h4>
<p>
The one thing the Customize Facility doesn’t support is customizing your own key
bindings; you have to do that in Elisp; see <a href="#orge0608a1"><i>Modifying Key
Bindings</i></a>.
</p>
</div>
</div>
<div id="outline-container-org2e85fab">
<h3 id="org2e85fab">The Package Manager  <a id="orgc96889a"></a></h3>
<div id="text-org2e85fab">
<p>
Emacs organizes most of its 20,692 commands and functions into
474 <i>libraries</i>: groups of functions
related by purpose.  When brand new functionality is added, as opposed to
existing functionality being merely enhanced, the new code is organized as a new
library; the libraries comprise 1,505 files of Emacs Lisp
source code that are shipped together with Emacs.
</p>

<p>
Rather than Emacs just forever acquiring more and more new functions, and
getting bigger and bigger all the time (which certainly still happens to some
extent), this scheme allows major chunks of code that perhaps not everybody
wants to use to be loaded into memory in a lazy fashion.  If you’re not going to
be printing to a Postscript printer today, why bother loading the 226K <code>ps-print</code>
library?  This lazy approach is called <i>autoloading</i>; you’ll see the
word when looking at the documentation for commands and functions via the <a href="#orge57a011">Help
facility</a>, as in:
</p>
<pre>ps-print-buffer is an autoloaded interactive Lisp function in ‘ps-print.el’.
</pre>

<p>
Autoloading also speeds up start-up.
</p>

<p>
The next step up from library is <i>package</i>.  A package is effectively a
library—that is, Elisp source files—together with data files, <a href="#orga6bbd55">Info</a>
documentation, and metadata (in the form of author information, a package
description, a version number, and typically a list of <i>dependencies</i>: other
packages that this package itself uses).
</p>

<p>
You can think of packages as <a href="https://en.wikipedia.org/wiki/Plug-in_(computing)"><i>plug-ins</i></a>: software that adds new functionality to
Emacs.  You can install and uninstall them in real-time, as you use Emacs,
without having to quit and restart.
</p>

<p>
Thanks to packages, third parties can write their own libraries and easily
contribute them to collections of packages (called <i>repositories</i> or <i>repos</i>), and
thanks to the metadata, these repositories are also searchable.  The Free
Software Foundation maintains two repositories of contributed packages (called
GNU- and NonGNU-ELPA<sup><a id="fnr.221" href="#fn.221" role="doc-backlink">221</a></sup>), and there are two major community-maintained
repositories (MELPA and Marmalade), and probably more that I don’t know about.
</p>

<p>
I recommend the GNU and NonGNU repositories, with 583
packages between them, and MELPA with 5,374, but I don’t
recommend Marmalade; it moves at a more aggressive pace and when I used to use
it, packages could get updated several times a day and any one of those updates
might be (briefly) buggy.  But your mileage may vary!
</p>
</div>
<div id="outline-container-org3ba666d">
<h4 id="org3ba666d">Configuration</h4>
<div id="text-org3ba666d">
<p>
Recent versions of Emacs come with the GNU and NonGNU ELPA repositories configured and ready
to use.  This <a href="#org2af3730">Init File</a> snippet adds the MELPA repo as well, and also
assigns repo priorities that put a premium on stability (so, if a package
appears in both the carefully curated GNU repo and in MELPA, we prefer the GNU
version, all else being equal; you can change this if you prefer to live on the
bleeding edge).
</p>

<div>
<pre>(<span>when</span> (&lt; emacs-major-version 24)
  <span>;; </span><span>For important compatibility libraries like cl-lib</span>
  (add-to-list &#39;package-archives &#39;(<span>&#34;gnu&#34;</span> . <span>&#34;https://elpa.gnu.org/packages/&#34;</span>)))
(<span>when</span> (version&lt; emacs-version <span>&#34;26.3&#34;</span>)
  <span>;; </span><span>older emacsen &lt; 26.3 may need this</span>
  (<span>setq</span> gnutls-algorithm-priority <span>&#34;NORMAL:-VERS-TLS1.3&#34;</span>))
(<span>with-eval-after-load</span> &#39;package
  (<span>dolist</span> (arc &#39;((<span>&#34;nongnu&#34;</span> . <span>&#34;https://elpa.nongnu.org/nongnu/&#34;</span>)
                 (<span>&#34;melpa-stable&#34;</span> . <span>&#34;https://stable.melpa.org/packages/&#34;</span>)
                 (<span>&#34;melpa&#34;</span> . <span>&#34;https://melpa.org/packages/&#34;</span>)))
    (add-to-list &#39;package-archives arc t))
  (<span>setq</span> package-archive-priorities
        &#39;((<span>&#34;gnu&#34;</span> . 10) (<span>&#34;nongnu&#34;</span> . 9) (<span>&#34;melpa-stable&#34;</span> . 8) (<span>&#34;melpa&#34;</span> . 7))))
</pre>
</div>
<p>
Note that the MELPA repo comes in two flavors: the stable repo and the unstable
repo.  I give the stable repo a higher priority than the unstable via the
  <code>package-archive-priorities</code> variable.
</p>
</div>
</div>
<div id="outline-container-orgefb9cb9">
<h4 id="orgefb9cb9">About Packages</h4>
<div id="text-orgefb9cb9">
<p>
How do you find out about these exciting additional packages?  I mention several in
this book, and you can find out about many more by following various Emacs
<a href="#orgef60a36">mailing lists, blogs, and web forums</a>.  But mostly you find them by searching and
browsing in Emacs.
</p>

<p>
If you’ve got the name of a package to hand, perhaps <a href="#org673c150">Vertico</a>, you can read it’s
description via     <code>C-h P</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Package-Keywords"><code>describe-package</code></a>﻿).  This will pop up a
<code>*Help*</code> Buffer showing at least the package metadata, like this:
</p>
<pre id="orgb76167e">Package vertico is available.

     Status: Available from gnu -- Install
    Archive: gnu
    Version: 0.20
     Commit: 1bd5438da9c661e2df5e9516f36d9cbc6d100a34
    Summary: VERTical Interactive COmpletion
   Requires: emacs-27.1
   Homepage: https://github.com/minad/vertico
 Maintainer: Daniel Mendler &lt;mail@daniel-mendler.de&gt;
     Author: Daniel Mendler &lt;mail@daniel-mendler.de&gt;
</pre>
<p>
The description may include extra text; the Vertico <code>*Help*</code> Buffer has 700-odd
more lines of documentation.
</p>
</div>
</div>
<div id="outline-container-org5fe1035">
<h4 id="org5fe1035">Searching and Browsing</h4>
<div id="text-org5fe1035">
<p>
A quick way to find packages is via
    <code>C-h p</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Package-Keywords"><code>finder-by-keyword</code></a>﻿), which pops up a Buffer containing
a list of keywords—for example:
</p>
<pre id="orgc9141e6">calendar      calendar and time management tools
languages     specialized modes for editing programming languages
mail          email reading and posting
matching      searching, matching, and sorting
</pre>
<p>
However, this list is limited to built-in packages that come with Emacs, and
those in the built-in repos.
</p>

<p>
Much better is to use   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Package-Menu"><code>list-packages</code></a>﻿, which will download all the
package descriptions from all the repos you have configured (four, in the Init
File snippet above) and add them to the built-in packages.  Here’s a tiny
excerpt from the thousands of entries in my <code>*Packages*</code> Buffer:
</p>
<pre id="org32b4737">Package              Version       Status     Archive    Description

ace-jump-mode      2.0           available  melpa-stable  a quick cursor location minor mode for emacs
afternoon-theme    0.1           available  nongnu        Dark color theme with a deep blue background
vertico            0.20          available  gnu           VERTical Interactive COmpletion
org                9.4.4         built-in                 Export Framework for Org Mode
csv-mode           1.18          installed                Major mode for editing comma/char separated values
</pre>
<p>
The <code>*Packages*</code> Buffer is called the <i>Package Menu</i>.  Hitting <code>RET</code> on any of these
lines pops up the same description that <code>C-h P</code> would present.  You can sort the
entries by clicking on the columns in the <a href="#orgbe2bf62">Header Line</a> (typing
    <code>S</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Several-Buffers"><code>tabulated-list-sort</code></a>﻿) will sort on the column containing
Point), and of course use <a href="#org3ffa52a">Incremental Search</a> or <a href="#org3c07b32">Occur</a>.
</p>

<p>
You can also filter the entries (rather like an in-Buffer Occur) by metadata
keyword with     <code>/ k</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Package-Menu"><code>package-menu-filter-by-keyword</code></a>﻿); <code>/ k
calendar</code> is exactly like selecting <code>calendar</code> from   <code>C-h p</code>, except it
includes all the packages in the repos you configured.
    <code>/ n</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Package-Menu"><code>package-menu-filter-by-name</code></a>﻿) filters by package name,
and     <code>﻿/ ﻿/</code> (<code>package-menu-clear-filter</code>) will restore all the
entries.
</p>

<p>
The <code>*Packages*</code> Buffer is in fact your Emacs <a href="https://en.wikipedia.org/wiki/Package_manager">package manager</a>, and you can do all
your package maintenance in this Buffer; see <a href="#orged63b12"><i>Package Maintenance</i></a> below.
</p>
</div>
</div>
<div id="outline-container-orge2f73e5">
<h4 id="orge2f73e5">Installing Packages</h4>
<div id="text-orge2f73e5">
<p>
You can install a package by name, from any Buffer, with
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Package-Installation"><code>package-install</code></a>﻿: the package will be downloaded if necessary,
compiled, and loaded: it’s now ready to use.  Once installed, the package is
available in future sessions (though some packages require enabling, typically
done in your <a href="#org2af3730">Init File</a>, and configuration, typically done via
<a href="#org27e6769">Customize</a>).
</p>

<p>
Installed packages live in your User Emacs Directory (see
  <code>user-emacs-directory</code>, typically <code>~/.emacs.d/</code>) in a
subdirectory <code>elpa</code>.
</p>

<p>
You can also install packages directly from your Init File, like this:
</p>
<div>
<pre>(<span>unless</span> (package-installed-p &#39;vertico)
  (<span>with-demoted-errors</span> <span>&#34;%s&#34;</span>
    (<span>unless</span> package-archive-contents
      (package-refresh-contents))
    (package-install &#39;vertico)))
(<span>with-demoted-errors</span> <span>&#34;%s&#34;</span> (vertico-mode 1))
</pre>
</div>
<p>
This is a good way to make sure all the packages you like are installed in all
your different Emacsen on your different computers, assuming you synchronize
your Init File; if you only use Emacs on one computer, it’s simpler just to
install your packages manually (actually, that’s all I do even though I use
multiple Emacs installations: I’ll quickly notice if a package is missing in
some other installation as soon as I try to use it).
</p>

<p>
Probably the most common way to install packages is from within the Package
Menu.
</p>
</div>
</div>
<div id="outline-container-org8478170">
<h4 id="org8478170">Package Maintenance <a id="orged63b12"></a></h4>
<div id="text-org8478170">
<p>
Package maintenance consists of installing new packages you want to use,
deleting old ones you no longer use, and updating your packages to the latest
versions.  All of these tasks are typically done in the Package Menu.  Table
<a href="#org452a8a4">30</a> lists the most useful maintenance key bindings;
searching was described above, and navigation is similar to any other <a href="#orgfa25f51">Special
Mode</a> Buffer.
</p>
<table id="org452a8a4">
<caption><span>Table 30:</span> Package Menu Maintenance Commands</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>RET</code>, <code>?</code></td>
<td>describe the package</td>
</tr>

<tr>
<td><code>i</code></td>
<td>mark package for Installation (with an <code>I</code>)</td>
</tr>

<tr>
<td><code>U</code></td>
<td>mark all packages with Upgrades (with a <code>U</code>)</td>
</tr>

<tr>
<td><code>d</code></td>
<td>mark package for Deletion (with a <code>D</code>)</td>
</tr>

<tr>
<td><code>~</code></td>
<td>mark all obsolete packages for deletion (with a <code>D</code>)</td>
</tr>

<tr>
<td><code>u</code></td>
<td>Unmark this package</td>
</tr>

<tr>
<td><code>x</code></td>
<td>eXecute all marks</td>
</tr>

<tr>
<td><code>g</code>, <code>r</code></td>
<td>Refresh buffer from repo</td>
</tr>
</tbody>
</table>

<p>
The Package Menu works similarly to a <a href="#orgcc42ce0">Dired</a> Buffer: you apply various <i>marks</i> to
different packages (marks appear in the leftmost column), unmark any (with <code>u</code>) if
you’ve changed your mind, and, when you’re ready, <i>execute</i> all your marks with
    <code>x</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Package-Menu"><code>package-menu-execute</code></a>﻿).  Any packages you’ve marked for
installation will be downloaded, compiled, and activated, and those marked for
deletion will be deleted (you can always reinstall them again at a future date).
</p>

<p>
You should periodically use the
    <code>U</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Package-Menu"><code>package-menu-mark-upgrades</code></a>﻿) command to check for packages
that have new, upgraded, versions available.  It will compare all the versions
of your installed packages with the latest versions in the repos and mark any
upgradable package with a <code>U</code>.  (This can take a minute or two, depending on the
repo, and so runs in the background.)  When it’s done, use <code>x</code> to upgrade the
packages; after the new versions have been installed, it will offer to clean up
obsolete versions for you.
</p>
</div>
</div>
<div id="outline-container-org8fcf665">
<h4 id="org8fcf665">Should You Write Your Own Packages?</h4>
<div id="text-org8fcf665">
<p>
Creating a proper Emacs package is easier than any other language I’ve
used,<sup><a id="fnr.222" href="#fn.222" role="doc-backlink">222</a></sup> but it still involves a few additional steps (e.g. writing
metadata) compared to just creating your own library (which just requires you to
create a file of Elisp somewhere in your   <code>load-path</code>).
There’s probably no need to go to the extra trouble of packaging if you’re going
to be the only user of your library.
</p>

<p>
But if you want to contribute your library to the Emacs community, then you’ll
need to package it; just follow the instructions in §41 of the Manual,
<a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Packaging"><i>Preparing Lisp code for Distribution</i></a>.
</p>
</div>
</div>
<div id="outline-container-org7d5f3da">
<h4 id="org7d5f3da">Security Issues</h4>
<p>
Every package manager—for a programming language, the app store on your phone,
or an application like a web browser—comes with security concerns, and Emacs is
no different.  See <a href="#org0959336"><i>Security</i></a> for more information.
</p>
</div>
</div>

<div id="outline-container-orgcbc267d">
<h3 id="orgcbc267d">Updates and Bugs <a id="orgd14cc9c"></a></h3>

<div id="outline-container-orgd3d2569">
<h4 id="orgd3d2569">Emacs Updates</h4>
<div id="text-orgd3d2569">
<p>
I’ve mentioned before that there have been an average of 2.5 new <a href="https://www.gnu.org/software/emacs/history.html">Emacs releases</a>
every year in GNU Emacs’s 38-year lifetime.  That
means it won’t be long before your OS package manager presents you with a fresh
new Emacs.
</p>

<p>
Emacs’s backward compatibility is excellent, so it’s unlikely that you’ll
experience any breakage when you fire up your new Emacs: your <a href="#org2af3730">Init File</a> will
almost certainly still work perfectly, your key bindings will still be the same.
At most, some things may look slightly different: changes in default fonts or
colors for example, and you can always fix these if you’re unhappy.  You may see
some <i>deprecation warnings</i> if you’re using functions that are being phased out;
the Emacs developers tend to give a <i>lot</i> of lead time for deprecated functions,
so there’s no need to panic.
</p>

<p>
However, it <i>is</i> likely that there will be new features that you will want to know
about.      <code>C-h C-n</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Help-Files"><code>view-emacs-news</code></a>﻿) will display the <i>change
log</i>, a very extensive list of all the user-visible changes in the version of
Emacs that you’re running: that is, everything that changed from the way it was
in the previous version.  If only you could get this kind of information for all
the web services you depend on!  If you invoke this command with a prefix
argument, <code>C-u C-h C-n</code>, you can request the change log for any previous version
of Emacs, all the way back to version 1.1 (the text of which is very quaint!).
</p>
</div>
</div>
<div id="outline-container-org285bca2">
<h4 id="org285bca2">Emacs Bugs <a id="org0eaad53"></a></h4>
<div id="text-org285bca2">
<p>
What, does Emacs have bugs?  Since all software does, I’m afraid so.  One of the
unique things about a Lisp Machine is that you can actually fix many bugs
yourself, live, while your Emacs is running, without recompiling or even
restarting.
</p>

<p>
Assuming you’re a programmer that is.  If you’re not, and you find a bug, you
should report it.  But first, you should try to make sure that this really is an
Emacs bug, and not a problem stemming from some settings in your own
<a href="#org27e6769">Customizations</a> or <a href="#org2af3730">Init File</a>.   This means firing up a fresh Emacs with the <code>-Q</code>
option, which avoids loading your init file and even some of the system-wide
initialization, thus giving you a really pristine Emacs:
</p>
<pre>emacs -Q
</pre>

<p>
Now try to replicate your bug.  You may need to manually load a package that
you <code>require</code> in your Init File if you think it’s implicated in the bug; you can
typically use   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Lisp-Libraries"><code>load-library</code></a>﻿ to load it.  The point is to have as
few non-standard customizations and loads as possible.
</p>

<p>
The Manual contains an <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Bugs">excellent chapter</a>
on reporting bugs, and you should really read it before reporting one: after
all, you’re having a problem with free software that you didn’t have to pay for,
and asking people to help you with your problem for free.  You can at least try
to make it as easy for them as possible.
</p>

<p>
If you can replicate your bug in this <code>-Q</code> environment, you can report it.  Just
say   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Checklist"><code>report-emacs-bug</code></a>﻿ and an email composition Buffer will pop
up, with some instructions in another window.  The email will be populated with
up to several hundred lines of data about the current state of your Emacs:
exactly which version you’re running, how your Emacs was compiled, which
packages you currently have loaded—all the kinds of information needed to help
figure out your bug.  (You can delete any personal info that you might be
uncomfortable sharing.)  You need to add a description of the bug, ideally
including a step-by-step recipe showing how to make the bug happen.  (“Put point
at the beginning of the second word of a line with at least five words in it,
and now…”)
</p>

<p>
If you’ve set up your Emacs to <a href="#org5e201bd">send mail</a>, you can just use
    <code>C-c C-c</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/message/Sending"><code>message-send-and-exit</code></a>﻿) and your bug report will be
emailed to the Emacs maintainers!  (If you can’t send mail from within Emacs,
you can cut-and-paste the contents of the message into the mailer you use, as
explained in the help window.)  There’s no guarantee that the Emacs maintainers
can fix your bug, of course: they may not even be able to reproduce it, if it
has something to do with your computer or operating system or the <a href="http://www.catb.org/jargon/html/P/phase-of-the-moon.html">phase of the
moon</a>.
</p>
</div>
<div id="outline-container-orgf6e610b">
<h5 id="orgf6e610b">Not Emacs’s Fault!</h5>
<div id="text-orgf6e610b">
<p>
If you <i>can’t</i> replicate your bug in this <code>-Q</code> environment, then it’s probably not a
bug in Emacs but in your Init File.  You’ll have to fix this on your own.
Generally the way you do this is to <a href="#orga31f0ee">comment out</a> all of your Init File except for
the first line (really, the first complete s-expression, which might span
several lines), save it, and fire up a fresh Emacs normally.  Now see if your
bug is fixed.  If it is, you know the problem is <i>not</i> in that first line, but
rather in the part of your Init File that you commented out!
</p>

<p>
But where?  Well, now uncomment (i.e. restore) the <i>next</i> complete s-expression and
repeat the process.  Eventually you’ll have restored the line that contains the
bug and you’ll know because suddenly the bug occurs again.  Now just fix the
offending line and uncomment all the rest of your Init File, and you’re done!
</p>

<p>
This process can be really tedious if you have a large Init File<sup><a id="fnr.223" href="#fn.223" role="doc-backlink">223</a></sup>.  There
are <i>much</i> more efficient ways to do this: really, any programmer would use <a href="https://en.wikipedia.org/wiki/Binary_search_algorithm">binary
search</a> to find the bug, and there are tools in the <a href="#orgc96889a">Package Manager</a> to do
this automatically (see <a href="https://github.com/Malabarba/elisp-bug-hunter"><code>bug-hunter</code></a>).
</p>
</div>
</div>
<div id="outline-container-org9c28ae1">
<h5 id="org9c28ae1">Helping Squash Bugs</h5>
<p>
If you’re a programmer, you can volunteer to help fix Emacs bugs; all reported
bugs are listed in the <a href="https://debbugs.gnu.org/cgi/pkgreport.cgi?package=emacs;max-bugs=100;base-order=1;bug-rev=1">Emacs Bug Tracker</a>.  You can pick one out and see if you
can fix it; see <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Contributing">“Contributing”</a> in the <i>Emacs</i> manual for more information.  There’s an
excellent interface to the bug tracker in the Package Manager called <a href="https://elpa.gnu.org/packages/debbugs.html"><code>debbugs</code></a>
that makes this even easier.
</p>
</div>
</div>
</div>
<div id="outline-container-orgcb54293">
<h3 id="orgcb54293">Exiting Emacs <a id="orge8c7343"></a></h3>
<div id="text-orgcb54293">
<p>
All good things must come to an end, meaning you will occasionally have to exit
your Emacs.  As you know, the usual command to use is
    <code>C-x C-c</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Exiting"><code>save-buffers-kill-terminal</code></a>﻿).  Note that if you are
in an <code>emacsclient</code> instance, <code>C-x C-c</code> only terminates that client, leaving the
server running.  See <a href="#org22671bb"><i>Client / Server</i></a> for details on how to terminate the Server.
</p>

<p>
If you have any modified Buffers (unsaved files) when you exit, Emacs will
ask if you want to save these files before exiting with a prompt like:
</p>
<pre>Save file emacs-tutorial/emacs-tutorial.org? (y, n, !, ., q, C-r, C-f, d or C-h)
</pre>

<p>
This prompt is really from the function   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Save-Commands"><code>save-some-buffers</code></a>﻿
which <code>C-x C-c</code> calls.  Your options for each file are summarized in Table <a href="#orgaef5f49">31</a>.
</p>
<table id="orgaef5f49">
<caption><span>Table 31:</span> <code>C-x C-c</code> Modified File Prompt</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SPC</code>, <code>y</code></td>
<td>save the prompted buffer</td>
</tr>

<tr>
<td><code>!</code></td>
<td>save all remaining unsaved buffers</td>
</tr>

<tr>
<td><code>C-f</code></td>
<td>switch to this File and stop exiting</td>
</tr>

<tr>
<td><code>C-r</code></td>
<td>peek at this buffer, Read-only</td>
</tr>

<tr>
<td><code>d</code></td>
<td>view a Diff of this buffer</td>
</tr>

<tr>
<td><code>C-g</code></td>
<td>cancel the whole exit command</td>
</tr>

<tr>
<td><code>.</code></td>
<td>save just the current buffer and exit</td>
</tr>

<tr>
<td><code>DEL</code>, <code>n</code></td>
<td>don’t save the prompted buffer</td>
</tr>

<tr>
<td><code>RET</code>, <code>q</code></td>
<td>don’t save this or any remaining buffers</td>
</tr>
</tbody>
</table>
<p>
The <code>C-r</code> and <code>d</code> responses allow you to peek at the file in question to figure out
whether or not you want to save or abandon your modifications.
</p>

<p>
If, after this process, you still have modified Buffers because you answered <code>n</code>
or <code>q</code> to one of the prompts, Emacs will ask:
</p>
<pre>Modified buffers exist; exit anyway? (yes or no)
</pre>

<p>
(Emacs really wants to make sure you don’t lose your data!)
</p>

<p>
Additionally, if you have any running subprocesses, you’ll get a another
cautious prompt:
</p>
<pre>Active processes exist; kill them and exit anyway? (yes or no)
</pre>

<p>
Along with this you’ll see a <a href="#org242e53c"><code>*Process List*</code> Buffer</a> showing all your
subprocesses.  The processes in question might be <a href="">shells or terminals</a>, or
long-running commands you’ve fired up with <a href="#orgf9812fe"><code>M-&amp;</code></a>.  Remember that if you kill
Emacs, which is the parent of these subprocesses, the subprocesses will
probably themselves die.<sup><a id="fnr.224" href="#fn.224" role="doc-backlink">224</a></sup>
</p>

<p>
It’s easy to type <code>C-x C-c</code> by accident, and who wants to terminate their
long-running Server full of dozens of files?  There’s no problem if you have any
modified file-visiting Buffers or subprocesses, thanks to the above prompts, but
I personally never want Emacs to exit unless I’m about to reboot.  So I have
this snippet in my <a href="#org2af3730">Init File</a>:
</p>
<div>
<pre>(<span>setq</span> confirm-kill-emacs &#39;yes-or-no-p)        <span>; </span><span>exiting emacs is silly</span>
</pre>
</div>
<p>
which causes Emacs to ask me if I really mean it.
</p>

<p>
I highly recommend exiting Emacs explicitly when you terminate your login
session (this of course includes rebooting or powering-off your computer).  This
assures that Emacs has a chance to save your files, and arrange for <i>persistence</i>
if you’re using the Desktop (see below).  There’s no need to exit Emacs when you
sleep your computer, though if you’re the cautious sort<sup><a id="fnr.225" href="#fn.225" role="doc-backlink">225</a></sup>  you might do
    <code>C-x s</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Save-Commands"><code>save-some-buffers</code></a>﻿) before sleeping (I do).
</p>
</div>
<div id="outline-container-org2e0b3b6">
<h4 id="org2e0b3b6">The Desktop: Persisting Your Buffers <a id="orgf2e3965"></a></h4>
<div id="text-org2e0b3b6">
<p>
You can easily have most of your file-visiting Buffers restored each time you
start up a fresh Emacs by turning on   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Saving-Emacs-Sessions"><code>desktop-save-mode</code></a>﻿ and
I recommend this for your <a href="#org2af3730">Init File</a>:
</p>
<div>
<pre>(desktop-save-mode 1)   <span>; </span><span>restore files from previous session</span>
</pre>
</div>
<p>
Not only are your file Buffers restored: so is your location (Point) in each Buffer,
its Major Mode, and even your Frames<sup><a id="fnr.226" href="#fn.226" role="doc-backlink">226</a></sup>, their Window configurations, and
all your Frame parameters (like fonts and font sizes).
</p>

<p>
<code>desktop-save-mode</code> also saves the Tabs in your <a href="#orgc6b43c3">Tab Bar</a>, the contents of all your
<a href="#orgcfc576b">Registers</a>, your <a href="#orgc4ddf2e">EWW</a> web Buffers, and probably more (Emacs packages can readily
hook themselves into <code>desktop-save-mode</code>).
</p>

<p>
By default, <a href="#org2bfdd17">remote files</a> loaded from other systems are excluded from being
restored (in order to speed up restoration; also, the network or certain remote
hosts might be unavailable when you restore).  You can change this by
<a href="#org27e6769">Customizing</a>   <code>desktop-files-not-to-save</code>.
</p>

<p>
You can trash your saved Desktop configuration with
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Saving-Emacs-Sessions"><code>desktop-clear</code></a>﻿—you might want to do this if it’s been such a long
time since you last ran Emacs<sup><a id="fnr.227" href="#fn.227" role="doc-backlink">227</a></sup> that you’re no longer interested in any of
the files you were last editing and they’re just clutter now.  <code>desktop-clear</code>
zaps the saved Desktop config and also kills all the Buffers that were
initialized from that config.
</p>

<p>
<code>desktop-save-mode</code> definitely slows down your Emacs startup speed.  Since I use
the Emacs Server, and only fire up Emacs at most once every few weeks, I don’t
mind this at all.  But you can Customize
  <code>desktop-restore-eager</code> in order to make the restoration of
your Buffers happen <i>lazily</i>—that is, delayed in the background instead of
all at once—which can give you a responsive fresh Emacs immediately.
</p>

<p>
By default, there’s only one saved Desktop configuration, and you generally
don’t want another Emacs to use it: that will just cause conflicts!  So the
Desktop config is <i>locked</i> by the first Emacs that restores it, and any
additional, newly fired-up Emacs will ask you if you really want to steal the
lock:
</p>
<pre id="org51bf6f3">Warning: desktop file appears to be in use by process with PID 1004.
Using it may cause conflicts if that process still runs.
Use desktop file anyway? (y or n)
</pre>
<p>
The only good reason to say yes is if the locking Emacs crashed, and was unable
to give up its lock, and isn’t actually running anymore<sup><a id="fnr.228" href="#fn.228" role="doc-backlink">228</a></sup>.  Note that there’s no
desktop conflict when using <a href="#org22671bb"><code>emacsclient</code></a>, since it <i>connects to</i> the running
Emacs and its desktop.
</p>

<p>
If you want to fire up a nonce Emacs, perhaps just to test a change to your Init
File<sup><a id="fnr.229" href="#fn.229" role="doc-backlink">229</a></sup>, and don’t intend to steal an existing desktop, just add the
<code>--no-desktop</code> option; see <a href="#org0a69d0d"><i>Starting Emacs!</i></a>.
</p>
</div>
</div>
</div>
<div id="outline-container-org729069b">
<h3 id="org729069b">Starting Emacs! <a id="org0a69d0d"></a></h3>
<div id="text-org729069b">
<p>
Because I advocate using a long-running Emacs in <a href="#org22671bb">Client / Server</a> mode, I haven’t
talked much about the details of starting up a fresh new Emacs, which weirdly
makes this chapter the last thing in Part I of the book.
</p>

<p>
Emacs has a number of command-line options to vary the details of how it starts
up.  Many of the options are very exotic and only useful to people doing really
fancy stuff—for these, you can read the man page or see
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Emacs-Invocation">“Emacs Invocation”</a> in the <i>Emacs</i> manual.
</p>

<p>
The rest of the options can be divided into two categories: those for scripting
Emacs, and those for occasional everyday use.  Most any option in that latter
category that you find yourself using all the time can be better done in your
<a href="#org2af3730">Init File</a>.  Of course, my definition of these two categories is just rhetorical:
there’s no real division in use.
</p>
</div>
<div id="outline-container-orge196e6a">
<h4 id="orge196e6a">File Arguments</h4>
<div id="text-orge196e6a">
<p>
As usual for Unix programs, all command-line arguments that don’t start with a
hyphen are taken as the names of files to visit.  So this command:
</p>
<pre>emacs file1 file2 file3
</pre>

<p>
has the same effect as firing up Emacs with no arguments and then using
    <code>C-x C-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-file</code></a>﻿) once for each file.
</p>

<p>
There’s one exception: an argument of the form <code>+123</code> positions Point at line 123
of the first file named on the command line.  The full form of this option is
<code>+</code>​<i>LN</i>​<code>:</code>​<i>CN</i> where <i>LN</i> is a line number and the optional <i>CN</i> is a column number.
</p>

<p>
This old-fashioned option is used by certain programs to fire up Emacs at the
precise line where an error has occurred.  <code>vi(1)</code> supports the same option, for
example.  In Emacs, we usually turn this inside-out by calling
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Compilation"><code>compile</code></a>﻿ from inside our running Emacs, and using
    <code>C-x `</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Compilation-Mode"><code>next-error</code></a>﻿) to load the files and jump to the error
location; see <a href="#org76cafbe"><i>Compiling Code</i></a>.  The <code>+</code> option might still occasionally be useful
to an Emacs user via <a href="#org22671bb"><code>emacsclient(1)</code></a>.
</p>
</div>
</div>
<div id="outline-container-org72bdab7">
<h4 id="org72bdab7">Occasional Options</h4>
<div id="text-org72bdab7">
<table id="orgfaf633f">
<caption><span>Table 32:</span> Occasional Command-Line Options</caption>

<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Option</th>
<th scope="col">​= Long Option</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-d DISPLAY</code></td>
<td><code>--display=DISPLAY</code></td>
<td>open Emacs on named X display</td>
</tr>

<tr>
<td><code>-nw</code></td>
<td><code>--no-window-system</code></td>
<td>open Emacs in this terminal</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>-daemon</code></td>
<td><code>--daemon</code></td>
<td>start the Emacs server</td>
</tr>

<tr>
<td> </td>
<td><code>--version</code></td>
<td>display version and exit</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>-q</code></td>
<td><code>--no-init-file</code></td>
<td>don’t load user’s init file</td>
</tr>

<tr>
<td> </td>
<td><code>--no-desktop</code></td>
<td>don’t load saved desktop</td>
</tr>

<tr>
<td> </td>
<td><code>--debug-init</code></td>
<td>debug your init file</td>
</tr>

<tr>
<td><code>-Q</code></td>
<td><code>--quick</code></td>
<td>don’t do <i>any</i> initialization</td>
</tr>
</tbody>
</table>
<p>
Table <a href="#orgfaf633f">32</a> lists what I think are the most useful occasional
options.
</p>

<p>
 <code>-d</code> and <code>-nw</code> let you choose between running this Emacs in Graphical mode versus
in a terminal.  You’ll <a href="#org6444e1f">recall</a> that I’m an advocate of using Graphical mode.  If
you’re running Emacs in a graphical environment (e.g., a Unix system running X
windows, or under MS Windows or Mac OS), Emacs will default to Graphical mode;
<code>-d</code> is mostly for X windows experts doing fancy things.  If you’re on a system
that’s not running in Graphical mode (like some big server machines, or in the
console of your Unix desktop), you’ll get Terminal mode by default and won’t
need <code>-nw</code>.  <code>-nw</code> is mostly needed for those who are running a Graphical system but
want to use Emacs in external terminals as if it were <code>vim(1)</code>.
</p>

<p>
The <code>-daemon</code> option is one of two ways of starting up the Emacs Server; see
<a href="#org22671bb"><i>Client / Server</i></a> for details.
</p>

<p>
The final group of options are mostly used for testing and debugging your Emacs
configuration.  <code>-q</code> runs an Emacs without loading your Init File or
<a href="#org27e6769">Customizations</a>.  It can be handy for a quick check of whether or not some recent
Init File tweak you made has broken something: if the suspected breakage doesn’t
occur with <code>-q</code>, the problem has to be in your Init File.  Since <a href="#orgf2e3965">Desktop Save Mode</a>
has to be enabled in your Init File, <code>-q</code> implies <code>--no-desktop</code>, which tells Emacs not to
load any saved Desktop; see <a href="#orgf2e3965"><i>The Desktop</i></a>.
</p>

<p>
A certain happy category of bug that can occur in your Init File causes an
explicit error each time you start Emacs.  I call this a “happy” bug because
it’s the easiest kind of Init File bug to detect and fix!  It can be hard to tell from the
startup error where it is in your Init File, so just restart Emacs with
<code>--debug-init</code> and Emacs will jump into the <a href="#org671ca2f">Elisp debugger</a> when the error occurs,
and you’ll be able to tell exactly where the buggy code is.<sup><a id="fnr.230" href="#fn.230" role="doc-backlink">230</a></sup>
</p>

<p>
<code>-Q</code> is a more extreme version of <code>-q</code> that also doesn’t load any system-wide init
file or Elisp<sup><a id="fnr.231" href="#fn.231" role="doc-backlink">231</a></sup>, nor any X window system resources.  This is the option to
use if you think you’ve found a bug in Emacs: replicating the suspected bug
under <code>-Q</code> makes it very unlikely to be your fault; see <a href="#org0eaad53"><i>Updates and Bugs</i></a>.
</p>
</div>
</div>
<div id="outline-container-orgf22a128">
<h4 id="orgf22a128">Scripting Options</h4>
<div id="text-orgf22a128">
<p>
What does it mean to “script Emacs” when the whole idea of the Lisp Machine is
to do everything inside Emacs with a real programming language, Emacs Lisp?
</p>

<p>
Well, sometimes we have to exist briefly in the world outside of Emacs, and use
Emacs as if it were a tool like <a href="https://en.wikipedia.org/wiki/AWK">AWK</a> or <a href="https://en.wikipedia.org/wiki/Sed"><code>sed(1)</code></a>; after all, Elisp is a much more
powerful programming language than either of those.  Additionally, you may want
to automate some of your Emacs tasks via a build automation tool like <a href="https://en.wikipedia.org/wiki/Make_(software)"><code>make(1)</code></a>; I
do that to automate the building of this book; see <a href="#orge9d3a1c">the Colophon</a>.  Table
<a href="#org86c0590">33</a> lists some of the options useful for this sort of thing.
These options take effect in the order given, which can be significant.
</p>
<table id="org86c0590">
<caption><span>Table 33:</span> Command-Line Options for Scripting</caption>

<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Option</th>
<th scope="col">Long Option</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-batch</code></td>
<td><code>--batch</code></td>
<td>run in batch mode</td>
</tr>

<tr>
<td><code>-l FILE</code></td>
<td><code>--load=FILE</code></td>
<td>Load an elisp file</td>
</tr>

<tr>
<td><code>-L DIR</code></td>
<td><code>--directory=DIR</code></td>
<td>add <code>DIR</code> to <code>load-path</code></td>
</tr>

<tr>
<td><code>-f FUNC</code></td>
<td><code>--funcall=FUNC</code></td>
<td>call function named <code>FUNC</code></td>
</tr>

<tr>
<td> </td>
<td><code>--eval=EXPR</code></td>
<td>evaluate elisp expression</td>
</tr>

<tr>
<td> </td>
<td><code>--script FILE</code></td>
<td>run Elisp from FILE in batch mode</td>
</tr>

<tr>
<td> </td>
<td><code>--kill</code></td>
<td>exit Emacs unconditionally</td>
</tr>
</tbody>
</table>
<p>
<code>-batch</code> puts Emacs into <i>batch mode</i>, which means it won’t fire up any sort of
interactive display: it will just process the following command line options,
and then exit.  It implies <code>-q</code> and is usually used with some combination of <code>-l</code>,
<code>-f</code>, or <code>--eval</code>.
</p>

<p>
The <code>--eval</code> option evaluates an arbitrary Elisp expression.  This example is a
homemade variation on the <code>--version</code> option:
</p>
<pre>emacs -batch --eval &#39;(message &#34;%s&#34; (emacs-version))&#39;
</pre>


<p>
Most Emacs functions aren’t designed for command-line use, though: they use
Buffers rather than simply printing text to the standard output.  But it’s easy
to write Elisp functions suitable for the command-line: you might collect some
in a file that you can load with <code>-l</code> and then invoke a function in it with <code>-f</code>.
But if you’re going this far, you might as well write a proper Elisp script, for
which the <code>--script</code> option is handy.  Here’s a dumb Emacs script that counts
words in the files named on the command line:
</p>
<div>
<pre><span>#</span><span>!/usr/bin/</span><span>emacs</span><span> --script</span>
(dolist (file argv)
  (with-temp-buffer
    (insert-file-contents file)
    (message <span>&#34;%s: %s words&#34;</span> file (count-words (point-min) (point-max)))))
</pre>
</div>
</div>
</div>
</div>
</div><div id="outline-container-orgdaf0c8d">
<h2 id="orgdaf0c8d"><b>ADDITIONAL TOPICS</b></h2>

<div id="outline-container-orgf90c84a">
<h3 id="orgf90c84a">Completion at Point <a id="org7206b03"></a></h3>
<p>
Up to now, when we’ve talked about completion we’ve been talking about it in the
Minibuffer.  But we can also do completion in any buffer, at Point.  This might
be familiar from the way IDEs complete keywords and symbols for various
programming languages, and Emacs <a href="#org5b21ef0">Major Modes</a> for programming languages do this
too; see <a href="#orgb851b48"><i>Pop-up Menu Completion</i></a>.  But Emacs also does this for ordinary text in
any buffer, and it’s an amazing feature, called <i>dynamic abbreviation expansion</i>
or <i>Dabbrev</i> for short<sup><a id="fnr.232" href="#fn.232" role="doc-backlink">232</a></sup>.
</p>

<div id="outline-container-org41ec069">
<h4 id="org41ec069"><a id="org844fd88"></a> Dynamic Abbrevs</h4>
<div id="text-org41ec069">
<p>
As you begin typing a longish word that you know or just suspect you’ve typed
before, hit     <code>M-/</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Dynamic-Abbrevs"><code>dabbrev-expand</code></a>﻿) after the first few
characters and the word will complete (or expand) in place.  For example, I just
typed “char” and <code>M-/</code> expanded it to <i>characters</i> — exactly what I wanted.
</p>

<p>
If that <i>wasn’t</i> the word I wanted, I would just have immediately hit <code>M-/</code> again,
and it would have changed the completion to another word starting with “char”:
in my case, one of <i>character</i>, <i>charts</i>, or <i>charlie</i>.  Why?  Because those are all
the words that start with “char” that I’ve used in this book (up to this point).
More <code>M-/</code>’s would cycle through all the words that match; I just stop when I get
to the one I want.
</p>

<p>
The completion candidates are selected from the preceding words in the buffer,
sorted so that the first one offered is the <i>nearest preceding matching</i> word; the
next would be the second-nearest, and so on.
</p>

<p>
If I keep cycling after rejecting the match that’s closest to the beginning of
the buffer, or if there’s no matching preceding word at all, then candidates
will be offered that are <i>ahead</i> of me in the buffer (again in the order of
closest to farthest).
</p>

<p>
Suppose my buffer contains just this one line; I’ve just typed “com” and Point
is indicated by <code>|</code>:
</p>
<pre id="orgf27071e">completely completeness completer com| completes completest completing completion
</pre>
<p>
What is the sequence of completions offered up by a repeated series of <code>M-/</code>’s?
</p>

<p>
The first completion offered is <i>completer</i>, followed by <i>completeness</i> and
<i>completely</i>.  We’ve hit the beginning of the buffer, so the next <code>M-/</code> would offer
<i>completes</i> followed by <i>completest</i>, <i>completing</i>, and <i>completion</i>.
</p>

<p>
What happens if, having rejected the last match in the buffer, we hit yet
another <code>M-/</code>?  Aha!  In that case, <code>M-/</code> proceeds to look for matches in
<i>other buffers</i>!  This almost makes it seem like <code>M-/</code> can read your mind, and the
effect and usefulness of this increases the more buffers you have.
</p>

<p>
By default, <code>M-/</code> will only examine other buffers that have the same Major Mode,
so that if you’re editing poetry in <code>latex-mode</code>, say, it won’t offer you the
names of variables and functions from your buffers full of Elisp code.  But if
these same-mode buffers don’t have <i>any</i> candidates, it will then consider all
types of buffers.
</p>

<p>
You can fine-tune this to make it behave exactly the way you like via
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-group</code></a>﻿ <code>RET dabbrev</code>; see <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Dynamic">“Dynamic”</a> in the <i>Emacs</i> manual.
</p>

<p>
The tricky part of Dabbrevs is, how many characters do you type before hitting
<code>M-/</code>?  If you type too few, you could get so many candidates that it might take you
ten times as long to cycle to the one you want as it would to just retype the
word.  But even one character could be okay if the word you want is long and you just
typed it a line or so ago.  If you don’t seem to be getting what you want after
a few tries, just undo and either type the whole thing, or try <a href="#org266522b"><code>C-M-/</code></a>.
</p>

<p>
Once you get used to <code>M-/</code>, you’ll develop a sort of automatic ability to know
when to use it, and it will both dramatically speed up your typing, and reduce
the number of typos you enter.
</p>

<p>
You can also complete a sequence of words.  Suppose you’re writing about your
favorite Czech composer and need to type his name again.  You type “Le” and then
<code>M-/</code> completes “Leoš”; now immediately type <code>SPC M-/</code> and his last name, “Janáček”
appears (this is assuming that you have his full name, “Leoš Janáček”, somewhere
in your Emacs).  You can keep typing <code>SPC M-/</code> to add more words: in general, you
can complete an <i>n</i>-word sequence, possibly containing some very long words, in
about \(n \times 2\) keystrokes via a long sequence of <code>SPC M-/</code>’s, though frankly I’ve
probably never used this technique for more than two or three words.
</p>
</div>

<div id="outline-container-orgaf2345b">
<h5 id="orgaf2345b"><a id="org266522b"></a> Dabbrevs via the Minibuffer</h5>
<div id="text-orgaf2345b">
<p>
There’s another command to do completion at Point sort of indirectly, via your
preferred completion framework.  (I would say this is not worth using unless
you’ve set up an INF like <a href="#org75fb6a2">Vertico or Ivy</a>, or are happy using the mouse.)
</p>

<p>
Type a partial word but this time invoke
    <code>C-M-/</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Dynamic-Abbrevs"><code>dabbrev-completion</code></a>﻿).  Instead of instant completion at
Point with the first candidate, and the need to cycle through them, you’ll be
presented with a complete list of candidates using whatever interface your INF
uses (Ivy will use a <a href="#orgb851b48">pop-up menu</a>, Selectrum the Minibuffer).
</p>

<p>
I don’t use this as often as <code>M-/</code> but it’s sometimes handy.
</p>
</div>
</div>
<div id="outline-container-orgffad858">
<h5 id="orgffad858">Hippie Expand</h5>
<div id="text-orgffad858">
<p>
If Dabbrev isn’t fancy enough for you, you can use <i>Hippie Expand</i>, which is like
Dabbrev on steroids.  Hippie works exactly like
    <code>M-/</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Dynamic-Abbrevs"><code>dabbrev-expand</code></a>﻿), except it chooses from a much wider range of sources of
candidates.  One of the sources is simply <code>dabbrev-expand</code> itself, but it can also
expand filenames, entire lines, parenthesized lists, kills from the kill ring,
etc.  You can customize which sources you want to use and in what order.  Most people that use Hippie just
bind it to <code>M-/</code> in place of <code>dabbrev-expand</code>, but you can use a different binding
in order to have access to both.  (Hippie can’t expand sequences of words the
way Dabbrev can.)
</p>

<p>
The only problem with Hippie Expand is that there are so many candidates it can
offer, what you get can seem like a crap shoot.  Really, I think it would be
more useful if it offered completions the way <code>dabbrev-completion</code> does
(implementing that would be a fun project).
</p>

<p>
But it’s quite amazing, and I bind it to <code>M-/</code> to replace <code>dabbrev-expand</code>; try it
and see what you think!
</p>
</div>
</div>
</div>
<div id="outline-container-org0a7b773">
<h4 id="org0a7b773"><a id="orgb851b48"></a> Pop-up Menu Completion</h4>
<div id="text-org0a7b773">
<p>
This form of completion-at-Point is primarily for completing <i>symbols</i>—e.g., the
names of variables, functions, and the like—in programming language modes,
though it’s more general than that.  There are two main frameworks to choose
from, and both need to be installed from the <a href="#orgc96889a">Package Manager</a>: <a href="http://company-mode.github.io/">Company</a> and <a href="https://github.com/minad/corfu">Corfu</a>.<sup><a id="fnr.233" href="#fn.233" role="doc-backlink">233</a></sup>
Candidates for completion can come from many sources, some built-in and most
from optional back-ends, so that besides symbols for a programming language, you
can complete email addresses, dictionary words, and Unicode math symbols and
emojis by name, among others.
</p>

<p>
Corfu is modern, clean, and “standards compliant”, meaning it uses the official
Emacs APIs to get its completion candidates, whereas Company instead uses its
own backends—but then, there are 74 of them in the
Package Manager.  One disadvantage of Corfu is that it only works in a
graphical-mode Emacs.
</p>

<p>
Both work roughly the same way: as you type the name of a symbol, a menu of
completions pops up at Point, either automatically or upon a keystoke, as you
prefer; you scroll to the completion you want (with <code>TAB</code> or some other key), and
hit <code>RET</code> to accept and expand it at Point.  For some symbols, a one-line
description will appear in the Minibuffer.  You can see from Figure
<a href="#org47392a0">35</a> and Figure <a href="#org4521444">36</a> that they look similar: here I’m in Emacs
Lisp Mode and have started typing the name of function: at the point at which
I’d typed “with-s” and paused for a fraction of a second, I get the menu.
</p>

<div id="org47392a0">
<p><a href="https:./images/company-mode.png" alt="=company-mode= in an Emacs Lisp buffer" title="=company-mode= in an Emacs Lisp buffer" width="100%"><img src="https://blog.veitheller.de/images/company-mode.png" alt="=company-mode= in an Emacs Lisp buffer" title="=company-mode= in an Emacs Lisp buffer" width="100%"/></a>
</p>
<p><span>Figure 35: </span><code>company-mode</code> in an Emacs Lisp buffer</p>
</div>


<div id="org4521444">
<p><a href="https:./images/corfu.png" alt="=corfu-mode= in an Emacs Lisp buffer" title="=corfu-mode= in an Emacs Lisp buffer" width="100%"><img src="https://blog.veitheller.de/images/corfu.png" alt="=corfu-mode= in an Emacs Lisp buffer" title="=corfu-mode= in an Emacs Lisp buffer" width="100%"/></a>
</p>
<p><span>Figure 36: </span><code>corfu-mode</code> in an Emacs Lisp buffer</p>
</div>

<p>
In my opinion, popup-menu completion doesn’t really do too much for you that
Minibuffer completion doesn’t—except for automatically insinuating itself as
you type, if you choose that mode of activation—assuming you’re using a good
<a href="#org75fb6a2">Incremental Narrowing Framework</a>, but your mileage may vary.  Without popup
completion, you can just invoke     <code>M-TAB</code> (<code>complete-symbol</code>)
(which is the same as <code>C-M-i</code>) and complete the symbol in the Minibuffer; see
Figure <a href="#org16a722c">37</a>.
</p>

<div id="org16a722c">
<p><a href="https:./images/complete-symbol.png" alt="=complete-symbol= in an Emacs Lisp buffer" title="=complete-symbol= in an Emacs Lisp buffer" width="100%"><img src="https://blog.veitheller.de/images/complete-symbol.png" alt="=complete-symbol= in an Emacs Lisp buffer" title="=complete-symbol= in an Emacs Lisp buffer" width="100%"/></a>
</p>
<p><span>Figure 37: </span><code>complete-symbol</code> in an Emacs Lisp buffer</p>
</div>

<p>
Since you get to use all the narrowing features of your preferred Minibuffer
completion framework, I prefer plain old <code>complete-symbol</code> to popup completion.
</p>

<p>
If you want to try popup completion, I guess I would recommend Company; just add
this snippet to your <a href="#org2af3730">Init File</a>:
</p>
<div>
<pre>(<span>unless</span> (package-installed-p &#39;company)
  (<span>with-demoted-errors</span> <span>&#34;%s&#34;</span>
    (<span>unless</span> package-archive-contents
      (package-refresh-contents))
    (package-install &#39;company)))
(add-hook &#39;prog-mode-hook (<span>lambda</span> () (<span>with-demoted-errors</span> <span>&#34;%s&#34;</span> (company-mode))))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgba16ed4">
<h3 id="orgba16ed4">Registers <a id="orgcfc576b"></a></h3>
<div id="text-orgba16ed4">
<p>
When you’re working in Emacs, you might save a lengthy chunk of text in the <a href="#orgee263e4">Kill
Ring</a> so that you can yank it back in several different places with a simple
    <code>C-y</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Yanking"><code>yank</code></a>﻿).  The Kill Ring can hold many distinct chunks, but
they’re all <i>anonymous</i> and get pushed deeper into the Ring with each new thing
you kill (and if you kill enough text, the oldest items will disappear from the
Kill Ring).  It would be nice to be able to give certain chunks of text names so
that you can easily remember how to access each of them.
</p>

<p>
Almost every programming language has the notion of a named <i>variable</i> that you
can set to some value for convenient reuse, and you could use Emacs Lisp
variables for this purpose, but Elisp is verbose and you need to understand the
subtleties of the language to use it.
</p>

<p>
So Emacs offers <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Registers"><i>Registers</i></a>: special
purpose named variables that can hold not just text, but a variety of things
that you might want to hang on to and eventually get back.  The name of a
Register is limited to a single character: any ASCII character except for <code>*</code> or
<code>C-d</code> (which have a special interpretation).  Most people stick to letters
(Register <code>a</code> is different from Register <code>A</code>) and digits.  (See <a href="#org2876984">below</a> for naming tips.)
</p>

<p>
For each type of thing you can store, there’s a command to <i>set</i> the content of
the Register, and a command to <i>get</i> the content.  There are only two getters:
    <code>C-x r i</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Text-Registers"><code>insert-register</code></a>﻿) serves for Register types whose
content gets <i>inserted</i> in a Buffer, and
    <code>C-x r j</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Position-Registers"><code>jump-to-register</code></a>﻿) serves for those types that hold
something that you in some sense <i>jump</i> to.
</p>
<table id="org59fe415">
<caption><span>Table 34:</span> Register Commands and Types</caption>

<colgroup>
<col/>

<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Type</th>
<th scope="col">Set</th>
<th scope="col">Get</th>
<th scope="col">Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td>Text</td>
<td><code>C-x r s</code></td>
<td><code>C-x r i</code></td>
<td>an arbitrary blob of text</td>
</tr>

<tr>
<td>Number</td>
<td><code>C-x r n</code></td>
<td><code>C-x r i</code></td>
<td>a number</td>
</tr>

<tr>
<td>Rectangle</td>
<td><code>C-x r r</code></td>
<td><code>C-x r i</code></td>
<td>a rectangle</td>
</tr>

<tr>
<td>Position</td>
<td><code>C-x r SPC</code></td>
<td><code>C-x r j</code></td>
<td>location of Point in this Buffer</td>
</tr>

<tr>
<td>Filename</td>
<td><code>C-x r C-f</code></td>
<td><code>C-x r j</code></td>
<td>a filename</td>
</tr>

<tr>
<td>Window Config</td>
<td><code>C-x r w</code></td>
<td><code>C-x r j</code></td>
<td>Windows layout of the current Frame</td>
</tr>

<tr>
<td>Frame Config</td>
<td><code>C-x r f</code></td>
<td><code>C-x r j</code></td>
<td>the layout of all your Frames</td>
</tr>

<tr>
<td>Keyboard Macro</td>
<td><code>C-x C-k x</code></td>
<td><code>C-x r j</code></td>
<td>the most recent Keyboard Macro</td>
</tr>
</tbody>
</table>
</div>
<div id="outline-container-orgc6b72fc">
<h4 id="orgc6b72fc">Register Preview and Contents</h4>
<div id="text-orgc6b72fc">
<p>
Whenever a Register command prompts you for a Register name, it displays a
transient Buffer that contains a preview of the contents of all defined
Registers, as an <i>aide memoire</i>.  You can see this preview<sup><a id="fnr.234" href="#fn.234" role="doc-backlink">234</a></sup> at any time with
  <code>M-x</code> <code>list-registers</code>.  Because a Register can contain a huge amount of
text, the content can be truncated in these previews.  If you want to see the
entirety of a Register, use   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Registers"><code>view-register</code></a>﻿.
</p>

<p>
Registers are a global data structure (not Buffer Local), so that they can be used to
move things from one Buffer to another.
</p>
</div>
</div>
<div id="outline-container-orgc941cad">
<h4 id="orgc941cad">Text in Registers</h4>
<div id="text-orgc941cad">
<p>
The <i>set</i> command for text is     <code>C-x r s</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Text-Registers"><code>copy-to-register</code></a>﻿) or its
alias   <code>C-x r x</code>.  It prompts you for a Register name and then
stores the text between Point and Mark (i.e., the <a href="#org34ab2da">Region</a>) in that Register.  With
a <a href="#orgb0f6ffd">prefix argument</a>, it deletes the text from the Buffer after storing it (you can
think of this as <i>moving</i> the text from the Buffer into the Register).
</p>

<p>
The <i>get</i> command for text is     <code>C-x r i</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Text-Registers"><code>insert-register</code></a>﻿) or its
alias   <code>C-x r g</code>; it inserts the value into the Buffer at Point.
</p>

<p>
You can append or prepend text to a Register with
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Text-Registers"><code>append-to-register</code></a>﻿ and   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Text-Registers"><code>prepend-to-register</code></a>﻿; see
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Text-Registers">“Text Registers”</a> in the <i>Emacs</i> manual.
</p>
</div>
</div>
<div id="outline-container-orgfcdce61">
<h4 id="orgfcdce61">Numbers in Registers</h4>
<p>
There is a special <i>set</i> command for numbers because you can use a proper number in a
Register as a counter;     <code>C-x r +</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Number-Registers"><code>increment-register</code></a>﻿) will add
\(1\) to the current value of the Register (or some other increment, if given as a
prefix argument).  This can be useful for <a href="#orgd2c3858">Keyboard Macros</a> in which you need to
count more than the one thing that the built-in <a href="#org4e40ec5">Macro Counter</a> can count.
</p>
</div>

<div id="outline-container-org92820cd">
<h4 id="org92820cd">Buffer Positions in Registers</h4>
<p>
You can store the position of Point in the current Buffer in a Register, with
    <code>C-x r SPC</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Position-Registers"><code>point-to-register</code></a>﻿), which has the aliases
  <code>C-x r C-SPC</code> and <code>C-x r C-@</code>.  The <i>get</i> command for
positions is     <code>C-x r j</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Position-Registers"><code>jump-to-register</code></a>﻿), which takes you
directly to that saved location.
</p>
</div>
<div id="outline-container-orgca5b97e">
<h4 id="orgca5b97e">Filenames in Registers</h4>
<div id="text-orgca5b97e">
<p>
You can also store a filename in a register, in which case <code>C-x r j</code> will actually
do a   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-file</code></a>﻿ for you (if the file is already in your
Emacs, it will jump to its Buffer).  But strangely, there’s no <i>set</i> command to
store a filename in a Register<sup><a id="fnr.235" href="#fn.235" role="doc-backlink">235</a></sup>: the
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/File-Registers">Manual</a> says to use Elisp.  So
I’ve defined the missing function; I put it on <code>C-x r C-f</code>.
</p>
<div>
<pre>(<span>defun</span> <span>kw-filename-to-register</span> (filename register)
  <span>&#34;Store a filename in a register.</span>
<span>Interactively, if a prefix arg, prompt for FILENAME.  With no</span>
<span>prefix arg, use `</span><span>ffap-file-at-point</span><span>&#39; to get the filename at point; if</span>
<span>that fails, use the buffer file name; if there is none, prompt for the</span>
<span>filename.  Reads the REGISTER using ‘</span><span>register-read-with-preview</span><span>’.&#34;</span>
  (<span>interactive</span>
   (list
    (<span>setq</span> filename
          (<span>if</span> current-prefix-arg
              (read-file-name <span>&#34;Filename: &#34;</span>)
            (<span>or</span>
             (<span>progn</span>
               (<span>require</span> &#39;<span>ffap</span>)
               (ffap-file-at-point))
             (buffer-file-name)
             (read-file-name <span>&#34;Filename: &#34;</span>))))
    (register-read-with-preview
     (format <span>&#34;Filename %s to register: &#34;</span> filename))))
  (set-register register `(file . ,filename)))

(global-set-key (kbd <span>&#34;C-x r C-f&#34;</span>) &#39;kw-filename-to-register)
</pre>
</div>
<p>
But if the idea of giving short names to a variety of files that you visit
frequently seems appealing, you should probably check out <a href="#org5690965">Bookmarks</a> instead.
</p>
</div>
</div>

<div id="outline-container-orgec64898">
<h4 id="orgec64898">Keyboard Macros in Registers</h4>
<p>
You can save the most recently defined <a href="#orgd2c3858">Keyboard Macro</a> in a Register with
    <code>C-x C-k x</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Keyboard-Macro-Registers"><code>kmacro-to-register</code></a>﻿) and invoke it with <code>C-x r j</code>.
Why would you do this when you can assign Macros to keys in the <code>C-x C-k</code> keymap
with     <code>C-x C-k b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Save-Keyboard-Macro"><code>kmacro-bind-to-key</code></a>﻿)?  The main advantage is
that <code>desktop-save-mode</code> will save any Macros in Registers for future Emacs
sessions without any extra work on your part, while preserving <code>C-x C-k b</code>
bindings requires the extra steps described in <a href="#org3b954e5"><i>Naming and Binding Your Macros</i></a>.
</p>
</div>
<div id="outline-container-orgafe75d7">
<h4 id="orgafe75d7">Saving Your Registers <a id="org2876984"></a></h4>
<div id="text-orgafe75d7">
<p>
You can automatically save the contents of all your Registers for future
sessions with the highly recommended <a href="#orgf2e3965">Desktop Save Mode</a>.
</p>

<p>
I have many Registers that have each retained their contents for years and I use
them regularly; they all have mnemonic alphabetic names.  But I regularly also
need transient Registers that I definitely don’t care about maintaining
forever.  I need short-term mnemonic names but don’t want to accidentally
clobber one of my “permanent” Registers.  What to do?
</p>

<p>
My solution is to use <a href="#org7997c3f">control characters</a> for the names.  So for example,
Register <code>k</code> contains:
</p>
<pre>call_kb(key=&#34;&#34;,cmd=&#34;&#34;)
</pre>

<p>
(a snippet of <a href="#org4a851ca">Org Mode</a> code that I use in this book all the time), so when I
temporarily need a Register to hold a blob of text about, say, koalas, I might
use <code>C-k</code> as the Register name.
</p>
</div>
</div>
</div>
<div id="outline-container-org1a385c3">
<h3 id="org1a385c3">Rectangles <a id="orgf8d8a5e"></a></h3>
<div id="text-org1a385c3">
<p>
Programmers and system administrators often need to edit files of rigidly
structured text, organized at least partially into columns.  It can be very
useful to be able to add, delete, or modify a rectangular chunk of such text,
and indeed Emacs has a suite of commands to do so.  But how do you indicate such
a chunk?
</p>

<p>
A <i>Rectangle</i> is just a special interpretation of the usual <a href="#org34ab2da">Region</a>.  Normally, the
Region is the linear sequence of characters (counting newlines as ordinary
characters) between Point and Mark, as in Figure <a href="#orgb99e92f">38</a>.
</p>

<div id="orgb99e92f">
<p><a href="https:./images/non-rectangular-region.png" alt="A Linear Region" title="A Linear Region" width="100%"><img src="https://blog.veitheller.de/images/non-rectangular-region.png" alt="A Linear Region" title="A Linear Region" width="100%"/></a>
</p>
<p><span>Figure 38: </span>A Linear Region</p>
</div>

<p>
But the Rectangle commands interpret the exact same Region rectangularly, as in
Figure <a href="#orgfe95d40">39</a>.
</p>

<div id="orgfe95d40">
<p><a href="https:./images/rectangular-region.png" alt="A Rectangular Region" title="A Rectangular Region" width="100%"><img src="https://blog.veitheller.de/images/rectangular-region.png" alt="A Rectangular Region" title="A Rectangular Region" width="100%"/></a>
</p>
<p><span>Figure 39: </span>A Rectangular Region</p>
</div>

<p>
Once we’ve defined a Rectangle we can easily do things to it, like say blank it
out with one keystroke (Figure <a href="#org6d45b7c">40</a>).
</p>

<div id="org6d45b7c">
<p><a href="https:./images/blanked-rectangular-region.png" alt="A Rectangular Region, Blanked" title="A Rectangular Region, Blanked" width="100%"><img src="https://blog.veitheller.de/images/blanked-rectangular-region.png" alt="A Rectangular Region, Blanked" title="A Rectangular Region, Blanked" width="100%"/></a>
</p>
<p><span>Figure 40: </span>A Rectangular Region, Blanked</p>
</div>

<p>
To work with a Rectangular Region, just <a href="#org231a697">set the Mark</a> at any of the four
potential corners of the Rectangle, then move Point to the <i>diagonally
opposite</i> corner.  At this moment, the ordinary linear Region has been defined
and will look (if you activate it with the usual
    <code>C-x C-x</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Setting-Mark"><code>exchange-point-and-mark</code></a>﻿)) like Figure
<a href="#orgb99e92f">38</a>.  To switch the interpretation to rectangular, do
    <code>C-x SPC</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Rectangles"><code>rectangle-mark-mode</code></a>﻿), and you’ll see something like
Figure <a href="#orgfe95d40">39</a>.  (Alternately, you can sweep out the Rectangular
Region with     <code>C-M-mouse-1</code> (<code>mouse-drag-region-rectangle</code>).)
</p>

<p>
With the Rectangular Region activated, Point is fixed to one of the four
corners.  You can grow or shrink the Rectangle in any of the four cardinal
directions with ordinary motion commands (such as
    <code>C-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>forward-char</code></a>﻿),     <code>M-b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Words"><code>backward-word</code></a>﻿),
    <code>&lt;down&gt;</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>next-line</code></a>﻿), or whatever).  Whether the Rectangle
grows or shrinks depends on the direction of the motion relative to the location
of Point.
</p>

<p>
You can cycle Point around the corners with repeated invocations of
  <code>C-x C-x</code>, which, when the Rectangular Region is activated, is
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>rectangle-exchange-point-and-mark</code></a>﻿.  If Point is at the
upper- or lower-right corner, rightward motion will grow the Rectangle to the
right, and leftward motion will shrink it to the left, for example.
</p>

<p>
In addition to the motion commands, commands that kill or copy the Region, like
    <code>C-w</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Kill-Commands"><code>kill-region</code></a>﻿) and
    <code>M-w</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Kill-Commands"><code>kill-ring-save</code></a>﻿), will operate on the Rectangle, and so
will commands that modify the text in the Region, like
    <code>C-x C-u</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Case"><code>upcase-region</code></a>﻿).
</p>

<p>
To deactivate the Rectangular Region, just use
    <code>C-g</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Quitting"><code>keyboard-quit</code></a>﻿).
</p>
</div>
<div id="outline-container-orgbcec1fe">
<h4 id="orgbcec1fe">Inactive Rectangular Regions</h4>
<div id="text-orgbcec1fe">
<p>
The motion and Region-manipulating commands described above only have their
special Rectangular interpretation when the Rectangular Region is <i>activated</i>.
But as you know, if the Mark is set in your Buffer, there is a Region present,
even it isn’t activated.  The same is true of the Rectangular Region: if there’s
a Mark, there’s an implied Rectangle, and there is a set of explicit Rectangle
commands (see Table <a href="#org0e740c6">35</a>) that will operate on it whether
you activate it with   <code>C-x SPC</code> or not (you might prefer to
activate it just so the precise extent of your Rectangle is more obvious).
</p>
<table id="org0e740c6">
<caption><span>Table 35:</span> Explicit Rectangle Commands</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>C-x r c</code></td>
<td>Clear rectangle (overwrite with spaces)</td>
</tr>

<tr>
<td><code>C-x r d</code></td>
<td>Delete rectangle</td>
</tr>

<tr>
<td><code>C-x r k</code></td>
<td>Kill rectangle</td>
</tr>

<tr>
<td><code>C-x r y</code></td>
<td>Yank previously killed rectangle</td>
</tr>

<tr>
<td><code>C-x r o</code></td>
<td>Open rectangle (shift rectangle right)</td>
</tr>

<tr>
<td><code>C-x r t</code></td>
<td>replace Text of rectangle</td>
</tr>

<tr>
<td><code>C-x r N</code></td>
<td>Number rectangle’s lines</td>
</tr>

<tr>
<td><code>C-x r r</code></td>
<td>copy rectangle to <a href="#orgcfc576b">Register</a></td>
</tr>
</tbody>
</table>

<p>
  <code>C-x r c</code> changes every character in the Rectangle to a space,
“clearing” it (as in Figure <a href="#org6d45b7c">40</a>).
  <code>C-x r o</code> on the other hand opens up a new rectangular space where
you’ve marked your Rectangle, but preserves the original text of the Rectangle
by shifting it to the right (that includes all the text to the right of the
original Rectangle too).
</p>

<p>
Deleting or killing the Rectangle actually eliminates all the characters
contained in the Rectangle, rather than converting them to spaces as <code>C-x r c</code>
does, thus squashing the Rectangle out of existence and shifting all the text to
right of it leftward.  If you use     <code>C-x r d</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Rectangles"><code>delete-rectangle</code></a>﻿),
the text of the Rectangle is gone forever<sup><a id="fnr.236" href="#fn.236" role="doc-backlink">236</a></sup>, but if you use
    <code>C-x r k</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Rectangles"><code>kill-rectangle</code></a>﻿) you can later yank the Rectangle
back with     <code>C-x r y</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Rectangles"><code>yank-rectangle</code></a>﻿).
</p>

<p>
  <code>C-x r t</code> is probably the Rectangle command I use the most: it
replaces the text of the Rectangle with new text: you’re prompted for a new
single line of text, and that line replaces the text of each of the Rectangle’s
lines.  Consider this list of some of my favorite drummers:
</p>
<pre id="org4fee0f0">+ Chris Cutler
+ Max Roach
+ Tatsuya Yoshida
+ Christian Vander
</pre>
<p>
I can change all the plus signs to bullets by setting a one-character-wide
Rectangle containing the column of pluses, and then executing <code>C-x r t •</code>.<sup><a id="fnr.237" href="#fn.237" role="doc-backlink">237</a></sup>  The
result will be:
</p>
<pre id="org88d9eeb">• Chris Cutler
• Max Roach
• Tatsuya Yoshida
• Christian Vander
</pre>
<p>
The new text doesn’t have to be the exact same width as the Rectangle; if
instead I used the string “Drummer” the result would be:
</p>
<pre id="org09cbf0e">Drummer Chris Cutler
Drummer Max Roach
Drummer Tatsuya Yoshida
Drummer Christian Vander
</pre>
</div>
</div>
<div id="outline-container-org7d99a08">
<h4 id="org7d99a08">Old- and New-School Rectangle Commands</h4>
<div id="text-org7d99a08">
<p>
The commands in Table <a href="#org90a8e27">36</a> were necessary before the
invention of the Rectangular Region in 2014, and of course you can still use
them, but if you’re activating the Rectangular Region via
  <code>C-x SPC</code> you can use the easier commands discussed above.
</p>
<table id="org90a8e27">
<caption><span>Table 36:</span> Old- and New-School Rectangle Commands</caption>

<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Inactive Rectangular Region</th>
<th scope="col"><i>Active</i> Rectangular Region</th>
</tr>

<tr>
<th scope="col"> </th>
<th scope="col">(Old School)</th>
<th scope="col">(New School)</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>C-x r k</code></td>
<td>Kill rectangle</td>
<td><code>C-w</code></td>
</tr>

<tr>
<td><code>C-x r d</code></td>
<td>Delete rectangle (not yankable)</td>
<td><code>C-w</code> (yankable)</td>
</tr>

<tr>
<td><code>C-x r M-w</code></td>
<td>copy rectangle to Kill Ring</td>
<td><code>M-w</code></td>
</tr>

<tr>
<td><code>C-x r y</code></td>
<td>Yank rectangle</td>
<td><code>C-y</code></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgeef9d5b">
<h4 id="orgeef9d5b">Empty Rectangles</h4>
<div id="text-orgeef9d5b">
<p>
If you set the Mark, and then move point directly downward say four lines with
    <code>C-n</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>next-line</code></a>﻿), you have created an <i>empty Rectangle</i> with a
width of zero columns which is four lines in height.  Such empty Rectangles are very
useful!  If you’ve typed in my list of drummers without any kind of bullet:
</p>
<pre id="org2325f6a">Chris Cutler
Max Roach
Tatsuya Yoshida
Christian Vander
</pre>
<p>
then you can add the bullets by defining an empty Rectangle extending vertically
from in front of the “C” of Chris Cutler down to the “C” of Christian Vander,
and then using <code>C-x r t</code> to insert the bullets.
</p>
</div>
</div>
<div id="outline-container-org95698a5">
<h4 id="org95698a5">Yanking Rectangles is Subtle</h4>
<div id="text-org95698a5">
<p>
When you yank back a previously killed Rectangle with
    <code>C-x r y</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Rectangles"><code>yank-rectangle</code></a>﻿), the lines of the Rectangle are
inserted into the Buffer with Point being the upper-left-hand corner of the
inserted text.
</p>

<p>
If I have previously killed a 3-line Rectangle consisting of hyphens, and I
position Point right before the space in the first line of this block of text:
</p>
<pre id="orgc7f05ae">XXXXXXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
</pre>
<p>
and then I say     <code>C-x r y</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Rectangles"><code>yank-rectangle</code></a>﻿), the result might
look like this:
</p>
<pre id="org5b035b7">XXXXXXXX----- XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXX-----XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXX-----XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
</pre>
<p>
Note how yanking shoves the characters to the right, rather than replacing any
of them.  To instead achieve <i>this</i> result:
</p>
<pre id="org7610861">        -----
        -----
        -----
XXXXXXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
</pre>
<p>
you would need to first, before yanking, open up three blank lines (perhaps with
<code>C-u 3</code>     <code>C-o</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Blank-Lines"><code>open-line</code></a>﻿)) and insert eight spaces on the first
of them to position Point where you want it horizontally.
</p>

<p>
<code>C-o</code> is very handy when yanking Rectangles.  Rather than counting precisely,
you can often give it a big numeric argument to open more lines than you’d need,
say, with <code>C-u C-u C-o</code> to get sixteen blank lines, yank your Rectangle, and then
close up the extraneous blank lines with a couple of
    <code>C-x C-o</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Blank-Lines"><code>delete-blank-lines</code></a>﻿)’s.
</p>
</div>
</div>
</div>
<div id="outline-container-org569fad0">
<h3 id="org569fad0">Bookmarks <a id="org5690965"></a></h3>
<div id="text-org569fad0">
<p>
Emacs Bookmarks are a sort of generalization of Filename Registers, but they
come with long names, some additional commands, and a <a href="#org5b21ef0">Major Mode</a> for browsing
and maintenance.  Most of us have a set of files, located all over the file
system, that we visit on a regular basis: Bookmarks are the way to manage them,
and they automatically persist across Emacs sessions.
</p>

<p>
Bookmarks were probably originally designed as a way to save your position
in a file, just like a physical bookmark does in a physical book: they let you
open up a file at the exact point that you were last reading (or editing).
</p>

<p>
But for this aspect of Bookmarks,   <code>save-place-mode</code> works
better.  If you enable it in your <a href="#org2af3730">Init File</a> (and I recommend you do), every time
you open any file, Point will be set to the position it had when you last saved
the file.
</p>
<div>
<pre>(save-place-mode 1)   <span>; </span><span>come back to where we were in that file</span>
</pre>
</div>

<p>
The main Bookmark commands share the <code>C-x r</code> prefix with the <a href="#orgcfc576b">Register</a> and
<a href="#orgf8d8a5e">Rectangle</a> commands. and basic usage is quite straightforward:
</p>
<table id="orgc939d0d">
<caption><span>Table 37:</span> Bookmark Commands</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>C-x r m</code></td>
<td>set or update a bookMark <i>NAME</i> here</td>
</tr>

<tr>
<td><code>C-x r M</code></td>
<td>set a <i>new</i> bookMark <i>NAME</i></td>
</tr>

<tr>
<td><code>C-x r b</code></td>
<td>jump to Bookmark <i>NAME</i></td>
</tr>

<tr>
<td><code>C-x r l</code></td>
<td>pop up List of all bookmarks</td>
</tr>

<tr>
<td><code>M-x bookmark-insert</code></td>
<td>insert contents of bookmarked file</td>
</tr>

<tr>
<td><code>M-x bookmark-insert-location</code></td>
<td>insert filename of bookmarked file</td>
</tr>
</tbody>
</table>
<p>
When you set a Bookmark with <code>C-x r m</code> you’ll be prompted for a name, which is an
arbitrary string (not just a single character like a Register); typing <code>C-w</code>’s at
the prompt will slurp up words from Point to use as the name.  The default name
will be the Buffer’s filename<sup><a id="fnr.238" href="#fn.238" role="doc-backlink">238</a></sup>.  You can only bookmark files or
directories (<code>C-x r m</code> will work in a <a href="#orgcc42ce0">Dired</a> Buffer), so you’ll get an error if
you’re in a Buffer that’s not visiting a file.  Note that you <i>can</i> bookmark
remote <a href="#org2bfdd17">Tramp</a> files and directories: extremely useful, and there’s special
support for bookmarking chapters of <a href="#orga6bbd55">Info</a> documentation.
</p>

<p>
Each Bookmark records not only the file, but the current location of Point.
You can have several Bookmarks pointing to different locations in the same file,
but you’ll want to give them distinct names so you can keep them straight.
</p>

<p>
If you have a Bookmark, and you invoke <code>C-x r m</code> at a different location in the
same file, Emacs will update the Bookmark to reflect the new location of Point.
With a prefix arg <code>C-u C-x r m</code> will update the Bookmark but rather than
discarding the old location, will <i>shadow</i> it: when you delete the Bookmark, the
previous location will be restored.  Effectively, with <code>C-u</code> you can push any
number of new locations on a stack and pop them off later.<sup><a id="fnr.239" href="#fn.239" role="doc-backlink">239</a></sup>
</p>

<p>
I say that a Bookmark records the value of Point, but actually it also stores
some of the file’s text before and after Point, so that if the file changes
slightly, Emacs can restore your location with more accuracy.
</p>

<p>
<code>C-x r M</code> is just like its lowercase sibling, except that it will refuse to update
an existing Bookmark.
</p>

<p>
Jumping to a Bookmark is as easy as <code>C-x r b</code>: just type the name and go.  With a
good Completion enhancement like <a href="#org5a7b83a">Marginalia</a> you’ll get some useful extra
context.
</p>

<p>
With   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Bookmarks"><code>bookmark-insert</code></a>﻿, you can also insert the complete contents
of a Bookmarked file into the current Buffer at Point; this is like
    <code>C-x i</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Misc-File-Ops"><code>insert-file</code></a>﻿) except you use the Bookmark name rather
than the complete filename.    <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Bookmarks"><code>bookmark-insert-location</code></a>﻿ inserts
just the filename of the named Bookmark.
</p>
</div>
<div id="outline-container-org231a697">
<h4 id="org231a697">Bookmark Maintenance with the Bookmark Menu</h4>
<div id="text-org231a697">
<p>
    <code>C-x r l</code> (<code>bookmark-bmenu-list</code>) pops up the Bookmark Menu
Buffer, a two-column listing of all your Bookmarks; it might look something like this:
</p>
<pre id="org0deb791">% Bookmark     File
  Inbox.org    ~/notes/syncthing/Inbox.org
  Web Space    /ssh:example.com:/home/login/web
  backdrops    ~/images/backdrops/DB
  books        ~/books/2022.db
</pre>
<p>
This Buffer works much like Dired or <a href="#org534efa3">Buffer Menu</a>, so you can probably start
using it without any explanation: hit <code>RET</code> on a line to jump to that Bookmark, <code>d</code>
to flag a Bookmark for deletion, and <code>x</code> to execute your deletions.<sup><a id="fnr.240" href="#fn.240" role="doc-backlink">240</a></sup> Here’s
a subset of the truly Bookmark-specific commands; as always, you can use
    <code>C-h m</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Misc-Help"><code>describe-mode</code></a>﻿) to see the expected <a href="#orgfa25f51">Special Mode</a>
commands for scrolling, opening your Bookmarks in the usual Window and Frame
variants, marking lines to open several in one go, limiting to matching
Bookmark names, and the like.
</p>
<table id="org06b4364">
<caption><span>Table 38:</span> Bookmark Menu Commands</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>r</code></td>
<td>Rename this bookmark (same file, new name)</td>
</tr>

<tr>
<td><code>R</code></td>
<td>Relocate this bookmark (same name, new file)</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>k</code></td>
<td>Kill this bookmark immediately</td>
</tr>

<tr>
<td><code>d</code></td>
<td>flag (with <code>D</code>) this bookmark to be Deleted</td>
</tr>

<tr>
<td><code>x</code></td>
<td>eXecute deletions of bookmarks marked with <code>D</code></td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>a</code></td>
<td>show the Annotation</td>
</tr>

<tr>
<td><code>A</code></td>
<td>show All annotations</td>
</tr>

<tr>
<td><code>e</code></td>
<td>Edit the annotation</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org8e37556">
<h4 id="org8e37556">Bookmark Annotations</h4>
<div id="text-org8e37556">
<p>
Bookmarks can have simple <i>annotations</i> attached to them; Bookmarks with
annotations are marked with an asterisk (<code>*</code>) at the left.  From the Bookmark
Menu, use the <code>a</code> command to display this line’s annotation in a pop-up Window (<code>A</code>
will show all of them).  To add or edit an annotation, use the <code>e</code> command.
</p>

<p>
Since a Bookmark is specific to a particular location in a file, you could
theoretically annotate many lines by creating many Bookmarks, but practically
speaking, the Bookmark Menu interface isn’t really up to this task.  There are
<a href="#orgc96889a">third-party packages</a> that handle this properly.
</p>
</div>
</div>
</div>
<div id="outline-container-org2a3d5ab">
<h3 id="org2a3d5ab">Abbreviations <a id="orgd0268b2"></a></h3>
<div id="text-org2a3d5ab">
<p>
Most forms of completion are about making it easy for you to choose from a set
of candidates, but Emacs also has a system known as <i>Abbrevs</i> in which a short,
user-defined abbreviation, at the moment you type it, automatically expands to
something (usually) much longer.
</p>

<p>
The great thing about Abbrevs is that they happen instantaneously without your
having to type so much as a single extra keystroke to invoke a completion
command: they just magically expand as you’re typing!  Suppose you’re writing
about Transylvanian cuisine and find yourself typing “Székelykáposzta” a lot.
You might like the Abbrev “sk” to expand to that word, properly capitalized, so
that when you type “Cooking sk is easy”, the Abbrev expands right after you type
“sk”, the result being “Cooking Székelykáposzta is easy”.
</p>

<p>
Of course there’s a flip-side.  Unlike completion patterns, you have to <i>define</i>
the Abbrevs you want to use, and, since they expand magically, they  might
occasionally expand when you don’t want them to.
</p>

<p>
Let’s try it.  First, in some writable Buffer, you need to enable the <a href="#org5b21ef0">Minor Mode</a>
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Abbrev-Concepts"><code>abbrev-mode</code></a>﻿ with <code>M-x abbrev-mode</code>.  This is a Buffer Local
Minor Mode, so it will only apply to the current Buffer.
</p>

<p>
Next, you have to define yourself an Abbrev.  You might decide to do this after you’ve
typed some long or tricky-to-spell word enough times that you notice you’re sick of
doing it, so the expansion is right there in the buffer, to the left of Point.  Before
typing any further, give the expansion an abbreviation with
    <code>C-x a l</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Defining-Abbrevs"><code>add-mode-abbrev</code></a>﻿).  This command defines an Abbrev
for the word immediately before Point.  It prompts for the abbreviation:
</p>
<pre>Mode abbrev for &#34;Székelykáposzta&#34;: sk
</pre>

<p>
That’s it!  Now “sk” will expand to Székelykáposzta in this Buffer.
</p>

<p>
Actually, as the name <code>add-mode-abbrev</code> suggests, it will expand in all buffers
that are in the same <a href="#org5b21ef0">Major Mode</a> and in which you’ve turned on <code>abbrev-mode</code>.  If
this buffer is in <a href="#org4a851ca">Org Mode</a>, then “sk” is “Székelykáposzta” in all your Org Mode
buffers, until you either change your mind and undefine it or until you end your
Emacs session.<sup><a id="fnr.241" href="#fn.241" role="doc-backlink">241</a></sup>
</p>

<p>
You can also define <i>global</i> abbrevs that work everywhere <code>abbrev-mode</code> is enabled,
regardless of the Major Mode, with
    <code>C-x a g</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Defining-Abbrevs"><code>add-global-abbrev</code></a>﻿).
</p>

<p>
The mnemonics for these keystrokes, then, are:
</p>
<dl>
<dt><code>C-x a l</code></dt><dd>Abbrev, Local (to Mode)</dd>
<dt><code>C-x a g</code></dt><dd>Abbrev, Global</dd>
</dl>

<p>
Both <code>C-x a l</code> and <code>C-x a g</code> take, as the expansion text, the text from Point
backwards to the beginning of the previous word.  This means that if you type
the expansion “foo ”—note the space after the word and before Point—the
expansion will include the space, and also any trailing punctuation; this will
be clear from the prompt.  For maximum flexibility you typically don’t want
trailing spaces or punctuation in your expansion text.
</p>
</div>
<div id="outline-container-org75ba235">
<h4 id="org75ba235">Multi-Word Expansions</h4>
<div id="text-org75ba235">
<p>
What do you do if you want your expansion text to include multiple words?  I
might want an Abbrev for the name of my workplace, The University of Chicago,
for example.  With Point after Chicago, I can use a numeric argument of 4 like
so: <code>C-u 4 C-x a l</code>.  I could also put the Region around the expansion text and
use a numeric argument of zero: <code>C-u 0 C-x a l</code><sup><a id="fnr.242" href="#fn.242" role="doc-backlink">242</a></sup>  These numeric arguments work
identically for the global command <code>C-x a g</code>.
</p>

<p>
You can also define Abbrevs backwards, by typing the Abbrev in the buffer and
then using either     <code>C-x a i l</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Defining-Abbrevs"><code>inverse-add-mode-abbrev</code></a>﻿) or
    <code>C-x a i g</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Defining-Abbrevs"><code>inverse-add-global-abbrev</code></a>﻿).  This way you never
have to count the words in your expansion.
</p>

<p>
All these defining keystrokes seem to be designed for people who are constantly
adding Abbrevs on the fly as they type at speed, but for me this only happens very
occasionally.  So I think the easiest way to define an Abbrev is with
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Defining-Abbrevs"><code>define-mode-abbrev</code></a>﻿ and   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Defining-Abbrevs"><code>define-global-abbrev</code></a>﻿.
These commands prompt you for both the expansion and the abbreviation in the
<a href="#orga329460">Minibuffer</a>, so there’s no counting.
</p>
</div>
</div>
<div id="outline-container-org56909a2">
<h4 id="org56909a2">Abbrevs and Case</h4>
<p>
The case of the letters you use in typing an Abbrev control the case of the
letters in the expansion in a manner analogous to the way case works in <a href="#orgd6159de">Isearch</a>.
If you’ve defined “wa” as an abbreviation for “wallabies”, typing “Wa” instead
of just “wa” will expand to “Wallabies” and “WA” will expand to “WALLABIES”.
</p>
</div>
<div id="outline-container-orga7ec0a9">
<h4 id="orga7ec0a9">Unexpanding Unhappy Expansions</h4>
<div id="text-orga7ec0a9">
<p>
What do you do if an Abbrev expands when you don’t want it to?  First, you
should choose unlikely abbreviations to minimize this problem: if you write
primarily in English, maybe don’t chose “the” as your abbreviation for
“Transportable Helicopter Enclosure”.  But there are certain circumstances when
even the unlikeliest of Abbrevs will expand when you don’t want them
to.<sup><a id="fnr.243" href="#fn.243" role="doc-backlink">243</a></sup>
</p>

<p>
When exactly <i>do</i> Abbrevs expand?  When you’ve enabled <code>abbrev-mode</code>, Abbrevs are
checked for every time you type a <i>non-word-constituent</i> character, that is, any
character that the current Major Mode doesn’t consider to be a part of words.
Typically that’s whitespace and punctuation.  So when you type “The End.”, as
soon as you type the space, <code>abbrev-mode</code> checks the preceding word (“The”) to see
if it’s an Abbrev, and if so it expands it.  Then when you type the period after
“End”, it checks to see if “end” is an abbrev, and so on.
</p>

<p>
This means that you might get an unwanted expansion.  This is especially common
when you’re briefly typing in a <a href="https://en.wikipedia.org/wiki/Domain-specific_language">domain specific language</a> in your otherwise
straight natural language prose.  Suppose I need to type a URL in my Transylvanian
cooking text, and the URL includes an innocent “sk” between punctuation
characters, like <code>https://example.com/d7/sk/45/d0/</code> — I would end up with
<code>https://example.com/d7/Székelykáposzta/45/d0/</code>!  This can also come up with
snippets of HTML, say, or examples from some programming language.
</p>

<p>
There are two solutions.  One is, as soon as you see the unwanted expansion,
<a href="#org3f93c8e">Undo</a> it.  This will lose you the punctuation character that caused the expansion
— a slash, above — so then add the slash back by quoting it with
    <code>C-q</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Inserting-Text"><code>quoted-insert</code></a>﻿) i.e. <code>C-q /</code>.  <code>quoted-insert</code> prevents
<code>abbrev-mode</code> from expanding the Abbrev.  If you’re thinking ahead you can
obviously skip the Undo part.
</p>

<p>
Another solution is to use   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Expanding-Abbrevs"><code>unexpand-abbrev</code></a>﻿, which does just what
it says; you’ll still need to use <code>quoted-insert</code> to get the punctuation back.
</p>

<p>
A real downside is that you might be typing quickly and <i>not notice</i> the
expansion!  Now you have an error: this is the same reason your SMS text
messages are full of embarrassing typos, and is the reason I don’t really use
Abbrevs very much.  I prefer <a href="#org844fd88">Dynamic Abbrevs</a>: if I’m typing Székelykáposzta
often enough, it’ll be sure to complete easily with <code>M-/</code>.
</p>
</div>
</div>
<div id="outline-container-org11518ad">
<h4 id="org11518ad">Prefixed Abbrevs</h4>
<div id="text-org11518ad">
<p>
The inverse of unwanted expansions is wanted expansions that don’t happen.
Suppose you’ve defined “bac” as an Abbrev for “bacterial”, and you expect that
when you type “antibac ” it will expand to “antibacterial”.  But of course it
doesn’t, because the word preceding the space isn’t “bac”.
</p>

<p>
You can solve this with     <code>M-&#39;</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Expanding-Abbrevs"><code>abbrev-prefix-mark</code></a>﻿).  Just type
“anti” <code>M-&#39;</code> “bac” and then space; when you type <code>M-&#39;</code> Emacs will insert a hyphen,
but this is a magic hyphen, and when you hit the space, “anti-bac” will expand
to “antibacterial” (and the hyphen disappears).
</p>
</div>
</div>
<div id="outline-container-org5c87f68">
<h4 id="org5c87f68">Turning <code>abbrev-mode</code> on in Your Init File</h4>
<div id="text-org5c87f68">
<p>
Unlike many modern Minor Modes, <code>abbrev-mode</code> doesn’t have a <code>global-abbrev-mode</code>
version, so if you want it on in all the Major Modes you use, you’ll have to
enumerate them in your <a href="#org2af3730">Init File</a>.  The easiest way is probably to use one or
both of these two hooks:
</p>
<div>
<pre>(add-hook &#39;text-mode-hook &#39;abbrev-mode)
(add-hook &#39;prog-mode-hook &#39;abbrev-mode)
</pre>
</div>
<p>
Most texty Major Modes inherit from   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Text-Mode"><code>text-mode</code></a>﻿, just as most
programming language modes inherit from   <code>prog-mode</code>.  If you
don’t want it everywhere, just add it to the hook for any Modes you want; see <a href="#orgc54c064"><i>Hooks</i></a>.
</p>
</div>
</div>
<div id="outline-container-orgd2d95ef">
<h4 id="orgd2d95ef">Listing and Editing Abbrevs</h4>
<div id="text-orgd2d95ef">
<p>
You can see all the Abbrevs that you’ve defined with
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Editing-Abbrevs"><code>list-abbrevs</code></a>﻿.  They’re grouped by Major Mode and will
include a special entry for the Global Abbrev Table.  Most definition lines will
look like:
</p>
<pre>&#34;sk&#34;           32   &#34;Székelykáposzta&#34;
</pre>

<p>
You can edit any of these lines to tweak or add new Abbrevs.  The number in the
middle is a count of how many times you’ve used that Abbrev, which can be
helpful if you decide to clean some of them up.  You can also delete lines to
delete the definition.  After making any such changes,
    <code>C-c C-c</code> (<code>edit-abbrevs-redefine</code>) will update Emacs’s state to
reflect your changes.  <code>C-x C-s</code> will save the buffer in a file that Emacs will
automatically load each time you start a session.
</p>
</div>
</div>
<div id="outline-container-org034ac0f">
<h4 id="org034ac0f">Saving Your Abbrevs</h4>
<p>
If you’ve defined any Abbrevs in a session, Emacs will ask if you want to save
them when you run     <code>C-x s</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Save-Commands"><code>save-some-buffers</code></a>﻿), or when you
exit.  When prompted for a filename to save them in, the default will be a file
in your <a href="#org18c7583">Emacs Directory</a>; Abbrevs in this file will be loaded and defined for you
when you start up Emacs.
</p>
</div>
</div>
<div id="outline-container-orgff5c55d">
<h3 id="orgff5c55d">Recursive Edit <a id="orgbcf0f80"></a></h3>
<div id="text-orgff5c55d">
<p>
One of the more unusual Emacs capabilities is what we call <i>Recursive Edit</i>; it
refers to your ability to do full-on Emacs editing while you’re in the middle of
doing Emacs editing.  What?
</p>

<p>
Suppose you’re doing a <a href="#orgb683e7c">Query Replace</a>, which is a very structured sort of
editing: you’re stepping from one match to the next and at each stage, answering
a yes-or-no-question (replace this one, or not).  It’s possible that in the
middle of this, you might need to look at some other part of the buffer, or some
other Buffer entirely, in order to decide between yes or no for one of the
matches.  You could quit the Query Replace, and then restart it, but the normal
Emacs thing to do is enter a Recursive Edit—which, in a Query Replace, you can
do by using   <code>C-r</code>.
</p>

<p>
The Recursive Edit is a way to leave the Query Replace frozen where you left it.
You can then do <i>any</i> Emacs editing you like: you’re no longer just answering yes
or no.  You can scroll the Buffer, move to a different location, make a quick
edit, change Buffers, send an email, or play a game of <a href="#org4041080">Tetris</a>.  Take as much
time as you like, even days if you want (as long as you don’t exit Emacs).
</p>

<p>
It will seem as if you’ve quit out of the Query Replace, but really it’s just
waiting patiently for you to end your Recursive Edit, at which point your
windows will be restored to exactly what they looked like when you hit <code>C-r</code>, and
it will be waiting for you to answer the exact same yes or no question it was
asking you before your excursion.
</p>

<p>
The word <a href="https://en.wikipedia.org/wiki/Recursion"><i>recursion</i></a> implies self-reference and nesting something within itself,
as in the recursive acronym GNU, which stands for “GNU’s not Unix!”<sup><a id="fnr.244" href="#fn.244" role="doc-backlink">244</a></sup>.
This is exactly what’s happening with a Recursive Edit: in order to let you do
an arbitrary something in the middle of something else, rather then implementing
a half-assed temporary-escape feature, Emacs does the simplest possible thing:
it calls itself recursively to do the job.  This simplest possible thing also
happens to be the most powerful thing.
</p>

<p>
The only way you can tell you’re in a Recursive Edit is by peeking at the <a href="#org6456ffd">Mode
Line</a>.  The section which displays Major and Minor Modes with parentheses will be
wrapped in square brackets, like this:
</p>
<pre>U:@---  *scratch*    All L1   Hg:94daf  [(Lisp Interaction ElDoc)]
</pre>

<p>
when you exit the Recursive Edit, the brackets will go away.
</p>

<p>
Since you can do <i>anything</i> while you’re in a Recursive Edit, that includes entering
another Recursive Edit!  If you do that, you’ll see another level of brackets in
the Mode Line.  The number of pairs of brackets indicates how deeply nested you
are.
</p>

<p>
Besides Query Replace, you’ll find special key-bindings for Recursive Edit in
other highly-structured Emacs subsystems, like <a href="#orgd2c3858">Keyboard Macros</a> and the
<a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Debugger">Elisp debugger</a>.  But because Emacs is
very much a non-<a href="https://en.wikipedia.org/wiki/Modal_window">modal</a> editor, there’s less call for special uses of this
powerful feature than you might think.  If you’re doing file management in
<a href="#orgcc42ce0">Dired</a>, or are the middle of editing a <a href="#org53af7eb">version control</a> log message, you can just
switch Buffers, do something else, and come back later.  This is even true when
you’re being prompted for information, as I described in <a href="#orga329460"><i>The Minibuffer</i></a>.
</p>

<p>
You <i>can</i> invoke a Recursive Edit manually whenever you want with
  <code>M-x</code> <code>recursive-edit</code>, but I’m hard pressed to think of times when I’ve
wanted to do this.
</p>
</div>
<div id="outline-container-org837b38c">
<h4 id="org837b38c">Exiting a Recursive Edit</h4>
<div id="text-org837b38c">
<p>
I encourage you to try a recursive excursion during your next Query Replace.  But
before you do, you need to know how to exit the Recursive Edit!  There are three
ways:
</p>
<dl>
<dt>    <code>C-M-c</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Recursive-Edit"><code>exit-recursive-edit</code></a>﻿)</dt><dd>exit the innermost Recursive
Edit and continue where you left off (perhaps back in your Query Replace)</dd>
<dt>    <code>C-]</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Quitting"><code>abort-recursive-edit</code></a>﻿)</dt><dd>same as above, but also abort
the command that gave you the Recursive Edit (perhaps your Query Replace)</dd>
<dt>  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Quitting"><code>top-level</code></a>﻿</dt><dd>abort <i>all</i> nested levels of Recursive Edit</dd>
</dl>

<p>
If you ever happen to notice some square brackets around the mode information in
your Minibuffer, it might be because you accidentally entered a Recursive Edit,
or perhaps days ago you intentionally did so in a Query Replace but then changed
your mind entirely about it, and simply forgot to exit — you might even have
killed the Buffer in which you were doing the Query Replace!  <code>C-]</code> is appropriate
in these situations, but <code>C-M-c</code> is the standard procedure.
</p>

<p>
A forgotten Recursive Edit rarely causes any problems — you could be working
for weeks in one without even noticing — but you might as well clean them up
when you discover them.
</p>
</div>
</div>
</div>
<div id="outline-container-org9ecc5a9">
<h3 id="org9ecc5a9">Visual Display and Color <a id="org4f82637"></a></h3>
<div id="text-org9ecc5a9">
<p>
Each character or span of characters in a Buffer can have any number of
<i>properties</i> that can be used to change its <i>Face</i> (font, colors, underlining,
slant, etc), the character set (encoding), directionality (left-to-right or
right-to-left), spacing and line-height, margins, visibility, modifiability, and
the like.  Chunks of text of any size can have clickable actions or an entire
menu associated with them and can change what a keystroke does when the cursor
is at a particular location.  Text can be displayed as glyphs (like emojis or
icons) or full-blown images.  All of this is done without any modification to
the plain text of the Buffer’s visited file (if any) and so won’t interfere with
or confuse external programs.
</p>

<p>
These facilities are used to build <a href="#orgf0e4005">Emacs applications</a> such as the <a href="#org27e6769">Customize facility</a>
and <a href="#orgcc42ce0">Dired</a>, and one generally needs to be an Elisp programmer to play with them,
but here we’ll discuss some of the user-level commands that enable
non-programmers to easily change the visual properties.
</p>
</div>
<div id="outline-container-org052a30e">
<h4 id="org052a30e">Fonts and Faces <a id="orgb1883e1"></a></h4>
<div id="text-org052a30e">
<p>
Loosely speaking a computer <i>font</i> (hereafter, just “font”) is a packaging of a
particular <a href="https://en.wikipedia.org/wiki/Typeface">typeface</a> design (think <a href="https://en.wikipedia.org/wiki/Helvetica">Helvetica</a>), including variations in size,
weight, slope, and the like.  Your operating system probably comes with some
fonts predefined, and you may have added many more via your OS package manager.
More precisely, a font is one specific expression of a typeface, a weight, a
slant, etc, such as “Helvetica 14 Bold”.  I have 786 fonts
installed on my system, which are all available to Emacs.
</p>

<p>
A <i>Face</i> is an Emacs concept: a combination of a font with any of the following
additional attributes: Underline, Overline, Strike-through, Box around text,
Inverse-video, Foreground (color), Background (color), or Stipple.<sup><a id="fnr.245" href="#fn.245" role="doc-backlink">245</a></sup>
</p>

<p>
Emacs predefines 150-odd different Faces, and packages can define and add many
more (my Emacs currently has 441).  You can see a colorful listing
of all the currently defined Faces with   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Faces"><code>list-faces-display</code></a>﻿.
</p>


<div id="org2395b9f">
<p><a href="https:./images/list-faces.png" alt="=M-x list-faces-display=" title="=M-x list-faces-display=" width="100%"><img src="https://blog.veitheller.de/images/list-faces.png" alt="=M-x list-faces-display=" title="=M-x list-faces-display=" width="100%"/></a>
</p>
<p><span>Figure 41: </span><code>M-x list-faces-display</code></p>
</div>

<p>
These Faces are used to present the typically colorful Emacs display of
mode-specific syntax highlighting, hypertext links: really, everything, because
in Emacs, all is text.
</p>

<p>
You don’t need to worry about specific Faces until you’re unhappy with one.  If
some Face in some mode rubs you the wrong way, you can easily change it; see
<a href="#org4c5ad38">Customize</a> for more information.
</p>
</div>

<div id="outline-container-org68031eb">
<h5 id="org68031eb">Changing the Default Font</h5>
<div id="text-org68031eb">
<p>
Most Faces are just customized versions of the <i>default font</i><sup><a id="fnr.246" href="#fn.246" role="doc-backlink">246</a></sup>, and the
default font is what most of your text will look like.  You may want to change
it from the default 10-point monospace font.  As a programmer, I much prefer a
monospace (fixed-pitch) font, but I like a specific one best and specify it in
my <a href="#org2af3730">Init File</a>.  You can do this yourself with something like this:<sup><a id="fnr.247" href="#fn.247" role="doc-backlink">247</a></sup>
</p>
<div>
<pre>(<span>with-demoted-errors</span> <span>&#34;%s&#34;</span>
  (add-to-list &#39;default-frame-alist &#39;(font . <span>&#34;Helvetica 12&#34;</span>))
</pre>
</div>
</div>
</div>
<div id="outline-container-org43833f4">
<h5 id="org43833f4">Changing Fonts on the Fly</h5>
<div id="text-org43833f4">
<p>
The default font is <a href="#org4dd50c2">Frame</a>-specific; though there’s a default, you can change the
current Frame’s font on the fly with   <code>M-x</code> <code>set-frame-font</code>; you can use
<a href="#org75fb6a2">Completion</a> to choose amongst all the fonts available on your system.
  <code>M-x</code> <code>menu-set-font</code> provides a popup GUI dialog and changes the font
of <i>all</i> your existing and future frames (in the current Emacs session) in one go.
</p>

<p>
You can of course customize different fonts for different <a href="#org5b21ef0">Major Modes</a> and the
like, and there are a number of <a href="#orgc96889a">third-party packages</a> for working with fonts as
well.
</p>
</div>
</div>
<div id="outline-container-org239becf">
<h5 id="org239becf">Text Scale: Changing the Font Size</h5>
<div id="text-org239becf">
<p>
Once you’ve chosen your default font, you probably won’t often feel the need to
change it on the fly, but you may well want to change the <i>size</i> from time to
time.  You can increase the font size with
    <code>C-x C-+</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Text-Scale"><code>text-scale-adjust</code></a>﻿), which immediately embiggens the
font by the factor in   <code>text-scale-mode-step</code> (default:
1.2), or decrease
the font size by the same factor with
    <code>C-x C--</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Text-Scale"><code>text-scale-adjust</code></a>﻿);
    <code>C-x C-0</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Text-Scale"><code>text-scale-adjust</code></a>﻿) will restore your default font
size.
</p>

<p>
You may have noticed that all these keystrokes are bound to the same function.
That’s because the <code>text-scale-adjust</code> function bases its behavior on the
keystroke that invoked it.  Additionally, after it’s invoked, if any of the next
keystrokes in unbroken sequence are <code>0</code>, <code>+</code>, or <code>-</code>,
ignoring any modifiers, the corresponding action is
invoked.  In short, start with any of <code>C-x C-0</code>, <code>C-x C-+,</code> or <code>C-x C--</code> and then you
can continue tweaking the font size with simple <code>0</code>, <code>+</code>, or <code>-</code> keystrokes until you get what
you want — terminate this with any key that doesn’t involve <code>0</code>, <code>+</code>, or <code>-</code>
(    <code>C-g</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Quitting"><code>keyboard-quit</code></a>﻿) is always there for you).
</p>

<p>
Since for me, the first adjustment is always to <i>enlarge</i> the font, I bind
<code>text-scale-adjust</code> to the <a href="#org38efd5c">felicitous</a> binding   <code>C-+</code> and start from there:
</p>
<div>
<pre>(global-set-key (kbd <span>&#34;C-+&#34;</span>) &#39;text-scale-adjust) <span>; </span><span>embiggen font</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgff53b6b">
<h4 id="orgff53b6b">Themes and Colors</h4>
<div id="text-orgff53b6b">
<p>
A <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Custom-Themes"><i>theme</i></a> is a named combination of
<a href="#orgb1883e1">Faces</a><sup><a id="fnr.248" href="#fn.248" role="doc-backlink">248</a></sup> that broadly determines the overall look of your Emacs, especially
the colors.  Emacs predefines 16 Themes, and there are at least
295 more in the <a href="#orgc96889a">Package Manager</a>, and many more on
Github and the like.
</p>

<p>
If you’d like to change your Theme, just call   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Custom-Themes"><code>customize-themes</code></a>﻿,
which will contain lines like:
</p>
<pre id="orgfbbc8d2">[ ] wheatgrass -- High-contrast green/blue/brown faces on a black background.
[ ] whiteboard -- Face colors similar to markers on a whiteboard.
[ ] wombat -- Medium-contrast faces with a dark gray background.
</pre>
<p>
Just check the box of the Theme you want and the Theme will be immediately
activated; check another box and it will switch to that theme; uncheck the box
to go back to Theme you were using before you started.  Some Themes are subtle
and you might need to see them in a variety of different types of Buffers to
appreciate them.  Third-party Themes you’ve installed from the Package Manager
will also be listed in this Buffer.  After you’ve chosen the one Theme you like,
you can make it your default for future sessions: evaluate
    <code>C-x C-s</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>custom-theme-save</code></a>﻿) in the Customize Buffer.
</p>

<p>
Who creates all these Themes?  Anybody, including you.  If you want to try your
hand at it, run   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Creating-Custom-Themes"><code>customize-create-theme</code></a>﻿ and answer “yes” to the
question:
</p>
<pre>Include basic face customizations in this theme? (y or n)
</pre>

<p>
You’ll be taken to a special <a href="#org27e6769">Customize</a> Buffer where you can choose all the
colors, fonts, and faces you want in your very own Theme, which you can save,
make your default, and even give away to other Emacs users.
</p>
</div>
<div id="outline-container-org5cd1839">
<h5 id="org5cd1839">Colors</h5>
<div id="text-org5cd1839">
<p>
One of the most important parts of a Theme is its (presumably harmonious) color
choices.  On my system, Emacs knows
752 named colors; you can
examine them via   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Colors"><code>list-colors-display</code></a>﻿ (see Figure <a href="#org24be2f3">42</a>).
</p>

<div id="org24be2f3">
<p><a href="https:./images/list-colors-display.png" alt="=M-x list-colors-display=" title="=M-x list-colors-display=" width="100%"><img src="https://blog.veitheller.de/images/list-colors-display.png" alt="=M-x list-colors-display=" title="=M-x list-colors-display=" width="100%"/></a>
</p>
<p><span>Figure 42: </span><code>M-x list-colors-display</code></p>
</div>
</div>
</div>
</div>

<div id="outline-container-org023b16e">
<h4 id="org023b16e">The Cursor</h4>
<div id="text-org023b16e">
<p>
Every <a href="#org9409b46">Window</a> has a <a href="#orgba1f634">Point</a>, which is indicated by a <i>cursor</i>.  By default, the
cursor is a solid block in the currently selected Window, and a hollow block in
any other visible Windows.  But you can change how the cursor is displayed if
you like.  Customize the many aspects of the cursor with
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-group</code></a>﻿ <code>RET cursor</code>. See
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Cursor-Display">“Cursor Display”</a> in the <i>Emacs</i> manual for more information.
</p>

<p>
By default, the cursor blinks, which drives me crazy; I turn it off in my <a href="#org2af3730">Init File</a>:
</p>

</div>
<div id="outline-container-org01037c7">
<h5 id="org01037c7">Emphasizing the Cursor’s Line</h5>
<div id="text-org01037c7">
<p>
When I’m reading text with long lines, I sometimes lose my focus as I scan the
lines from left to right; it’s also an issue for me vertically with very tall
windows.  To solve this problem, I invoke   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Cursor-Display"><code>hl-line-mode</code></a>﻿, which
changes the background of the entire line containing Point (i.e. the cursor) to
make that line stand out.  As you move the Point from line to line, the
background emphasis follows along.
</p>

<p>
I turn this on automatically in many <a href="#org5b21ef0">Major Modes</a> that display lists of
things, like   <code>package-menu-mode</code>,
  <code>occur-mode</code>, and   <code>dired-mode</code> via
<a href="#org2af3730">Init File</a> snippets like these:
</p>
<div>
<pre>(add-hook &#39;occur-mode-hook &#39;hl-line-mode)
(add-hook &#39;dired-mode-hook &#39;hl-line-mode)
(add-hook &#39;package-menu-mode-hook &#39;hl-line-mode)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org1c98072">
<h4 id="org1c98072">Highlighting Text <a id="orgde73944"></a></h4>
<div id="text-org1c98072">
<p>
By now you’ve noticed how colorful the typical <a href="#orgc3260f6">Buffer</a> is.  Almost every <a href="#org5b21ef0">Major
Mode</a> does a certain amount of what we call <i>fontification</i> to apply <a href="#orgb1883e1">Faces</a> based on
the structure or syntax of the text.  This is typically done by a Minor Mode
called   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Font-Lock"><code>font-lock-mode</code></a>﻿, which is enabled globally by
default.  If you’re looking at a colorful Buffer right now, try saying <code>M-x
font-lock-mode</code> and you’ll be stunned to see all the colors disappear: you’ll be
staring at 100% monochrome text!  This is what Emacs used to look like in the
70s.  (Quick!  Reinvoke that command to get your colors back!)
</p>

<p>
Fontification is mostly performed by Major or Minor Modes, so you have to be an
Elisp programmer and <a href="#org19c6ad0">Regular Expression</a> wizard to do it.  But there is a small
collection of commands that allow you to fontify your text <i>dynamically</i>: we call
this on-the-fly fontification <i>highlighting</i>.
</p>
</div>
<div id="outline-container-orgacf4a6c">
<h5 id="orgacf4a6c">Hi-Lock Mode</h5>
<div id="text-orgacf4a6c">
<p>
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Highlight-Interactively"><code>hi-lock-mode</code></a>﻿ lets you highlight text that matches certain
patterns, to make occurrences of those patterns stand out dramatically.  As a
programmer, I often use it to highlight the name of a function or variable in my
code so that all the uses jump out at me; you might also use it to highlight the
names of people or things in a document so that they stand out as you scroll
through.  It looks rather like the highlighting of your search term that
<a href="#org3ffa52a">Incremental Search</a> does, but the Isearch highlights disappear as soon you
terminate your search: Hi-Lock highlighting sticks around until you turn it off.
</p>

<div id="orgb782744">
<p><a href="https:./images/highlight.png" alt="Highlighting with =M-s h=" title="Highlighting with =M-s h=" width="100%"><img src="https://blog.veitheller.de/images/highlight.png" alt="Highlighting with =M-s h=" title="Highlighting with =M-s h=" width="100%"/></a>
</p>
<p><span>Figure 43: </span>Highlighting with <code>M-s h</code></p>
</div>

<p>
In Figure <a href="#orgb782744">43</a>, I’ve highlighted all occurrences of the variable <code>node</code>
in pink.  All the occurrences in the Buffer are pink, not just the ones visible
in the Window: as I scroll the Buffer, any <code>node</code> I see will be pink, and if I
type new text that contains <code>node</code>, that new <code>node</code> will immediately become pink as
well.  In addition, I’ve highlighted a comment describing a bug in unmissable
yellow; all other comments that start with <code>TODO BUG</code> will also be lit up this
way.  I consider Hi-Lock Mode an essential feature and use it all day long.
</p>

<p>
Note that these highlights don’t modify your text in any way.  If you save your
file, they won’t corrupt your program with hidden codes.  On the other hand, if
you want them to come back the next time you edit your file, you have to say so.
</p>

<p>
The Hi-Lock commands all live on the <code>M-s h</code> prefix; see Table
<a href="#org75d9832">39</a>.
</p>
<table id="org75d9832">
<caption><span>Table 39:</span> Hi-Lock Mode Commands</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>M-s h .</code></td>
<td>highlight symbol at Point</td>
</tr>

<tr>
<td><code>M-s h p</code></td>
<td>highlight-phrase</td>
</tr>

<tr>
<td><code>M-s h r</code></td>
<td>highlight-regexp</td>
</tr>

<tr>
<td><code>M-s h l</code></td>
<td>highlight-lines-matching-regexp</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>M-s h u</code></td>
<td>unhighlight-regexp</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>M-s h f</code></td>
<td>hi-lock-find-patterns</td>
</tr>

<tr>
<td><code>M-s h w</code></td>
<td>hi-lock-write-interactive-patterns</td>
</tr>
</tbody>
</table>
<p>
The simplest command is     <code>M-s h .</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Highlight-Interactively"><code>highlight-symbol-at-point</code></a>﻿);
just invoke it and the symbol<sup><a id="fnr.249" href="#fn.249" role="doc-backlink">249</a></sup> at Point, and all other occurrences of
that symbol in the Buffer, will be highlighted in yellow.
</p>

<p>
Actually, not always in yellow: the <i>next Hi-Lock color</i> will be used.  Hi-Lock
has a default list of colors it uses; if you’ve already highlighted something
in yellow, it will use the next color to avoid a conflict.  You can explicitly
choose your own color by giving <code>M-s h .</code> a <a href="#orgb0f6ffd">prefix arg</a>.
</p>

<p>
And as a matter of fact, Hi-Lock doesn’t highlight with colors: it uses <i>Faces</i>.
You’ll recall that Emacs comes with 150 or so, and you can use any of them for
highlighting.
</p>

<p>
Instead of highlighting the symbol at Point,
    <code>M-s h p</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Highlight-Interactively"><code>highlight-phrase</code></a>﻿) prompts you for a phrase: that is,
a sequence of words, and highlights matches.  It ignores case and whitespace
distinctions when looking for matches.  Of course you can use a one-word phrase,
which is like highlighting a symbol which doesn’t happen to be right at Point.
</p>

<p>
    <code>M-s h r</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Highlight-Interactively"><code>highlight-regexp</code></a>﻿) prompts you for a <a href="#org19c6ad0">Regular
Expression</a> and a Face, and then highlights all the matches, and
    <code>M-s h l</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Highlight-Interactively"><code>highlight-lines-matching-regexp</code></a>﻿) works the same way
except it highlights the entirety of any lines that <i>contain</i> the matches.  This
is what I used in Figure <a href="#orgb782744">43</a> to highlight the Regexp <code>TODO BUG</code>.
</p>

<p>
Of course you can remove any of the highlighting you’ve applied, with
    <code>M-s h u</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Highlight-Interactively"><code>unhighlight-regexp</code></a>﻿).  It will prompt you to select
one of the patterns you’ve used and it will eliminate that one.  With a prefix
arg, it will remove <i>all</i> the patterns you’ve used in this Buffer.
</p>

<p>
I mostly use Hi-Lock transiently throughout the day. turning it on and off to
enhance my focus as I work, but you can also set up persistent highlighting for
a given file that will be automatically applied every time you visit the file.
</p>
</div>
</div>
</div>
<div id="outline-container-orgcf81a64">
<h4 id="orgcf81a64">Visualizing Whitespace <a id="orgf0ba624"></a></h4>
<div id="text-orgcf81a64">
<p>
Whitespace—spaces, tabs, newlines, blank lines—is a big component of your
text, but it can be an annoying component, mostly because it can be hard to tell
these characters apart.<sup><a id="fnr.250" href="#fn.250" role="doc-backlink">250</a></sup>  Sometimes you don’t care about such subtle
distinctions, but sometimes, depending on what kind of program will be consuming
your text, you need to.
</p>

<p>
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Useless-Whitespace"><code>whitespace-mode</code></a>﻿ is a <a href="#org5b21ef0">Minor Mode</a> that can help by displaying the
various sorts of whitespace with a subtle (or not so subtle) differentiation.
In Figure <a href="#org95fb5ae">44</a> I’ve toggled it on.
</p>

<div id="org95fb5ae">
<p><a href="https:./images/whitespace-mode.png" alt="=M-x whitespace-mode=" title="=M-x whitespace-mode=" width="100%"><img src="https://blog.veitheller.de/images/whitespace-mode.png" alt="=M-x whitespace-mode=" title="=M-x whitespace-mode=" width="100%"/></a>
</p>
<p><span>Figure 44: </span><code>M-x whitespace-mode</code></p>
</div>

<p>
Spaces are shown as a centered dot in a gray background, which makes the excess
spaces between “until” and “there” more noticeable; the space between “world”
and “will” is a non-breaking space, and is shown differently.  Newlines are
shown as a gray dollar sign, and there’s a TAB character after the question mark
shown as a right-pointing guillemet.
</p>

<p>
These are all pretty subtle, so that <code>whitespace-mode</code> isn’t <i>too</i> jarring to use.
</p>

<p>
But the trailing spaces on line 2 <i>really</i> stand out, as does the trailing blank
line at the end of the Buffer, since these are considered to be always
offensive.
</p>

<p>
You can use   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-group</code></a>﻿ <code>whitespace RET</code> to change these <a href="#orgb1883e1">Faces</a>
if you want them to be more or less noticeable.
</p>

<p>
<code>whitespace-mode</code> has <i>a lot</i> of options that you can customize, and you can also
interactively tweak them on and off in a given buffer with
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Useless-Whitespace"><code>whitespace-toggle-options</code></a>﻿ — type <code>?</code> at the prompt.
</p>

<p>
If you want <code>whitespace-mode</code> on all the time in all your Buffers, you can use
  <code>M-x</code> <code>customize-variable</code> <code>global-whitespace-mode</code>.  Personally I only
occasionally turn <code>whitespace-mode</code> on, but it’s very handy when I need it.
</p>

<p>
However, I do want to always see trailing whitespace at the ends of lines, since
it annoys me and I want to clean it up.  You don’t need <code>whitespace-mode</code> for
this; just do <code>M-x customize-variable show-trailing-whitespace</code>.
</p>

<p>
It’s easy to get rid of trailing whitespace when you notice it (as you will,
with this setting):   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Useless-Whitespace"><code>delete-trailing-whitespace</code></a>﻿ will delete all
trailing whitespace in your Buffer, including all blank lines at the end of the
Buffer.  If the <a href="#org34ab2da">Active Region</a> is enabled, only the text in the Region is
processed.  You could put this function in   <code>before-save-hook</code>
so that these are cleaned up every time you save, but that’s a little too
helpful for my tastes.
</p>
</div>
</div>
</div>
<div id="outline-container-orgee5f7d0">
<h3 id="orgee5f7d0">Manipulating Plain Text <a id="org146e18d"></a> <a id="org521f7e2"></a></h3>
<p>
Emacs’s many modes and applications represent structured data as plain text.  In
this chapter we’ll look at some commands that are useful for manipulating text
in a variety of domains and <a href="#org5b21ef0">Modes</a>.  For other facilities that are most useful
for prose, see <a href="#org6412830"><i>Emacs for Writers</i></a>.
</p>
<div id="outline-container-org04c6531">
<h4 id="org04c6531">Mass Line Deletions</h4>
<div id="text-org04c6531">
<p>
Data is often arranged in the form of lines, and a frequent operation is to
reduce it: either by deleting certain lines or by keeping only others (which
amounts to the same thing).  You can delete all the lines after Point that match
a <a href="#org19c6ad0">Regular Expression</a> in one stroke with   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Repeating-Search"><code>flush-lines</code></a>﻿, or the
converse with   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Repeating-Search"><code>keep-lines</code></a>﻿.  Complete lines are deleted (or kept)
regardless of how much text your Regexp matches: <code>M-x flush-lines RET foo</code> deletes
all the lines that contain <code>foo</code> anywhere in the line.
Both of these functions instead operate on the <a href="#org34ab2da">Region</a> if it is Active.
</p>

<p>
Your Regexp can cross line boundaries like, say, <code>foo[[:space:]]+bar</code>, which will
match <code>foo</code> and <code>bar</code> separated by whitespace, including newlines; in this case the
entirety of all the lines containing the match will be deleted.
</p>

<p>
Emacs makes a distinction between <i>deleting</i> and <i>killing</i>: text that’s deleted is
simply thrown away<sup><a id="fnr.251" href="#fn.251" role="doc-backlink">251</a></sup>, while text that’s killed is put on the <a href="#orgee263e4">Kill Ring</a> and so can
be yanked back.
</p>

<p>
There’s <a id="org8a78e8f"></a> a variation on <code>flush-lines</code> called
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Repeating-Search"><code>kill-matching-lines</code></a>﻿, which works in exactly the same way except
instead of deleting, it <i>kills</i> the lines, so they are pushed onto the Kill Ring
in one bunch.  This makes it a good way of moving a bunch of discontiguous
lines, or even of copying them, if you immediately Undo after killing them.
</p>

<p>
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Deletion"><code>delete-duplicate-lines</code></a>﻿ is a powerful function that deletes all
but the first of any identical lines in the Region.  So if the Region contains
the eight lines in column one of Table <a href="#org3cd190d">40</a>, then after
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Deletion"><code>delete-duplicate-lines</code></a>﻿ it will contain only the lines in column two.
</p>
<table id="org3cd190d">
<caption><span>Table 40:</span> <code>M-x delete-duplicate-lines</code></caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Before</th>
<th scope="col">After</th>
</tr>
</thead>
<tbody>
<tr>
<td>foo</td>
<td>foo</td>
</tr>

<tr>
<td>bar</td>
<td>bar</td>
</tr>

<tr>
<td>baz</td>
<td>baz</td>
</tr>

<tr>
<td>bar</td>
<td>zap</td>
</tr>

<tr>
<td>bar</td>
<td> </td>
</tr>

<tr>
<td>zap</td>
<td> </td>
</tr>

<tr>
<td>foo</td>
<td> </td>
</tr>

<tr>
<td>baz</td>
<td> </td>
</tr>
</tbody>
</table>
<p>
You’ll note that the order of the remaining lines stays the same, so this
isn’t simply <code>C-u M-| sort -u</code>….
</p>
</div>
</div>
<div id="outline-container-orgcacb5a2">
<h4 id="orgcacb5a2">Sorting Lines</h4>
<div id="text-orgcacb5a2">
<p>
Emacs has a powerful set of commands that sort lines, distinguished by how they
interpret the sort field.
</p>

<p>
The simplest is   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Sorting"><code>sort-lines</code></a>﻿, which uses the entire line as the
sort field.    <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Sorting"><code>sort-fields</code></a>﻿ sorts based on whitespace-separated
fields within the line; use a numeric argument to specify which field; the
default is 1.    <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Sorting"><code>sort-numeric-fields</code></a>﻿ works the same way, but
interprets the contents of the sort fields numerically.  In both cases, if you
specify a negative field number, it means to count the fields from the <i>right</i>, so
<code>C-u -1</code> would sort on the last field in each line.
</p>

<p>
Here are some examples.  In column one of Table <a href="#org61ea0d4">41</a>, I generated 10
random words and paired them with 10 random numbers.  Columns 2-4 illustrate
different sorts.
</p>
<table id="org61ea0d4">


<colgroup>
<col/>

<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Random</th>
<th scope="col"><code>sort-lines</code></th>
<th scope="col"><code>C-u 2 sort-fields</code></th>
<th scope="col"><code>sort-numeric-fields</code></th>
</tr>

<tr>
<th scope="col"> </th>
<th scope="col"><code>sort-fields</code></th>
<th scope="col"> </th>
<th scope="col"><code>C-u 1 sort-numeric-fields</code></th>
</tr>

<tr>
<th scope="col"> </th>
<th scope="col"><code>C-u 1 sort-fields</code></th>
<th scope="col"> </th>
<th scope="col"> </th>
</tr>
</thead>
<tbody>
<tr>
<td>16 honkers</td>
<td>16 honkers</td>
<td>34 France</td>
<td>2  err</td>
</tr>

<tr>
<td>39 oysters</td>
<td>2  err</td>
<td>5  Madge</td>
<td>3  cuddling</td>
</tr>

<tr>
<td>99 disheartening</td>
<td>3  cuddling</td>
<td>59 corny</td>
<td>5  Madge</td>
</tr>

<tr>
<td>5  Madge</td>
<td>34 France</td>
<td>45 cranks</td>
<td>16 honkers</td>
</tr>

<tr>
<td>2  err</td>
<td>39 oysters</td>
<td>3  cuddling</td>
<td>34 France</td>
</tr>

<tr>
<td>3  cuddling</td>
<td>45 cranks</td>
<td>99 disheartening</td>
<td>39 oysters</td>
</tr>

<tr>
<td>59 corny</td>
<td>5  Madge</td>
<td>2  err</td>
<td>45 cranks</td>
</tr>

<tr>
<td>57 huskiest</td>
<td>57 huskiest</td>
<td>16 honkers</td>
<td>57 huskiest</td>
</tr>

<tr>
<td>45 cranks</td>
<td>59 corny</td>
<td>57 huskiest</td>
<td>59 corny</td>
</tr>

<tr>
<td>34 France</td>
<td>99 disheartening</td>
<td>39 oysters</td>
<td>99 disheartening</td>
</tr>
</tbody>
</table>
<p>
Note that in this example, <code>sort-lines</code> would happen to be the same as
<code>sort-fields</code>, which is also the same as <code>C-u 1 sort-fields</code>.  In column 3, France
comes first because the sorting functions all work case-sensitively, and
upper-case letters precede lower-case letters.  <code>sort-numeric-fields</code> is the same
as <code>C-u 1 sort-numeric-fields</code>.
</p>

<p>
All of these sorts are what programmers call <a href="https://en.wikipedia.org/wiki/Sorting_algorithm#Stability"><i>stable sorts</i></a>: that is, the
relative order of records with equal keys is maintained.  This means you can
sort a Region again to achieve a sub-sort.
</p>

<p>
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Sorting"><code>sort-columns</code></a>﻿ lets you indicate the sort field as a rigid range
of (single-character) columns.  You do this by effectively defining the sort
fields via a <a href="#orgf8d8a5e">Rectangle</a>: the upper-left-hand corner of the rectangle determines
the starting column the sort field, the width of the Rectangle in characters
determines the its width, and the height of the Rectangle in lines determines
the range of lines to sort.
</p>

<p>
Consider this (slightly modified) excerpt from the table of contents of the
Emacs Manual.  We want to sort these lines by the heading (e.g. “Basic Undo”),
ignoring the summary descriptions.  We can’t use <code>sort-lines</code> because the numbers
will result in no change to the order.  We can’t use <code>C-u 2 sort-fields</code> because
some of the headings are two words long and some aren’t: we want “Basic Help” to sort before
“Basic Undo”, but <code>sort-fields</code> is sorting <i>only</i> on the second field, so all the
“Basic”’s will retain their relative order, due to the stability of the sort.
</p>
<pre id="orga7ba32d">1 Erasing::             Deleting and killing text.
2 Basic Undo::          Undoing recent changes in the text.
3 Basic Help::          Asking what a character does.
4 Basic Files::         Visiting, creating, and saving files.
5 Blank Lines::         Making and deleting blank lines.
6 Position Info::       What line, row, or column is point on?
7 Arguments::           Numeric arguments for repeating a command N times.
8 Repeating::           Repeating the previous command quickly.
9 Continuation Lines::  How Emacs displays lines too wide for the screen.
</pre>
<p>
The solution is to set the Mark in front of “Erasing” and Point in front of
“How” on line 9, defining a Rectangle that encompasses the entire width of the
columns we want to use as the sort field.  Now   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Sorting"><code>sort-columns</code></a>﻿ will
sort the lines correctly, resulting in:
</p>
<pre id="orgad58a61">7 Arguments::           Numeric arguments for repeating a command N times.
4 Basic Files::         Visiting, creating, and saving files.
3 Basic Help::          Asking what a character does.
2 Basic Undo::          Undoing recent changes in the text.
5 Blank Lines::         Making and deleting blank lines.
9 Continuation Lines::  How Emacs displays lines too wide for the screen.
1 Erasing::             Deleting and killing text.
6 Position Info::       What line, row, or column is point on?
8 Repeating::           Repeating the previous command quickly.
</pre>
</div>
<div id="outline-container-org68f6623">
<h5 id="org68f6623">Ignoring Case Distinctions</h5>
<div id="text-org68f6623">
<p>
I mentioned that the sort commands are case-sensitive, which is why France comes
first in the <code>C-u 2 sort-fields</code> example above.  You can sort in a
case-insensitive manner as well, but it’s a little awkward: you have to change
the variable   <code>sort-fold-case</code> from its default of <code>nil</code> to <code>t</code>:
</p>
<pre>M-x set-variable RET sort-fold-case RET t
</pre>

<p>
You’ll have to remember to change it back to <code>nil</code> unless you’re happy with
case-insensitive sorting for the rest of your session.  If you like, you could
make that variable <a href="#org871902b">Buffer Local</a> before changing it, with
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Locals"><code>make-variable-buffer-local</code></a>﻿.
</p>
</div>
</div>
<div id="outline-container-orgef164c0">
<h5 id="orgef164c0">Reversing Lines</h5>
<p>
You may have noticed that there seems to be no way to sort in reverse order, and
you’re right.  But you can always just reverse the order of all the lines you
just sorted with   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Sorting"><code>reverse-region</code></a>﻿.  <code>reverse-region</code> can of course
also be used on unsorted lines.
</p>
</div>
</div>
<div id="outline-container-orgd967049">
<h4 id="orgd967049">Numbering Lines</h4>
<p>
  <code>linum-mode</code> and   <code>global-linum-mode</code>
display line numbers in the <a href="#org2f7933b">Fringe</a>, but you may need to occasionally actually
insert line numbers into your text.  We’ve already discussed two ways to do
this: using a counter in a <a href="#org4e40ec5">Keyboard Macro</a>, or using
    <code>C-x r N</code> (<code>rectangle-number-lines</code>), which is usually easier:
see <a href="#orgf8d8a5e"><i>Rectangles</i></a>.
</p>
</div>
<div id="outline-container-orgec0da97">
<h4 id="orgec0da97">Whitespace and Blank Lines <a id="org116f70d"></a></h4>
<div id="text-orgec0da97">
<p>
Whitespace and blank (empty) lines are a common feature of most Buffers.
<i>Whitespace</i> encompasses several distinct but easily confused characters, most
notably the space (<a href="#org7997c3f">ASCII</a> 32 or #x20) and tab (<code>C-i</code>, ASCII 9 or #x09).  Those two
are confusing enough already without throwing in the <a href="#org45c89bb">formfeed</a> (<code>C-l</code>, ASCII 12 or
#x0C) and the little known <i>vertical tab</i> (<code>C-k</code>, ASCII 11 or #x0B).  The newline
(<code>C-j</code>, ASCII 10 or #x0A) and carriage return (<code>C-m</code>, ASCII 13 or #x0D), the two
possible line terminators, also count as whitespace in some contexts.  And then
there are all the Unicode whitespace characters, like the en and em spaces, the
thin and hair spaces, and the whole family of <a href="#org80c565b">non-breaking spaces</a>!
</p>

<p>
The mere visibility of these characters and how to distinguish them on the
screen is <a href="#orgf0ba624">its own topic</a>.
</p>

<p>
It’s no wonder there are several commands for dealing with whitespace; see also
the related topic of <a href="#org890316d"><i>Filling and Indenting</i></a>.
</p>
</div>
<div id="outline-container-org083bff9">
<h5 id="org083bff9">Tabs vs. Spaces <a id="orgfe6844c"></a></h5>
<div id="text-org083bff9">
<p>
Inserting a space is as simple as hitting the space bar (<code>SPC</code>), but how do you
insert a tab character?  It’s not as simple as hitting the tab key, because <code>TAB</code>
is typically bound to a special command for indenting lines; even in
  <code>fundamental-mode</code> it’s bound to
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Indentation"><code>indent-for-tab-command</code></a>﻿.  The guaranteed way to insert a
single, actual, tab is via     <code>C-q</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Inserting-Text"><code>quoted-insert</code></a>﻿) followed by
the <code>TAB</code> key (see <a href="#org244f9ee"><i>Inserting Non-Printing Characters</i></a>).
</p>

<p>
Probably more common than needing to insert a guaranteed tab is needing to
remove them.  Tabs often cause problems in data files and source code for
languages that are especially picky about indentation<sup><a id="fnr.252" href="#fn.252" role="doc-backlink">252</a></sup>.  Of course it’s
easy to change each tab to one space with
    <code>M-%</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Query-Replace"><code>query-replace</code></a>﻿), but what if you want to preserve the
relative horizontal spacing?  The   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Just-Spaces"><code>untabify</code></a>﻿ command will replace
all the tabs in the region with one or more spaces, preserving the horizontal
spacing.  That is, any given tab will display as one or more spaces to expand to
the next <a href="#orgebe89a2">tab stop</a>; <code>untabify</code> reifies each tab into as many actual spaces as it
takes to reach the same tab stop.
</p>

<p>
If you’re confused, or just never understood that <a href="https://en.wikipedia.org/wiki/Silicon_Valley_(TV_series)"><i>Silicon Valley</i></a> episode, see
<a href="https://www.jwz.org/doc/tabs-vs-spaces.html">Jamie Zawinski’s explanation</a>.
</p>
</div>
</div>
<div id="outline-container-orgc8482ca">
<h5 id="orgc8482ca">Horizontal Whitespace</h5>
<div id="text-orgc8482ca">
<p>
Sometimes your Buffer will contain several horizontal whitespace characters in a
row, like 5 spaces or a space and a tab.  There are two handy ways to get rid of
the excess.    <code>M-\</code> eliminates <i>all</i> the
whitespace around Point, while     <code>M-SPC</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Deletion"><code>just-one-space</code></a>﻿)
replaces it all with just one actual space character (with a numeric Arg, it
replaces them with exactly that many spaces).  Note that these two commands only treat
in spaces and tabs, but not any of the more exotic whitespace characters like
formfeeds and non-breaking spaces.
</p>

<p>
If you’re like me and consider <i>trailing whitespace</i>—i.e., whitespace
characters following the last non-whitespace character on a line—to be, in
general, an intolerable offense, you can rid yourself of all of these within
the Region with   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Useless-Whitespace"><code>delete-trailing-whitespace</code></a>﻿.  This command works
on all horizontal whitespace characters except formfeeds.<sup><a id="fnr.253" href="#fn.253" role="doc-backlink">253</a></sup>
</p>
</div>
</div>
<div id="outline-container-org354b9d1">
<h5 id="org354b9d1">Blank Lines</h5>
<div id="text-org354b9d1">
<p>
Blank lines and empty lines also have some handy commands.  You can of course
create a new empty line by hitting     <code>RET</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Inserting-Text"><code>newline</code></a>﻿) a few times; this takes
the usual numeric Arg so you can insert, say, four new lines with <code>C-u RET</code> or
seven with <code>C-u 7 RET</code>.  This leaves Point after the last newline.  Sometimes you
want Point to be <i>before</i> the new newlines, which is what
    <code>C-o</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Blank-Lines"><code>open-line</code></a>﻿) is for.  It’s especially useful for working
with <a href="#orgf8d8a5e">Rectangles</a>, <a href="#orgd014c8d">Picture Mode, and Artist Mode</a>, where you need a big block of
blank lines in which you can do two-dimensional things.
</p>

<p>
    <code>C-x C-o</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Blank-Lines"><code>delete-blank-lines</code></a>﻿) is the inverse of <code>C-o</code>: when
Point is in the middle of a bunch of consecutive blank lines, <code>C-x C-o</code> reduces
them to just one blank line; an additional <code>C-x C-o</code> removes that remaining blank
line too.
</p>

<p>
What’s the difference between a <i>blank</i> line and an <i>empty</i> line, exactly?  An empty
line is what you get when you have two newlines in a row: to be precise, two
newlines with an empty string between them.  A blank line is two newlines with
nothing but zero or more whitespace characters between them.  So a line full of
nothing but spaces and tabs is a blank line, but not an empty line.
</p>

<p>
There’s a variant of <code>C-o</code> that splits a line in two, vertically rather than
linearly:     <code>C-M-o</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Indentation-Commands"><code>split-line</code></a>﻿).  Here Point is represented by <code>|</code>:
</p>
<pre>Lorem ipsum dolor sit amet, |consectetuer adipiscing elit.
</pre>

<p>
The result of a <code>C-M-o</code> would be:
</p>
<pre>Lorem ipsum dolor sit amet, |
                             consectetuer adipiscing elit.
</pre>


<p>
    <code>M-^</code> (<code>join-line</code>) (a.k.a. <code>delete-indentation</code>) joins the current
line (containing Point) to the end of the previous line, regardless of Point’s
exact location in the current line.  It ensures that there will be one space
between the joined lines; Point is positioned at that space (which you could
immediately eliminate with <code>M-\</code>).
</p>

<p>
This all means that if you repeatedly invoke <code>M-^</code>, it will join together several
previous lines, going backwards.  So if Point is in front of “baz”:
</p>
<pre id="org0062469">foo
bar
|baz
</pre>
<p>
two <code>M-^</code>’s will result in:
</p>
<pre id="orgb6f2d1f">foo| bar baz
</pre>
</div>
</div>
</div>
<div id="outline-container-org7d353f4">
<h4 id="org7d353f4">Indenting Lines <a id="org29e8ff7"></a></h4>
<div id="text-org7d353f4">
<p>
Indentation—that is, the presence or absence of whitespace at the beginning of a
line—is an annoyingly complex topic.  Fortunately, it’s less complex than it
used to be decades ago, but Emacs of course still supports all the old-school
complexity.  I think we can ignore most it!
</p>

<p>
Indentation is primarily a concern when you’re editing structured text:
programming languages, like Elisp or Python; data interchange languages, like
<a href="https://en.wikipedia.org/wiki/Json">JSON</a>; or <a href="https://en.wikipedia.org/wiki/Markup_language">markup languages</a>, like HTML and Latex.  Emacs has a <a href="#org5b21ef0">Major Mode</a>
for almost every such language you might need to work with, and these Modes
understand the indentation requirements or conventions and handle it for you.
Mostly, it boils down to this: just hit   <code>TAB</code> (wherever you may be
in the line) to indent the current line correctly.
</p>

<p>
The topic is most complex when you’re editing prose in a Major Mode like
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Text-Mode"><code>text-mode</code></a>﻿.  But who edits plain text prose anymore?
Decades ago I used <code>text-mode</code> all the time, but I probably haven’t used it for 10
or more years.  Now I do all my prose in the amazing <a href="#org4a851ca">Org Mode</a>, which uses a form
of structured text that makes straight prose more readable than <code>text-mode</code>, and
yet lets me publish it as plain text, HTML or a PDF<sup><a id="fnr.254" href="#fn.254" role="doc-backlink">254</a></sup> with a keystroke.
And as a structured text mode, Org handles indentation automatically: I just hit
<code>TAB</code>.
</p>

<p>
So the only kind of indenting I’m going to discuss here is <i>rigid indentation</i>,
which you may occasionally need to do in any random mode.  The main command is
    <code>C-x TAB</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Indentation-Commands"><code>indent-rigidly</code></a>﻿): just set the <a href="#org34ab2da">Region</a> around a bunch
of lines, and <code>C-x TAB</code> will prompt you:
</p>
<pre>Indent region with &lt;left&gt;, &lt;right&gt;, S-&lt;left&gt;, or S-&lt;right&gt;.
</pre>

<p>
You’re in a transient mode for as long as you hit any unbroken sequence of the
mentioned keystrokes; typing any other key will exit the mode (and do whatever
that other key is supposed to do).
</p>

<p>
<code>&lt;right&gt;</code> and <code>&lt;left&gt;</code> will indent or <i>dedent</i>, respectively, the whole block of lines
one column at a time.  The shifted versions will move in larger jumps of 8
columns at a time.<sup><a id="fnr.255" href="#fn.255" role="doc-backlink">255</a></sup> With a positive or negative <a href="#orgb0f6ffd">numeric argument</a>, it will
increase or decrease the indentation by exactly that many characters.  The
related command   <code>C-M-\</code> (  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Indentation-Commands"><code>indent-region</code></a>﻿),
with a numeric argument, will re-indent all the lines in the Region to the
column indicated by the argument: <code>C-u 12 C-M-\</code> will leave you with all the lines
indented 12 spaces from the left, regardless of how much each line was already
indented.
</p>

<p>
The command     <code>M-m</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Indentation-Commands"><code>back-to-indentation</code></a>﻿) conveniently moves
Point to the first non-whitespace character on the line: it’s like a
  <code>C-a</code> for indented lines.
</p>
</div>
</div>
<div id="outline-container-org9448bdf">
<h4 id="org9448bdf">Tabs and Tab Stops <a id="orgebe89a2"></a></h4>
<div id="text-org9448bdf">
<p>
In many Major Modes,   <code>TAB</code> is bound to
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Indentation"><code>indent-for-tab-command</code></a>﻿, which typically<sup><a id="fnr.256" href="#fn.256" role="doc-backlink">256</a></sup> causes Emacs to
insert enough whitespace to move Point to the next <i>tab stop</i>.  A tab stop is one
of a set of specific column numbers or horizontal positions, the idea being to
use them to line your text up in columns.
</p>

<p>
If there are no explicit tab stops defined, the default is every 8
columns.<sup><a id="fnr.257" href="#fn.257" role="doc-backlink">257</a></sup>  You can define tab stops at arbitrary positions (for the
current Buffer) by invoking   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Tab-Stops"><code>edit-tab-stops</code></a>﻿.
</p>

<p>
Frankly, tab stops are not much used anymore, because, as mentioned above,
people tend to use markup languages instead of manually laying out plain text.
So I’ll say no more on this topic.
</p>

<p>
However, since TAB characters cause problems—they’re hard to distinguish from
runs of spaces, their displayed width varies depending on the tab stops so they
can seem to have different widths to different people, and their presence can
confuse certain programs—I recommend telling Emacs never to implicitly insert them, and
to always use runs of spaces instead; this <a href="#org2af3730">Init File</a> snippet does that.  Because
EIPNIF, you can of course always insert a real tab with <code>C-q TAB</code>.
</p>
<div>
<pre>(<span>setq-default</span> indent-tabs-mode nil)      <span>; </span><span>don&#39;t insert tabs</span>
</pre>
</div>
<p>
Since you might encounter tabs in a file authored by someone else, you can
readily convert all tabs in the Region to equivalent runs of spaces with
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Just-Spaces"><code>untabify</code></a>﻿; the inverse (rarely needed) is   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Just-Spaces"><code>tabify</code></a>﻿.
</p>
</div>
</div>

<div id="outline-container-org88fb99c">
<h4 id="org88fb99c">Case Changing</h4>
<div id="text-org88fb99c">
<p>
There are three ways to change the case of your alphabetic text: converting it
to all-uppercase, to all-lowercase, and to capitalize the first letter of each
word.  There are two modes of invoking these case changes: by word or by region.
</p>
<table>


<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col"> </th>
<th scope="col">Word</th>
<th scope="col">Region</th>
</tr>
</thead>
<tbody>
<tr>
<td>Upcase</td>
<td><code>M-u</code> (​<code>upcase-word</code>​)</td>
<td><code>C-x C-u</code> (​<code>upcase-region</code>​)</td>
</tr>

<tr>
<td>Downcase</td>
<td><code>M-l</code> (​<code>dowcase-word</code>​)</td>
<td><code>C-x C-l</code> (​<code>downcase-region</code>​)</td>
</tr>

<tr>
<td>Capitalize</td>
<td><code>M-c</code> (​<code>capitalize-word</code>​)</td>
<td><code>M-x capitalize-region</code></td>
</tr>
</tbody>
</table>
<p>
The by-word commands change the case of the next word (leaping over intervening
non-alphabetic characters), or with a prefix arg, the next \(N\) words (a negative
argument works backwards); Point moves across each converted word.  So you can
upcase the next several words in a row with repeated invocations of <code>M-u</code>, for example.
</p>

<p>
The by-region commands operate on the Region without moving Point.  Note that
<code>upcase-region</code> and <code>downcase-region</code> are <a href="#org46fc1c3">Disabled</a> by default, just because
beginners, who aren’t comfortable with how easy it is to <a href="#org3f93c8e">Undo</a> changes, are often
disturbed when they accidentally change the text of their entire thesis to all
uppercase.
</p>
</div>
</div>
<div id="outline-container-org0fc6708">
<h4 id="org0fc6708">Tables</h4>
<div id="text-org0fc6708">
<p>
Emacs has a powerful set of commands for creating and editing plain-text
tables.  Here’s a plain-text version of the Verlaines discography from <a href="https://en.wikipedia.org/wiki/The_Verlaines">Wikipedia</a>:
</p>
<pre id="org6dfaf6e">+-------+------------+----------------+-------+-------------+--------+
|Date of|Title       |Label           |Charted|Certification|Catalog |
|Release|            |                |       |             |Number  |
+-------+------------+----------------+-------+-------------+--------+
|1985   |Hallelujah  |Flying          |-      |-            |FN040 / |
|       |All the     |Nun/Homestead   |       |             |HMS138  |
|       |Way Home    |                |       |             |        |
+-------+------------+----------------+-------+-------------+--------+
|1987   |Bird Dog    |Flying          |-      |-            |FN077 / |
|       |            |Nun/Homestead   |       |             |HMS095  |
+-------+------------+----------------+-------+-------------+--------+
|1987   |Juvenilia   |Flying Nun      |-      |-            |FN COMP |
|       |            |                |       |             |02      |
+-------+------------+----------------+-------+-------------+--------+
|1989   |Some        |Flying          |-      |-            |FN129 / |
|       |Disenchanted|Nun/Homestead   |       |             |HMS162  |
|       |Evening     |                |       |             |        |
+-------+------------+----------------+-------+-------------+--------+
|1991   |Ready to Fly|Slash           |-      |-            |C30718  |
+-------+------------+----------------+-------+-------------+--------+
|1993   |Way Out     |Slash           |-      |-            |D31032  |
|       |Where       |                |       |             |        |
+-------+------------+----------------+-------+-------------+--------+
|1996   |Over the    |Columbia        |-      |-            |486880.2|
|       |Moon        |                |       |             |        |
+-------+------------+----------------+-------+-------------+--------+
|2003   |You&#39;re Just |Flying Nun      |-      |-            |FNCD476 |
|       |Too Obscure |                |       |             |        |
|       |for Me      |                |       |             |        |
+-------+------------+----------------+-------+-------------+--------+
|2007   |Pot Boiler  |Flying Nun      |-      |-            |FNCD501 |
+-------+------------+----------------+-------+-------------+--------+
|2009   |Corporate   |Dunedinmusic.com|-      |-            |        |
|       |Moronic     |                |       |             |        |
+-------+------------+----------------+-------+-------------+--------+
|2012   |Untimely    |Flying Nun      |-      |-            |FNCD524 |
|       |Meditations |                |       |             |        |
+-------+------------+----------------+-------+-------------+--------+
|2020   |Dunedin     |Schoolkids      |-      |-            |SMR-060 |
|       |Spleen      |Records         |       |             |        |
+-------+------------+----------------+-------+-------------+--------+
</pre>
<p>
I created this by simply cut-and-pasting the Wikipedia table from the web page,
which results, in my Buffer, in one line per row, with columns separated by tab
characters.  I set the Region around this and invoked
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Table-Conversion"><code>table-capture</code></a>﻿ and got the result you see above.
</p>

<p>
There are commands to split, merge, enlarge, and shrink cells, edit easily
within a multi-line cell, justify cell contents, insert and delete rows and
columns: it’s very powerful.
</p>

<p>
The only question is, who needs attractive plain-text tables now that most
documents are “typeset” from a markup language like LaTeX or <a href="#org4a851ca">Org Mode</a>?  Org
Mode, in fact, has its own powerful markup for tables which in my opinion is
much nicer to use—it’s in many ways more powerful<sup><a id="fnr.258" href="#fn.258" role="doc-backlink">258</a></sup>, though these
plain-text tables are probably easier for multi-line cells.
</p>

<p>
The main use, nowadays, for this facility is probably for programmers who want
to insert plain-text tables into comments in programming language source code.
If you need these, see <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Text-Based-Tables">“Text Based Tables”</a> in the <i>Emacs</i> manual.
</p>
</div>
</div>

</div>

<div id="outline-container-org71fb38c">
<h3 id="org71fb38c">Folding Text <a id="org707bf87"></a></h3>
<p>
It can be very useful to <a href="https://en.wikipedia.org/wiki/Folding_editor"><i>fold</i></a> or collapse some of your text in order to
ignore or to focus on certain parts, or to get an outline-like high-level overview.
Emacs provides several subsystems to do this.  They can be divided into two
categories: one in which you must explicitly impose an outline- or tree-like
markup to your text ahead of time, and the other which recognizes and folds text
based on its implicit structure.
</p>
<div id="outline-container-org82844ce">
<h4 id="org82844ce">Markup-Based Folding</h4>
<div id="text-org82844ce">
<p>
Emacs has had markup-based folding since the very beginning in the form of
Outline Mode; it’s basically Text Mode plus extremely simple markup to express
your text in the form of an outline, which brings the ability to fold and unfold
the headlines of the outline.
</p>

<p>
Outline Mode has additional commands to navigate by headline, and move headlines
(and their folded components) up or down, or in and out (demoting or promoting
them, headline-wise).
</p>

<p>
It’s a big payoff for such a trivial amount of markup.  But for most Emacsers,
Outline Mode has been rendered obsolete by Org Mode.
</p>

<p>
Org Mode is like Outline Mode on steroids: it does exactly what Outline Mode
does, with the same markup, but adds hundreds of additional features.  If you
think Outline Mode sounds useful, just skip directly to Org Mode instead: it’ll
be an improvement even if you aren’t interested in its extra features.
</p>

<p>
Org Mode gets an entire chapter to itself; see <a href="#org4a851ca"><i>Org Mode</i></a> for details.
</p>
</div>
</div>
<div id="outline-container-org150678f">
<h4 id="org150678f">Implicit Folding</h4>
<p>
The problem with markup-based folding is of course the markup.  But lots of text
has implicit structure that Emacs can exploit for folding without your having to
add any.  Most programming languages, for example, have an implicit tree
structure eminently suitable for folding.  But even simple indentation can be
used for folding purposes.
</p>
<div id="outline-container-orgfba68e9">
<h5 id="orgfba68e9">Hideshow Minor Mode</h5>
<div id="text-orgfba68e9">
<p>
Hideshow Minor Mode is the high-level built-in mechanism for implicit folding.
When enabled, you can fold function definitions in the source code of many
programming languages.  Consider this Python function from <a href="https://en.wikipedia.org/wiki/Python_syntax_and_semantics">Wikipedia</a>:
</p>

<div>
<pre><span>def</span> <span>qsort</span>(L):
    <span>if</span> L == []:
        <span>return</span> []
    pivot = L[0]
    <span>return</span> (qsort([x <span>for</span> x <span>in</span> L[1:] <span>if</span> x &lt; pivot]) +
            [pivot] +
            qsort([x <span>for</span> x <span>in</span> L[1:] <span>if</span> x &gt;= pivot]))
</pre>
</div>
<p>
With Point anywhere in the definition, you can fold it with one keystroke into
this:
</p>

<p>
Note the ellipsis <code>...</code> at the end of the line, which indicates the presence of
hidden folded text under this line (the dots are just for display and are
not actually actually added to your text).
Motion commands will skip over the ellipsis as if it were one character wide.
</p>

<p>
As with all the Emacs text folding subsystems, the invisible text is still
there: you can search into it (which will unfold it), and if you copy a region
that includes the folded text, the copied text contains all the hidden text as
well; if you save the Buffer’s file when some of the text is folded, you are of
course saving all the hidden text as well, and there’s no indication in the file
that the text was folded (the next time you open the file, all your text will be
there, unfolded).
</p>

<p>
You can unfold anything you’ve folded, and you can also fold and unfold all the
top-level functions in one go.  A Buffer consisting of hundreds of lines of
code, when completely folded, would look something like:
</p>
<div>
<pre><span>def</span> <span>writable</span>(path):...
<span>def</span> <span>myurlopen</span>(url, count = 0):...
<span>def</span> <span>httpopen</span>(scheme, hostport, path, parms, query, frag, count = 0):...

<span>def</span> <span>snarf</span>(url, clone):...
<span># </span><span>checkout a locked version from rcs</span>
<span>def</span> <span>co</span>(clone):...
<span># </span><span>checkin (ci -l)</span>
<span>def</span> <span>ci</span>(clone):...
</pre>
</div>
<p>
Truth be told, I don’t like Hideshow.  For one thing, the default keybindings
are just unusable.  But this being Emacs, that’s easily fixed.  The bigger
problem is that it doesn’t work very well.  It seems to work fine in
  <code>python-mode</code>, but in   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/ccmode/Introduction"><code>c-mode</code></a>﻿ it does a
bad job of recognizing function definitions, and it doesn’t work at all for my
favorite (non-Lisp) programming language, <a href="https://ocaml.org/">OCaml</a> (which has an admittedly very
free-form syntax).  This is why I use the third-party library <a href="#orgf58080b">Yafolding</a> instead;
see below.
</p>

<p>
See <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Hideshow">“Hideshow”</a> in the <i>Emacs</i> manual for more information.  If you want to use
it, try this <a href="#org2af3730">Init File</a> snippet that adds two usable key bindings for the most
commonly used commands:
</p>
<div>
<pre><span>;; </span><span>Hideshow for folding in programming modes</span>
(add-hook &#39;prog-mode-hook &#39;hs-minor-mode)

<span>;; </span><span>from: Joseph Eydelnant</span>
(<span>defvar</span> <span>ue-hs-hide</span> nil <span>&#34;Current state of hideshow for toggling all.&#34;</span>)
(<span>defun</span> <span>ue-toggle-hideshow-all</span> ()
  <span>&#34;Toggle hideshow all.&#34;</span>
  (<span>interactive</span>)
  (<span>setq</span> ue-hs-hide (not ue-hs-hide))
  (<span>if</span> ue-hs-hide
      (hs-hide-all)
    (hs-show-all)))

<span>;; </span><span>add usable key bindings</span>
(<span>with-eval-after-load</span> &#39;hideshow
  <span>;; </span><span>toggle hiding this block</span>
  (define-key hs-minor-mode-map (kbd <span>&#34;C-&lt;return&gt;&#34;</span>) &#39;hs-toggle-hiding)
  <span>;; </span><span>toggle hiding all blocks in buffer</span>
  (define-key hs-minor-mode-map (kbd <span>&#34;C-M-&lt;return&gt;&#34;</span>) &#39;ue-toggle-hideshow-all))
</pre>
</div>
</div>
</div>
<div id="outline-container-org884dfb9">
<h5 id="org884dfb9">Yafolding Mode <a id="orgf58080b"></a></h5>
<div id="text-org884dfb9">
<p>
Zeno Zeng’s Yafolding Mode is the package I prefer for folding text.  It works
great in every programming language I’ve tried, including OCaml with its nested
function definitions expressed without any braces, because it just works based
on indentation, which almost all programmers use consistently.
</p>

<p>
I only use two of its commands:
    <code>C-&lt;return&gt;</code> (<code>yafolding-toggle-element</code>) to toggle the folding
of the “element” (typically a function definition) at Point, and
    <code>C-M-&lt;return&gt;</code> (<code>yafolding-toggle-all</code>) to toggle the folding of
every element in the Buffer.  This Init File snippet will set it up:
</p>
<div>
<pre>(<span>unless</span> (package-installed-p &#39;yafolding)
  (<span>with-demoted-errors</span> <span>&#34;%s&#34;</span>
    (<span>unless</span> package-archive-contents
      (package-refresh-contents))
    (package-install &#39;yafolding)))
(add-hook &#39;prog-mode-hook
          (<span>lambda</span> () (<span>with-demoted-errors</span> <span>&#34;%s&#34;</span> (yafolding-mode +1))))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgea88240">
<h5 id="orgea88240">Selective Display</h5>
<div id="text-orgea88240">
<p>
The simplest, but lowest level, text folding command is
    <code>C-x $</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Selective-Display"><code>set-selective-display</code></a>﻿).  It’s very old, and Yafolding
does the same thing in a much friendlier manner.  But for reasons of historical
interest, here’s how Selective Display works.
</p>

<p>
Given a numeric argument of \(N\), <code>C-x $</code> folds all lines that are indented more
than \(N\) spaces.  Suppose your Buffer contains this simple outline-like text:
</p>
<pre id="orge29781e">Folding Text
  Markup-Based Folding
    Outline Mode
    Org Mode
  Implicit Folding
    selective display
    Hide / Show Minor Mode
    3rd-party
      yafolding
</pre>
<p>
These lines are indented in steps of two, with the first line not indented at
all.  So <code>C-u 1 C-x $</code> would hide all lines but the first:
</p>
<pre id="orgbf2c5f5">Folding Text...
</pre>
<p>
To unfold and reveal all your text, invoke <code>C-x $</code> without any argument.
</p>

<p>
Line-based motion commands like <code>C-n</code>, <code>C-p</code>, <code>&lt;up&gt;</code>, and <code>&lt;down&gt;</code> skip over the folded
text, but other commands will move into it, including searching.  If you find
yourself lost in the folded text, just unfold it.
</p>

<p>
If you invoke <code>C-u 3 C-x $</code> it will hide all the lines with indentation of 3 or
more spaces:
</p>
<pre id="org0556c4f">Folding Text
  Markup-Based Folding...
  Implicit Folding...
</pre>

<p>
Having to count the spaces in the indentation is an awkward step.  This
alternative function automates the process.  If you like it, you can use it to
replace the standard command with:
</p>
<pre>(global-set-key [remap set-selective-display] &#39;ue-auto-selective-display)
</pre>

<p>
but it’s really just a poor man’s Yafolding.
</p>

<div>
<pre>(<span>defun</span> <span>ue-auto-selective-display</span> (arg)
  <span>&#34;Hide lines with greater indentation than this one.</span>
<span>With a prefix ARG, reveal all lines.</span>

<span>This function simply sets `</span><span>selective-display</span><span>&#39;.&#34;</span>
  (<span>interactive</span> <span>&#34;P&#34;</span>)
  (<span>if</span> arg
      (<span>setq</span> selective-display nil)
    (<span>save-match-data</span>
      (<span>save-excursion</span>
        (forward-line 0)
        (<span>if</span> (looking-at (<span>rx</span> (+ space)))
            (<span>setq</span> selective-display (1+ (length (match-string 0))))
          (<span>setq</span> selective-display 1))))))
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-orga19d683">
<h3 id="orga19d683">International Character Set Support <a id="org5f6b09d"></a></h3>
<div id="text-orga19d683">

<div id="org2a7df46">
<p><a href="https:./images/hello.png" alt="=M-x view-hello-file= (=C-h h=)" title="=M-x view-hello-file= (=C-h h=)" width="100%"><img src="https://blog.veitheller.de/images/hello.png" alt="=M-x view-hello-file= (=C-h h=)" title="=M-x view-hello-file= (=C-h h=)" width="100%"/></a>
</p>
<p><span>Figure 45: </span><code>M-x view-hello-file</code> (<code>C-h h</code>)</p>
</div>

<p>
Emacs has very sophisticated support for international languages and the
character sets and encodings used to represent them.  This is one of the more
complex Emacs topics: there are 23 pages devoted to it in the manual and I
won’t attempt to cover all of it here.  I’ll describe the most useful facilities
for a mostly-monolingual Emacs user, from my perspective as an English speaker.
</p>

<p>
In the earliest days of computing, the only characters you could use were the
upper case Latin alphabetics, the base 10 digits, and a handful of punctuation
characters.  Pretty quickly, non-English speakers and users of non-Latin
alphabets, syllabaries, and logographies—various <i>scripts</i>—defined their own
mutually incompatible character sets, and a Tower of Babel reigned.
</p>

<p>
You would think that, since the polyglot <a href="https://en.wikipedia.org/wiki/Unicode">Unicode</a> is now the standard, with its
support for 160-odd historical and modern scripts and over 150,000 characters,
symbols, and emojis, there would be no need to handle any other character sets,
but in addition to legacy data, Unicode is not yet completely dominant.  In
particular, users of Chinese, Japanese, Korean, and Cyrillic scripts still use
non-Unicode character sets for various reasons.  While most text editors support
Unicode, they may <i>only</i> support Unicode (and sometimes only Unicode’s UTF-8
encoding).
</p>

<p>
Emacs supports 1,071 character sets and
encodings, including Unicode and <a href="https://en.wikipedia.org/wiki/ISO/IEC_2022">ISO-2022</a> (which allows you to switch between
different character sets in a given Buffer or File).  It also handles
bidirectional text: that is, you can combine scripts that are written from right
to left (like Arabic or Hebrew) with text written from left to right (like
English).  For a quick demonstration of all this, invoke
    <code>C-h h</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/International-Chars"><code>view-hello-file</code></a>﻿).
</p>

<p>
Emacs also supports 212 <i>input
methods</i>, which are ways of entering characters that might not have keys on your
keyboard, including both natural language scripts and various types of symbols
(e.g. mathematical).  You can see all of them via
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Select-Input-Method"><code>list-input-methods</code></a>﻿.  The <a href="#orgc96889a">Package Manager</a> has
17 additional input methods.
</p>
</div>
<div id="outline-container-org6caecc6">
<h4 id="org6caecc6">Language Environment</h4>
<div id="text-org6caecc6">
<p>
You can enter or view any kind of text in any script in any Buffer at any time.
That is, you can have, say, Latin, Cyrillic, Hebrew, and Tamil scripts all mixed
together; the buffer popped up by   <code>C-h h</code> is a perfect
example—see Figure <a href="#org2a7df46">45</a>.
</p>

<p>
But Emacs always has a notion of your default <i>language environment</i>.  Normally,
your operating system defines this<sup><a id="fnr.259" href="#fn.259" role="doc-backlink">259</a></sup> and Emacs inherits it.  (If your OS
sets it wrong, or you just prefer a different one for Emacs, you can override
it; see <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Language-Environments">“Language Environments”</a> in the <i>Emacs</i> manual.)  Your language
environment determines which character sets (Emacs calls them
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Coding-Systems"><i>coding systems</i></a>) are assumed as
defaults for the files you create and edit, the script used to represent such
text (and therefore an appropriate font for that script), and a way of
interpreting your keyboard to enter the glyphs that comprise the script.
</p>

<p>
If your OS has declared your correct language environment and you have the
necessary fonts installed, everything in Emacs should work out of the box.
</p>

<p>
You can browse all the language environments with
    <code>C-h L</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Language-Environments"><code>describe-language-environment</code></a>﻿); here’s what you’ll see
if you choose Czech:
</p>
<pre id="org437974d">Czech language environment

This language environment is almost the same as Latin-2,
but sets the default input method to &#34;czech&#34;,
and selects the Czech tutorial.

Sample text:
  Přejeme vám hezký den!

Input methods (default czech)
  czech (&#34;CZ&#34; in mode line)
  czech-prog-3 (&#34;CZ&#34; in mode line)
  czech-prog-2 (&#34;CZ&#34; in mode line)
  czech-prog-1 (&#34;CZ&#34; in mode line)
  czech-qwerty (&#34;CZ&#34; in mode line)

Character sets:
  ascii: ASCII (ISO646 IRV)
  latin-iso8859-2: Right-Hand Part of ISO/IEC 8859/2 (Latin-2): ISO-IR-101

Coding systems:
  iso-8859-2 (‘2’ in mode line):
	ISO 2022 based 8-bit encoding for Latin-2 (MIME:ISO-8859-2).
	(alias: iso-latin-2 iso-8859-2 latin-2)
</pre>
<p>
The most practically useful section of this information is the list of <i>input
methods</i>, which in this case are systematic ways for someone who works primarily
in Czech to enter characters from the Czech script.
</p>
</div>
</div>
<div id="outline-container-org270b962">
<h4 id="org270b962">Inserting the Occasional Funny Character <a id="orgcdb47e9"></a></h4>
<div id="text-org270b962">
<p>
But first let’s discuss the <i>non-systematic</i> way to enter characters: that is,
characters that aren’t a normal part of your spoken language’s script, ones that
you only occasionally need to type.  This includes typographical symbols like
the <i>pilcrow</i> or <i>paragraph symbol</i> ¶, the copyright symbol ©, emojis. and the odd
character from some other language with a different script.  With no disrespect
to natural languages other than your own, I’ll call all of these <i>funny
characters</i>.
</p>

<p>
The easiest way to insert these characters is with
    <code>C-x 8 RET</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Inserting-Text"><code>insert-char</code></a>﻿), which uses <a href="#org75fb6a2">Completion</a> to prompt you
for the name of a Unicode character.  Usually you can just narrow the enormous
list of 45,000-odd candidates by typing words from their official long Unicode
name—the word “paragraph” will narrow the list to 10 different paragraph
symbols, and you’ll see the Pilcrow you want near the elegant Ethiopic Paragraph
Separator.  If you know the Unicode code-point (a hexadecimal number), you can
enter that instead.
</p>

<p>
The <code>C-x 8</code> prefix has a whole slew (close to 200) of other convenient key
bindings to insert common funny characters.  For example, <code>C-x 8 C</code> inserts the
copyright symbol; <code>C-x 8 [</code> and <code>C-x 8 ]</code> insert the left- and right-curly single
quotation marks, etc.  I don’t actually know any of these and just use <code>C-x 8 RET</code> for
everything I need (my completion system puts the ones I use regularly at the top
of the list).  To see the complete list of shortcuts, type <code>C-x 8 C-h</code> (or
    <code>C-h b</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Misc-Help"><code>describe-bindings</code></a>﻿) and search for “C-x 8” in that
Buffer).
</p>
</div>
</div>
<div id="outline-container-org2ff91da">
<h4 id="org2ff91da">Input Methods</h4>
<div id="text-org2ff91da">
<p>
If you’re typing in a language that uses a lot of diacritical marks. like Czech,
or a completely non-Latin script, like Ukrainian, you’ll be typing <code>C-x 8</code> way too
much.  Instead, you want to use an <i>input method</i>.  An input method causes Emacs
to translate the ordinary ASCII characters of your keyboard into non-ASCII characters.
</p>

<p>
Broadly, there are two kinds of input methods.  One kind remaps all (or many) of
your normal keyboard keys, often to match the typical hardware computer keyboard
that would be used by the user of a given language; the input method Emacs calls
<code>ukrainian-computer</code> matches the Ukrainian keyboard in Figure
<a href="#org0fe0daa">46</a>.<sup><a id="fnr.260" href="#fn.260" role="doc-backlink">260</a></sup>
</p>

<div id="org0fe0daa">
<p><a href="https:./images/Keyboard_layout_ua_vista_ext.png" alt="A Ukrainian Keyboard" title="A Ukrainian Keyboard" width="100%"><img src="https://blog.veitheller.de/images/Keyboard_layout_ua_vista_ext.png" alt="A Ukrainian Keyboard" title="A Ukrainian Keyboard" width="100%"/></a>
</p>
<p><span>Figure 46: </span>A Ukrainian Keyboard</p>
</div>

<p>
So to enter the Ukrainian φ character, you would just press the <code>a</code> key, and to
enter the Ukrainian <code>E</code> you press the <code>T</code> key.
</p>

<p>
If Ukrainian is your default language environment, this input method will be
your default.
</p>

<p>
But perhaps you’re an English speaker with a default English language
environment who also speaks Ukrainian and therefore sometimes types large amounts
of Ukrainian text.  To solve this problem, you can change the input method
associated with a given Buffer with
  <code>C-x RET C-\</code>.  After switching away from
your default like this, a simple   <code>C-\</code>
will toggle back and forth between the two; use <code>C-u C-\</code> to change to yet another
input method.
</p>

<p>
Another use for the broad type of input method is to use a non-standard keyboard
layout for your default language environment, like the well-known <a href="https://en.wikipedia.org/wiki/Dvorak_keyboard_layout">Dvorak
kayboard layout</a> for English, regarded as superior to <a href="https://en.wikipedia.org/wiki/QWERTY">QWERTY</a> by its partisans.
Just do <code>C-x RET C-\</code> and specify <code>english-dvorak</code>.
</p>

<p>
The second, less broad, kind of input method only changes a few ASCII characters
and treats them as <a href="#org7ae2b56">Prefix Keys</a> that you can use to enter funny characters.  For
example, there are several input methods for entering the characters of the
<a href="https://en.wikipedia.org/wiki/International_Phonetic_Alphabet">International Phonetic Alphabet (IPA)</a> used by linguists, and by lexicographers to
indicate pronunciation in dictionaries, whereas the <code>tex</code> input method changes only a few
characters (mostly <code>\</code>, <code>^</code>, and <code>$</code>) into prefixes to enter close to 2,000 funny
characters, including many technical and mathematical ones, like <code>\exists</code> for
\(\exists\) and <code>\lambda</code> for \(\lambda\); you can use <code>TAB</code> to complete these.<sup><a id="fnr.261" href="#fn.261" role="doc-backlink">261</a></sup>
</p>

<p>
I use <code>latin-1-postfix</code> as my default transient input method (the one that <code>C-\</code>
will switch to by default); this makes it easy for me to enter the occasional
foreign language<sup><a id="fnr.262" href="#fn.262" role="doc-backlink">262</a></sup> proper noun by making all the ASCII characters that
are typically accented in Western European Latin-script languages into prefixes.
</p>

<p>
So after enabling <code>latin-1-postfix</code> with <code>C-\</code>, I can more easily type the French
word <i>déçût</i>: when I typed “e” Emacs reminded me, in the Echo Area, of the
possible stand-ins for accents, displaying: <code>e[&#34;&#39;/^`]</code>—I then typed <code>&#39;</code>, the pair
of which became “é”—and when I typed “c” I saw the reminder <code>c[,]</code> and added the
comma to get “ç”, etc.; see Table <a href="#org0471c09">41</a>.  Typing an <code>e</code> followed
by some character <i>other than</i> any of the special e-accent stand-ins just gives
you a plain <code>e</code> followed by that character—so <code>et</code> for example comes out as
<code>et</code>—, and if you need to type an <code>e</code> followed by one of the stand-ins, you just
double the stand-in, so <code>e^^</code> gives me <code>e^</code> rather than <code>ê</code>.  It’s an easy to learn
system, even if you don’t use it much.
</p>
<table id="org0471c09">
<caption><span>Table 41:</span> Typing <i>déçût</i> with <code>latin-1-postfix</code></caption>

<colgroup>
<col/>

<col/>

<col/>

<col/>

<col/>

<col/>

<col/>

<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td>Keystroke</td>
<td><code>d</code></td>
<td><code>e</code></td>
<td><code>&#39;</code></td>
<td><code>c</code></td>
<td><code>,</code></td>
<td><code>u</code></td>
<td><code>^</code></td>
<td><code>t</code></td>
</tr>

<tr>
<td>Buffer Contents</td>
<td><code>d</code></td>
<td><code>d‍e‍</code></td>
<td><code>dé</code></td>
<td><code>dé‍c</code></td>
<td><code>déç</code></td>
<td><code>déç‍u</code></td>
<td><code>déçû</code></td>
<td><code>déçût</code></td>
</tr>

<tr>
<td>Echo Area</td>
<td> </td>
<td><code>e[&#34;&#39;/^`]</code></td>
<td> </td>
<td><code>c[,]</code></td>
<td> </td>
<td><code>u[&#34;&#39;^`]</code></td>
<td> </td>
<td> </td>
</tr>
</tbody>
</table>

<p>
Table <a href="#org455937b">42</a> summarizes some of what the <code>latin-1-postfix</code> Input
Method can do.
</p>
<table id="org455937b">
<caption><span>Table 42:</span> <code>latin-1-postix</code> Input Method Summary</caption>

<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Accent</th>
<th scope="col">Postfix</th>
<th scope="col">Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td>acute</td>
<td><code>&#39;</code></td>
<td><code>a&#39;</code> → <code>á</code></td>
</tr>

<tr>
<td>grave</td>
<td><code>`</code></td>
<td><code>a`</code> → <code>à</code></td>
</tr>

<tr>
<td>circumflex</td>
<td><code>^</code></td>
<td><code>a^</code> → <code>â</code></td>
</tr>

<tr>
<td>diaeresis</td>
<td><code>&#34;</code></td>
<td><code>a&#34;</code> → <code>ä</code></td>
</tr>

<tr>
<td>tilde</td>
<td><code>~</code></td>
<td><code>a~</code> → <code>ã</code></td>
</tr>

<tr>
<td>cedilla</td>
<td><code>,</code></td>
<td><code>c,</code> → <code>ç</code></td>
</tr>

<tr>
<td>nordic</td>
<td><code>/</code></td>
<td><code>d/</code> → <code>ð</code> ;  t/ → þ ;  a/ → å ;  e/ → æ ; o/ → ø</td>
</tr>

<tr>
<td>others</td>
<td><code>/</code></td>
<td><code>s/</code> → <code>ß</code> ;  ?/ → ¿ ;  !/ → ¡ ;  // → °</td>
</tr>

<tr>
<td> </td>
<td>various</td>
<td><code>&lt;‍&lt;</code> → <code>«</code> ;  &gt;‍&gt; → » ;  o_ → º ;  a_ → ª</td>
</tr>
</tbody>
</table>

<p>
There’s also a <code>latin-1-alt-postfix</code> Input Method that’s only slightly different
(thought by some to be more convenient), and a <code>latin-1-prefix</code> Method in which
you type the activating punctuation mark <i>before</i> the letter.  There are a couple
of dozen more <code>-prefix</code> and <code>-postfix</code> Input Methods suited to various other
combinations of scripts.
</p>
</div>
</div>
<div id="outline-container-orgbab6846">
<h4 id="orgbab6846">Coding Systems <a id="org2733d30"></a></h4>
<div id="text-orgbab6846">
<p>
Emacs supports 267 coding systems, but they only really
come into play when you read (visit) or write (save) a file, because data in
memory is represented in an internal format known only to Emacs; at the
transition between Emacs and the file system, Emacs has to translate to or from
a coding system.<sup><a id="fnr.263" href="#fn.263" role="doc-backlink">263</a></sup>
</p>

<p>
Emacs can recognize some coding systems automatically when you visit a file, or
when you save a file after editing, but some sequences of bytes in text are
inherently ambiguous.  When this occurs, Emacs will choose based on an order
of preference if possible; otherwise you’ll be offered a list of compatible
coding systems and asked to identify the correct one.  When Emacs chooses one for
you, you can find out which one it is with
  <code>M-x</code> <code>describe-current-coding-system</code>, and if you disagree, you can
change it with     <code>C-x RET r</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Text-Coding"><code>revert-buffer-with-coding-system</code></a>﻿).
</p>

<p>
You can force a persistent specific coding system for a particular file in two
ways: via a <a href="#org3917dde">File-Local Variable</a> or, more broadly, set it according to a file
extension.  For example, to specify Chinese BIG5 via a File-Local Variable, you
could add this line to the top of the file:
</p>
<pre>-*- coding: big5; -*-
</pre>

<p>
Or, if all your <code>.txt</code> files are in BIG5, you could specify that in the
  <code>auto-coding-alist</code> variable.  That variable is flexible
enough to specify a coding system for just one file, or all the files in a given
directory, regardless of their extension.
</p>
</div>
</div>
<div id="outline-container-org9966932">
<h4 id="org9966932">Line Endings</h4>
<div id="text-org9966932">
<p>
One final wrinkle concerns <i>line endings</i>: the way text encodes where lines break.
This is independent of the coding system and is indicated by <a href="#org70cfb13"><i>control
characters</i></a>.  There are three different ways to indicate a line ending:<sup><a id="fnr.264" href="#fn.264" role="doc-backlink">264</a></sup>
</p>
<dl>
<dt><i>unix</i></dt><dd>use a control-J (ASCII 10 = #x01 = <code>^J</code>) aka <i>linefeed</i></dd>
<dt><i>mac</i></dt><dd>use a control-M (ASCII 13 = #x0D = <code>^M</code>) aka <i>carriage return</i></dd>
<dt><i>dos</i></dt><dd>use a pair of carriage return followed by linefeed (<code>^M^J</code>) aka <i>CRLF</i></dd>
</dl>
<p>
As the names suggest, these three different line-endings are mandated
by the three major families of operating systems.  If you are a
Windows user and receive a file created by a Macintosh user, you
might have trouble distinguishing the breaks between lines because
they are encoded differently.  How massively annoying!
</p>

<p>
The good news is, the Unix operating systems<sup><a id="fnr.265" href="#fn.265" role="doc-backlink">265</a></sup> have mostly won
this battle<sup><a id="fnr.266" href="#fn.266" role="doc-backlink">266</a></sup>.  Apple switched from its carriage return line
endings after 2001, when they rewrote the Mac OS operating system and
based it on Unix, inheriting the linefeed.  So the <i>unix</i> category above
includes Mac OS X, and the <i>mac</i> category only includes old
unconverted Classic Mac OS data.
</p>

<p>
Unfortunately, Microsoft Windows is still sticking to its CRLF line endings
(inherited from MS-DOS in 1985), by far the most awkward of the three.
</p>

<p>
As a result of all this, every one of the 267 coding
systems comes in all three flavors of line endings: so there’s <code>utf-8-unix</code>,
<code>utf-8-mac</code>, and <code>utf-8-dos</code>; also <code>big5-unix</code>, <code>big5-mac</code>, and <code>big5-dos</code>; and so on.
You don’t usually need to specify the full names of the coding system and can
just say <code>utf-8</code> and <code>big5</code> and the like—they will default to your operating
system’s line-ending type—and Emacs will typically figure out the line endings
automatically when you read in a foreign file.  But when you occasionally need
to save a file for a Windows user, you can do so by spelling it out explicitly.
</p>
</div>
</div>
</div>
<div id="outline-container-org28301c2">
<h3 id="org28301c2">Remote File Editing with Tramp <a id="org2bfdd17"></a> <a id="orgfc11c3c"></a></h3>
<div id="text-org28301c2">
<p>
One of Emacs’s killer features is its ability to transparently edit files over
the Internet on remote computers via the Tramp subsystem.  Instead of logging-in
to a remote computer (with <a href="https://en.wikipedia.org/wiki/Secure_Shell"><code>ssh</code></a>, say) and firing up Emacs on that computer to
edit a file, you just use     <code>C-x C-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-file</code></a>﻿) with special
remote-file syntax and edit the file in your local Emacs.  This means that Emacs
doesn’t even need to be installed on the remote computer!
</p>

<p>
While other editors have added a version of this feature recently,
Emacs has been doing this since at least 1989<sup><a id="fnr.267" href="#fn.267" role="doc-backlink">267</a></sup>.  I believe that
Tramp supports more remote file access protocols and features than any
other editor.
</p>

<p>
Every time that Emacs asks you for a filename, you can optionally use
Tramp’s remote file syntax<sup><a id="fnr.268" href="#fn.268" role="doc-backlink">268</a></sup>.  So if your username on the host
<code>myoffice.example.com</code> is <code>mary</code>, you might edit your file <code>~/txt/project.org</code>
on that computer with:
</p>
<pre>C-x C-f /ssh:mary@myoffice.example.com:txt/project.org
</pre>

<p>
It will pop up a Buffer called <code>project.org</code> and editing will work
exactly like editing a local file, at local speeds.  You might notice
a few messages about the network connection flash past in the Echo
Area if you’re paying attention, but otherwise it’s hard to tell you’re
editing a remote file.  <a href="#org0c51c8b">Backup</a> files and <a href="#orgd3c522d">auto-save</a> files work as you’d
expect.  When you save your Buffer in any of the usual ways, your
edits are written out to the remote file.  You don’t have to specially
shut-down a network connection: just kill the Buffer whenever you like
(or not).
</p>

<p>
Additionally, you can visit a remote <i>directory</i> with <code>C-x C-f</code> or
    <code>C-x d</code> (<code>dired</code>) and it will of course come up in a
<a href="#orgcc42ce0">Dired</a> buffer!  All the normal Dired file management commands work as
usual.  Pop up another Dired Buffer—either on that remote host, or
on your local host, or on a second remote host—and you’ve got
<a href="#org34be85c">two-panel file management</a> and can easily copy or move files from one
host to another.
</p>

<p>
If you run   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/File-Names"><code>pwd</code></a>﻿ you’ll see that this Buffer’s working
directory is <code>/ssh:mary@myoffice.example.com:txt/</code>.  This has
interesting implications.  If you visit another file from this Buffer
with <code>C-x C-f</code> (or anything else) from this Buffer, the default
directory will indeed be the remote directory revealed by <code>pwd</code>, so it’s
easy to pull up more remote files; if you <i>don’t</i> want another remote
file. just delete the remote part of the filename in the prompt.
</p>

<p>
Probably the most amazing feature is that Emacs functions that run external
commands, like   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Grep-Searching"><code>grep</code></a>﻿,   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Interactive-Shell"><code>shell</code></a>﻿,
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Compilation"><code>compile</code></a>﻿, Dired’s   <code>!</code> (<code>dired-do-shell-command</code>)
and     <code>&amp;</code> (<code>dired-do-async-shell-command</code>) commands, and the like
all run <i>on the remote host</i>, due to the   <code>default-directory</code>
being expressed in Tramp syntax.  This means all the <a href="#org53af7eb">VC</a> version control commands
work remotely too: pull up that remote file, make your edits, diff it against an
older version, and check in your changes with the same simple VC commands you
use on local files: Tramp makes them run remotely.
</p>
</div>
<div id="outline-container-orgced554b">
<h4 id="orgced554b">Getting Started</h4>
<div id="text-orgced554b">
<p>
Let’s see if Tramp works for you out of the box!  The full Tramp remote
file syntax looks like:
</p>
<pre>/method:user@host#port:/path/to/file
</pre>

<p>
Assuming you’re using SSH, then <i>method</i> will be <code>ssh</code>; <i>user</i> will be your
remote username (I’ll use <code>mary</code>); and <i>host</i> will be the hostname of the
remote system you’re connecting to (I’ll use <code>myoffice.example.com</code> for
your hostname).  If your local username is also <code>mary</code>, you can skip the
<i>user@</i> part of the filename (it defaults to your local username).  You
can use a relative hostname (e.g. just <code>myoffice</code>) if your local host’s
DNS is set up appropriately (or if you have hostname patterns
configured in your SSH configuration).  If the remote SSH server is
listening on the standard port (22), you can leave out the <i>#port</i>
component.  You can also write the <i>method</i> as <code>–</code> if the default method
in   <code>tramp-default-method</code> is the one you
want<sup><a id="fnr.269" href="#fn.269" role="doc-backlink">269</a></sup>.  Finally, if the <code>/path/to/file</code> is in your remote home
directory, you can use a relative path (e.g. just <code>file</code>).  So the
shortest remote filename might be: <code>/–:myoffice:newfile</code>.
</p>

<p>
But let’s issue this command:
</p>
<pre>C-x C-f /ssh:mary@myoffice.example.com:newfile
</pre>

<p>
If you’re using SSH public key encryption and are running
<code>ssh-agent(1)</code>, there will be no need for you to type your passphrase,
but if otherwise, Tramp will prompt you.  Tramp supports completion of
most components of a remote file name.
</p>

<p>
You’ll know it worked if you get a Buffer named <code>newfile</code> and no errors!
But to confirm, do   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/File-Names"><code>pwd</code></a>﻿ in this Buffer and make sure
the output looks something like:
</p>
<pre>Directory /ssh:myoffice.example.com:/home/mary/
</pre>
</div>
</div>
<div id="outline-container-org3f66c5d">
<h4 id="org3f66c5d">Troubleshooting</h4>
<div id="text-org3f66c5d">
<p>
When both the local and the remote host are running Unix, and you’re
already set up and happily using SSH for your logins outside of Emacs,
Tramp is easy to configure and use.  With non-Unix operating systems
(like Windows) or less common login protocols (like, say, <code>telnet</code>
(heaven forbid!)), you may need to do a little light reading.
Fortunately, the 5,203-line
Tramp manual is very well written, and Tramp maintainer Michael
Albinus is one of the most responsive and helpful developers on the
help-gnu-emacs <a href="#org5f3536d">mailing list</a>.
</p>

<p>
In my experience<sup><a id="fnr.270" href="#fn.270" role="doc-backlink">270</a></sup>, the most common problem encountered in using
Tramp is having an <i>exotic remote (or local) shell prompt</i>.  Tramp needs be able to
recognize your shell prompt, and does a pretty good job at it, simply
assuming that your prompt ends with one of the characters <code>#</code>, <code>$</code>, <code>%</code>, or
<code>&gt;</code> followed by a space, which matches the defaults of most shells.  If
your prompt doesn’t fit this requirement, you can fix it by changing
the value of   <code>shell-prompt-pattern</code>.
</p>

<p>
If you use a fancy multiline shell prompt with right-hand end-of-line
components, lots of colors, or perhaps an ASCII-art talking cow, then you may
have trouble.  This is fixable by hacking your shell’s rc file to turn off all
the sexiness (only when Tramp is controlling the shell—you can still have your
crazy prompt in your interactive shells).
</p>

<p>
If you’re a <code>zsh(1)</code> or <code>bash(1)</code> user, using <i>one</i> of these lines as the <i>first</i> line
of your <code>~/.zshrc</code> or <code>~/.bashrc</code> on hosts that you want to Tramp into should do the
job:
</p>
<div>
<pre><span># </span><span>for tramp</span>
[[ <span>&#34;$TERM&#34;</span> == <span>&#34;dumb&#34;</span> ]] &amp;&amp; <span>unsetopt</span> zle &amp;&amp; <span>PS1</span>=<span>&#39;$ &#39;</span> &amp;&amp; <span>return</span> <span># </span><span>zsh</span>
[[ <span>&#34;$TERM&#34;</span> == <span>&#34;dumb&#34;</span> ]] &amp;&amp;                 <span>PS1</span>=<span>&#39;$ &#39;</span> &amp;&amp; <span>return</span> <span># </span><span>bash</span>
</pre>
</div>
<p>
You can set up your fancy cow prompt after this line and it’ll work for you as
usual in interactive shells.
</p>

<p>
For more information and other tips, see <a href="https://www.gnu.org/software/emacs/manual/html_node/tramp/Remote-shell-setup">“Remote shell setup”</a> in the <i>Tramp</i> manual.
</p>
</div>
</div>
<div id="outline-container-orgf80a02e">
<h4 id="orgf80a02e">Tramp Methods</h4>
<div id="text-orgf80a02e">
<p>
While the <code>ssh</code> method is probably the most commonly used Tramp remote
file access method (it is for me), there are actually
35 in total.
Ignoring four that are for obsolete and insecure protocols<sup><a id="fnr.271" href="#fn.271" role="doc-backlink">271</a></sup> and
two for <a href="https://en.wikipedia.org/wiki/Kerberos_(protocol)">Kerberos</a> users, we can divide the remainder into four main
groups: methods for accessing files on Unix systems, methods for
accessing local files under different permission schemes, methods for
accessing specialized file systems, and methods specific to Microsoft
Windows.
</p>

<p>
Orthogonal to these four classes are two different types of
connection: <i>inline</i> and <i>external</i>.
</p>

<p>
<i>Inline</i> methods maintain a persistent connection to a remote host, so
even if logging in to some remote happens to be slow, after the first
connection it will be speedier.  These methods are good for frequently
editing relatively small remote files, but have relatively high
overhead that may slow down access to large files: if you know you’re
about to visit a large file, you might opt for the equivalent
<i>external</i> method.<sup><a id="fnr.272" href="#fn.272" role="doc-backlink">272</a></sup>
</p>

<p>
<i>External</i> methods effectively use an additional out-of-band channel to
transfer the data (possibly storing the data in a temporary file).
These can be slower due to the need to set up and tear down the
additional channel, but faster at transferring large amounts of data.
</p>
</div>
<div id="outline-container-orgcc6bd5e">
<h5 id="orgcc6bd5e">Unix Remote Access Methods</h5>
<div id="text-orgcc6bd5e">
<p>
Unix users accessing remote Unix systems will typically be happy with
these three methods.<sup><a id="fnr.273" href="#fn.273" role="doc-backlink">273</a></sup>
</p>
<table>


<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Method</th>
<th scope="col">Type</th>
<th scope="col">Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td>ssh</td>
<td>inline</td>
<td>Great for small files</td>
</tr>

<tr>
<td>scp</td>
<td>external</td>
<td>Great for large files</td>
</tr>

<tr>
<td>rsync</td>
<td>external</td>
<td>Best for large files that exist on both hosts</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgba76e75">
<h5 id="orgba76e75">Local Permission Access</h5>
<div id="text-orgba76e75">
<p>
Sometimes you need to access a file on your local system as if you
were a different user.  Tramp makes this situation look like a remote
file access.
</p>

<p>
The most common situation for Unix users on their own
desktop machine is the <code>sudo</code> method, which lets you access a file or
directory as root via the <code>sudo(8)</code> program.  It also allows you run a
root shell in your Emacs by visiting a file or directory as root and then
running   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Interactive-Shell"><code>shell</code></a>﻿ within that Buffer.
</p>

<p>
Since this family of methods run on the local host, you just leave the
hostname part of the remote filename empty,
e.g. <code>/sudo::/etc/resolv.conf</code>.
</p>

<p>
The <code>sudoedit</code> method is a more paranoid version of <code>sudo</code> that’s more
annoying to use.
</p>

<p>
<code>su</code> is similar to <code>sudo</code> but uses <code>su(8)</code> and allows you to edit as non-root users;
of course you have to have the ability (i.e., permission) to use <code>su(8)</code> outside of
Emacs for this to work.
</p>

<p>
<code>doas(8)</code> is an alternative to <code>sudo</code> that is the default on <a href="https://en.wikipedia.org/wiki/OpenBSD">OpenBSD</a> systems.
</p>

<p>
Finally, the <code>sg</code> method uses <code>sg(8)</code> to let you edit files under a different
group.
</p>
<table>


<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Method</th>
<th scope="col">Type</th>
<th scope="col">Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td>sudo</td>
<td>inline</td>
<td>Root access</td>
</tr>

<tr>
<td>sudoedit</td>
<td>external</td>
<td>Paranoid root access</td>
</tr>

<tr>
<td>su</td>
<td>inline</td>
<td>Access as a different user</td>
</tr>

<tr>
<td>doas</td>
<td>inline</td>
<td>… via <code>doas(8)</code></td>
</tr>

<tr>
<td>sg</td>
<td>inline</td>
<td>Access as a different group</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgf2c9e61">
<h5 id="orgf2c9e61">Specialized File System Access</h5>
<div id="text-orgf2c9e61">
<p>
There are a number of “file systems” that aren’t <i>real</i> file systems, i.e. aren’t
simply organizations of bytes on a disk partition.  Instead, they’re <i>applications</i> that
offer up files, masquerading as file systems.  Tramp can handle several of
these.  Note that all of them require external programs to be installed, and
these are all external methods.
</p>
<table>


<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Method</th>
<th scope="col">Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td>ftp</td>
<td>For FTP servers</td>
</tr>

<tr>
<td>sftp</td>
<td>SSH FTP</td>
</tr>

<tr>
<td>rclone</td>
<td>Many remote storage systems via <code>rclone(1)</code></td>
</tr>

<tr>
<td>sshfs</td>
<td>Remote files via the sshfs file system</td>
</tr>

<tr>
<td>afp</td>
<td>Apple Filing Protocol</td>
</tr>

<tr>
<td>dav</td>
<td>WebDAV</td>
</tr>

<tr>
<td>davs</td>
<td>… via SSL</td>
</tr>

<tr>
<td>gdrive</td>
<td>Google Drive</td>
</tr>

<tr>
<td>nextcloud</td>
<td>NextCloud and OwnCloud systems</td>
</tr>

<tr>
<td>mtp</td>
<td>Media devices like phones and cameras</td>
</tr>

<tr>
<td>adb</td>
<td>Access a phone through the Android Debug Bridge</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgbaeb418">
<h5 id="orgbaeb418">Windows-Specific Access Methods</h5>
<div id="text-orgbaeb418">
<p>
Microsoft Windows does things its own way.  If you’re a Unix Emacs user that
needs to access files on a remote Windows machine, probably all you’ll need is
the <code>smb</code> method.  If you’re a Windows Emacs user that needs to access remote
hosts, whether remote Unix or remote Windows hosts, you may need to use the
other methods depending on how your Window system is set up.  Frankly, as
someone who’s basically never used Windows, I can’t pretend to understand these
distinctions.  As always, see <a href="https://www.gnu.org/software/emacs/manual/html_node/tramp/Top">the manual</a>.
</p>
<table>


<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Method</th>
<th scope="col">Type</th>
<th scope="col">Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td>smb</td>
<td>external</td>
<td>Access files via Samba or SMB</td>
</tr>

<tr>
<td>ssh</td>
<td>inline</td>
<td>… via SSH</td>
</tr>

<tr>
<td>plink</td>
<td>inline</td>
<td>… via Putty</td>
</tr>

<tr>
<td>plinkx</td>
<td>inline</td>
<td> </td>
</tr>

<tr>
<td>scpx</td>
<td>external</td>
<td>… via SCP</td>
</tr>

<tr>
<td>pscp</td>
<td>external</td>
<td>… via Putty</td>
</tr>

<tr>
<td>psftp</td>
<td>external</td>
<td> </td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="outline-container-org2eece26">
<h4 id="org2eece26">Multi-Hop Connections</h4>
<div id="text-org2eece26">
<p>
Perhaps you’re at home and need to access a file on work machine
<code>internal.example.com</code> that’s on a non-routable private network, like a host with
<code>10.*.*.*</code> IP address.  This would normally be impossible, but if this host is
accessible via ssh from your work desktop <code>myoffice.example.com</code>, say, then you can use
that as a proxy.  You can Tramp into the internal host via a <i>multi-hop</i> filename
like this: <code>/ssh:myoffice.example.com|ssh:internal.example.com:/filename</code>.  You
just separate the hops with vertical bars (<code>|</code>).  You can mix different methods
(e.g. <code>ssh</code> to get to the proxy, but <code>smb</code> to get to the internal host) and
different usernames for each hop.
</p>

<p>
This implies that you can edit a file on  <code>myoffice.example.com</code> as root
by adding a <code>sudo</code> hop (<code>/ssh:myoffice.example.com|sudo::/filename</code>) and
indeed that works fine.  Very powerful.
</p>
</div>
</div>
<div id="outline-container-orgb93e5ab">
<h4 id="orgb93e5ab">Connection Cleanup</h4>
<div id="text-orgb93e5ab">
<p>
Occasionally you may find that your persistent Tramp connections are
hung.  This is most likely to happen if a network connection gets
dropped—say, your WIFI connection gets dropped, or the remote host
is rebooted, or you slept your laptop.  In some cases Tramp
automatically reconnects for you and you don’t even notice, but if
you’re getting Tramp errors, you can fix them by cleaning up your
connection and starting over.
</p>

<p>
The first command to try is   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/tramp/Cleanup-remote-connections"><code>tramp-cleanup-connection</code></a>﻿,
which will offer all your remote connections for completion.  Pick the
one that’s generating complaints, and now you can reconnect to that
host (say by revisiting the file with
    <code>C-x C-v</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-alternate-file</code></a>﻿) or
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Reverting"><code>revert-buffer</code></a>﻿.  If you just like to keep things neat,
you can explicitly clean up connections when you know you’re done with
them.
</p>

<p>
In extreme cases, you can use   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/tramp/Cleanup-remote-connections"><code>tramp-cleanup-all-buffers</code></a>﻿
to clean up all your connections for a totally fresh start.  See
<a href="https://www.gnu.org/software/emacs/manual/html_node/tramp/Cleanup-remote-connections">“Cleanup remote connections”</a> in the <i>Tramp</i> manual for more information.
</p>
</div>
</div>
<div id="outline-container-org05c7268">
<h4 id="org05c7268">References</h4>
<p>
Free Software Foundation. 2022. <i>TRAMP User Manual.</i> Cambridge, MA: Free Software Foundation..
Read in Emacs with <code>M-x info-display-manual RET tramp RET</code>.
</p>
</div>
</div>

<div id="outline-container-orga741bb2">
<h3 id="orga741bb2">Client / Server <a id="org22671bb"></a></h3>
<div id="text-orga741bb2">
<p>
In this book I advocate living in Emacs the Lisp Machine: using pure Elisp
applications (like <a href="#orgb2b6b30">Calc</a> for your calculator, <a href="#orgc4ddf2e">EWW</a> for your web browser, and
<a href="#orgcc42ce0">Dired</a> for your file manager) and Emacs front-ends to the external applications
you need to use (like <a href="#org53af7eb">VC</a> for your version control and <a href="#org4d9b857">Ediff</a> for your diffing and
merging), But even if you work this way as much as possible, you’ll inevitably
need to occasionally run an application from a shell in a terminal, and some of
these applications will want to invoke “your editor”.  For example, if you use
<a href="https://en.wikipedia.org/wiki/Mutt_(email_client)"><code>mutt(1)</code></a> as your mailer<sup><a id="fnr.274" href="#fn.274" role="doc-backlink">274</a></sup>, it will need to invoke your editor every time
you compose an email; if you run <code>git(1)</code> in the terminal for version
control<sup><a id="fnr.275" href="#fn.275" role="doc-backlink">275</a></sup> it will invoke your editor so you can edit a commit message.
</p>

<p>
Programs like this typically determine your preferred editor via the value of
the <code>EDITOR</code> environment variable.  Yes, you can set <code>EDITOR=emacs</code>, but this isn’t
really right: Emacs is already running, and has been running since you booted
your computer, right?  Every additional time Emacs is fired up, you’re divorced from
all the files and Buffers in your main Emacs instance: your <i>state</i>.  Also, any
<code>vim(1)</code> user will tell you that Emacs <a href="#org81d2eb2">takes too long to start up</a> (this isn’t
really true, but a large and insufficiently lazy <a href="#org2af3730">Init File</a> can make it so).
</p>

<p>
The solution to both of these problems—speed, and isolation from your
state—is to run the <i>Server</i> in your main Emacs instance, and set your <code>EDITOR</code> to
be <code>emacsclient</code>.
</p>

<p>
<code>emacsclient(1)</code> is a separate program that installs alongside <code>emacs(1)</code>.  When you
run it, all it does is instantly connect to your running Server, where all your
state is, creating a new Buffer editing the file that was named on the
<code>emacsclient</code> command line.  When you’re done editing this file, you have Emacs
tell the <code>emacsclient</code> that you’re done, and the Client then terminates.
</p>

<p>
And speaking of state, when you’re in an <code>emacsclient</code> Buffer, you really <i>are</i> in
the Server Emacs: all your state is available: you can switch Buffers, split
Windows, edit other files or read some emails: anything you like.  If you’ve
jumped around and have forgotten where your new client Buffer is, you can invoke
    <code>C-x #</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>server-edit</code></a>﻿) and it will take you back there.
</p>

<p>
A program like <code>mutt</code> or <code>git</code> will have invoked <code>emacsclient</code> with the
name of a temporary file where you’ll edit your email or <code>git</code> commit message: this
file gets visited in your Server Emacs like any other file.  The external
program will be waiting for you to finish editing before it mails the email or
checks-in the commit message.
</p>

<p>
When you’re done with the edit, you’ll save the Buffer as usual, and then invoke
<code>C-x #</code>.  When you invoke this command in a client Buffer, it tells <code>emacsclient</code>
that you’re “done” with this edit: it kills the Buffer containing the temporary
file, and terminates, returning control to the program that invoked <code>$EDITOR</code>.
Note that only the <code>emacsclient</code> program, <i>not</i> your Emacs Server, terminates: the
Server keeps running, preserving all your state.
</p>

<p>
A subtlety for Unix users, at least: <code>C-x #</code> tells the <code>emacsclient</code> to exit
<i>successfully</i> (i.e. with a status of 0); on rare occasions you might want to tell
it explicitly to exit <i>unsuccessfully</i> (i.e. with a non-zero status) so that the
program that invoked the Client via <code>$EDITOR</code> knows you’re unhappy with your
edit.  So <code>mutt</code> for example would <i>not</i> send your email<sup><a id="fnr.276" href="#fn.276" role="doc-backlink">276</a></sup>, and <code>git</code> would abort your
commit.  You can do this by invoking, instead of <code>C-x #</code>,
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>server-edit-abort</code></a>﻿.
</p>

<p>
If your Emacs Server and your terminal are side by side when the external
program invokes <code>emacsclient</code>, you’ll see the temporary file suddenly appear in
Emacs.  If your Emacs is not visible—because it’s on another desktop, or it’s
iconified (minimized) or buried under a pile of other windows—you’ll have to
pull it up to do your editing.  You can instead arrange for the <code>emacsclient</code> to
open up a new <a href="#org4dd50c2">Frame</a> right in front of you; see <a href="#org5a1fb40">below</a>.
</p>

<p>
It’s not only programs using <code>$EDITOR</code> that can invoke <code>emacsclient</code>—you can invoke
it explicitly yourself.<sup><a id="fnr.277" href="#fn.277" role="doc-backlink">277</a></sup>  Invoking it with a filename, say:
</p>
<pre>emacsclient foo.c
</pre>

<p>
will visit <code>foo.c</code> in the Server.  This time it’s your shell that’s waiting
for <code>emacsclient</code> to terminate.  You’ll notice that, in your shell, <code>emacsclient</code>
has printed a message and your shell is waiting for it, and hasn’t yet displayed
its next prompt:
</p>
<pre id="orgdb5c075">$ emacsclient foo.c
Waiting for Emacs...
</pre>
<p>
<code>C-x #</code> will indicate you’re finished and you’ll get your shell prompt back.
</p>

<p>
If, in your shell, you invoke <code>emacsclient</code> with several filenames, then the
Client loads all the files into the Server, and <code>C-x #</code> in one of those Buffers
will kill the Buffer and switch to the next file, which has its own Client
Buffer.  When you’ve indicated you’re done with all the Client Buffers by
invoking <code>C-x #</code> in each, the <code>emacsclient</code> terminates and returns control to the
shell.  You can edit all these files in any order you like and flip back and forth
between them at will.
</p>
</div>
<div id="outline-container-org9a5a6d2">
<h4 id="org9a5a6d2"><code>emacsclient</code> Operating Modes <a id="org5a1fb40"></a></h4>
<div id="text-org9a5a6d2">
<p>
<code>emacsclient</code> actually has three distinct modes of operation.  The default, as
I’ve described, is to visit a file in an existing Frame of the Server Emacs.
</p>

<p>
If you use the <code>-c</code> or <code>--create-frame</code> option, it will instead open a new graphical
Frame managed by your window system, exactly as if you had invoked
    <code>C-x 5 f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-file-other-frame</code></a>﻿) from inside Emacs.  This
means you don’t have to navigate to one of your other Frames that’s possibly in
another desktop or on another monitor.  (This is the option I usually prefer.)
</p>

<p>
The third possibility is to use the <code>-t</code> (equivalently, the <code>--tty</code> or <code>-nw</code>) option,
which will open a new non-graphical Frame right in your terminal.  This has the
advantage of being most intimately connected to the terminal you’re working in,
but all the disadvantages of a <a href="#org6444e1f">non-graphical Emacs</a>.
</p>

<p>
There are several other <code>emacsclient</code> options, but most of them are for people
with very special needs.  Table <a href="#org34c7fb1">43</a> lists the only ones
I’ve ever needed.
</p>
<table id="org34c7fb1">
<caption><span>Table 43:</span> <code>emacsclient</code> Options</caption>

<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Option</th>
<th scope="col">​= Long Option</th>
<th scope="col">Effect</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-c</code></td>
<td><code>--create-frame</code></td>
<td>Create a new graphical frame</td>
</tr>

<tr>
<td><code>-t</code></td>
<td><code>--tty</code></td>
<td>create a new Terminal frame</td>
</tr>

<tr>
<td><code>-nw</code></td>
<td><code>--tty</code></td>
<td>… the same (“no window”)</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>-n</code></td>
<td><code>--no-wait</code></td>
<td>No wait for <code>C-x #</code></td>
</tr>

<tr>
<td><code>-a</code></td>
<td><code>--alternate-editor</code></td>
<td>what to run if no server</td>
</tr>
</tbody>
</table>
<p>
The <code>-n</code> option tells <code>emacsclient</code> not to wait for you to “finish editing”.  It
just visits the named file in the Server and you can take all the time you want
editing it.  This is an <i>asynchronous</i> edit, unlike the default <code>emacsclient</code>
<i>synchronous</i> edit, which leaves the invoking shell or other program waiting for
you to finish.  With <code>-n</code>, you get your shell prompt back immediately.  It works
in all three operating modes: you can combine it with <code>-c</code>, <code>-t</code>, or neither.  Note
that you <i>never</i> want to include this option in your <code>EDITOR</code> environment variable!
It would violate the expectations of <code>mutt</code>, <code>git</code> and friends.
</p>

<p>
The <code>-a</code> option says what to do if there’s no Emacs server running; it takes the
name of an alternate editor program as a parameter.  The best alternate editor
is of a course a non-Server Emacs!  So this command:
</p>
<pre>emacsclient -a emacs foo.c
</pre>

<p>
edits <code>foo.c</code> in the running Server, but if there <i>is</i> no running Server, edits
<code>foo.c</code> in a fresh Emacs (which might start up a Server for next time—see <a href="#org4e3dad5"><i>Starting Up the
Server</i></a>).
</p>

<p>
I recommend configuring your <code>EDITOR</code> variable in one these forms, depending on
your preference for a graphical client Frame, a non-graphical (terminal) client
Frame, or no new frame (the default).  I use Posix syntax, which will work for
<code>bash(1)</code>, <code>zsh(1)</code>, etc, but maybe not in exotic shells.  This line would go in your
<code>~/.bashrc</code>, <code>~/.zshrc</code>, or equivalent.
</p>
<table>


<colgroup>
<col/>

<col/>
</colgroup>
<tbody>
<tr>
<td>Graphical Frame</td>
<td><code>export EDITOR​=&#34;​emacsclient -a emacs -c&#34;</code></td>
</tr>

<tr>
<td>Terminal Frame</td>
<td><code>export EDITOR​=&#34;​emacsclient -a emacs -t&#34;</code></td>
</tr>

<tr>
<td>Existing Frame</td>
<td><code>export EDITOR​=&#34;​emacsclient -a emacs&#34;</code></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org9c3b825">
<h4 id="org9c3b825">Edit, Compile, Run Cycle <a id="orgdff2e46"></a></h4>
<div id="text-org9c3b825">
<p>
If you haven’t yet completely bought into the new Lisp Machine cult into which
I’m trying to recruit you, you may still be spending a lot of time in a terminal
shell.
</p>

<p>
<code>emacsclient</code> presents a synchronous mode of editing that allows you to work in
the terminal like a <code>vim</code> user: compile your program, run <code>emacsclient</code> to fix your
code, exit and re-compile.
</p>

<p>
This is an alternative to doing things the Emacs way, in which, instead of
living in a shell in a terminal, you’re in your Emacs: you pull up your file
with   <code>C-x C-f</code> <code>foo.c</code>, compile it with   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Compilation"><code>compile</code></a>﻿, and
jump to your errors with     <code>C-x `</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Compilation-Mode"><code>next-error</code></a>﻿).  In my opinion,
the Emacs way is superior, but if I haven’t convinced you, Emacs gives you
options.
</p>

<p>
With <code>-c</code> (or <code>-t</code>) you can fire up <code>emacsclient</code> without giving it a file name.
Maybe you’re working in a terminal and want to jot down a quick note in a file
that’s already in your Server Emacs; <code>emacsclient -c</code> will open a new client Frame
right in front of you; now, switch to the Buffer of interest, and when you’re done,
delete the Frame with <code>C-x 5 0</code>.<sup><a id="fnr.278" href="#fn.278" role="doc-backlink">278</a></sup>  Or leave the Frame open for as long as
you like.
</p>
</div>
</div>
<div id="outline-container-org4024a5f">
<h4 id="org4024a5f">Remote Server</h4>
<div id="text-org4024a5f">
<p>
Another reason to run the Emacs Server is so you can connect to a remote Emacs
running on another computer.  This is sort of an alternative to using <a href="#org2bfdd17">Tramp</a> to
edit a remote file in your local Emacs: you can instead connect to the Emacs
Server that you’re running on the remote host, and do your editing there.
</p>

<p>
Tramp is much lighter-weight and is the way to go if you just want to edit a
given file, especially over a slow, low-bandwidth, or unreliable network
connection.  But if what you want is access to your complete remote Emacs <i>state</i>,
then you want a remote Server connection.  The more state you have in the remote
Emacs, the more useful this is.  When you connect to the remote Emacs you have all
your Buffers available: all your web browser tabs, your Registers and Bookmarks,
your email, your Dired Buffers complete with all their marks, and all the rest.
</p>

<p>
It’s like a plain-text version of <a href="https://en.wikipedia.org/wiki/Remote_desktop_software">Remote Desktop</a> or <a href="https://en.wikipedia.org/wiki/Virtual_Network_Computing">VNC</a> on a Windows or Mac OS
machine, except in my experience it’s <i>much</i> more responsive, simply because
you’re only shipping compact plain text across the network most of the time,
rather than high resolution images of GUI windows.<sup><a id="fnr.279" href="#fn.279" role="doc-backlink">279</a></sup>
</p>

<p>
I use this method to connect to the always-running Emacs on my work desktop from
my home laptop<sup><a id="fnr.280" href="#fn.280" role="doc-backlink">280</a></sup>; this is how I occasionally work remotely, and during the pandemic of
2020 I worked this way exclusively for years.  I do all my email in Emacs on my
work desktop, and I’m connected to all the work servers via <a href="#org2bfdd17">Tramp</a> from this
Emacs.
</p>

<p>
There’s really nothing new to learn about using a remote Server: all you do is
run the <code>emacsclient</code> on the remote host via SSH like this:
</p>
<pre>ssh -f myoffice.example.com emacsclient -c
</pre>

<p>
If you’re running the <a href="https://en.wikipedia.org/wiki/X_Window_System">X Windows System</a> on a Unix system and you have enabled SSH
to use X Forwarding, this will open a new graphical Frame on your local
computer, but the Frame belongs to the remote Server running on
<code>myoffice.example.com</code> and makes all your state available.  Simple as that.
</p>

<p>
If you don’t have X Forwarding enabled (you can enable it on the command line
with the <code>ssh -A</code> option), use this form of the command:
</p>
<pre>ssh -t myoffice.example.com emacsclient -t
</pre>

<p>
The two <code>-t</code> options give you a terminal Frame instead.  If you have a terrible
network connection, the terminal version may be more responsive; I’ve used this
to good effect on long-distance trains for example, which have typically had
very sketchy connectivity.  Using <a href="https://en.wikipedia.org/wiki/Mosh_(software)"><code>mosh(1)</code></a> instead of SSH will make for the
most robust connection.
</p>

<p>
You do want to have a few SSH options in your SSH config for best results.  I use:
</p>
<pre id="orgad9e1e2">ForwardX11 yes
ForwardX11Trusted yes
ForwardAgent yes
Compression yes
ServerAliveInterval 120
</pre>
</div>
</div>
<div id="outline-container-org3ad88b7">
<h4 id="org3ad88b7">Starting Up the Server <a id="org4e3dad5"></a></h4>
<p>
We’ve talked a lot about the Emacs Client, but how do you start up the Emacs
Server?  There are at least three ways.
</p>
<div id="outline-container-org2d4e02b">
<h5 id="org2d4e02b">The <code>--daemon</code> Option</h5>
<div id="text-org2d4e02b">
<p>
Start your Server by invoking Emacs with the <code>--daemon</code> option.  Usually you
arrange for this to happen automatically when you start up your computer: for Unix
users running the <a href="https://en.wikipedia.org/wiki/X_Window_System">X Window System</a>, this typically means adding the line:
</p>
<pre>emacs --daemon
</pre>

<p>
to your <code>~/.xinitrc</code> file.
</p>

<p>
When you start up Emacs this way, the usual initial Frame with its splash screen
won’t appear. You’ll need to use the <code>emacsclient</code> command to connect to the
Server and open up a Frame.  If you always want an initial Frame to appear
first thing, you can add an invocation of <code>emacsclient -c</code> in your
<code>~/.xinitrc</code>.
</p>
</div>
</div>
<div id="outline-container-org9e1606f">
<h5 id="org9e1606f">Have the OS Start the Server</h5>
<p>
If you’re on a Unix OS that runs <a href="https://en.wikipedia.org/wiki/Systemd">Systemd</a>, you can have it start up your Emacs
Server for you when you log in.  The main advantage of this is that
Systemd will restart your Emacs if it gets killed.  See <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Emacs-Server">“Emacs Server”</a> in the <i>Emacs</i> manual.
</p>
</div>
<div id="outline-container-orgdb01922">
<h5 id="orgdb01922">Start the Daemon in Your Init File</h5>
<div id="text-orgdb01922">
<p>
You can instead start up the Server from your <a href="#org2af3730">Init File</a>.  This means that
whenever you fire up an Emacs, it will ensure that the Server is started for
you.  This is the method I use.  This Init File snippet starts up the Server
unless one is already running.<sup><a id="fnr.281" href="#fn.281" role="doc-backlink">281</a></sup>
</p>
<div>
<pre>(<span>require</span> &#39;<span>server</span>)
(<span>if</span> (fboundp &#39;server-running-p)         <span>; </span><span>new in v28</span>
    (<span>unless</span> (server-running-p)
      (server-start))
  <span>;; </span><span>server-start will fail if the server is already running...</span>
  (<span>ignore-errors</span> (server-start)))
</pre>
</div>
<p>
Note that if you’re not a regular user of the Server, you can also fire it up
interactively on special occasions with   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Emacs-Server"><code>server-start</code></a>﻿.
</p>
</div>
</div>
</div>
<div id="outline-container-org8a7f959">
<h4 id="org8a7f959">Shutting Down the Server</h4>
<div id="text-org8a7f959">
<p>
There’s no reason in normal use to explicitly shut down the Server; just let it
run until you’re done with Emacsing.<sup><a id="fnr.282" href="#fn.282" role="doc-backlink">282</a></sup>
</p>

<p>
But the usual command for exiting Emacs,   <code>C-x C-c</code>
(  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Exiting"><code>save-buffers-kill-terminal</code></a>﻿), is a little more subtle when
you’re running the Server.  If you give that command in a Client Frame (as
created by <code>emacsclient -c</code> or <code>emacsclient -t</code>), it doesn’t exit your Emacs:
 rather, it offers to save your Buffers and then acts exactly like <code>C-x #</code>,
informing the <code>emacsclient</code> that you’re done editing, and then terminating the
Client, leaving the Server running.  You can use this instead of <code>C-x #</code> if you
like, though I think developing the <code>C-x #</code> habit is better.
</p>

<p>
If you start Emacs with <code>(server-start)</code> and are in the original server Frame (not
in a Client Frame), <code>C-x C-c</code> <i>will</i> exit your Emacs, though in addition to the
<a href="#orge8c7343">usual cautions</a>, if there are any attached Clients, you’ll be asked:
</p>
<pre>This Emacs session has clients; exit anyway? (yes or no)
</pre>


<p>
Note that if you start Emacs with <code>--daemon</code>, then <i>all</i> Frames are client Frames,
so <code>C-x C-c</code> will never terminate your Emacs!  With <code>--daemon</code>, you need to use
  <code>M-x</code> <code>save-buffers-kill-emacs</code> to do so.
</p>
</div>
</div>
<div id="outline-container-org54865bb">
<h4 id="org54865bb">Troubleshooting</h4>
<div id="text-org54865bb">
<p>
A quick way to see if your local Emacs Server is happy is to run this command:
</p>
<pre>emacsclient --eval &#34;(print :ok)&#34;
</pre>

<p>
If you get a “:ok” in response, the Server is running and all is well.
</p>

<p>
You can check on a remote Server by <code>ssh</code>’ing to the remote host and running the
same command there.  Due to shell quoting issues, this obvious shortcut won’t
work:
</p>
<pre>ssh myoffice.example.com emacsclient --eval &#34;(print :ok)&#34;
</pre>

<p>
You need an extra level of shell quoting:
</p>
<pre>ssh myoffice.example.com emacsclient --eval &#39;&#34;(print :ok)&#34;&#39;
</pre>

<p>
In either case, if the Server’s not running, you’ll get some message like:
</p>
<pre>emacsclient: can&#39;t find socket; have you started the server?
</pre>


<p>
Very occasionally, you might try to initiate a connection to a
remote server and find that <code>emacsclient</code> just hangs!  Before you do anything as
extreme as <code>ssh myoffice.example.com pkill emacs</code>, try this command:
</p>
<pre>ssh myoffice.example.com emacsclient --eval &#39;&#34;(top-level)&#34;&#39;
</pre>

<p>
Occasionally you’ll have left your remote Emacs in the middle of waiting for you
to type a response in the Minibuffer or the like, which can cause your
<code>emacsclient</code> connection to hang; invoking   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Quitting"><code>top-level</code></a>﻿ can
abort this.
</p>
</div>
</div>
<div id="outline-container-org63b2370">
<h4 id="org63b2370">Midnight Mode <a id="org4584d48"></a></h4>
<div id="text-org63b2370">
<p>
When you’re running the Server, you tend to have a very long-running Emacs,
which can accumulate a lot of Buffers.<sup><a id="fnr.283" href="#fn.283" role="doc-backlink">283</a></sup> (You can say
  <code>M-x</code> <code>emacs-uptime</code> to see how long your Emacs has been running.)
Assuming you’re not out of space from visiting enormous files and never killing
their Buffers, there’s nothing wrong with this per se.  However, you might
consider 100 or more old Buffers to be too much clutter in your <a href="#org534efa3">Buffer Menu</a> or
your <a href="#org75fb6a2">Completion</a> candidates.  If so,   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Kill-Buffer"><code>midnight-mode</code></a>﻿ to the
rescue.  If you invoke it in your Init File:
</p>

<p>
then every night at midnight, it kills all the Buffers that are more than three
days old (for file-visiting Buffers, only if they are unmodified of course).
Three days is just the default, and there are a number of exceptions.  You can
readily exclude Buffers that you never want it to clean up, and force it to
always kill Buffers that annoy you.  It’s very customizable, so if you use it,
be sure to investigate it by invoking   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-group</code></a>﻿ <code>RET midnight</code>.
</p>
</div>
</div>
</div>
<div id="outline-container-orga424e99">
<h3 id="orga424e99"><span>UNFINISHED</span> Ubiquitous Capture <a id="org7cc7ea9"></a></h3>
</div>

<div id="outline-container-orgff8f880">
<h3 id="orgff8f880"><span>UNFINISHED</span> Org Mode <a id="org4a851ca"></a></h3>
<div id="text-orgff8f880">
<blockquote>
<p>
Sitting on top of Emacs is Org mode.  It is the thing which made irrelevant my
search for the perfect task management software.  Like Emacs, you can mold it
into whatever workflow works best for you at the time.  Later, I discovered it
is also a wonderful publishing platform […].  I have used it to author
countless technical specifications, my blog, and all of my books.  In
“Concurrency in Go”, it allowed me to execute the code snippets embedded in the
book—a form of literate programming.  This ensured that the code people are
reading, the output from that code, and the code exported into the book’s
repository all have the same provenance. — <a href="https://usesthis.com/interviews/katherine.cox-buday/">Katherine Cox-Buday / writer,
computer scientist</a>
</p>
</blockquote>

<div id="orge7df19e">
<p><a href="https:./images/org-babel.png" alt="Editing This Book in Org Mode with Babel" title="Editing This Book in Org Mode with Babel" width="100%"><img src="https://blog.veitheller.de/images/org-babel.png" alt="Editing This Book in Org Mode with Babel" title="Editing This Book in Org Mode with Babel" width="100%"/></a>
</p>
<p><span>Figure 47: </span>Editing This Book in Org Mode with Babel</p>
</div>

<p>
It all began with <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Outline-Mode"><code>outline-mode</code></a>, a simple <a href="#org5b21ef0">Major Mode</a>
for editing outlines with nested headings, which had been in GNU Emacs since the
very beginning.
</p>

<p>
<a href="#org4a851ca"><code>org-mode</code></a> is like <code>outline-mode</code> on steroids.  Starting from <code>outline-mode</code>’s
simple syntax, it adds metadata (such as a notion of author and title), markup
(italics, bold, tables), hypertext links, and the ability to export your text as
HTML, PDF, and more.  It’s very easy to use at this level and should be your
choice for most of your “plain text” files.
</p>

<p>
But this description doesn’t come close to doing Org justice: Org is the subject
of a 23,603-line manual and also incorporates
calendaring, TODO lists, agendas, database, spreadsheets, literate programming,
and metaprogramming.  (This book is an Org Mode document.)
</p>
</div>


</div>
<div id="outline-container-org2ff7f10">
<h3 id="org2ff7f10"><span>UNFINISHED</span> Third-Party Packages <a id="org660cffc"></a> <a id="orgd1263eb"></a></h3>
<p>
The community package repository currently has 5,374 packages
available for installation.
</p>
</div>
<div id="outline-container-org8213317">
<h3 id="org8213317"><span>UNFINISHED</span> Security Concerns <a id="org0959336"></a></h3>

<div id="outline-container-org70cb5fc">
<h4 id="org70cb5fc">Third-Party Packages</h4>
<div id="text-org70cb5fc">
<p>
When installing third-party packages via the <a href="#orgc96889a">Package Manager</a>, remember that a
third-party Emacs package can do anything you can do with Emacs or Elisp
yourself, including deleting files or stealing your personal data!  In this
sense, Emacs is no different than every other package manager—whether for a
programming language, the app store on your phone, or an application like a web
browser.
</p>

<p>
In an ideal world, you would personally vet the source code for any package
before you install it<sup><a id="fnr.284" href="#fn.284" role="doc-backlink">284</a></sup>, but this assumes you’re a competent Elisp programmer, and
realistically, very few people are willing to go to all this trouble and are
more trusting or risk-taking than that.<sup><a id="fnr.285" href="#fn.285" role="doc-backlink">285</a></sup>
</p>

<p>
The GNU and NonGNU ELPA repos are managed by the Emacs developers and hosted by
the GNU project, and are probably more secure than MELPA or Marmalade, where any
user can upload any code.  That being said, I currently use some
<code>123</code> third-party Elisp packages, have used many more in
the past, and have never in 38 years encountered any malware.
But it’s up to you to do what you consider to be due diligence.  Do some
research before installing: search the package on the web and see what people
say about it; visit the package’s home page (very likely to be found on <a href="https://github.com/">Github</a>;
    <code>C-h P</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Package-Keywords"><code>describe-package</code></a>﻿) will tell you) and see how many
people are using it.
</p>
</div>
</div>
</div>
<div id="outline-container-org9df1e26">
<h3 id="org9df1e26"><span>UNFINISHED</span> Authentication <a id="orgb9ccb9b"></a></h3>
</div>
<div id="outline-container-org5f48be9">
<h3 id="org5f48be9">Programming the Lisp Machine <a id="org1882224"></a> <a id="org36dd556"></a></h3>
<div id="text-org5f48be9">
<blockquote>
<p>
What one fool can do, another can. — Silvanus P. Thompson, <i>Calculus
Made Easy</i>, 1911
</p>
</blockquote>
<blockquote>
<p>
You can avoid learning elisp and
still be very productive using emacs, but chances are if you’re like
most people you will get sucked in eventually as the lure of sanding
the rough edges off of some mode or other becomes too great :) — <a href="https://www.feoh.org/vim-versus-emacs-minus-the-religion.html">Chris Patti</a>
</p>
</blockquote>
<p>
Unlike most lesser but still somewhat-customizable applications, Emacs provides a
clear path from your first customization tweak to power user to full-blown
extension programmer, primarily because Emacs is itself written in the language
used to customize it.
</p>
</div>
<div id="outline-container-orgd9008f8">
<h4 id="orgd9008f8">Customization in Emacs Lisp <a id="org2af3730"></a> <a id="org18c7583"></a></h4>
<div id="text-orgd9008f8">
<p>
In the old days, the only way to customize Emacs was by adding Elisp to your
Init File, but for at least 26 years—since version
20—the Customize Facility has provided an interactive forms-based system for
most of your customization needs.  I’m embarrassed to say that I used to disdain
Customize (I guess I thought it was too hand-holdy, and anyway, writing Elisp is
fun!)—but I was a fool.  Customize is very powerful and has major advantages,
and I encourage you to use it as much as possible; see <a href="#org27e6769"><i>The Customize Facility</i></a>.
</p>

<p>
That being said, there <i>are</i> a few sorts of customizations that you can’t do, or
can’t do conveniently, via Customize.  First and foremost is setting up custom
key bindings; another is complex customizations that require conditional logic
(say, dependent on which host your Emacs is running on, or the version of your
Emacs).  Also, if you’re adding a non-trivial <a href="https://en.wikipedia.org/wiki/Anonymous_function">lambda expression</a> to a hook, it’s
typically much nicer to edit it in your Init File in
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Lisp-Eval"><code>emacs-lisp-mode</code></a>﻿ than to edit it in a hole in a Customize form.
Additionally, some authors of 3rd-party libraries, especially older ones,
may have been too lazy to set up Customization for their User Options.<sup><a id="fnr.286" href="#fn.286" role="doc-backlink">286</a></sup>
Finally, if you start writing your own Elisp functions or defining your own
<a href="#orgb1883e1">Faces</a>, your Init File is the place to put them!
</p>
</div>
<div id="outline-container-orgc413609">
<h5 id="orgc413609">Where is My Init File?</h5>
<p>
For historical and political<sup><a id="fnr.287" href="#fn.287" role="doc-backlink">287</a></sup> reasons, there are several acceptable
locations for your Init File.  The oldest, most traditional, filename is
<code>~/.emacs</code>, though Emacs now prefers <code>~/.emacs.el</code> (adding the standard file
extension for Elisp files).  These locations use your home directory, but there
are good reasons to prefer putting it in your User Emacs Directory, which by
default is <code>~/.emacs.d/</code> under the name <code>init.el</code>, or, in full, <code>~/.emacs.d/init.el</code>.
I recommend the latter: Emacs will eventually create this directory anyway, to
store other files like packages you’ve installed, abbreviations, or <a href="#orgf2e3965">your
saved desktop</a>, so why not keep your Init File in the same place?  For more
information, see <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Find-Init">“Find Init”</a> in the <i>Emacs</i> manual.<sup><a id="fnr.288" href="#fn.288" role="doc-backlink">288</a></sup>
</p>
</div>
<div id="outline-container-orgb3e62d1">
<h5 id="orgb3e62d1">Basics of Elisp Syntax</h5>
<div id="text-orgb3e62d1">
<p>
While you don’t really need to be an Elisp programmer to do simple Init File
customizations, you do need to understand the bare minimum of Lisp syntax to do
it correctly.  Fortunately, few serious programming languages have a simpler
syntax than Lisp!<sup><a id="fnr.289" href="#fn.289" role="doc-backlink">289</a></sup>
</p>

<p>
A Lisp expression is either an <i>atom</i>, or a list of expressions—note the
recursive definition.  The simplest atom is a <i>symbol</i>, which you can think of as
a word, and a <i>list</i> is a space-separated sequence of expressions surrounded by
parentheses.  So all of these are expressions:
</p>
<dl>
<dt><code>nil</code></dt><dd>an atom (symbol)</dd>
<dt><code>use-file-dialog</code></dt><dd>another atom</dd>
<dt><code>(nil use-file-dialog)</code></dt><dd>a list of two atoms</dd>
<dt><code>(nil (nil use-file-dialog))</code></dt><dd>a list of two expressions, an atom and a (sub-)list</dd>
</dl>

<p>
That’s almost all there is to it!  Your Init File consists of a sequence of such
expressions, separated by (optional) blank lines and <i>comments</i>.  Practically
speaking, all your top-level expressions will be lists.  Comments are notes to
the reader and are ignored by Elisp; a comment starts with a semicolon and
extends to the end of the line.  Here’s a possible snippet from an Init File: a
comment, followed by an expression that’s a list of three symbols:
</p>
<div>
<pre><span>;; </span><span>turn off GUI dialogs...</span>
(<span>setq</span> use-file-dialog nil)
</pre>
</div>
<p>
Note that using two semicolons to start the comment is just a convention; just
one would be sufficient.
</p>

<p>
There is of course a little more—but surprisingly little—to Lisp syntax than
this.  In particular, there are a few types of atoms other than symbols, which
have their own syntax: things like numbers, strings, and such; see <a href="#org07c1cba"><i>Variables
and Symbols</i></a> for details.
</p>
</div>
</div>
<div id="outline-container-org1d13f50">
<h5 id="org1d13f50">Quoting</h5>
<div id="text-org1d13f50">
<p>
One final bit of syntax is the <i>quotation</i>: any Lisp expression can be prefixed
with a single quote (apostrophe) character <code>&#39;</code> in order to prevent its
<i>evaluation</i>.  Here are two quoted expressions: <code>&#39;linum-mode</code> and
<code>&#39;(partial-completion substring flex)</code>.  Note that we use just one <code>&#39;</code> as a prefix,
not a pair of them!
</p>

<p>
I can’t reveal the truth of when you need to quote something and when you don’t
in the space I have available: this is at the heart of understanding the
semantics of Lisp.  See <a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/Top">the <i>Eintr</i> manual</a> for a complete discussion.
But I will give a few hints below.
</p>
</div>
</div>
<div id="outline-container-org5fe54f1">
<h5 id="org5fe54f1"><a id="orge6fb506"></a> Setting User Options</h5>
<div id="text-org5fe54f1">
<p>
Let’s see how to set a simple User Option in your Init File (even though you
should prefer   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-option</code></a>﻿).  I personally hate the GUI
dialog boxes that Emacs will occasionally pop up; I want Emacs to always use
the <a href="#orga329460">Minibuffer</a> instead.  There are two User Options to control this:
  <code>use-file-dialog</code> and   <code>use-dialog-box</code>.
</p>

<p>
The first step in setting a User Option is to <i>read the help</i> so that you
understand what values are legitimate, so do
    <code>C-h v</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Name-Help"><code>describe-variable</code></a>﻿) on each of them.  Turns out both of
these are simple Booleans: I want to set them to <code>nil</code> (i.e. “false”, or
“off”).<sup><a id="fnr.290" href="#fn.290" role="doc-backlink">290</a></sup>
</p>

<p>
The basic Elisp function for setting a variable’s value is
  <code>setq</code>.  It takes two parameters: the variable name, and the
new value.  So this snippet does the job:
</p>
<div>
<pre><span>;; </span><span>turn off GUI dialogs...</span>
(<span>setq</span> use-file-dialog nil)
(<span>setq</span> use-dialog-box nil)
</pre>
</div>
<p>
Some variables want to be set to a number or a string; just write the obvious:
</p>
<pre>(setq some-variable &#34;this is a string&#34;)
(setq some-other-variable 12)
</pre>

<p>
But some variables want to be set to a <i>symbol</i>.  For example,
  <code>locale-coding-system</code> says what to interpret as your <a href="https://en.wikipedia.org/wiki/Locale_(computer_software)"><i>system
locale</i></a>.  Your OS usually tells Emacs what this is, but if it doesn’t, you could
set it in your Init File.  The point is that this variable should be set to a
symbol—perhaps <code>utf-8-unix</code>.  You would think this would do the job:
</p>
<pre>(setq locale-coding-system utf-8-unix)            ; WRONG
</pre>

<p>
But this will generate an error.   Since symbols serve as Lisp variables. Elisp
will try to evaluate <code>utf-8-unix</code> as a variable to get its value—but it’s not a
variable with a value: it’s just a symbol standing for itself.  So you have to
quote it to prevent it from being evaluated, like so:
</p>
<pre>(setq locale-coding-system &#39;utf-8-unix)
</pre>

<p>
Remember, when the help for a variable says its value should be a symbol, you
need to quote the symbol.
</p>

<p>
When a variable says its value should be a <i>function</i>, you also want to quote it.
This is for the same reason, because most functions are represented as symbols.
The help for   <code>confirm-kill-emacs</code> says:
</p>
<blockquote>
<p>
How to ask for confirmation when leaving Emacs.  If nil, the default, don’t ask
at all.  If the value is non-nil, it should be a predicate function; for example
‘yes-or-no-p’.
</p>
</blockquote>
<p>
I have this in my Init File:
</p>
<pre>(setq confirm-kill-emacs &#39;yes-or-no-p)
</pre>


<p>
The same goes for when a variable wants a list: you’ll need to be sure to <i>quote</i>
the list.  This is because lists of data look like function calls: or if you prefer,
function calls are expressed as lists.  This keeps the syntax very simple, at
the cost of knowing what’s data and what isn’t.
</p>

<p>
  <code>world-clock-list</code> configures the cities for
  <code>M-x</code> <code>world-clock</code> (see <a href="#org307006d"><i>World Clock</i></a>).  I set it to four cities:
</p>
<div>
<pre>(<span>setq</span> world-clock-list
      &#39;((<span>&#34;America/Chicago&#34;</span> <span>&#34;Chicago&#34;</span>)
        (<span>&#34;America/New_York&#34;</span> <span>&#34;Kalamazoo&#34;</span>)
        (<span>&#34;America/New_York&#34;</span> <span>&#34;Syracuse&#34;</span>)
        (<span>&#34;Europe/Vienna&#34;</span> <span>&#34;Vienna&#34;</span>)))
</pre>
</div>
<p>
The value here is a list of four lists; each sub-list is a list of two strings.
Note how I quote the outer list (but I don’t need to quote any of the contained
values).  If I don’t quote the list, I get an error:
</p>
<pre>Invalid function: (&#34;America/Chicago&#34; &#34;Chicago&#34;)
</pre>

<p>
So when setting a variable to a list, quote the list.
</p>
</div>
</div>
<div id="outline-container-orgea6d6f2">
<h5 id="orgea6d6f2">Setting Default Values</h5>
<div id="text-orgea6d6f2">
<p>
Some variables are declared <a href="#org871902b"><i>Buffer Local</i></a>; when you ask for help about them,
the documentation will say: “Automatically becomes buffer-local when set”.
Buffer Local variables are meant to potentially have a different value in every
Buffer.  So customizing one actually means setting a <i>default</i> value, which will
be the variable’s value in any Buffer where you haven’t given it a presumably
different <i>local</i> value.
</p>

<p>
<code>setq</code> will only set the local value of a Buffer Local variable; to set the
default value, we need to use a different function:
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Locals"><code>setq-default</code></a>﻿.
</p>

<p>
I recommend setting the variable   <code>indent-tabs-mode</code> to <code>nil</code>
so that Emacs uses only spaces—never tab characters—for indentation (see
<a href="#orgfe6844c"><i>Tabs vs Spaces</i></a>).  Here’s how to do it:
</p>
<div>
<pre><span>;; </span><span>never use tabs to indent</span>
(<span>setq-default</span> indent-tabs-mode nil)
</pre>
</div>
<p>
So remember, when you read the Help and it says the variable is Buffer Local,
use <code>setq-default</code>.
</p>
</div>
</div>
<div id="outline-container-org534aa0f">
<h5 id="org534aa0f">Setting Hooks <a id="org23573da"></a></h5>
<div id="text-org534aa0f">
<p>
A <i>Hook</i> is just a regular variable with a particular purpose: to hold a list of
functions; see <a href="#orgc54c064"><i>Hooks</i></a> for an explanation.  While you could technically set a
Hook in your Init File with <code>setq</code>, there’s a special function to make it easier:
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Hooks"><code>add-hook</code></a>﻿.  <code>add-hook</code> is preferred to <code>setq</code> for this purpose
because it does some extra work that’s appropriate to Hook variables.
</p>

<p>
Suppose you want to turn on <a href="#orgda03eba">spell check</a> in   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Text-Mode"><code>text-mode</code></a>﻿ and
other Major Modes derived from it.  This is the right way to do it:
</p>
<pre>(add-hook &#39;text-mode-hook &#39;flyspell-mode)
</pre>

<p>
<code>flyspell-mode</code> is of course a function that toggles a Minor Mode on and off, and
such Minor Mode functions are the most common things to add to Hooks.
</p>

<p>
Since   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Spelling"><code>flyspell-mode</code></a>﻿ is a function, you know you have to
quote it.   But why is the variable name   <code>text-mode-hook</code>
also quoted?  The variable names we use with <code>setq</code> aren’t quoted!
</p>

<p>
There’s a good and sensible reason, but I won’t try to go into it here (Chassell
explains it in <a href="https://www.gnu.org/software/emacs/manual/html_node/eintr/Text-and-Auto-fill">“Text and Auto-fill”</a> in the <i>Eintr</i> manual): for now, you’ll
have to just take this as a magic incantation that placates the Emacs gods.
So when using <code>add-hook</code>, quote both the name of the Hook, and the name of the
function you’re adding to it.
</p>

<p>
By the way, the extra work that <code>add-hook</code> does for you that plain <code>setq</code> wouldn’t
is that it only adds the function to the Hook’s list of functions if it’s not
already there.
</p>

<p>
Please note that you can set Hooks from Customize, and you should generally
prefer to do so.  But as your Elisp skills grow, you might find it awkward to
edit a multi-line
<a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Lambda-Expressions">lambda expression</a> in a hole
in a form.
</p>
</div>
</div>
<div id="outline-container-org827e7d8">
<h5 id="org827e7d8"><a id="orge0608a1"></a> Defining Key Bindings</h5>
<div id="text-org827e7d8">
<p>
Defining Key Bindings is the big lacuna in the Customize Facility, but your Init
File is here for you.  Let’s bind   <code>linum-mode</code> to a key so
you can more easily toggle it on and off.  We’ll use the mnemonic <code>C-c l</code> for our
keystroke (see <a href="#orgcd7c1d3"><i>Bind It To a Key</i></a> for more on this choice).  If we want our new
binding to work everywhere, then we want to use
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Rebinding"><code>global-set-key</code></a>﻿ according to this pattern:
</p>
<div>
<pre>(global-set-key (kbd <span>&#34;C-c l&#34;</span>) &#39;linum-mode)
</pre>
</div>
<p>
By now you won’t be surprised that you have to quote the function (<code>linum-mode</code>)
that you’re binding.  But what’s up with <code>(kbd &#34;C-c l&#34;)</code>?
</p>

<p>
This is one of many ways you can “spell” a key binding.  The <code>kbd</code> function takes
a string that specifies the binding in the same way that Emacs talks about it.
So think of your desired binding, and then ask Emacs how it’s spelled, and use
that.
</p>

<p>
Suppose you want to bind <code>linum-mode</code> mode to a function key instead—perhaps F7.
But how do you spell “F7”?  Just ask Emacs: invoke
    <code>C-h c</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Key-Help"><code>describe-key-briefly</code></a>﻿) and when prompted for a
keystroke, hit that key.  You’ll see in the <a href="#org7e7133f">Echo Area</a> that Emacs spells it <code>&lt;f7&gt;</code>, so
you’d use <code>(kbd &#34;&lt;f7&gt;&#34;)</code>.
</p>
</div>
<div id="outline-container-orge3ee3d5">
<h6 id="orge3ee3d5">Remapping Commands</h6>
<div id="text-orge3ee3d5">
<p>
Sometimes you want to replace a command that’s already bound to one or more
keystrokes with an alternative command that you prefer.  Suppose you’ve
installed an alternative to <a href="#orgcc42ce0">Dired</a>, say <code>neo-dired</code>, for directory editing.
    <code>C-h w</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Key-Help"><code>where-is</code></a>﻿) tells me that   <code>dired</code> is
bound to three keystrokes<sup><a id="fnr.291" href="#fn.291" role="doc-backlink">291</a></sup>: <code>C-x C-d</code>, <code>C-x d</code>, and <code>&lt;menu-bar&gt; &lt;file&gt;
&lt;dired&gt;</code>.  We can change the binding of <code>C-x C-d</code> with this expression:
</p>
<div>
<pre>(global-set-key (kbd <span>&#34;C-x C-d&#34;</span>) &#39;neo-dired)
</pre>
</div>
<p>
but now we have to do two more.  Instead, we can change all the <code>dired</code> bindings
with this single expression:
</p>
<div>
<pre>(global-set-key [remap dired] &#39;neo-dired)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd11e99d">
<h6 id="orgd11e99d">Disabling Commands</h6>
<div id="text-orgd11e99d">
<p>
As discussed earlier, Emacs starts with some commands (thought to be confusing
to newbies) <a href="#org46fc1c3">disabled</a> by default.  While I think you’ll eventually enable all
these commands, you might actually want to <i>disable</i> some other commands that you
find annoying.
</p>

<p>
For example,   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Exiting"><code>suspend-frame</code></a>﻿ is bound to <code>C-z</code> and <code>C-x C-z</code> and
“iconifies” an Emacs Frame (when running in graphical mode).  What
“iconification” actually does is up to your window manager; usually it minimizes
the Frame.  Since I use a <a href="https://en.wikipedia.org/wiki/Tiling_window_manager">tiling window manager</a>, this command is useless to me
and actually has an annoying effect.  I don’t want to accidentally invoke it, so
I disable it like so:
</p>
<div>
<pre>(put &#39;suspend-frame &#39;disabled t)
</pre>
</div>
<p>
You can use this as a recipe; be sure to imitate the quoting style.
</p>
</div>
</div>
<div id="outline-container-orgebe53bd">
<h6 id="orgebe53bd">Un-binding Commands</h6>
<div id="text-orgebe53bd">
<p>
A less extreme version of this might be to not actually disable a command, but
just remove the key binding by which you accidentally invoke it.  You can do
this by binding a key to the special symbol <code>nil</code> like this:
</p>
<div>
<pre>(global-set-key (kbd <span>&#34;C-z&#34;</span>) nil)
</pre>
</div>
<p>
After this, <code>C-z</code> will just beep at you, but you can still invoke the command that
was previously bound to <code>C-z</code> with   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Exiting"><code>suspend-frame</code></a>﻿.
See <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Key-Bindings">“Key Bindings”</a> in the <i>Emacs</i> manual for more information..
</p>
</div>
</div>
</div>
<div id="outline-container-org8c2354a">
<h5 id="org8c2354a">Test Your Init File Modifications!</h5>
<div id="text-org8c2354a">
<p>
After every Init File tweak, you should immediately do a test to make sure you
haven’t introduced an error!  This is especially so if, as I recommend, you run
the <a href="#org22671bb">Emacs Server</a>, which implies that it may be a long time before you next
restart your Emacs.  If it’s been weeks since you tweaked your Init File, an
error at startup time will be all the more puzzling.
</p>

<p>
After saving your tweaked Init File, just do this:
</p>
<pre>M-&amp; emacs --no-desktop --debug-init
</pre>

<p>
This fires up a fresh Emacs (without your current desktop); if it pops up with
no errors, you’ve passed the first test!  You should also test the new
functionality you added to see if, in addition to not blowing up with an error,
it also actually does what you expect!  Then just do
    <code>C-x C-c</code> (<code>save-buffers-kill-emacs</code>) to exit and breathe
easy. (Some classes of bugs won’t reveal themselves this early in the game, but
you might as well eliminate the ones that will.)
</p>

<p>
If you <i>have</i> made a mistake that generates an error, the <code>--debug-init</code>
option will pop up the debugger; even without Elisp debugging skills, this should
help you determine where your error is—and anyway, you know it’s got to be in
the tweak you just made!  Use     <code>q</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>debugger-quit</code></a>﻿) to quit out
of the debugger, and <code>C-x C-c</code> to exit the test Emacs, and see if you can fix your
bug (in the original Emacs where you were editing your Init File).
</p>
</div>
</div>
</div>
<div id="outline-container-org431dde2">
<h4 id="org431dde2">Defining Your Own Commands</h4>
<div id="text-org431dde2">
<p>
One common reason for writing a program is to automate a repetitive editing
task.  Many such tasks are ad hoc and unique to one situation.  <a href="#orgd2c3858">Keyboard Macros</a>
are often ideal for this: they’re easy and fast to write, so you don’t feel bad
about throwing them away when you’re done.
</p>

<p>
But for more complex tasks, you’ll need a real programming language, and since
you’re living inside of a Lisp Machine, of course you’ll choose Emacs Lisp.
</p>

<p>
Now, I can’t teach you to program in one chapter, but you <i>can</i> learn if you want
to, and Robert Chassell’s <a href="https://www.gnu.org/software/emacs/manual/html_mono/eintr.html#Top"><i>An Introduction to Programming in Emacs Lisp</i></a> is the
perfect choice.  It starts from scratch, uses Elisp, the programming examples
are Emacs-oriented, and the entire book can be read in <a href="#orga6bbd55">Info</a>, while you write,
test, and debug your programs in Emacs.
</p>

<p>
If you’re already a programmer, or know another Lisp (like Common Lisp or
Clojure), you can skim through Chassell or dive right into the <a href="https://www.gnu.org/software/emacs/manual/html_mono/elisp.html#Top">Elisp manual</a>.
</p>

<p>
What I <i>can</i> do in this chapter is give you a taste of what Elisp programming
feels like.  We’ll implement a realistic but simple new Emacs command, one that
I, at least, actually find to be useful.
</p>
</div>
<div id="outline-container-orgd8f65f1">
<h5 id="orgd8f65f1">A Missing Command</h5>
<div id="text-orgd8f65f1">
<p>
What with the 6,045 interactive commands that Emacs starts out
with, you might be surprised to discover you need one that doesn’t already
exist.  I wanted to be able to jump to a random Buffer line, and couldn’t find a
command to do it.  Such a command would fit among the Goto commands on the <code>M-g</code>
prefix (    <code>M-g M-g</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>goto-line</code></a>﻿),
    <code>M-g c</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>goto-char</code></a>﻿), and friends).  Myself, I’d bind it to
<code>M-g M-r</code>.
</p>

<p>
So of course I wrote it and added it to my <a href="#org2af3730">Init File</a>, and now I can <code>M-g M-r</code>
whenever I want.
</p>

<p>
What use is such a command?  I frequently have lists of things in my Emacs: some
are generated by Emacs (like the Buffer generated by
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Colors"><code>list-colors-display</code></a>﻿) and some I maintain in files myself —
lists of songs or books or movies to watch, for example.  Some of these lists
have hundreds of lines, and sometimes it’s easier to have Emacs pick a
candidate, rather than having to scroll through them, staring until my eyes
glaze over.  (I can’t be the only person who needs this; there are dozens of web
sites that let you paste in your data and will then pick a line at random for
you — while you gaze at their ads and they gather your personal info from the
data, I presume.)
</p>
</div>
</div>
<div id="outline-container-org45bd8a3">
<h5 id="org45bd8a3">An Implementation</h5>
<div id="text-org45bd8a3">
<p>
Here’s what I wrote.  Let’s dissect the parts to see what makes Elisp code, and
an Emacs command, tick.
</p>
<div>
<pre><span>;; </span><span>this is my new command</span>
(<span>defun</span> <span>kw-goto-random-line</span> ()
  <span>&#34;Go to a randomly chosen line in the current buffer.&#34;</span>
  (<span>interactive</span>)
  (goto-line (+ 1 (random (count-lines (point-min) (point-max))))))
</pre>
</div>
<p>
The first thing you’ll notice, probably <i>especially</i> if you’re a programmer, is
all the nested parentheses; this is a hallmark of all members of the <a href="https://en.wikipedia.org/wiki/Lisp_(programming_language)">Lisp</a>
family.<sup><a id="fnr.292" href="#fn.292" role="doc-backlink">292</a></sup> Don’t worry about it:   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Lisp-Eval"><code>emacs-lisp-mode</code></a>﻿ makes
it very easy to keep track of where you are when you’re editing code.
</p>

<p>
Amounts of whitespace (except in string literals) are not significant in
Elisp<sup><a id="fnr.293" href="#fn.293" role="doc-backlink">293</a></sup>; you could write the whole function on one line to be perverse.
Lispers use a standard indentation style which is understood by <code>emacs-lisp-mode</code>,
so you barely have to do anything other than hit return in order to have your
function indented conventionally.
</p>
</div>
</div>
<div id="outline-container-orgff4917c">
<h5 id="orgff4917c">Comments</h5>
<div id="text-orgff4917c">
<p>
My code starts with a
<a href="https://en.wikipedia.org/wiki/Comment_(computer_programming)">comment</a> on the
first line:
</p>
<pre>;; this is my new command
</pre>

<p>
Elisp comments start with a semicolon and continue to the end of the line; it’s
conventional, but not mandatory, that whole-line comments start with two
semicolons.  Comments are very useful in general, and are to be encouraged, but
this comment is just a demonstration; it’s completely pointless.  For one thing,
it tells the reader nothing useful.  It would also be pointless to use it to
describe what the function does—the usual reason for such a comment in most
languages—because the <i>docstring</i> (see below) does that for us.
</p>
</div>
</div>
<div id="outline-container-org4875131">
<h5 id="org4875131">Naming Things</h5>
<div id="text-org4875131">
<p>
We’re looking at a <i>function definition</i>: <code>defun</code> stands for “define function”.  For
the name of this function I chose <code>kw-goto-random-line</code>.  Elisp functions need
fairly long, descriptive names.  Since there are 21,066
functions in a stock Emacs, you need a long name to make it unique (there’s
already a standard Elisp function called   <code>random</code>, for
example, so that’s right out).  When you type them, either at a <code>M-x</code> prompt for
commands, or in source code, <a href="#org75fb6a2">Completion</a> means you don’t need to type the whole
thing anyway, and the long names help you recognize the function you want to use
amongst the Completion candidates.
</p>

<p>
I chose <code>goto-random-line</code> rather than, say, <code>jump-to-random-line</code>, just
because Emacs already uses the <code>goto-</code> prefix for other related functions.
Finally, I used my <i>personal namespace</i>, <code>kw-</code>, at the very beginning: Elisp doesn’t have
real <a href="https://en.wikipedia.org/wiki/Namespace">namespaces</a>, so we use package name prefixes as a hack<sup><a id="fnr.294" href="#fn.294" role="doc-backlink">294</a></sup>, and every Emacs user
(who programs) has their own personal prefix they use to namespace their
personal functions.
</p>

<p>
You might be surprised that I’m allowed to use hyphens in my function
name<sup><a id="fnr.295" href="#fn.295" role="doc-backlink">295</a></sup>; this isn’t allowed in most programming languages because it would
be taken as a chained subtraction of four variables.  In most programming
languages, underscores are used instead of hyphens, but because of Lisp’s
unique syntax, you can use almost any character in a name.  In Lisp, hyphens are to be
preferred over underscores.
</p>
</div>
</div>
<div id="outline-container-orge4ff8e5">
<h5 id="orge4ff8e5">Function Parameters</h5>
<p>
The <code>()</code> after the function name is the <i>formal parameter list</i>; this function
doesn’t have any parameters, but the empty parens are still required.
</p>
</div>
<div id="outline-container-orgfe71c86">
<h5 id="orgfe71c86">The Docstring</h5>
<div id="text-orgfe71c86">
<p>
We know that all (good) Emacs commands have documentation that you can look up
in the <a href="">Help</a> system (and that goes for non-command functions too).  This
documentation is a part of the function definition called the <a href="https://en.wikipedia.org/wiki/Docstring"><i>docstring</i></a>.  Most
modern programming languages have docstrings (they were invented in the TECO
implementation of Emacs in 1976), though often only as a distinguished form of
comment extracted by a post-processor; in Elisp, docstrings are actually
attached to the symbol that names the command, which is what makes the Help and
<a href="#org42f1d6b">Apropos</a> systems possible.
</p>

<p>
A good docstring starts with a one-sentence summary of the behavior of the
function.  It can be much longer than that: many paragraphs, if necessary, and
Elisp defines a markup language for docstrings that supports hypertext links to
related functions, variables, documentation, and the like.
</p>
</div>
</div>
<div id="outline-container-orgc5a1d98">
<h5 id="orgc5a1d98">Commands Must be Interactive</h5>
<div id="text-orgc5a1d98">
<p>
While all Emacs commands are functions, not all functions are commands.
Commands are functions intended to be called <i>interactively</i>: that is, invoked
explicitly by the user, via   <code>M-x</code> or a key- or mouse-binding.
Non-command functions, on the other hand, are intended to be called indirectly
by other commands or functions.
</p>

<p>
Why not let all functions be invoked by the user?<sup><a id="fnr.296" href="#fn.296" role="doc-backlink">296</a></sup> The main reason is
because it results in a better user experience; otherwise, the Completion space
would be expanded at least four-fold, and it would diminish the utility of
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Apropos"><code>apropos-command</code></a>﻿, forcing you to plow through many functions that
you’re never going to invoke directly.
</p>

<p>
So, unless you mark a function as a command, you can’t invoke it via <code>M-x</code> or a
key binding.  The <a href="https://www.gnu.org/software/emacs/manual/html_mono/elisp.html#Special-Forms"><i>special form</i></a> <code>(interactive)</code> marks a function as a command,
and it has to come immediately after the docstring in the function definition.
</p>

<p>
The remainder of the <code>defun</code> is the code that actually implements our command.  To
summarize, the overall shape of any Elisp command definition looks like:
</p>
<div>
<pre>(<span>defun</span> <span>COMMAND-NAME</span> (PARAMETER ...)
  <span>&#34;DOCSTRING.</span>
<span>MORE DOCUMENTATION...&#34;</span>
  (<span>interactive</span>)
  (IMPLEMENTATION CODE))
</pre>
</div>
</div>
</div>
<div id="outline-container-org30eea6d">
<h5 id="org30eea6d">The Algorithm</h5>
<div id="text-org30eea6d">
<p>
So how can we implement jumping to a random line in the Buffer?  We know how to
jump to a <i>specific</i> line: just call   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>goto-line</code></a>﻿ with the number of
the line we want to jump to.  So what if we just call <code>goto-line</code> with a <i>random</i>
number?  That’s not quite right: about half of the random numbers are <i>negative</i>
numbers, and those are not suitable to use as line numbers.  So we need a
<i>positive</i> random number — but even that’s not quite right: there are a lot of
positive random numbers out there, and most of them are bigger than the number
of lines in any given buffer.<sup><a id="fnr.297" href="#fn.297" role="doc-backlink">297</a></sup>
</p>

<p>
So really, we want a random number greater than \(0\) and less than or equal to
the number of lines in the current Buffer.  Given that, we can just pass it to
<code>goto-line</code> and we’re done.
</p>

<p>
Every programming language has functions to generate random numbers, but how do
we figure out how to do that in Elisp?  The <a href="#org42f1d6b">Apropos</a> system will do the job:
<code>M-x apropos RET random RET</code> lists seven candidates<sup><a id="fnr.298" href="#fn.298" role="doc-backlink">298</a></sup> and we can easily spot
the obvious one:   <code>random</code>.  Alternatively, we can pop into
the <a href="https://www.gnu.org/software/emacs/manual/html_mono/elisp.html#Top">Elisp manual</a> in <a href="#orga6bbd55">Info</a>, invoke     <code>i</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/info/Search-Index"><code>Info-index</code></a>﻿) and give it
“random” and be taken directly to §3.10 Random Numbers, which describes the
<code>random</code> function in detail.  Most significantly, we see that we can give <code>random</code>
an optional integer parameter \(LIMIT\), which causes <code>random</code> to return a number
from 0 to \((LIMIT-1)\).
</p>

<p>
We also need to know how to find the number of lines in the current Buffer, so that
we can pass a suitable upper-bound to <code>random</code>.  The same documentation-searching
techniques with Apropos or the Manual will lead us to the function
  <code>count-lines</code>.
</p>

<p>
So our algorithm is: count the lines in the Buffer, get a random number in that
range, and pass it to <code>goto-line</code>.
</p>
</div>
</div>
<div id="outline-container-org4f182b8">
<h5 id="org4f182b8">The Actual Code</h5>
<div id="text-org4f182b8">
<p>
Finally, we get to the actual code that implements our algorithm.  After the
<code>(interactive)</code> in our defun, we place one or more Elisp <i>expressions</i><sup><a id="fnr.299" href="#fn.299" role="doc-backlink">299</a></sup>.  (The
value of the last expression in the defun is returned from the function, but
the returned value of an interactively-invoked command is ignored.)
</p>

<p>
Our implementation is a one-liner: four nested function calls.  In most
programming languages, a <i>function call</i> looks much as it does in mathematical
notation.  To call a function \(f\) with the arguments \(x\) and \(y\) typically looks
like \(f(x,y)\).  This is a <i>prefix notation</i>—the function name precedes its
operands—to be distinguished from the <i>infix notation</i> used for common <a href="https://en.wikipedia.org/wiki/Infix_notation">binary
operators</a> like \(+\), \(-\), \(\times\), and \(\div\).
</p>

<p>
But Lisp uses <i>fully-parentheszied Polish prefix notation</i><sup><a id="fnr.300" href="#fn.300" role="doc-backlink">300</a></sup>, in which the
function call would look like <code>(f x y)</code>.  We just move the left parenthesis to the
left of the function name.  Additionally, we don’t need to use commas to separate the
arguments: just whitespace.  Our expression:
</p>
<pre>(goto-line (+ 1 (random (count-lines (point-min) (point-max))))))
</pre>

<p>
in traditional notation would look something like:
</p>
<pre>goto_line(1 + random(count_lines(point_min(), point_max()))) ; this is NOT Elisp
</pre>

<p>
Polish prefix notation implies that even functions that are typically written as
infix operators are written in prefix form: instead of \(1 + x\) we write <code>(+ 1 x)</code>.
Prefix notation is more consistent, allows us to use any characters in our
function and variable names, doesn’t require us to memorize operator precedence
rules, and has <a href="https://en.wikipedia.org/wiki/Homoiconicity">deeper advantages</a> as well.
</p>

<p>
Step 1 in our algorithm is to call <code>count-lines</code>.    <code>C-h f</code>
<code>count-lines</code> tells us that we need to give it two parameters:
</p>
<pre>(count-lines START END)
</pre>

<p>
because it’s a general purpose function that counts the lines in the Region
bounded by <code>START</code> and <code>END</code>, which are character positions in the Buffer,
i.e. possible values of <a href="#orgba1f634">Point</a>.  For <code>START</code> we need the position of the beginning
of the Buffer, and for <code>END</code> that of the end of the Buffer.  The function
  <code>point-min</code> gives us <code>START</code><sup><a id="fnr.301" href="#fn.301" role="doc-backlink">301</a></sup>, and
  <code>point-max</code> gives us <code>END</code>.  Neither of these functions takes
any parameters, so putting them together gives us:
</p>
<pre>(count-lines (point-min) (point-max))
</pre>

<p>
the result of which is the value we want to pass to <code>random</code>.
</p>

<p>
There’s a wrinkle: a careful reading of <code>random</code>’s documentation tells us that,
given a numeric parameter as a limit, it will return a random number from \(0\) to
<i>one less than</i> the limit.  (Counting from zero makes programmers happy and is
very common.)  There’s really no line \(0\) in a Buffer, and if our random number
can never be the last line in the Buffer, then our random number is <i>biased</i>
against the last line.
</p>

<p>
Fortunately we can easily fix both of these problems by just adding \(1\) to the
number of lines!  The number is still random: we’ve just adjusted its range:
</p>
<pre>(+ 1 (count-lines (point-min) (point-max)))
</pre>

<p>
All that’s left is to pass this adjusted random line number to <code>goto-line</code>:
</p>
<pre>(goto-line (+ 1 (random (count-lines (point-min) (point-max))))))
</pre>

<p>
That’s our complete function; let’s take a look at it again:
</p>
<div>
<pre>(<span>defun</span> <span>kw-goto-random-line</span> ()
  <span>&#34;Go to a randomly chosen line in the current buffer.&#34;</span>
  (<span>interactive</span>)
  (goto-line (+ 1 (random (count-lines (point-min) (point-max))))))
</pre>
</div>
<p>
We can test it with <code>M-x kw-goto-random-line</code>.
</p>
</div>
</div>
<div id="outline-container-org6d06757">
<h5 id="org6d06757">Bind It to a Key <a id="orgcd7c1d3"></a></h5>
<div id="text-org6d06757">
<p>
For some custom commands, we might be done at this point.  <code>M-x</code> is good enough
for commands that are only occasionally invoked.  But my use case for this
command is to invoke it in a long Buffer, and if I’m not inspired by the line I
land on, to invoke it again immediately, and perhaps repeat the process a dozen
times until serendipity solves my decision-making problem—kind of like the way
<a href="https://en.wikipedia.org/wiki/John_Cage">John Cage</a> or <a href="https://en.wikipedia.org/wiki/Philip_K._Dick">Philip K. Dick</a> used the <a href="https://en.wikipedia.org/wiki/I_Ching"><i>I Ching</i></a> in their music composition or
writing.
</p>

<p>
In other words, I want to bind my new command to a keystroke for easy
invocation.  This means I need to pick a key sequence.  I can either come up
with an unused one, or steal the existing binding of some command I don’t I
think deserves it.  (It’s completely fine to change standard key bindings:
you’re just turning Emacs into your ideal editor.)
</p>

<p>
<a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Key-Binding-Conventions">Appendix D.2, Key Binding Conventions</a>,
in the Elisp manual, addressing the authors of Elisp packages, says:
</p>
<blockquote>
<p>
Don’t define ‘C-c LETTER’ as a key in Lisp programs.  Sequences consisting of
‘C-c’ and a letter (either upper or lower case) are reserved for users; they are
the <b>only</b> sequences reserved for users, so do not block them.
</p>
</blockquote>
<p>
When you’re defining a command in your Init File, <i>you’re</i> the user, so those 52
<code>C-c</code> <i>LETTER</i> key sequences are available to use for your own commands.  But for this
command, I’m going to put it on the <code>M-g</code> prefix along with the other <code>goto-</code>
commands.  The <code>M-g</code> prefix only has nine bindings out of the box, which gives me
a wealth of available bindings to choose from.  I think the <a href="#org38efd5c">felicitous</a> and
mnemonic binding <code>M-g M-r</code> is perfect.  Here’s the command that goes in our <a href="#org2af3730">Init
File</a>:
</p>
<div>
<pre>(global-set-key (kbd <span>&#34;M-g M-r&#34;</span>) &#39;kw-goto-random-line)
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org5e9b007">
<h4 id="org5e9b007">References</h4>
<div id="text-org5e9b007">
<ul>
<li>Chassell, Robert J. 2020. <i>An Introduction to Programming in Emacs Lisp.</i> Cambridge, MA: Free Software Foundation. <a href="https://www.gnu.org/software/emacs/manual/eintr.html">https://www.gnu.org/software/emacs/manual/eintr.html</a>.
Read in Emacs with <code>M-x info-display-manual RET eintr RET</code>.</li>

<li>Glickstein, Bob. 1997. <i>Writing GNU Emacs Extensions.</i> Sebastopol, CA: O’Reilly Media..</li>

<li>Guerry, Bastien. 2013. <i>Learn Emacs Lisp in 15 minutes.</i> <a href="https://learnxinyminutes.com/docs/elisp/">https://learnxinyminutes.com/docs/elisp/</a>.</li>

<li>Krawitz, Robert, Bil Lewis, Dan LaLiberte, Richard M. Stallman and Chris Welty. 2019. <i>GNU Emacs Lisp Reference Manual.</i> Cambridge, MA: Free Software Foundation. <a href="https://www.gnu.org/software/emacs/manual/elisp.html">https://www.gnu.org/software/emacs/manual/elisp.html</a>.
Read in Emacs with <code>M-x info-display-manual RET elisp RET</code>.</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org9b84fb8">
<h3 id="org9b84fb8">The Emacs Community <a id="orgef60a36"></a></h3>
<p>
There’s a vibrant, friendly, and helpful global community of Emacs users,
including the volunteers who maintain the source code.
</p>
<div id="outline-container-org1b817fa">
<h4 id="org1b817fa">Project GNU</h4>
<p>
GNU Emacs is part of the <a href="https://www.gnu.org/">GNU</a> project (GNU’s Not Unix!) and has its <a href="https://www.gnu.org/software/emacs/">home</a> there.
You can go there for the official <a href="https://www.gnu.org/software/emacs/download.html">download page</a>, web versions of the
<a href="https://www.gnu.org/software/emacs/documentation.html">documentation</a>, and more.
</p>
</div>

<div id="outline-container-org55544db">
<h4 id="org55544db">The Emacs Wiki <a id="org3f8226a"></a></h4>
<p>
After the FAQ, your next stop should be the community-supported <a href="http://www.emacswiki.org/">Emacs Wiki</a>; it’s
loaded with tips, tutorials, opinions, examples, and Elisp code.  Try the <a href="https://www.emacswiki.org/emacs/EmacsNewbie">Emacs
Newbie</a> page.  Of course it works great with <a href="#orgc4ddf2e">EWW</a>: <code>M-x eww RET https://www.emacswiki.org/</code>.
</p>
</div>
<div id="outline-container-org95d965c">
<h4 id="org95d965c">Mailing Lists <a id="org5f3536d"></a></h4>
<div id="text-org95d965c">
<p>
There are many <a href="https://www.emacswiki.org/emacs/EmacsMailingLists">Emacs mailing lists</a> you can subscribe to.  The two most important
are probably:
</p>
<dl>
<dt><a href="https://lists.gnu.org/mailman/listinfo/info-gnu-emacs">info-gnu-emacs</a></dt><dd>a read-only list of official announcements from the Emacs maintainers</dd>
<dt><a href="https://lists.gnu.org/mailman/listinfo/help-gnu-emacs">help-gnu-emacs</a></dt><dd>you can post questions to this list and the list members
will be happy to try to help you out</dd>
</dl>
</div>
</div>
<div id="outline-container-orgdf1a938">
<h4 id="orgdf1a938">Web Sites and Blogs</h4>
<p>
There are innumerable independent web sites and blogs devoted to Emacs; for one
stop shopping, go straight to <a href="https://planet.emacslife.com/">Planet Emacslife</a>, a <a href="https://en.wikipedia.org/wiki/Planet_(software)">feed aggregator</a> covering over 200
Emacs blogs.  If you can only read one blog on a regular basis, I’d have to
recommend Sacha Chua’s indispensable <a href="https://sachachua.com/blog/category/emacs-news/"><i>Emacs News</i></a>.<sup><a id="fnr.302" href="#fn.302" role="doc-backlink">302</a></sup>
</p>
</div>
<div id="outline-container-orge14efe5">
<h4 id="orge14efe5">Github</h4>
<p>
The last time I checked (2021), there were 4,029 public Github repositories tagged with “Emacs”.
</p>
</div>
<div id="outline-container-org24cc84c">
<h4 id="org24cc84c">Videos, Screencasts, and Podcasts</h4>
<p>
There are scads of Emacs videos and podcasts, available in the usual places.
Try <a href="https://www.emacswiki.org/emacs/EmacsScreencasts">Emacs Screencasts</a> in the Wiki for a starting point.
</p>
</div>

<div id="outline-container-org01b978c">
<h4 id="org01b978c">IRC</h4>
<div id="text-org01b978c">
<p>
You can easily chat with actual humans (one assumes…) about Emacs on <a href="https://en.wikipedia.org/wiki/Irc">Internet
Relay Chat (IRC)</a>.<sup><a id="fnr.303" href="#fn.303" role="doc-backlink">303</a></sup> Project GNU <a href="https://www.gnu.org/software/emacs/further-information.html">says</a>:
</p>
<blockquote>
<p>
There are several IRC channels dedicated to discussion around Emacs on the
Libera.Chat network. Use #emacs for general discussion about Emacs, #emacs-beginners
for Emacs beginner help, and #emacs-til (“today I learned”) for sharing Emacs tips
and tricks. See also our rules and guidelines for the official GNU and FSF IRC
channels.
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org6eec958">
<h4 id="org6eec958">EmacsConf</h4>
<div id="text-org6eec958">
<blockquote>
<p>
EmacsConf is the conference about the joy of Emacs, Emacs Lisp, and memorizing key
sequences. — <a href="https://emacsconf.org/">https://emacsconf.org/</a>
</p>
</blockquote>
<p>
There’s been an occasional (verging on annual) free <a href="https://emacsconf.org/">Emacs conference</a>
since 2013.  You can watch the videos of past talks and download papers and such
from the conference web site.
</p>
</div>
</div>
</div>
</div><div id="outline-container-org1d7f608">
<h2 id="org1d7f608"><b>NEVER LEAVE EMACS: APPLICATIONS</b> <a id="orgf0e4005"></a></h2>
<div id="text-org1d7f608">
<p>
In this part of the book we discuss major Emacs <i>applications</i>: <a href="#org5b21ef0">Modes</a> and
subsystems that either replace the other applications most computer users need,
or provide Emacs front-ends to them.
</p>

<p>
Some topics that could be considered Emacs applications are discussed elsewhere;
for example:
</p>
<dl>
<dt>archivers</dt><dd>see <a href="#org648e64d"><i>Archive Files</i></a></dd>
<dt>document readers</dt><dd>see <a href="#orga6bbd55"><i>Info: The Emacs Documentation Reader</i></a> and <a href="#org8dc49db"><i>Document Files (PDFs and the Like)</i></a></dd>
<dt>file managers</dt><dd>see <a href="#orgcc42ce0"><i>Directory Editing with Dired</i></a></dd>
<dt>file pagers, <code>tail -f</code></dt><dd>see <a href="#org34c6961"><i>Read-Only Buffers, or, Emacs is More</i></a> and <a href="#org2a1e428"><i>Auto-Reverting (Watching Files)</i></a></dd>
<dt>file searching tools</dt><dd>see <a href="#orgfdf7146"><i>Meet the Greps</i></a></dd>
<dt>image viewers</dt><dd>see <a href="#orgd9f78fb"><i>Image Files</i></a></dd>
<dt>printing utilities</dt><dd>see <a href="#org4d1e6a3"><i>Printing</i></a></dd>
<dt>remote logins and shells</dt><dd>see <a href="#org2bfdd17"><i>Remote File Editing with Tramp</i></a></dd>
<dt>spreadsheets</dt><dd>see <a href="#org4a851ca"><i>Org Mode</i></a></dd>
</dl>
</div>
<div id="outline-container-org37b6f88">
<h3 id="org37b6f88">External Commands, Shells and Terminals <a id="org039ef0a"></a></h3>
<div id="text-org37b6f88">
<p>
There is a world outside of Emacs, and sadly we must occasionally interact with
it directly.
</p>

<p>
Emacs provides indirect, smooth and transparent access to the outside world
through interfaces like the <a href="#orgfdf7146"><code>grep</code></a> family of search commands, the <a href="#org53af7eb"><code>vc</code></a> family of
version control commands, and many more — you might well use commands like
these without even knowing that they’re interfaces to external commands.
</p>

<p>
But we still need to run the occasional <i>ad hoc</i> external command that no one has
yet written an interface for.  Emacs provides many ways to do this.
</p>
</div>
<div id="outline-container-orgf916208">
<h4 id="orgf916208">Running One Command</h4>
<div id="text-orgf916208">
<p>
If you just need to run one command, you can use   <code>M-!</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Single-Shell"><code>shell-command</code></a>﻿).  It prompts you for a command<sup><a id="fnr.304" href="#fn.304" role="doc-backlink">304</a></sup>, runs it <i>synchronously</i>, and
shows you the command’s output (standard output and standard error combined).
</p>

<p>
For example, if you want to know the date and time<sup><a id="fnr.305" href="#fn.305" role="doc-backlink">305</a></sup>, you could say <code>M-!</code>, type <code>date</code>
at the “Shell command:” prompt, and hit return.  This runs the standard Unix
command <code>date</code>.
</p>

<p>
As the name <code>shell-command</code> and its prompt implies, it uses the shell to run this
command, so you can use shell metacharacters, file globs, redirection, pipes, etc.
</p>

<p>
Already, even with such a simple command, several questions are raised.
</p>
</div>
<div id="outline-container-org0a0608e">
<h5 id="org0a0608e">Which shell is being used?</h5>
<p>
Emacs tries hard to use “your shell” when executing external commands.  If your
shell is <code>bash</code> or <code>zsh</code> or any Posix-compliant shell, it’ll be fine.  If your shell
is an exotic, not-so-Posix, shell, like say <a href="https://fishshell.com/"><code>fish</code></a> or <code>rc</code>, you may or may not have
problems.  If you do, try setting   <code>shell-file-name</code> to <code>bash</code>
or <code>sh</code> in your init file<sup><a id="fnr.306" href="#fn.306" role="doc-backlink">306</a></sup>.
</p>
</div>
<div id="outline-container-orgf106a08">
<h5 id="orgf106a08">Where’s the output?</h5>
<div id="text-orgf106a08">
<p>
If the command ran successfully but produced no output at all, you’ll see the
message “(Shell command succeeded with no output)” in the Echo Area.  For
example, you might remove a file by saying, <code>M-! rm FILENAME</code><sup><a id="fnr.307" href="#fn.307" role="doc-backlink">307</a></sup>.  Since <code>rm</code> is
usually silent, Emacs will report the message above.  You can try this with
the harmless command <code>M-! true</code>, which does nothing but succeed, and produces no output.
</p>

<p>
If the command failed<sup><a id="fnr.308" href="#fn.308" role="doc-backlink">308</a></sup> silently, you’ll instead see the message “(Shell
command failed with code 1 and no output)”; try <code>M-! false</code> to see this.
</p>

<p>
If the command produces output (whether to stdout or to stderr), Emacs pops up a
Buffer named <code>*Shell Command Output*</code> which contains it.  You can do what you like
with this: gaze upon the output before <a href="#org341aea6">deleting the Window</a> or <a href="#orgcf558ce">killing the
Buffer</a>, jump to the Window to copy some of the text<sup><a id="fnr.309" href="#fn.309" role="doc-backlink">309</a></sup>, or edit the output
to get it into shape for some other purpose.
</p>

<p>
However, if the command produced only a small amount of output<sup><a id="fnr.310" href="#fn.310" role="doc-backlink">310</a></sup>, it will
be inserted into the <code>*Shell Command Output*</code> Buffer as above, but the Buffer
won’t be popped up; instead the output will be shown in the Echo Area.  (You can
still switch to the output Buffer to grab the text.)  So <code>M-! date</code> seems to have
the effect of just showing the date and time in the Echo Area.
</p>
</div>
</div>

<div id="outline-container-orgc9c3af8">
<h5 id="orgc9c3af8">What happens to the output Buffer if I do <code>M-!</code> twice?</h5>
<p>
By default, if the <code>*Shell Command Output*</code> Buffer already exists, its contents
are erased before the next <code>M-!</code> uses it.  If you’d prefer that subsequent <code>M-!</code>
commands append to this Buffer, you can change this in your init file<sup><a id="fnr.311" href="#fn.311" role="doc-backlink">311</a></sup>.
If you only occasionally want to keep the old contents around, you can also
<a href="#orgf6e5f11">rename the Buffer</a> before the second <code>M-!</code>.
</p>
</div>
<div id="outline-container-orgdeae98e">
<h5 id="orgdeae98e">What do you mean, synchronously?</h5>
<div id="text-orgdeae98e">
<p>
When I say that <code>M-!</code> runs the command <i>synchronously</i>, I mean that Emacs waits
until the command finishes: if the command takes a noticeable amount of time to
run, Emacs will appear to freeze up, and you can’t type or execute commands.
This is a usually a good thing, because it means that you can’t, say,
accidentally save a file that would affect the running command: synchronous
execution is easier to understand and so the effect is more reliable.  Try
running the command <code>M-! sleep 60</code> and you’ll have to wait one minute before Emacs
comes back to you: that’s synchronous execution.
</p>

<p>
Of course, you can always interrupt and terminate the external command.  You’ve
probably guessed that you do this the same way you interrupt an internal Emacs
command: just hit     <code>C-g</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Quitting"><code>keyboard-quit</code></a>﻿) — try it with <code>M-!
sleep 60</code>.  This is exactly the same as Control-C’ing a command in the shell:
Emacs sends a SIGINT signal to the process.
</p>

<p>
If you’re a Unix programmer, you know that external commands are allowed to
ignore SIGINT.  If you hit <code>C-g</code> <i>twice</i>, Emacs sends the unignorable SIGKILL signal
to the command.
</p>
</div>
</div>
<div id="outline-container-org822d191">
<h5 id="org822d191">Isn’t there an easier way to insert command output?</h5>
<p>
A common reason to run an external command is to grab its output to insert in
some Buffer.  Rather then micromanaging Buffers and Windows by switching to and
from the output Buffer and copying and pasting text, you can directly insert the
output of the command into the <i>current</i> Buffer (at Point) instead, just by giving
<code>M-!</code> a <a href="#orgb0f6ffd">prefix argument</a>.  So, if you want a time-stamp in the current Buffer, you
can say <code>C-u M-! date</code>.
</p>
</div>
<div id="outline-container-org78e5f65">
<h5 id="org78e5f65">What about standard input?</h5>
<div id="text-org78e5f65">
<p>
By default, the standard input of the external command is redirected to come
from <code>/dev/null</code>.  You can see this by running <code>M-! cat</code> — this command terminates
immediately with no output instead of waiting for input, the way it would in the
shell.  In other words, Emacs effectively runs <code>cat &lt; /dev/null</code>.
</p>

<p>
Sometimes you instead want to use part of a Buffer as the input to the external
command.  You could of course tediously copy the text to a temp file and say
something like <code>M-! tr a-z A-Z &lt; /tmp/myfile</code>, but there’s a much easier way.
Just set <a href="#org34ab2da">the Region</a> around the text you want to feed to the command and use
  <code>M-|</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Single-Shell"><code>shell-command-on-region</code></a>﻿) — that’s a pipe, not an
exclamation point.
</p>

<p>
Perhaps you want to know how many words are in the previous paragraph.  Just set
the Region around the paragraph with     <code>M-h</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Paragraphs"><code>mark-paragraph</code></a>﻿)
and say <code>M-| wc -w</code> and you’ll see the answer in the Echo Area (there are
80)<sup><a id="fnr.312" href="#fn.312" role="doc-backlink">312</a></sup>.
</p>

<p>
Sometimes you want the output of the external command to actually <i>replace</i> some
text in your Buffer; giving <code>M-|</code> an argument will do this.  For example, if you
just typed a whole paragraph of an email in which you really wanted to yell at
someone but forgot to hold down Caps Lock, just set the Region around the
paragraph and say: <code>C-u M-| tr a-z A-Z</code>, which will feed the paragraph to <code>tr</code>, and
replace the paragraph with <code>tr</code>’s all-uppercase and shouty output<sup><a id="fnr.313" href="#fn.313" role="doc-backlink">313</a></sup>.
</p>
</div>
</div>
<div id="outline-container-org4e51243">
<h5 id="org4e51243">Can I run any program this way? <a id="orgf580c35"></a></h5>
<div id="text-org4e51243">
<p>
I’m afraid that fully answering this question requires us to enter rather deeply
into the Unix weeds<sup><a id="fnr.314" href="#fn.314" role="doc-backlink">314</a></sup>.  You can run any <i>classic Unix command-line
application</i>, keeping in mind that if it reads from standard input, you need to
redirect stdin from a file, as in:
</p>
<div>
<pre>M-! tr a-z A-Z &lt; /etc/passwd
</pre>
</div>
<p>
or from the current Buffer, as with <code>M-|</code>: you can’t expect to provide input by
typing at the program (but see <a href="#org3e9bc8f"><i>Interactive Shells</i></a> below).
</p>

<p>
You <i>can</i> fire up GUI programs that don’t use the terminal, like, say, <code>firefox</code>
(best done asynchronously with <code>M-&amp;</code>).
</p>

<p>
But you can’t necessarily run every program that prompts a human for input (from
<code>/dev/tty</code>, a.k.a. The Terminal) with <code>M-!</code>, or <code>M-|</code>.  Some such programs may
work with <code>M-&amp;</code>, but it’s highly dependent on how exactly they use the
terminal<sup><a id="fnr.315" href="#fn.315" role="doc-backlink">315</a></sup>.  There aren’t a lot of Unix command-line programs that ask
questions and expect answers, but there are a lot that allow for
single-character input.  Many so-called <a href="https://en.wikipedia.org/wiki/Curses_(programming_library)"><i>Curses
applications</i></a> fall into this category: programs like <code>top</code>, <code>htop</code>, <code>vi</code>, <code>vim</code>, <code>less</code>,
<code>more</code>, <code>mutt</code>, and many more.
</p>

<p>
Additionally, most Curses applications also <i>address the screen</i> i.e. clear the
screen, move the cursor around — up and down and left and right — as an
animation perhaps, or the way <code>vi</code> lets you move the cursor with the <code>hjkl</code> or arrow
keys.  Even if they don’t ask for input, these programs won’t work successfully
because cursor addressing requires a <i>terminal emulator</i><sup><a id="fnr.316" href="#fn.316" role="doc-backlink">316</a></sup>.  If you try to
run such a program, the output (consisting largely of what we call <i>escape
sequences</i>) will look like garbage.
</p>

<p>
The good news is:
</p>
<ol>
<li>Emacs implements native versions of many of these kinds of Curses programs;
instead of <code>top</code>, use <a href="#orgf52231b"><code>proced</code></a>; instead of <code>mutt</code>, any of Emacs’s <a href="#org5e201bd">mailers</a>;
instead of <code>less</code>,   <code>M-x</code> <code>view-mode</code>; instead of <code>vim</code>, Emacs with
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>evil-mode</code></a>﻿; and so forth.</li>
<li>If you really want to run <code>vim</code> (!) or <code>top</code> or <code>mutt</code> inside Emacs, you
can; you just can’t use <code>M-!</code> to do it; see <a href="#org1271dbd"><i>Terminal Emulation</i></a> below.</li>
</ol>
</div>
</div>
<div id="outline-container-orge46ca16">
<h5 id="orge46ca16">What if I don’t want to wait? <a id="orgf9812fe"></a></h5>
<div id="text-orge46ca16">
<p>
While synchronous execution is often a good thing, sometimes you want to run a
command asynchronously — what if you want to fire up a PDF viewer for example,
as a background process<sup><a id="fnr.317" href="#fn.317" role="doc-backlink">317</a></sup>?  You don’t want Emacs to be frozen until you’re
done reading.
</p>

<p>
All you need to do in this case is run     <code>M-&amp;</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Single-Shell"><code>async-shell-command</code></a>﻿).  Unlike <code>M-!</code>, after <code>M-&amp;</code> Emacs doesn’t freeze because
it’s not waiting for the command to finish; you can continue working<sup><a id="fnr.318" href="#fn.318" role="doc-backlink">318</a></sup>.
</p>

<p>
The output Buffer in this case uses a different name: <code>*Async Shell Command*</code>.
There’s one big difference between this Buffer and the synchronous <code>*Shell
Command Output*</code> Buffer: the background process is <i>connected</i> to the <code>*Async Shell
Command*</code> Buffer.  This means that if you kill that Buffer, Emacs will kill the
background process associated with it.  It will ask permission first:
</p>
<pre id="orgc3d6b75">Buffer &#34;*Async Shell Command*&#34; has a running process; kill it? (yes or no)
</pre>
<p>
Also, if you terminate Emacs itself, all running async processes that Emacs
started will be killed.  It will display a list of these processes and ask you
first: “Active processes exist; kill them and exit anyway? (yes or no)”.
</p>

<p>
If you instead terminate an asynchronous command outside of Emacs (that
PDF viewer probably has a quit command), Emacs will notice and mention this in the Echo
Area (e.g. “pdfviewer filename.pdf: finished.”).
</p>

<p>
Since async commands tend to stick around for a long time, if you run a second
<code>M-&amp;</code>, Emacs will ask:
</p>
<pre id="org16d588d">A command is running in the default buffer.  Use a new buffer? (yes or no)
</pre>
<p>
If you don’t want to wait for the previous command to terminate, you should say
“yes”.  Really, I’ve never had a reason to answer this question with “no”; also,
most of the commands one typically runs asynchronously don’t produce any useful output,
so the fact that the <code>*Async Shell Command*</code> Buffer is always popped up is kind of
annoying.  I recommend the following settings for your <a href="#org2af3730">init file</a>:
</p>
<div>
<pre>(<span>setq</span> async-shell-command-buffer &#39;new-buffer) <span>;</span><span>multiple async commands ok!</span>
(<span>setq</span> async-shell-command-display-buffer nil) <span>;</span><span>don&#39;t pop up the buffer</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org46d858f">
<h5 id="org46d858f">Managing Asynchronous Processes <a id="org242e53c"></a></h5>
<div id="text-org46d858f">
<p>
If you fire up a number of asynchronous processes in a long running Emacs, you
might want to check on them and see what state they’re in.
</p>

<p>
  <code>M-x</code> <code>list-processes</code> pops up a Buffer listing all the asynchronous
processes of which Emacs is the parent.
It might look like this:
</p>
<pre id="org6efc91f">Process ▼   PID     Status  Buffer                TTY          Thread Command
OCaml       447866  run     *OCaml*               --           Main   ocaml -nopromptcont
Shell       3779765 run     *Async Shell Command* /dev/pts/0   Main   /bin/zsh -c llpp web/emacs-tutorial.pdf
compilation 418697  run     *compilation*         /dev/pts/6   Main   /bin/zsh -c make clean check
ielm        941277  run     *ielm*                /dev/pts/4   Main   hexl
ispell      1495152 run     --                    --           Main   aspell -a -m -d en_US --encoding=utf-8
server      --      listen  --                    --           Main   (network server on /run/user/1000/emacs/server)
shell       274144  run     *shell*               /dev/pts/5   Main   /bin/zsh -i
</pre>
<p>
You can find your <code>M-&amp;</code> commands by looking in the <code>Command</code> column.
</p>

<p>
The <code>Buffer</code> column contains clickable links that take you to the Buffer of the
command; you can thus access any output the process has produced.  In addition,
if you issue the command <code>d</code>
(<code>process-menu-delete-process</code>) it will kill the
process on that line, and <code>g</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Reverting"><code>revert-buffer</code></a>﻿)
will update the <code>list-processes</code> Buffer to reflect any changes in the state or existence of the
processes (running <code>M-x list-processes</code> again has the same effect).
</p>

<p>
For example, if you say <code>M-&amp; sleep 60</code> and then <code>M-x list-processes</code>, you will see
your command listed;
if you type <code>g</code> within 60 seconds, it will still be there, but if you type it
after 60 seconds, your process, which will have terminated, will be gone from
the list.
</p>

<p>
You may notice processes in this list that you didn’t start with <code>M-&amp;</code>.  These are
processes that Emacs starts for you in response to various commands.  In the
above, you can see, from top to bottom:
</p>
<ul>
<li>an interactive REPL for the OCaml programming language</li>
<li>an external PDF viewer (<code>llpp</code>)</li>
<li>a compilation in progress (<code>make clean check</code>)</li>
<li>an interactive REPL for Elisp (  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Lisp-Interaction"><code>ielm</code></a>﻿)</li>
<li>the <a href="#orgda03eba">spelling checker</a> (<code>aspell</code>)</li>
<li>a <code>network server</code> process (which is due to my running this Emacs in <a href="#org22671bb">Server Mode</a>)</li>
<li>an interactive shell that I’m using (<code>zsh -i</code>)</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org2d1931f">
<h4 id="org2d1931f">Run Commands from Dired</h4>
<p>
Another way to run an external command is from a <a href="#orgcc42ce0">Dired</a> Buffer.  This is great
if you already happen to be in Dired, but if you’re about to run a command on
several files, it’ll often be worth your while to pop up a Dired Buffer first.  This
lets you pick and choose the files in various ways when a simple file glob isn’t
enough.  The dozens of basic Dired commands let you do standard file management
with a single keystroke (delete, rename, copy, etc), but Dired also has powerful
ways to run arbitrary programs on precisely selected sets of files,
synchronously, asynchronously, or in parallel.  See <a href="#org55c7f09"><i>Running External Commands</i> in Dired</a>.
</p>
</div>
<div id="outline-container-org3e9bc8f">
<h4 id="org3e9bc8f">Interactive Shells</h4>
<div id="text-org3e9bc8f">
<p>
If you anticipate the need to run a whole sequence of shell commands in the near
future, you might as well fire up a shell!    <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Interactive-Shell"><code>shell</code></a>﻿ will pop up a
new Buffer with your shell running in it, in the directory of the Buffer in
which you invoked it (so, if you’re editing a file, the shell comes up in the
directory of that file); the Buffer is in a special Major Mode,
  <code>shell-mode</code>.
</p>

<p>
You can now use that shell much as you would in a terminal.  Type commands at
the prompt, hit return, and see the output.  There are advantages and
disadvantages to running your shells in Emacs; the advantages are substantial.
</p>
</div>

<div id="outline-container-org506e58c">
<h5 id="org506e58c"><code>shell-mode</code> Advantages</h5>
<div id="text-org506e58c">
<p>
First and foremost, <code>shell-mode</code> implements an editable transcript of your entire
session.  Shell Buffers subsume the features of fancy terminal programs and
add-on <a href="https://en.wikipedia.org/wiki/Terminal_multiplexer">terminal multiplexers</a> like <a href="https://en.wikipedia.org/wiki/Tmux">tmux</a> and <a href="https://en.wikipedia.org/wiki/GNU_Screen">screen</a>, but with the advantage of
using native Emacs features and key bindings that you already know, which are in
sum far more powerful than any given terminal, and which are completely
customizable and extensible.
</p>
<ul>
<li>Say goodbye to pagers like <code>less</code> and <code>more</code>!  Never again will you need to pull
up the previous command just to append <code>| less</code> to it (and then pointlessly
re-run it!).  Just use any Emacs scrolling or motion commands to view any of
the output in this session (but especially see
    <code>C-c C-r</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Shell-Mode"><code>comint-show-output</code></a>﻿)).  This is of course like
using the scroll bar in a terminal, but far more precise, and once you get
where you’re going:</li>
<li>you can easily copy and paste or even edit in place any of the output;</li>
<li>or open any filename or URL in the output without copy-pasting, retyping, or
mousing (just use   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/FFAP"><code>find-file-at-point</code></a>﻿,
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Browse-URL"><code>browse-url</code></a>﻿ or the like);</li>
<li>or zap uninteresting previous output with a keystroke
(    <code>C-c C-o</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Shell-Mode"><code>comint-delete-output</code></a>﻿));</li>
<li>and rather than scrolling, you can search back through any of the output in
this session with all the power of <a href="#org3fa1f0c">incremental search</a> and
  <code>M-x</code> <a href="https://www.gnu.org/software/emacs/manual/html_mono/emacs.html#Other-Repeating-Search"><code>occur</code></a>.</li>
</ul>

<p>
Parenthetically, it should be noted that <code>shell-mode</code> is a descendant of
  <code>comint-mode</code>, from which many Emacs interactive modes are
made (such as most programming language REPL modes), so many of the above
advantages also accrue to any <code>comint</code> Buffer (with the same key bindings).
</p>
</div>
</div>

<div id="outline-container-org8ceaaf9">
<h5 id="org8ceaaf9">Command History</h5>
<div id="text-org8ceaaf9">
<p>
<code>shell-mode</code> implements its own command-line history operations in place of your
shell’s (though you can link the two histories together); these commands are
tightly integrated with Emacs.
</p>

<p>
If you’re at the shell prompt, a sequence of
    <code>M-p</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Shell-Ring"><code>comint-previous-input</code></a>﻿) (or <code>&lt;C-up&gt;</code>) commands will pull
up your previous shell commands in place, at the prompt;
    <code>M-n</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Shell-Ring"><code>comint-next-input</code></a>﻿) (or <code>&lt;C-down&gt;</code>’s) will change
direction.  (In most shells, plain up- and down-arrows do this, but in a Shell
Buffer, these are the normal Emacs cursor-motion commands, so they actually move
within the Buffer (i.e., within the transcript), as do <code>C-p</code> and <code>C-n</code>).
</p>

<p>
But you can also move back in the transcript to previous commands at their
original prompts with     <code>C-c C-p</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Shell-History-Copying"><code>comint-previous-prompt</code></a>﻿); when
you do this you can see the command’s output in context
(    <code>C-c C-n</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Shell-History-Copying"><code>comint-next-prompt</code></a>﻿) goes the other way.)
</p>
</div>

<div id="outline-container-org7205df1">
<h6 id="org7205df1">Re-running Commands</h6>
<div id="text-org7205df1">
<p>
If you’re at a previous prompt, you can hit
<code>RET</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Shell-Mode"><code>comint-send-input</code></a>﻿) to copy that command to
the prompt at the end of the transcript and resubmit (i.e., re-execute) it (you
can edit it before hitting <code>RET</code>).
    <code>C-c RET</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Shell-History-Copying"><code>comint-copy-old-input</code></a>﻿) does the same thing without
submitting the command, so you can edit it at the end of the transcript instead.
It’s a subtle but useful distinction; try both to see what I’m talking about.
</p>

<p>
In fact, with <code>RET</code> and <code>C-c RET</code> you can re-run shell commands that appear in the
<i>output</i> of shell commands: in other words, you don’t have to be at a previous shell
prompt.  So if you do <code>cat README</code> and the <code>README</code> file contains a shell command
like this:
</p>
<pre id="orgd484109">This command prints a Coordinated Universal Time (UTC) timestamp in
ISO 8601 format:

    env TZ=Zulu date +%Y-%m-%dT%H:%M:%SZ

and here&#39;s why.
</pre>
<p>
you can execute that shell command without cutting-and-pasting: just position
Point anywhere in that line and hit <code>RET</code> or <code>C-c RET</code>, possibly after editing the
command however you like.
</p>
</div>
</div>
<div id="outline-container-orge9332ea">
<h6 id="orge9332ea">Searching Command History</h6>
<p>
There are two ways to search your command history.  If you just search backward
with     <code>C-r</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Basic-Isearch"><code>isearch-backward</code></a>﻿), you will search back through
the transcript, and when you find your way to the command you want, you hit <code>RET</code>
or <code>C-c RET</code> as just described.  This involves searching past false matches in the
output of previous commands, so you can instead search the history of commands
in place, like a conventional shell in a terminal, at the latest prompt at the
end of the transcript, with     <code>M-r</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Shell-Ring"><code>comint-history-isearch-backward-regexp</code></a>﻿).
</p>
</div>

<div id="outline-container-orga8be263">
<h6 id="orga8be263">Shell Control Characters</h6>
<div id="text-orga8be263">
<p>
Most shells support the commands in column one of Table <a href="#org955d985">44</a>, so you
may be used to them (unless you’ve turned on <code>vi</code> bindings!); because many of
these keystrokes already have a use in Emacs, the <code>shell-mode</code> equivalents (shown
in column two) are prefixed with <code>C-c</code>.
</p>

<table id="org955d985">
<caption><span>Table 44:</span> Shell Commands</caption>

<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Shell</th>
<th scope="col">Emacs</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>C-a</code></td>
<td><code>C-a</code> or <code>C-c C-a</code></td>
<td>Go to beginning of line (after prompt)</td>
</tr>

<tr>
<td><code>C-c</code></td>
<td><code>C-c C-c</code></td>
<td>Interrupt the running command</td>
</tr>

<tr>
<td><code>C-d</code></td>
<td><code>C-c C-d</code></td>
<td>Send EOF</td>
</tr>

<tr>
<td><code>C-e</code></td>
<td><code>C-e</code></td>
<td>Go to end of line</td>
</tr>

<tr>
<td> </td>
<td><code>C-c C-e</code></td>
<td>*Go to prompt at end of Buffer</td>
</tr>

<tr>
<td><code>C-o</code></td>
<td><code>C-c C-o</code></td>
<td>*Discard output</td>
</tr>

<tr>
<td><code>C-n</code> or ↓</td>
<td><code>M-n</code> or <code>C-&lt;down&gt;</code></td>
<td>Retrieve the next command</td>
</tr>

<tr>
<td><code>C-p</code> or ↑</td>
<td><code>M-p</code> or <code>C-&lt;up&gt;</code></td>
<td>Retrieve the previous command</td>
</tr>

<tr>
<td><code>C-r</code></td>
<td><code>M-r</code></td>
<td>Incremental search of command history</td>
</tr>

<tr>
<td><code>C-u</code></td>
<td><code>C-c C-u</code></td>
<td>Kill (erase) current line (back to prompt)</td>
</tr>

<tr>
<td><code>C-w</code></td>
<td><code>C-c C-w</code></td>
<td>Kill (erase) previous word</td>
</tr>

<tr>
<td><code>C-z</code></td>
<td><code>C-c C-z</code></td>
<td>Stop the running command</td>
</tr>

<tr>
<td><code>C-\</code></td>
<td><code>C-c C-\</code></td>
<td>Quit the running command</td>
</tr>

<tr>
<td><code>ESC .</code></td>
<td><code>C-c .</code></td>
<td>Insert previous final argument</td>
</tr>
</tbody>
</table>

<p>
Two actions (marked) are not perfect equivalents, in order to make them more
useful in an Emacs context.
</p>

<p>
<code>C-c C-e</code> goes to the end of the line if you’re at the final prompt at end of the
transcript, but if you’re elsewhere, it jumps to the end of the transcript.
Unix’s ancient <i>Control+O</i> command is usually overridden or ignored in modern
shells.
</p>
</div>
</div>
</div>
<div id="outline-container-orge6b2df6">
<h5 id="orge6b2df6">Manipulating the Transcript</h5>
<div id="text-orge6b2df6">
<p>
You can edit the transcript using any commands you like, but <code>shell-mode</code> defines
some convenience features.
</p>
<dl>
<dt>    <code>C-c C-r</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Shell-Mode"><code>comint-show-output</code></a>﻿)</dt><dd>scrolls the first line of
this batch of output to the top of the Window; this is what to type if the
output of your command was too long to fit in the Window, rather than
scrolling backwards imprecisely, hoping to spot the beginning of the output.</dd>
<dt>    <code>C-c C-o</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Shell-Mode"><code>comint-delete-output</code></a>﻿)</dt><dd>deletes the last batch of
output from the transcript (replacing it with the string <code>*** output flushed ***</code>).</dd>
<dt>    <code>C-c M-o</code> (<code>comint-clear-buffer</code>)</dt><dd>delete everything from
the transcript except for one prompt, exactly what you see when you first run
<code>M-x shell</code>.</dd>
<dt>    <code>C-c C-s</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Shell-Mode"><code>comint-write-output</code></a>﻿)</dt><dd>write the output of the
last executed command to a file; this is equivalent to, but nicer than,
explicitly navigating to the beginning and end of the output, setting the
region, and executing     <code>C-x C-w</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Save-Commands"><code>write-file</code></a>﻿).</dd>
</dl>
</div>
</div>
<div id="outline-container-orgda7e6cb">
<h5 id="orgda7e6cb">Directory Tracking</h5>
<p>
<code>shell-mode</code> tracks <code>cd</code>, <code>pushd</code>, and <code>popd</code> commands<sup><a id="fnr.319" href="#fn.319" role="doc-backlink">319</a></sup> and synchronizes
the Buffer’s   <code>default-directory</code> with them, so as
you move around in the shell, file-related Emacs commands (like
    <code>C-x C-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-file</code></a>﻿)) will be aware of where you are
(so if you type <code>cd /etc</code> and then <code>C-x C-f passwd</code> Emacs will pull up
<code>/etc/passwd</code>).
</p>
</div>

<div id="outline-container-org2fdf113">
<h5 id="org2fdf113">Terminating the Shell</h5>
<p>
You can terminate your shell just as you would in a terminal: run the shell’s
exit command (typically <code>exit</code> or <code>logout</code>) or send the shell EOF, with
    <code>C-c C-d</code> (<code>comint-send-eof</code>).  If you do this, the shell Buffer
remains; it will be dead — unresponsive — but you can view it and manipulate
the transcript; you can kill the Buffer when you’re really done.  You can also
save a step and just run     <code>C-x k</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Kill-Buffer"><code>kill-buffer</code></a>﻿) without
properly exiting the shell; Emacs will, as usual, tell you the Buffer contains a
running process, ask if you really want to terminate it, and if so, kill the Buffer.
</p>
</div>
<div id="outline-container-org6cf4bda">
<h5 id="org6cf4bda">Multiple Shell Buffers</h5>
<div id="text-org6cf4bda">
<p>
If you’ve already fired up a shell, <code>M-x shell</code> will return you to that same shell
Buffer, but you can have as many distinct shells as you like.  If you want
another one, you can either manually <a href="#orgf6e5f11">rename the Buffer</a> first, or instead invoke
<code>C-u M-x shell</code>, which will prompt you for a Buffer name for a brand new shell.
To be precise, with no argument, <code>M-x shell</code> looks for a Buffer named exactly
<code>*shell*</code> and switches to it if it exists; if no such Buffer exists, it fires up a
new shell in a Buffer with that name.
</p>

<p>
An easy way to manage the common situation of one-shell-per-software-project is
to use     <code>C-x p s</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Project-File-Commands"><code>project-shell</code></a>﻿) instead of <code>M-x shell</code>; see
<a href="#orga12fa37"><i>Managing Projects</i></a> for more information.
</p>

<p>
There’s no one-size-fits-all way to manage many shell Buffers, so if you don’t
want to use the usual Buffer selection commands to choose the one you want,
you’ll have to explore the <a href="#orgc96889a">Package Manager</a>, which has many third-party packages
offering a choice of schemes for managing and tracking shell Buffers (none of
them suited me, so I wrote my own<sup><a id="fnr.320" href="#fn.320" role="doc-backlink">320</a></sup>).
</p>
</div>
</div>
<div id="outline-container-org0fcda49">
<h5 id="org0fcda49">What about the memory usage of the shell Buffer?</h5>
<div id="text-org0fcda49">
<p>
The transcript can take up a lot of space in your Emacs.  If you run a command
which starts spewing output uncontrollably, it could conceivably eat up all of
memory, which is annoying.  Why isn’t this a problem in a terminal?  Simply
because no terminal that I know of stores an unlimited amount of output: they
all truncate it at some (probably customizable) limit (the default is often a
mere 1,024 lines).
</p>

<p>
While <code>shell-mode</code> doesn’t have any limit by default, you can set one (expressed
in lines), and I recommend it.  However, to maximize the usefulness of the
transcript, I recommend setting it to a fairly sizable number.  This <a href="#org2af3730">init file</a> setting
uses the number of lines in <a href="https://en.wikipedia.org/wiki/War_and_Peace"><i>War and Peace</i></a>:
</p>
<div>
<pre>(<span>setq</span> comint-buffer-maximum-size 65336) <span>; </span><span>must be able to cat War and Peace!</span>
(add-hook &#39;comint-output-filter-functions &#39;comint-truncate-buffer)
</pre>
</div>
</div>
</div>
<div id="outline-container-orge1e7489">
<h5 id="orge1e7489"><code>shell-mode</code> Disadvantages</h5>
<div id="text-orge1e7489">
<p>
<code>shell-mode</code> does have some disadvantages, compared to running a shell in a
terminal.
</p>
<ul>
<li>As mentioned above, you can’t run raw-mode or Curses applications.</li>
<li><p>
<code>shell-mode</code>’s completion is simply nowhere near as good as that of <code>zsh</code> (which I
think has the best completion of any shell), <code>fish</code>, or even <code>bash</code> — all of
which can complete command-line options for many standard commands.  Do you
know all the long options for GNU <code>tar</code>?  <code>zsh</code> does:
</p>
<pre>$ tar --&lt;TAB&gt;
zsh: do you wish to see all 170 possibilities (171 lines)?
</pre>

<p>
and if you hit <code>TAB</code>, will display them with documentation!
</p>

<p>
I used to think this was a major weakness, but thanks to the valiant
contributors to the Emacs ecosystem, no longer!  See <a href="#org3bcde72"><i>Recommended Third-Party
Packages</i></a> for a solution.
</p></li>
</ul>
</div>
</div>
<div id="outline-container-org24f45d2">
<h5 id="org24f45d2">Recommended Third-Party Packages <a id="org3bcde72"></a></h5>
<div id="text-org24f45d2">
<p>
To get completion in   <code>shell-mode</code> that’s almost as good as
<code>zsh(1)</code> in a terminal, install the <code>fish(1)</code> shell via your OS package manager (I’m
assuming you already have the ubiquitous <code>bash(1)</code> installed), and add this code
to your <a href="#org2af3730">Init File</a>.
</p>
<div>
<pre>(<span>dolist</span> (pkg &#39;(fish-completion bash-completion))
  (<span>unless</span> (package-installed-p pkg)
    (<span>with-demoted-errors</span> <span>&#34;%s&#34;</span>
      (<span>unless</span> package-archive-contents
        (package-refresh-contents))
      (package-install pkg))))

(add-hook &#39;shell-mode-hook
          (<span>lambda</span> ()
            (<span>when</span> (<span>and</span> (executable-find <span>&#34;fish&#34;</span>)
                       (<span>require</span> &#39;<span>fish-completion</span> nil t))
              (fish-completion-mode +1)
              (<span>when</span> (<span>and</span> (executable-find <span>&#34;bash&#34;</span>)
                         (<span>require</span> &#39;<span>bash-completion</span> nil t))
                (<span>setq</span> fish-completion-fallback-on-bash-p t)))))
</pre>
</div>
</div>
</div>
<div id="outline-container-org428e486">
<h5 id="org428e486">Shell Init File Tweaks</h5>
<div id="text-org428e486">
<p>
I recommend the following code snippet for your shell’s init file; it’s at least
suitable for <code>bash(1)</code> (add to your <code>~/.bashrc</code>) or <code>zsh(1)</code> (add to your <code>~/.zshrc</code>).
Remember that regardless of which shell you use in your terminals,
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Interactive-Shell"><code>shell</code></a>﻿ runs the shell defined in
  <code>shell-file-name</code>.
</p>

<p>
The <code>INSIDE_EMACS</code> environment variable will be non-empty (hence the <code>-n</code>) in
subprocesses fired up by Emacs (like the shell run by   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Interactive-Shell"><code>shell</code></a>﻿).
We want to set <code>TERM</code> to a terminal that supports ANSI SGR color control sequences for
programs that emit them (notably, <code>grep(1)</code>, <code>ls(1)</code>, and <code>diff(1)</code>) — <code>ansi</code> is fine
for this.  We define aliases to encourage programs to produce colorized output.
</p>

<p>
We also want to convince programs never to direct their output to a pager like
<code>more(1)</code> or <code>less(1)</code> — remember that the   <code>shell-mode</code>
transcript is itself the best pager; we do this by setting <code>PAGER</code> to
<code>cat(1)</code>.<sup><a id="fnr.321" href="#fn.321" role="doc-backlink">321</a></sup>
</p>

<p>
Of course, in general we prefer   <code>M-x</code> <code>manual-entry</code> to <code>man(1)</code>,
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Grep-Searching"><code>grep</code></a>﻿ and friends to <code>grep(1)</code>,   <code>M-x</code> <code>dired</code> to <code>ls(1)</code>, and
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/ediff/Major-Entry-Points"><code>ediff</code></a>﻿ and friends to <code>diff(1)</code>, but if you’re in a shell Buffer
you’ll occasionally want to invoke these commands.
</p>

<p>
Finally, I unset a <code>zsh(1)</code> option to prevent it from invoking the Zsh Line Editor
(<code>shell-mode</code> replaces that facility).
</p>
<div>
<pre><span>if</span> [ -n <span>&#34;$INSIDE_EMACS&#34;</span> ]
<span>then</span>
  <span>export</span> <span>TERM</span>=ansi
  <span>export</span> <span>PAGER</span>=cat
  <span>export</span> <span>MANPAGER</span>=cat
  grep --version | grep GNU &gt; /dev/null &amp;&amp; <span>alias</span> <span>grep</span>=<span>&#39;command grep --color=auto&#39;</span>
  ls   --version | grep GNU &gt; /dev/null &amp;&amp; <span>alias</span> <span>ls</span>=<span>&#39;command   ls   --color=auto&#39;</span>
  diff --version | grep GNU &gt; /dev/null &amp;&amp; <span>alias</span> <span>diff</span>=<span>&#39;command diff --color=auto&#39;</span>
  <span>case</span> <span>&#34;$0&#34;</span><span> in</span>
  *zsh) <span>unsetopt</span> ZLE ;;
  <span>esac</span>
<span>fi</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgb091621">
<h4 id="orgb091621">Terminal Emulation <a id="org1271dbd"></a></h4>
<div id="text-orgb091621">
<p>
You can solve both of my claimed   <code>shell-mode</code> disadvantages
by using   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Terminal-emulator"><code>term</code></a>﻿ instead:
</p>
<ul>
<li>you can run raw-mode and Curses applications because <code>term</code> is a full-fledged
terminal emulator, just like <code>xterm</code> or any other terminal</li>
<li>you get the full completion capabilities of whatever shell you use — because
input is delivered a character at a time, instead of a line at a time (as with
<code>shell-mode</code>), when you hit <code>TAB</code> your shell responds normally.</li>
</ul>

<p>
So now you can happily run <code>htop</code>, <code>mutt</code> — even <code>vim</code> works perfectly (if you’re in
a sacrilegious mood).
</p>
</div>

<div id="outline-container-org5ee3efc">
<h5 id="org5ee3efc">Thanks for wasting my time with all that stuff about <code>shell-mode</code> then!</h5>
<p>
Most of the concepts and commands from <code>shell-mode</code> apply to <code>term-mode</code> as well, if
you factor in the additional complexities of <code>term-mode</code>.
</p>
</div>

<div id="outline-container-org0c1a606">
<h5 id="org0c1a606">Complexities?</h5>
<div id="text-org0c1a606">
<p>
Since <code>term-mode</code> delivers your input to the shell a character at a time, that
means that you can’t just type Emacs commands!  If you fire up <code>term-mode</code> for the
first time, and think, “How does this mode work?  I know, I’ll type
    <code>C-h m</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Misc-Help"><code>describe-mode</code></a>﻿) as usual!”, it won’t work.  The <code>C-h</code> is
immediately passed to your shell (where it almost certainly deletes the
character to the left of your cursor), and the <code>m</code> will then be inserted at the
prompt.  If you type <code>C-a</code> and your cursor goes to the beginning of the line,
that’s not Emacs doing it: the <code>C-a</code> went directly to your shell and your shell
moved the cursor.  You can’t type a <code>M-x</code> command because <i>that</i> gets passed to your
shell (<code>zsh</code> has its own <code>M-x</code> command, for example).  Neither <code>&lt;up&gt;</code> nor <code>C-p</code> will
move back into the transcript.  You get the idea.  If you’re new to <code>term-mode</code>
you might have a lot of trouble figuring out how to “get back to Emacs”.<sup><a id="fnr.322" href="#fn.322" role="doc-backlink">322</a></sup>
</p>

<p>
Obviously a shell that isolates you from all the powerful synergistic
interactions of Emacs commands would be more of a liability than a
help — you wouldn’t be able to “use Emacs” until you quit the
<code>term-mode</code> shell! — so there’s a way to solve the problem.
</p>
</div>
</div>

<div id="outline-container-orgda062ef">
<h5 id="orgda062ef">Line Mode versus Char Mode</h5>
<div id="text-orgda062ef">
<p>
At any moment, the terminal emulator is one of two “sub-modes”<sup><a id="fnr.323" href="#fn.323" role="doc-backlink">323</a></sup>.  It
starts up in Char Mode, the “raw” sub-mode, in which (almost) every character is
sent directly to your shell (this is indicated in the Mode Line where it says
“Term: char”), but you can switch to Line Mode to make it act like <code>shell-mode</code>:
almost all control characters are interpreted normally by Emacs and commands are
only sent to the shell when you hit <code>RET</code>.  You can toggle back and forth between
these two “modes” at will:
</p>
<dl>
<dt>    <code>C-c C-j</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>term-line-mode</code></a>﻿)</dt><dd>switch to Line Mode (mnemonic
(for nerds): <i>Control-j</i> is ASCII “<i>line</i> feed”)</dd>
<dt>    <code>C-c C-k</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Term-Mode"><code>term-char-mode</code></a>﻿)</dt><dd>switch to Char Mode (mnemonic:
K for Char, or “the key next to <code>C-j</code>”)</dd>
</dl>

<p>
I said above that in Char Mode, <i>almost</i> every character goes direct to the shell.
But obviously <code>C-c</code> is an exception, since you can use <code>C-c C-j</code>; there are several
other commands on the <code>C-c</code> prefix in Char Mode, including all the <code>shell-mode</code>
commands (so <code>C-c C-c</code> sends a <code>SIGINT</code>, etc).  Additionally, <code>C-x</code> is an exception,
so you can change Windows and suchlike easily; it has a few additional
convenience bindings, like <code>C-x M-x</code> being bound to
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/M-x"><code>execute-extended-command</code></a>﻿.
</p>
</div>
</div>

<div id="outline-container-org28659af">
<h5 id="org28659af">Disadvantages of the Terminal Emulator</h5>
<div id="text-org28659af">
<p>
The terminal emulator is a bit of a trade-off.  If you spend a lot of time in
the shell running Curses programs, you’ll find the terminal emulator invaluable.
But the less you do in the shell and the more you do in an Emacs-native manner
(as this book is intended to encourage), the more fiddly you may find the need
to switch between Char Mode and Line Mode.  Additionally, <code>term-mode</code> is not well
integrated with Tramp (see <a href="#orgaab4054"><i>Remote Shells</i></a> below), and the transcript commands
(<code>C-c C-o</code>, etc) don’t work as cleanly, because the shell can use escape sequences
in ways that can’t be perfectly predicted and coped with — the transcript can
end up looking strange (this doesn’t really interfere with working in the
terminal, it’s just wonky).
</p>

<p>
Myself, I basically don’t need any Curses applications (thanks to Emacs
alternatives), so I prefer   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Interactive-Shell"><code>shell</code></a>﻿ with it’s powerful transcript
and lack of <code>term-mode</code> fiddlyness; my only problem is how desperately I miss
Zsh’s completion (and I have a plan for an Elisp project to fix that).
</p>
</div>
</div>
</div>
<div id="outline-container-org54851a1">
<h4 id="org54851a1"><a id="orgaab4054"></a> Remote Shells</h4>
<p>
If you are editing a remote file via <a href="#org2bfdd17">Tramp</a>, any shell commands you execute,
whether by <code>M-!</code>, <code>M-&amp;</code>, <code>M-x shell</code>, or <code>M-x eshell</code> (and also <code>dired</code>), will
transparently execute on the remote host.  This is frankly almost miraculous
when you first try it, and I feel like I’m underselling this amazing feature by
saying so little about it.  But what more can I say?  It just works
automatically.  As a simple demo, open a remote file (to a Unix host for this
demo) with Tramp and say <code>M-! uname -n</code>; it will display the remote hostname —
<i>not</i> the local hostname!  See <a href="#org2bfdd17">Tramp</a> for details.
</p>
</div>
<div id="outline-container-orgf58e197">
<h4 id="orgf58e197">Eshell</h4>
<div id="text-orgf58e197">
<blockquote>
<p>
Switching to Eshell marked a milestone for me: from then on I dropped all my crufty
curses-based programs and switched to much more powerful Emacs alternatives.  I now
use Emacs everywhere to the point that it even is my window manager.  Having a
consistent environment well glued together really empowers you. — <a href="https://ambrevar.xyz/emacs-eshell/index.html">Pierre Neidhardt</a>
</p>
</blockquote>
<p>
Finally, I need to mention the exotic   <code>M-x</code> <code>eshell</code>.  <code>M-x shell</code> is
brilliantly integrated into Emacs via the combination of excellent subprocess
support and <code>comint-mode</code>, but taking those for granted, it’s a rather simple
thing: Emacs just sits between you and your shell.  After hooking it up, the
shell, which is almost certainly a program written in C, does all the heavy
lifting of running programs, redirecting input and output, setting up pipelines,
etc.
</p>

<p>
That was too easy for John Wiegley; his <code>eshell</code> is a true, native Emacs shell
implemented in Elisp; it’s not an external program.  Its command language is a
wild hybrid of Unix shell and Elisp, and has kind of amazing support for
redirecting command output directly to Emacs Buffers and the like.  It’s
well-integrated with <a href="#org2bfdd17">Tramp</a>.  Not only does it interpret your shell commands, but
it also lets you run Elisp commands and mix them with shell commands!  This is a
really novel shell that has some very clever ideas, but as a result, it takes a
little getting used to.  Many people who really give it a fair trial are very
devoted to it; doing that is on my TODO list.
</p>
</div>

</div>
</div>

<div id="outline-container-orgd4e62c9">
<h3 id="orgd4e62c9">Browsing the Web <a id="org5138d90"></a></h3>
<div id="text-orgd4e62c9">
<p>
Probably more people spend more time in a web browser than any other
application.  While this book is intended to encourage you to move all
of your computing life inside Emacs, I have to admit that the most
unyielding application in this plan is the web browser.
</p>

<p>
Emacs has at least two viable web browsers (one built-in), but most
of them don’t support <a href="https://en.wikipedia.org/wiki/JavaScript">Javascript</a>, which means that not all web sites are
fully functional.  In particular, you can forget about doing
any shopping in Emacs for now.<sup><a id="fnr.324" href="#fn.324" role="doc-backlink">324</a></sup>  But I do a large amount of my web
browsing in Emacs.  Many sites don’t require Javascript to function.
Emacs web browsing is great for tech blogs and news sites, and in fact
being Javascript-free can be a distinct advantage: 1. you’ll almost
never see an advertisement in an Emacs browser, and 2. browsing
without Javascript is more secure (since many attacks from malicious
web pages require it) and preserves more of your privacy.
</p>

<p>
Two different applications exemplify the two (current) approaches to writing an
Emacs web browser:
</p>
<ul>
<li>Emacs-w3m is a front-end to the external <a href="http://w3m.sourceforge.net/index.en.html"><code>w3m</code></a> text-mode browser.
It’s somewhat complex to install but, <code>w3m</code> being written in C, is pretty
fast.</li>
<li>EWW is a browser written in Emacs Lisp that’s built-in and ready to run.  This
is the browser I use (I used to use Emacs-w3m): it works great, is completely
keyboard-controllable, and when you find a web page that requires Javascript
to work, one keystroke pops it open in your preferred external browser: what
have you got to lose?</li>
</ul>
</div>
<div id="outline-container-orgef24aab">
<h4 id="orgef24aab">EWW: Emacs Web Wowser <a id="orgc4ddf2e"></a></h4>
<div id="text-orgef24aab">

<div id="org6bec6fd">
<p><a href="https:./images/emacswiki.png" alt="Browsing the Web with EWW" title="Browsing the Web with EWW" width="100%"><img src="https://blog.veitheller.de/images/emacswiki.png" alt="Browsing the Web with EWW" title="Browsing the Web with EWW" width="100%"/></a>
</p>
<p><span>Figure 48: </span>Browsing the Web with EWW</p>
</div>

<p>
EWW was originally implemented by <a href="#org9017fdf">Gnus</a> author Lars Magne Ingebrigtsen: hence the
silly name EWW: Emacs Web Wowser.  An EWW Buffer, like that in Figure
<a href="#org6bec6fd">48</a>, is recognizably both an Emacs Buffer <i>and</i> a web page and many of your
intuitive actions and keystrokes will work as expected: <code>TAB</code> from link to link,
<code>SPC</code> to page through, and <code>RET</code> or a mouse-click to follow a link.  While there’s
no Javascript support, EWW does handle cookies, submit forms, and display
images.
</p>

<p>
But many web browser features are handled in a more Emacs-ish manner.
In particular, browser tabs are <a href="#orgc3260f6">Buffers</a>.  The default Buffer is <code>*eww*</code>,
and when you click on a link, the new page re-uses the same Buffer.
You can open a link in a “new tab”—that is, a new Buffer—if you
like.
</p>

<p>
If you’re using   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Saving-Emacs-Sessions"><code>desktop-save-mode</code></a>﻿, all your EWW Buffers
will be saved when you exit, and restored when you next fire-up Emacs.  By
default, the restoration of the Buffer contents is done lazily; this is because
fetching and rendering many Buffers full of HTML will slow down your startup.
So after restarting, when you switch to an EWW Buffer it will look empty, or at
most contain a string of text telling you what’s going on.  Just type
    <code>g</code> (<code>eww-reload</code>) to restore your web page.  If you’d prefer to
sacrifice startup speed to get all your EWW Buffers reloaded automatically,
<a href="#org27e6769">Customize</a>   <code>eww-restore-desktop</code>.
</p>
</div>
<div id="outline-container-org1b95afb">
<h5 id="org1b95afb">Entry Points</h5>
<div id="text-org1b95afb">
<p>
The main entry point for EWW is   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/EWW"><code>eww</code></a>﻿, which prompts for
a URL or search keywords.  So you can invoke something like:
</p>
<pre>M-x eww RET https://www.gnu.org/software/emacs/ RET
</pre>

<p>
or perhaps:
</p>
<pre>M-x eww RET gnu emacs web browsers RET
</pre>

<p>
    <code>M-s M-w</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Word-Search"><code>eww-search-words</code></a>﻿) will do a web search for the
contents of the <a href="#org34ab2da">Active Region</a> or else prompt you just like   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/EWW"><code>eww</code></a>﻿.
</p>

<p>
The default search engine is the privacy-focused <a href="https://duckduckgo.com/">DuckDuckGo</a>; you can Customize
  <code>eww-search-prefix</code> to change that.
</p>

<p>
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/EWW"><code>eww-open-file</code></a>﻿ is equivalent to giving <code>M-x eww</code> a <code>file://</code> URL, but
you don’t need to type the <code>file://</code> part, and of course you’ll be able to use
<a href="#org75fb6a2">Completion</a> for the filename.
</p>

<p>
The command   <code>M-x</code> <code>eww-list-bookmarks</code> let’s you fire-up EWW on one of
your EWW bookmarks (see <a href="#orgfec4fdc">EWW Bookmarks</a> below) and you can also use URLs in the
standard Emacs <a href="#org5690965">Bookmarks</a> facility.
</p>

<p>
You can also invoke EWW from outside Emacs—from an external shell’s
command line, from scripts, or from the <a href="https://www.freedesktop.org/wiki/Software/xdg-utils/"><code>xdg-open(1)</code></a> command.  A
suitable invocation is:
</p>
<pre>emacs --no-desktop -f eww-browse URL
</pre>

<p>
This of course fires up a fresh Emacs; you can also do this via
<a href="#org22671bb"><code>emacsclient(1)</code></a> with a little more fiddling, which might be trickier
to script<sup><a id="fnr.325" href="#fn.325" role="doc-backlink">325</a></sup>:
</p>
<pre>emacsclient --eval &#39;(eww &#34;URL&#34;)&#39;
</pre>


<p>
There are many more implicit entry points to EWW via the <a href="#orgab8b7dc">Browse Url</a>
subsystem.  If you configure EWW as (one of) your default browsers,
then you can open web pages from <a href="#orgcc42ce0">Dired</a>, <a href="#org5e201bd">Email messages</a>,
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/FFAP"><code>find-file-at-point</code></a>﻿, and many other places; see also
<a href="#orgad98b96">Goto Address Mode</a>.
</p>
</div>
</div>
<div id="outline-container-org333eae5">
<h5 id="org333eae5">Using the Browser</h5>
<div id="text-org333eae5">
<p>
What do you do with a web page once you’ve pulled it up?  First and foremost,
you read it.  You can scroll through the Buffer with the <a href="#org7e57cd2">usual commands</a>, and use
<a href="#org3ffa52a">Incremental Search</a> to search within the page.  Like most Emacs applications,
EWW’s <a href="#org5b21ef0">Major Mode</a> inherits from <a href="#orgfa25f51"><code>special-mode</code></a> and so supports its usual helpful
bindings for scrolling the Window.  EWW has a wealth of its own key bindings;
see Table <a href="#org6f81ea1">45</a>.
</p>
<table id="org6f81ea1">
<caption><span>Table 45:</span> EWW Key Bindings</caption>

<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Type</th>
<th scope="col">Key</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>Page Display</td>
<td><code>F</code></td>
<td>toggle Fonts</td>
</tr>

<tr>
<td> </td>
<td><code>M-C</code></td>
<td>toggle Colors</td>
</tr>

<tr>
<td> </td>
<td><code>M-I</code></td>
<td>toggle Images</td>
</tr>

<tr>
<td> </td>
<td><code>E</code></td>
<td>correct character Encoding</td>
</tr>

<tr>
<td> </td>
<td><code>D</code></td>
<td>toggle paragraph Direction</td>
</tr>

<tr>
<td> </td>
<td><code>R</code></td>
<td>Reader mode</td>
</tr>
</tbody>
<tbody>
<tr>
<td>Navigation</td>
<td><code>&lt;tab&gt;</code></td>
<td>move Point to next link</td>
</tr>

<tr>
<td> </td>
<td><code>&lt;backtab&gt;</code></td>
<td>move Point to previous link</td>
</tr>

<tr>
<td> </td>
<td><code>RET</code></td>
<td>follow the link at Point</td>
</tr>

<tr>
<td> </td>
<td><code>C-u RET</code></td>
<td>open this link in another browser</td>
</tr>

<tr>
<td> </td>
<td><code>C-u C-u RET</code></td>
<td>open this link in a new Buffer</td>
</tr>

<tr>
<td> </td>
<td><code>G</code></td>
<td><code>M-x eww</code></td>
</tr>

<tr>
<td> </td>
<td><code>d</code></td>
<td>Download the object of this link</td>
</tr>

<tr>
<td> </td>
<td><code>w</code></td>
<td>copy URL of link to kill ring</td>
</tr>

<tr>
<td> </td>
<td><code>i</code></td>
<td>browse to the Image at Point</td>
</tr>

<tr>
<td> </td>
<td><code>C-u i</code></td>
<td>copy URL of Image to kill ring</td>
</tr>

<tr>
<td> </td>
<td><code>&amp;</code></td>
<td>open this page in another browser</td>
</tr>
</tbody>
<tbody>
<tr>
<td>“Tabs”</td>
<td><code>C-u M-x eww</code></td>
<td>open a web page in a new Buffer</td>
</tr>

<tr>
<td> </td>
<td><code>M-RET</code></td>
<td>open link at Point in a new Buffer</td>
</tr>

<tr>
<td> </td>
<td><code>s</code></td>
<td>switch to a different “tab” (with completion)</td>
</tr>

<tr>
<td> </td>
<td><code>S</code></td>
<td>list all EWW “tabs”</td>
</tr>
</tbody>
<tbody>
<tr>
<td>History</td>
<td><code>l</code></td>
<td>go back (Left) to previous page</td>
</tr>

<tr>
<td> </td>
<td><code>r</code></td>
<td>undo <code>l</code> by going Right</td>
</tr>

<tr>
<td> </td>
<td><code>H</code></td>
<td>list history of previous pages</td>
</tr>
</tbody>
<tbody>
<tr>
<td>Site Navigation</td>
<td><code>n</code></td>
<td>go to “Next” page</td>
</tr>

<tr>
<td> </td>
<td><code>p</code></td>
<td>go to “Previous” page</td>
</tr>

<tr>
<td> </td>
<td><code>u</code></td>
<td>go to this page’s parent</td>
</tr>

<tr>
<td> </td>
<td><code>t</code></td>
<td>go to this site’s Top (home) page</td>
</tr>
</tbody>
<tbody>
<tr>
<td>Bookmarks</td>
<td><code>b</code></td>
<td>Bookmark this page</td>
</tr>

<tr>
<td> </td>
<td><code>B</code></td>
<td>list EWW Bookmarks</td>
</tr>

<tr>
<td> </td>
<td><code>M-n</code></td>
<td>goto Next EWW bookmark</td>
</tr>

<tr>
<td> </td>
<td><code>M-p</code></td>
<td>goto Previous EWW bookmark</td>
</tr>
</tbody>
<tbody>
<tr>
<td>Miscellaneous</td>
<td><code>g</code></td>
<td>revert (reload) the web page</td>
</tr>

<tr>
<td> </td>
<td><code>q</code></td>
<td>quit the browser window</td>
</tr>

<tr>
<td> </td>
<td><code>w</code></td>
<td>copy URL of this page to kill ring</td>
</tr>

<tr>
<td> </td>
<td><code>v</code></td>
<td>View HTML source of this page</td>
</tr>

<tr>
<td> </td>
<td><code>C</code></td>
<td>view Cookies</td>
</tr>
</tbody>
<tbody>
<tr>
<td>Org Mode</td>
<td><code>C-c C-x C-w</code></td>
<td>translate region to org mode</td>
</tr>

<tr>
<td> </td>
<td><code>C-c C-x M-w</code></td>
<td>… the same</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgcac4816">
<h5 id="orgcac4816">Page Display</h5>
<div id="text-orgcac4816">
<p>
While you’re reading, you may want to change the way the display looks.  You can
change the fonts from variable-pitch (proportional, the default) to fixed-pitch
with     <code>F</code> (<code>eww-toggle-fonts</code>),<sup><a id="fnr.326" href="#fn.326" role="doc-backlink">326</a></sup>
    <code>M-C</code> (<code>eww-toggle-colors</code>) let’s choose between accepting the
web page’s preferred color scheme or not<sup><a id="fnr.327" href="#fn.327" role="doc-backlink">327</a></sup>, and you can toggle images on
and off with     <code>M-I</code> (<code>eww-toggle-images</code>).<sup><a id="fnr.328" href="#fn.328" role="doc-backlink">328</a></sup>
</p>

<p>
Those of you who read languages other than English may occasionally need to
correct a bogus character-set encoding with
    <code>E</code> (<code>eww-set-character-encoding</code>) or toggle the paragraph
direction with     <code>D</code> (<code>eww-toggle-paragraph-direction</code>).
</p>

<p>
The page display command I use the most is     <code>R</code> (<code>eww-readable</code>),
which implements the <i>reader mode</i> familiar from other web browsers.  Just plain
EWW is already kind of gloriously like reader mode, but <code>R</code> is great for zapping
all the menus and other navigation from the top of the page.  Just use
    <code>l</code> (<code>eww-back-url</code>) to restore the full page.
</p>
</div>
</div>
<div id="outline-container-orgc4dda76">
<h5 id="orgc4dda76">Navigating Links</h5>
<div id="text-orgc4dda76">
<p>
You can navigate from link to link with     <code>TAB</code> (<code>shr-next-link</code>)
and     <code>S-TAB</code> (<code>shr-previous-link</code>) (or any other motion or search
commands!) and of course     <code>RET</code> (<code>eww-follow-link</code>) will follow
the link and open the new page in the same Buffer.  With a single prefix
argument, <code>RET</code> will open the link in another web browser (presumably external to
Emacs), like <code>&amp;</code> (below) does for the current page.  With two prefix args (<code>C-u C-u RET</code>),
<code>RET</code> will open the link in a new Buffer, like <code>M-RET</code> below.      <code>G</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/EWW"><code>eww</code></a>﻿) lets you
enter a new URL or search to be opened in this Buffer.
</p>

<p>
Instead of <i>browsing</i> the content of the link at Point,
    <code>d</code> (<code>eww-download</code>) will <i>download</i> it to the
  <code>eww-download-directory</code>, which you can Customize.  If Point
isn’t on a link, it will download the current web page (as HTML).
</p>

<p>
When Point is on an image, <code>+</code> and <code>-</code> scale the image size; <code>r</code> will rotate the image
90° at a time; and     <code>i</code> (<code>shr-browse-image</code>) will browse to that
image directly, from which page you could perhaps download it.  With a prefix
argument, <code>i</code> copies the URL of the image to the <a href="#orgee263e4">Kill Ring</a>.
</p>

<p>
Likewise,     <code>w</code> (<code>eww-copy-page-url</code>) will copy the URL of the link
at Point to the Kill Ring, or, if Point is <i>not</i> on a link, the URL of the page
you’re looking at.
</p>

<p>
Sometimes, after following a link, you’ll find that EWW is not up to handling
that web page, typically because it depends heavily on Javascript.  The
solution for these cases is
    <code>&amp;</code> (<code>eww-browse-with-external-browser</code>), which pops up the
current page in another web browser, probably outside of Emacs.  But which
browser?  It uses the Browse URL facility’s <i>secondary browser</i>, which you’ve
presumably configured (if necessary) to your liking; see <a href="#orgab8b7dc">below</a>.
</p>
</div>
</div>
<div id="outline-container-orgd1b8327">
<h5 id="orgd1b8327">Managing “Tabs” (EWW Buffers)</h5>
<div id="text-orgd1b8327">
<p>
If you invoke   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/EWW"><code>eww</code></a>﻿ (or <code>G</code> in an EWW Buffer) with a prefix
argument, i.e. <code>C-u M-x eww</code>, your web page will come up in a new Buffer,
preserving your other EWW Buffers.  You can think of these Buffers as browser
“tabs”.  The new Buffer will be named according to the <a href="#org147636d">usual scheme</a>, by default
with a numeric suffix like <code>*eww*&lt;2&gt;</code>; feel free to rename this Buffer to whatever
you like.  When you’re following a link,
    <code>M-RET</code> (<code>eww-open-in-new-buffer</code>) or <code>C-u C-u RET</code> will open that
link in a new Buffer.
</p>

<p>
Obviously you can “switch tabs” using any <a href="#orgfef4c7a">Buffer switching command</a>, but from an
EWW buffer you can switch with     <code>s</code> (<code>eww-switch-to-buffer</code>),
which has the advantage of offering up (via Completion) <i>only</i> your EWW Buffers,
and showing their URLs with their Buffer names.
    <code>S</code> (<code>eww-list-buffers</code>) brings up a Buffer with a line for each
EWW Buffer, showing their page titles as well.  Just hit <code>RET</code> on the line of the web
page you want to switch to.  (You can also invoke
  <code>M-x</code> <code>eww-list-buffers</code> from outside of EWW.)  This is probably the
friendliest way to switch tabs.
</p>
</div>
</div>
<div id="outline-container-orgbd91c1d">
<h5 id="orgbd91c1d">Browser History</h5>
<p>
The left- and right-arrow icons of the standard web browser are just the two EWW
commands     <code>l</code> (<code>eww-back-url</code>) and
    <code>r</code> (<code>eww-forward-url</code>): <code>l</code> goes <i>left</i>—back—to the web page that was
previously displayed in the current EWW Buffer, and <code>r</code> lets you undo that by
going <i>right</i>.
    <code>H</code> (<code>eww-list-histories</code>) pops up a new Buffer with the history
of this Buffer’s previous pages: their titles and URLs, just like the <code>S</code> command
does for “tabs”.
</p>
</div>
<div id="outline-container-org0e87398">
<h5 id="org0e87398">Web Site Navigation</h5>
<p>
EWW has convenience functions for navigating the structure of a web site.  When
a web site has next-page and previous-page links, whether represented as text or
graphical arrows or the like, you can use EWW’s     <code>n</code> (<code>eww-next-url</code>) and
    <code>p</code> (<code>eww-previous-url</code>) commands to follow those links.  The
    <code>u</code> (<code>eww-up-url</code>) command likewise follows a page’s “up” link
and     <code>t</code> (<code>eww-top-url</code>) follows its “home” link.  Needless to
say, these commands can’t be guaranteed to work with every site—they depend on
the web site author having clearly labeled those links in the site’s HTML
metadata.
</p>
</div>
<div id="outline-container-org3756fa6">
<h5 id="org3756fa6">EWW Bookmarks <a id="orgfec4fdc"></a></h5>
<p>
You can bookmark the current web page with
    <code>b</code> (<code>eww-add-bookmark</code>).  This is an EWW-specific bookmark, not
a standard Emacs <a href="#org5690965">Bookmark</a>, but you can also add the current web page to your
Emacs Bookmarks with the usual     <code>C-x r m</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Bookmarks"><code>bookmark-set</code></a>﻿), or do
both: your choice.  The     <code>B</code> (<code>eww-list-bookmarks</code>) command pops
up a Buffer of all EWW-specific bookmarks that’s similar to the <code>S</code> and <code>H</code> Buffers.  You can also
navigate sequentially through your EWW bookmarks with
    <code>M-n</code> (<code>eww-next-bookmark</code>) and
    <code>M-p</code> (<code>eww-previous-bookmark</code>), which I think is a weird idea:
is the sequence of <i>your</i> web browser bookmarks significant to you?  To me these
feel almost like a way of jumping to a random bookmark, but YMMV.
</p>
</div>
<div id="outline-container-orgac35c06">
<h5 id="orgac35c06">Miscellaneous EWW Commands</h5>
<div id="text-orgac35c06">
<p>
EWW supports the common   <code>special-mode</code> binding of <code>g</code> to <a href="#org652e622">Revert</a> your Buffer, which in this case
means to reload the page, and the usual <code>q</code> to <a href="#orgb416722">quit</a> the window.  <code>w</code> will copy the
URL of the current page to the Kill Ring, but only if Point is not on a link.
You can view the HTML source of the current page in an <code>*eww-source*</code> Buffer with
    <code>v</code> (<code>eww-view-source</code>).  There’s a very powerful function for
<a href="#org4a851ca">Org Mode</a> users:     <code>C-c C-x C-w</code> (<code>org-eww-copy-for-org-mode</code>) will
copy the text in the <a href="#org34ab2da">Active Region</a> to the Kill Ring, translating all links to
Org syntax.
</p>

<p>
Finally, the command     <code>C</code> (<code>url-cookie-list</code>) pops up a Buffer
displaying all the cookies that Emacs has received in this session; see <a href="#org0629b66"><i>HTTP
Cookies</i></a> for details.
</p>
</div>
</div>
<div id="outline-container-org768d3a6">
<h5 id="org768d3a6">EWW From the Command Line</h5>
<div id="text-org768d3a6">
<p>
If you’d like to invoke EWW outside of Emacs from the shell command line, you
can use this trivial script (I name it <code>~/bin/eww</code>):
</p>
<div>
<pre><span>#</span><span>!/usr/bin/</span><span>env</span><span> sh</span>
<span>CREATE</span>=
<span>case</span> <span>&#34;$1&#34;</span><span> in</span>
-c) <span>shift</span>; <span>CREATE</span>=-c ;;
--) <span>shift</span> ;;
-*) <span>exit</span> 124 ;;
<span>esac</span>
<span>exec</span> emacsclient $<span>CREATE</span> --eval <span>&#39;(eww-browse-url &#34;&#39;&#34;$*&#34;&#39;&#34; (quote (4)))&#39;</span>
</pre>
</div>
<p>
Now you can say things like:
</p>
<pre>$ eww https://www.gnu.org/software/emacs/
</pre>

<p>
or:
</p>
<pre>$ eww gnu emacs web browsers
</pre>

<p>
and it will open EWW in an existing Frame of your running Emacs, assuming you’re
running the <a href="#org22671bb">Emacs Server</a>; if you’d prefer it to open a new Frame, add the <code>-c</code>
option.  If you don’t run the Server, just change <code>emacsclient $CREATE</code> to <code>emacs
--no-desktop</code> and it’ll start up a fresh Emacs for your (this will of course be
slower).
</p>
</div>
</div>
</div>
<div id="outline-container-orga9fc8a6">
<h4 id="orga9fc8a6">Browse URL <a id="orgab8b7dc"></a></h4>
<div id="text-orga9fc8a6">
<p>
URLs can be found anywhere in Emacs.  They might be in the text of some file
you’re editing, or in the documentation of an Emacs command, or in an <a href="#org5e201bd">email</a>.
You might be about to type one in.  The <i>Browse URL</i> subsystem’s job is to make it
easy for you to browse these URLs.  Browse URL also typically handles clickable links
that are actually URLs rather than internal Emacs links.  It predates <a href="#orgc4ddf2e">EWW</a> and so
has extensive support for external web browsers (though it also supports EWW).
</p>

<p>
The fundamental Browse URL command is, appropriately enough,
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Browse-URL"><code>browse-url</code></a>﻿, which prompts you for a URL, with a default that
comes from the text at Point: so if Point is in or next to a URL, that will be
the default.  You can edit it, or zap it and reenter a URL from scratch, or <a href="#orge04d5e2">yank</a>
a URL from the <a href="#orgee263e4">Kill Ring</a>, as you like.  When you hit <code>RET</code>, the URL will be opened
in your “preferred web browser”.  But what <i>is</i> your preferred web browser?
</p>

<p>
With no <a href="#org27e6769">Customization</a>, Browse URL will try to choose a suitable one for you.
Strangely (in my opinion), as of this writing, it will never choose EWW!  The
default is first guided by your operating system: if you’re running Microsoft
Windows, it will use the default Windows web browser<sup><a id="fnr.329" href="#fn.329" role="doc-backlink">329</a></sup>; if Mac OS, the
default Apple browser.  If you’re running Unix, it will use the browser
specified the by the freedesktop.org XDG specification<sup><a id="fnr.330" href="#fn.330" role="doc-backlink">330</a></sup>, falling back to
a list of commonly-installed browsers like <code>firefox(1)</code>, <code>chromium(1)</code>, KDE,
<code>chrome(1)</code> and finally <code>lynx(1)</code> running in a terminal.
</p>

<p>
You should give Browse URL a test-run and see if you like the browser that’s
chosen for you:
</p>
<pre>M-x browse-url RET https://www.gnu.org/software/emacs/ RET
</pre>

<p>
If you’re not happy, you should Customize the variable
<code>browse-url-browser-function</code> and change it.
</p>

<p>
There’s also a notion of your <i>secondary</i> web browser choice: various commands
make it easy for you to occasionally open a URL in this other web browser—for
example, in EWW, by following a link at Point with <code>C-u RET</code>.  Setting a
secondary browser especially makes sense if you choose EWW as your primary
browser.  For example, I set my secondary browser to be <code>firefox(1)</code>, which I use
for web sites that require Javascript.  I recommend Customizing
  <code>browse-url-secondary-browser-function</code>.
</p>

<p>
Now you’re ready to use the fleet of Browse URL commands.  In addition to plain
old <code>browse-url</code>, you can use the following:
</p>
<dl>
<dt>  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Browse-URL"><code>browse-url-at-point</code></a>﻿</dt><dd>browse the URL at Point; like <code>browse-url</code>, but doesn’t prompt.</dd>
<dt>  <code>M-x</code> <code>browse-url-of-file</code></dt><dd>render the current Buffer, presumably of HTML, in your browser.</dd>
<dt>  <code>M-x</code> <code>browse-url-of-buffer</code></dt><dd>like <code>browse-url-of-file</code>, but works when the Buffer
isn’t visiting a file, or the Buffer is narrowed.</dd>
<dt>  <code>M-x</code> <code>browse-url-of-region</code></dt><dd>render, in your browser, the HTML in the Region</dd>
<dt>  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Misc-Dired-Features"><code>browse-url-of-dired-file</code></a>﻿</dt><dd>in a <a href="#orgcc42ce0">Dired</a> Buffer, open the file on this line in
your browser; this is bound to <code>W</code> in   <code>dired-mode</code>.</dd>
</dl>

<p>
Additionally, when looking at a URL,   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/FFAP"><code>find-file-at-point</code></a>﻿ is
another entry point to Browse URL; see <a href="#org557005c"><i>Find File at Point</i></a>.
</p>

<p>
You can also explicitly invoke Browse URL to use a specific browser by calling
one of the commands in Table <a href="#orgff4b25d">46</a>.
</p>
<table id="orgff4b25d">
<caption><span>Table 46:</span> Browse URL Browsers</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">​<code>M-x</code> Command</th>
<th scope="col">Browser</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>browse-url-chrome</code></td>
<td><code>chrome(1)</code></td>
</tr>

<tr>
<td><code>browse-url-chromium</code></td>
<td><code>chromium(1)</code></td>
</tr>

<tr>
<td><code>browse-url-default-macosx-browser</code></td>
<td>Mac OS <code>open</code> command</td>
</tr>

<tr>
<td><code>browse-url-default-windows-browser</code></td>
<td>Windows <code>open</code> command</td>
</tr>

<tr>
<td><code>browse-url-elinks</code></td>
<td>​<code>elinks(1)</code> in a terminal</td>
</tr>

<tr>
<td><code>browse-url-epiphany</code></td>
<td>Gnome web browser</td>
</tr>

<tr>
<td><code>browse-url-firefox</code></td>
<td><code>firefox(1)</code></td>
</tr>

<tr>
<td><code>browse-url-generic</code></td>
<td>your custom browser</td>
</tr>

<tr>
<td><code>browse-url-kde</code></td>
<td>KDE web browser</td>
</tr>

<tr>
<td><code>browse-url-mozilla</code></td>
<td>old <code>mozilla</code> browser</td>
</tr>

<tr>
<td><code>browse-url-text-xterm</code></td>
<td>text-mode browser in an <code>xterm(1)</code></td>
</tr>

<tr>
<td><code>browse-url-text-emacs</code></td>
<td>text-mode browser in an Emacs terminal</td>
</tr>

<tr>
<td><code>browse-url-w3</code></td>
<td>old all-Elisp browser</td>
</tr>

<tr>
<td><code>browse-url-xdg-open</code></td>
<td><code>xdg-open(1)</code></td>
</tr>

<tr>
<td><code>eww-browse-url</code></td>
<td>EWW</td>
</tr>
</tbody>
</table>

<p>
The <code>browse-url-text-xterm</code> command fires up any text-mode web browser, named by
  <code>browse-url-text-browser</code>.  The default value is <code>lynx</code>; IMHO
better choices are <code>elinks(1)</code> (which does a really nice layout) or <code>w3m(1)</code> (which
does images in the terminal).
</p>

<p>
The <code>browse-url-generic</code> command is what you can use to configure some other
exotic web browser (perhaps the Emacs-inspired <a href="https://nyxt.atlas.engineer/">Nyxt</a>, or <a href="https://en.wikipedia.org/wiki/Opera_(web_browser)">Opera</a>).  Just set
  <code>browse-url-generic-program</code> to the name of your browser, and
optionally set   <code>browse-url-generic-args</code> as needed.  Most of
the other browser-specific commands in Table <a href="#orgff4b25d">46</a> have their own
<code>browse-url-*-args</code> variable as well, in case you want to add some options.
</p>

<p>
Browse URL not only handles <code>http:</code> (and <code>https:</code>) URL schemes, but also the <code>mailto:</code>
scheme; when presented with a <code>mailto:</code> URL it invokes your preferred mailer; see
<a href="#org5e201bd"><i>Mail, News, and Feeds</i></a>.  You can teach it to handle other URL schemes by
Customizing   <code>browse-url-handlers</code>; this variable is flexible
enough for you to define custom handling of specific web sites too, perhaps
sending Javascript-dependent shopping domains to your secondary browser
automatically.
</p>
</div>
</div>

<div id="outline-container-orgac9acc6">
<h4 id="orgac9acc6">Goto Address Mode <a id="orgad98b96"></a></h4>
<div id="text-orgac9acc6">
<p>
I mentioned that URLs can appear in almost any Buffer, and the <a href="#orgab8b7dc">Browse URL</a>
commands will let you jump to them.  The <a href="#org5b21ef0">Minor Mode</a>
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Goto-Address-mode"><code>goto-address-mode</code></a>﻿ is a nice enhancement: it colorizes all
the URLs (and also email addresses) in your Buffer, making them more noticeable,
and when Point is at one of these locations,
    <code>C-c RET</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Goto-Address-mode"><code>goto-address-at-point</code></a>﻿) invokes
  ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Browse-URL"><code>browse-url</code></a>﻿.
</p>

<p>
You can turn it on everywhere by invoking
  <code>global-goto-address-mode</code> in your Init File, but I find that
a bit too sweeping; after all, many application Buffers, like <a href="">EWW</a> and <a href="#org9017fdf">Gnus</a>, have
their own in-built facility.  I turn it on in <a href="#org039ef0a">Shell</a> Modes and, via
  <code>goto-address-prog-mode</code>, in programming language Major
Modes, where it’s only activated in comments and strings.
</p>
<div>
<pre><span>;; </span><span>goto-address-mode is handy in these modes</span>
(<span>dolist</span> (hook &#39;(shell-mode-hook eshell-mode-hook))
  (add-hook hook #&#39;goto-address-mode))
(add-hook &#39;prog-mode-hook #&#39;goto-address-prog-mode)
</pre>
</div>
</div>
</div>
<div id="outline-container-org0068b91">
<h4 id="org0068b91">HTTP Cookies <a id="org0629b66"></a></h4>
<div id="text-org0068b91">
<p>
All Emacs commands that fetch data from a web server use functions from
the <code>url</code> package, and handling of all <a href="https://en.wikipedia.org/wiki/HTTP_cookie">HTTP cookies</a> is done in these functions.
</p>

<p>
While cookies are obviously essential for sites requiring authentication,
managing shopping carts, and the like, since such sites almost always require
Javascript, they don’t work in EWW.  For most other sites, cookies are
unnecessary and probably only used to track you.  I block all of them and this
has never yet interfered with my use of any web site in EWW.  You can block them
with this <a href="#org2af3730">Init File</a> snippet:
</p>
<div>
<pre>(<span>setq</span> url-cookie-untrusted-urls &#39;(<span>&#34;.*&#34;</span>)) <span>; </span><span>cookies: generally a bad idea</span>
</pre>
</div>
<p>
If you feel less extreme about this than I do, you can Customize this variable
to block only specific domains or URLs instead.
</p>

<p>
Note that if you don’t use EWW and configure Browse URL to invoke an external
web browser, then cookies will of course be handled by that browser, and not by
Emacs.
</p>
</div>
</div>
<div id="outline-container-orgb7ead6f">
<h4 id="orgb7ead6f">User Options</h4>
<p>
There are many User Options related to web browsing that you might want to
Customize.  Do   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-group</code></a>﻿ for the <code>eww</code>, <code>browse-url</code>, and
<code>url-cookie</code> groups.
</p>
</div>

</div>

<div id="outline-container-org84c1c34">
<h3 id="org84c1c34">The Calendar, Diary, and Clocks <a id="org0c5e670"></a></h3>
<div id="text-org84c1c34">

<div id="orgc22d038">
<p><a href="https:./images/epoch.png" alt="Calendar for the Epoch" title="Calendar for the Epoch" width="100%"><img src="https://blog.veitheller.de/images/epoch.png" alt="Calendar for the Epoch" title="Calendar for the Epoch" width="100%"/></a>
</p>
<p><span>Figure 49: </span>Calendar for the Epoch</p>
</div>

<p>
The calculation of dates and holidays is extremely complex, and Emacs has a
correspondingly powerful Calendar subsystem to handle this.  You can pop up
a three-month calendar, centered on today, in a compact Window with
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Calendar/Diary"><code>calendar</code></a>﻿.  Add a prefix argument and it will prompt you for a
year and month on which to center (instead of today).  Figure <a href="#orgc22d038">49</a>
shows the Calendar window for the <a href="https://en.wikipedia.org/wiki/Unix_time">Unix Epoch</a><sup><a id="fnr.331" href="#fn.331" role="doc-backlink">331</a></sup>, which is 00:00:00 UTC on 1
January 1970.  The highlighted dates are holidays.
</p>

<p>
The Emacs Calendar can display any month since January of the year 1 of the
Common Era; the Calendar always displays the Gregorian calendar, even for a date
at which the Gregorian calendar did not exist (i.e. before October 1582).
However, the Calendar supports eleven additional <i>calendar systems</i>—Bahá’í,
Chinese, Coptic, Ethiopic, French Revolutionary, Hebrew, Islamic, ISO, Julian,
Mayan, and Persian—and can translate between them.
</p>

<p>
Besides displaying the calendar for any month, the Calendar subsystem can count
days between arbitrary dates, display holidays and astronomical information,
convert dates to and from the other calendar systems, generate printed calendars
(in HTML, PDF, or LaTeX forms), and it also has a powerful Diary to keep track
of your appointments.  There’s also a
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Time-Intervals">timeclock facility</a> for tracking
your hours, but I think that’s better done in <a href="#org4a851ca">Org Mode</a>.
</p>
</div>

<div id="outline-container-org75943fd">
<h4 id="org75943fd">Setting Up the Calendar</h4>
<div id="text-org75943fd">
<p>
You should Customize the two variables   <code>calendar-latitude</code>
and   <code>calendar-longitude</code> to exploit some of the Calendar’s
more interesting features; these values are easy to get from a
gazetteer<sup><a id="fnr.332" href="#fn.332" role="doc-backlink">332</a></sup>, map or mapping software, or from Wikipedia in many cases.
The easiest way to express these values is as a Lisp vector, as in this example:
</p>
<div>
<pre>(<span>setq</span> calendar-latitude  [43 02 north]) <span>; </span><span>= 43°02&#39;49&#34;N</span>
(<span>setq</span> calendar-longitude [76 08 west])  <span>; </span><span>= 76°08&#39;40&#34;W</span>
</pre>
</div>
<p>
While you’re at it, you might set   <code>calendar-location-name</code> to
a string naming your location; this is totally optional and merely makes some
displays look a little nicer.
</p>
<div>
<pre>(<span>setq</span> calendar-location-name <span>&#34;Syracuse, NY&#34;</span>)
</pre>
</div>
<p>
You can of course set these via   <code>M-x</code> <code>customize-variable</code> instead.
</p>

<p>
I also recommend these <a href="#org2af3730">Init File</a> settings so that you’ll get colorized holidays
and diary entries by default:
</p>
<div>
<pre>(<span>setq</span> calendar-mark-holidays-flag t        <span>; </span><span>colorize holidays in the calendar</span>
      calendar-mark-diary-entries-flag t)  <span>; </span><span>also diary entries</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9099796">
<h4 id="org9099796">Motion</h4>
<div id="text-org9099796">
<p>
Moving around in the Calendar is designed by analogy to the <a href="#orgee51965">textual object
motion commands</a> you’re already familiar with, from the smallest units (days =
characters) to the largest (years = pages).  All these commands take numeric
arguments, so it’s easy to jump forward six months, say, with <code>C-u 6 M-}</code>.  See
Table <a href="#orgfe6d9da">47</a>.
</p>
<table id="orgfe6d9da">
<caption><span>Table 47:</span> Calendar Motion Commands</caption>

<colgroup>
<col/>

<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Backward</th>
<th scope="col">Unit</th>
<th scope="col">Forward</th>
<th scope="col">Analog</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>C-b</code>, <code>←</code></td>
<td>day</td>
<td><code>C-f</code>, <code>→</code></td>
<td>(character)</td>
</tr>

<tr>
<td><code>C-p</code></td>
<td>week</td>
<td><code>C-n</code></td>
<td>(line)</td>
</tr>

<tr>
<td><code>M-{</code></td>
<td>month</td>
<td><code>M-}</code></td>
<td>(paragraph)</td>
</tr>

<tr>
<td><code>C-x [</code></td>
<td>year</td>
<td><code>C-x ]</code></td>
<td>(page)</td>
</tr>
</tbody>
<tbody>
<tr>
<td>Beginning</td>
<td> </td>
<td>Ending</td>
<td> </td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C-a</code></td>
<td>week</td>
<td><code>C-e</code></td>
<td>(line)</td>
</tr>

<tr>
<td><code>M-a</code></td>
<td>month</td>
<td><code>M-e</code></td>
<td>(sentence)</td>
</tr>

<tr>
<td><code>M-&lt;</code></td>
<td>year</td>
<td><code>M-&gt;</code></td>
<td>(buffer)</td>
</tr>
</tbody>
</table>
<p>
You can jump directly to a specific date with the commands in Table
<a href="#org8d4c5e0">48</a>.
</p>
<table id="org8d4c5e0">
<caption><span>Table 48:</span> Specific Calendar Dates and Scrolling</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Command</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>g d</code></td>
<td>go to specific date</td>
</tr>

<tr>
<td><code>o</code></td>
<td>center calendar on specific month</td>
</tr>

<tr>
<td><code>g D</code></td>
<td>go to specific day number in year</td>
</tr>

<tr>
<td><code>g w</code></td>
<td>go to specific week number in year</td>
</tr>

<tr>
<td><code>.</code></td>
<td>go to today</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>&gt;</code></td>
<td>scroll one month forward</td>
</tr>

<tr>
<td><code>&lt;</code></td>
<td>… backward</td>
</tr>

<tr>
<td><code>C-v</code></td>
<td>scroll three months forward</td>
</tr>

<tr>
<td><code>M-v</code></td>
<td>… backward</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org8ad7d74">
<h4 id="org8ad7d74">Counting Days</h4>
<p>
You can count the number of days between any two dates in the Calendar.  Just
move to one of the days, <a href="#org40fd5a7">set the Mark</a>, move to the other day, and invoke
    <code>M-‌=</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Counting-Days"><code>calendar-count-days-region</code></a>﻿).
</p>
</div>
<div id="outline-container-org04f0dfe">
<h4 id="org04f0dfe">Holidays</h4>
<div id="text-org04f0dfe">
<p>
Emacs knows a lot of holidays, both secular United States holidays and major
religious holidays in the Bahá’í, Chinese, Christian, Islamic, and Jewish
traditions.<sup><a id="fnr.333" href="#fn.333" role="doc-backlink">333</a></sup>  Use   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-group</code></a>﻿ <code>RET holidays</code> to choose the ones
you’re interested in.  When you’re in the Calendar, you can display them with
the commands in Table <a href="#org73a2873">49</a>.
</p>

<table id="org73a2873">
<caption><span>Table 49:</span> Calendar Holiday Commands</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Command</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>h</code></td>
<td>display Holidays for date at point</td>
</tr>

<tr>
<td><code>a</code></td>
<td>display All holidays in view in another window</td>
</tr>

<tr>
<td><code>x</code></td>
<td>mark holidays in view</td>
</tr>

<tr>
<td><code>u</code></td>
<td>unmark …</td>
</tr>
</tbody>
</table>
<p>
My recommended setting for <code>calendar-mark-holidays-flag</code> above <i>marks</i> (colorizes)
the holidays in the Calendar Window by default, so you won’t need the <code>x</code> command
unless you unmark them with <code>u</code> (for a clearer view perhaps).
</p>

<p>
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Holidays"><code>holidays</code></a>﻿ pops up the same window as the <code>a</code> command in the
Calendar Window, but you can use it without first opening the Calendar;
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Holidays"><code>list-holidays</code></a>﻿ prompts you for a range of years and generates a
Buffer listing all the known holidays in that time range.
</p>
</div>
</div>
<div id="outline-container-orgd6764f1">
<h4 id="orgd6764f1">The Emacs Ephemeris: Astronomical Information</h4>
<div id="text-orgd6764f1">
<p>
The Calendar can compute the times of sunset and sunrise, the phases of the
moon<sup><a id="fnr.334" href="#fn.334" role="doc-backlink">334</a></sup>, and the dates of upcoming eclipses.
</p>
<table id="org3e1e0a2">
<caption><span>Table 50:</span> Calendar Astronomical Commands</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Command</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>S</code></td>
<td>display time of Sunrise and Sunset</td>
</tr>

<tr>
<td><code>M-x calendar-sunrise-sunset-month</code></td>
<td>… for every day this month</td>
</tr>

<tr>
<td><code>M-x sunrise-sunset</code></td>
<td>… for today</td>
</tr>

<tr>
<td><code>C-u M-x sunrise-sunset</code></td>
<td>… for a given date</td>
</tr>

<tr>
<td><code>C-u C-u M-x sunrise-sunset</code></td>
<td>… and a given location</td>
</tr>

<tr>
<td><code>M</code></td>
<td>display Moon phases in calendar view</td>
</tr>

<tr>
<td><code>M-x lunar-phases</code></td>
<td>… the same</td>
</tr>

<tr>
<td><code>C-u M-x lunar-phases</code></td>
<td>… for a given month and year</td>
</tr>
</tbody>
</table>
<p>
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Lunar-Phases"><code>lunar-phases</code></a>﻿ includes upcoming eclipses in its listing; here’s
an example:
</p>
<pre id="orgb0c730b">Wednesday, July 6, 2022: First Quarter Moon 9:15pm (CDT)
Wednesday, July 13, 2022: Full Moon 1:33pm (CDT)
Wednesday, July 20, 2022: Last Quarter Moon 9:24am (CDT) **  Eclipse possible **
Thursday, July 28, 2022: New Moon 12:55pm (CDT)
Friday, August 5, 2022: First Quarter Moon 6:08am (CDT) **  Eclipse **
Thursday, August 11, 2022: Full Moon 8:31pm (CDT)
Thursday, August 18, 2022: Last Quarter Moon 11:41pm (CDT) **  Eclipse **
Saturday, August 27, 2022: New Moon 3:17am (CDT)
Saturday, September 3, 2022: First Quarter Moon 1:09pm (CDT)
Saturday, September 10, 2022: Full Moon 4:54am (CDT)
Saturday, September 17, 2022: Last Quarter Moon 4:56pm (CDT)
Sunday, September 25, 2022: New Moon 4:54pm (CDT)
</pre>
</div>
</div>
<div id="outline-container-orgca8eb00">
<h4 id="orgca8eb00">To and From Other Calendar Systems</h4>
<div id="text-orgca8eb00">
<p>
On the <code>g</code> keymap are commands to <i>go to</i> a date expressed in one of the
non-Gregorian calendar systems, and on the <code>p</code> keymap, to <i>print</i> (i.e. display) the
current date in another system.
</p>
<table id="org4df5be6">
<caption><span>Table 51:</span> To and From Other Calendar Systems</caption>

<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Goto</th>
<th scope="col">Print</th>
<th scope="col">Calendar System</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>g a</code></td>
<td><code>p a</code></td>
<td>astronomical (Julian) day number</td>
</tr>

<tr>
<td><code>g b</code></td>
<td><code>p b</code></td>
<td>Bahá’í</td>
</tr>

<tr>
<td><code>g C</code></td>
<td><code>p C</code></td>
<td>Chinese</td>
</tr>

<tr>
<td><code>g k</code></td>
<td><code>p k</code></td>
<td>Coptic</td>
</tr>

<tr>
<td><code>g e</code></td>
<td><code>p e</code></td>
<td>Ethiopic</td>
</tr>

<tr>
<td><code>g f</code></td>
<td><code>p f</code></td>
<td>French Revolutionary</td>
</tr>

<tr>
<td><code>g h</code></td>
<td><code>p h</code></td>
<td>Hebrew</td>
</tr>

<tr>
<td><code>g i</code></td>
<td><code>p i</code></td>
<td>Islamic</td>
</tr>

<tr>
<td><code>g c</code></td>
<td><code>p c</code></td>
<td>ISO commercial calendar</td>
</tr>

<tr>
<td><code>g w</code></td>
<td> </td>
<td>ISO commercial calendar week</td>
</tr>

<tr>
<td><code>g j</code></td>
<td><code>p j</code></td>
<td>Julian</td>
</tr>

<tr>
<td><code>g m</code> …</td>
<td><code>p m</code></td>
<td>Mayan</td>
</tr>

<tr>
<td><code>g p</code></td>
<td><code>p p</code></td>
<td>Persian</td>
</tr>

<tr>
<td> </td>
<td><code>p o</code></td>
<td>various other calendars</td>
</tr>
</tbody>
</table>
<p>
Converting to the Mayan calendar is complex enough to require its own keymap of
seven extra bindings; see <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Mayan-Calendar">“Mayan Calendar”</a> in the <i>Emacs</i> manual.
</p>

<p>
The <code>p o</code> command displays the selected date in all the other calendar systems;
here’s the result for the Epoch:
</p>
<pre id="org10e0be6">Day 1 of 1970; 364 days remaining in the year
ISO date: Day 4 of week 1 of 1970
Julian date: December 19, 1969
Astronomical (Julian) day number (at noon UTC): 2440588.0
Fixed (RD) date: 719163
Hebrew date (before sunset): Teveth 23, 5730
Persian date: Dey 11, 1348
Islamic date (before sunset): Shawwal 22, 1389
Bahá’í date: S͟haraf 2, 126
Chinese date: Cycle 77, year 46 (Ji-You), month 11 (Bing-Zi), day 24 (Xin-Si)
Coptic date: Kiyahk 23, 1686
Ethiopic date: Takhsas 23, 1962
French Revolutionary date: Primidi 11 Nivôse an 178 de la Révolution, jour du Granit
Mayan date: Long count = 12.17.16.7.5; tzolkin = 13 Chicchan; haab = 3 Kankin
</pre>
</div>
</div>
<div id="outline-container-org74f58b1">
<h4 id="org74f58b1">Printed Calendars</h4>
<p>
There are a variety of commands to generate “printed” calendars in HTML, LaTeX,
and (indirectly via LaTeX), PDF.  See <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Writing-Calendar">the Manual</a> for details.
</p>
</div>
<div id="outline-container-org79bf2bf">
<h4 id="org79bf2bf">The Diary</h4>
<div id="text-org79bf2bf">
<p>
Emacs has a Diary facility that allows you to record appointments, reminders,
meetings, birthdays, and the like.  They can be marked in the Calendar<sup><a id="fnr.335" href="#fn.335" role="doc-backlink">335</a></sup>
and the appointments for the day can be displayed in a pop-up Window via
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Diary"><code>diary</code></a>﻿.  Diary entries are entered in your diary file, defined by
  <code>diary-file</code>, in a flexible format that allows for complex
dates and repeats.  Here’s an example diary file:
</p>
<pre id="org369c58c">4/15 TAX DAY
*/1  Submit Time Card
%%(diary-anniversary 10 20 1874) Charles Ives&#39; Birthday: %d years old

Wednesday
  2:30pm-3:30pm Staff Meeting
  5:00pm-7:00pm Study Group
</pre>
<p>
The easiest way to make Diary entries is from inside the Calendar via the
commands in Table <a href="#org801bc57">52</a>.  See
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Format-of-Diary-File">“Format of Diary File”</a> in the <i>Emacs</i> manual for a description of the syntax
used in manual edits.
</p>

<table id="org801bc57">
<caption><span>Table 52:</span> Calendar Diary Commands</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Command</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>d</code></td>
<td>Display Diary entries for this date</td>
</tr>

<tr>
<td><code>M-x diary</code></td>
<td>… the same</td>
</tr>

<tr>
<td><code>s</code></td>
<td>Show the diary file</td>
</tr>

<tr>
<td><code>m</code></td>
<td>Mark all dates with diary entries</td>
</tr>

<tr>
<td><code>u</code></td>
<td>Unmark all calendar marks</td>
</tr>

<tr>
<td><code>i d</code></td>
<td>Insert a diary entry for this Date</td>
</tr>

<tr>
<td><code>i w</code></td>
<td>… for this day of the Week (e.g. any Thursday)</td>
</tr>

<tr>
<td><code>i m</code></td>
<td>… for this day of the Month (e.g. any 12th)</td>
</tr>

<tr>
<td><code>i y</code></td>
<td>… for this day of the Year</td>
</tr>
</tbody>
</table>

<p>
It must be said that for many Emacs users, myself included, the <a href="#org4a851ca">Org Mode</a>
<a href="https://www.gnu.org/software/emacs/manual/html_node/org/Agenda-Views">Agenda</a> has largely replaced the
functionality of the Diary.  The Agenda can incorporate the Diary, so anything
you record with the Diary will show up if you display the Agenda; this Init File
snippet does the job:
</p>
<div>
<pre>(<span>setq</span> org-agenda-include-diary t)  <span>; </span><span>incorporate the diary into the agenda</span>
</pre>
</div>
<p>
If you use the Agenda and don’t already use the Diary, the main reason to use it
occasionally is because the Diary’s ability to express complex recurring dates
exceeds Org’s.
</p>
</div>
</div>
<div id="outline-container-org4727f38">
<h4 id="org4727f38">Appointments <a id="org5487358"></a></h4>
<div id="text-org4727f38">
<p>
Emacs can notify you of any Diary entries with an attached time of day
through the
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Appointments">Appointments subsystem</a>.<sup><a id="fnr.336" href="#fn.336" role="doc-backlink">336</a></sup>  A certain
amount of time before the appointment occurs, a notification window will pop up
and the bell will ring.  More notifications will pop up until the appointment
time has passed.  You can customize the details via
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-group</code></a>﻿ <code>RET appt</code>, but this Init File snippet will enable
the defaults:
</p>
<div>
<pre>(appt-activate +1)        <span>; </span><span>appointment notifications, please</span>
(<span>require</span> &#39;<span>notifications</span>)  <span>; </span><span>also via desktop notifications</span>
</pre>
</div>
<p>
On most operating systems, this snippet will also generate OS notifications.<sup><a id="fnr.337" href="#fn.337" role="doc-backlink">337</a></sup>
</p>

<p>
You can add a nonce appointment as a sort of alarm without going to the trouble
of creating a Diary or Agenda appointment with   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Appointments"><code>appt-add</code></a>﻿; it will
prompt you for the time, a description, and the number of minutes of lead time.
Any upcoming appointment notifications for the day can be canceled with
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Appointments"><code>appt-delete</code></a>﻿; you get to confirm the deletions one at a time, so
if you just answer “no” to all of them, this is also usable as a way of checking
which appointments are coming up.  Note that these nonce appointments don’t
persist across Emacs sessions!
</p>
</div>
</div>
<div id="outline-container-org0cd897a">
<h4 id="org0cd897a">Customization</h4>
<div id="text-org0cd897a">
<p>
The Calendar is highly customizable;   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-group</code></a>﻿ <code>RET calendar</code>
offers you the option to change how everything is displayed, marked, and named,
and much more.
</p>

<p>
Holidays are of particular note.  The default holidays are those common
throughout the United States, and only a small set of the (many) religious
holidays known to Emacs are included.    <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-group</code></a>﻿ <code>RET holidays</code>
makes it easy to include or exclude any of these.
</p>

<p>
You can readily add your own holidays, perhaps local holidays, holidays for your
workplace or university, birthdays of your friends or favorite celebrities.  I
think it’s easiest to do this in your Diary; second easiest is in your <a href="#org2af3730">Init
File</a>.
</p>

<p>
The Calendar is capable of computing even the most complicated of holiday dates
(like Passover and Easter), and you can use its powerful functions for your own
dates.  Here, for example, is an entry for the date of the US Presidential
Election:
</p>
<div>
<pre>(add-to-list &#39;calendar-holidays
             &#39;(holiday-sexp
               &#39;(if (zerop (% year 4))
                    (calendar-gregorian-from-absolute
                     (1+ (calendar-dayname-on-or-before
                          1 (+ 6 (calendar-absolute-from-gregorian
                                  (list 11 1 year)))))))
               <span>&#34;US Presidential Election&#34;</span>))
</pre>
</div>
</div>
</div>
<div id="outline-container-org1b3398b">
<h4 id="org1b3398b">Clocks and Time</h4>
<p>
In addition to calendar features, Emacs has a variety of clocks for displaying
the current time.
</p>

<div id="outline-container-org83f047a">
<h5 id="org83f047a">World Clock <a id="org307006d"></a></h5>
<div id="text-org83f047a">
<p>
  <code>M-x</code> <code>world-clock</code> pops up a <code>*wclock*</code> Buffer displaying the current
time in various world time zones:
</p>
<pre id="org8572e57">Seattle   Friday 05 August 12:14 PDT
New York  Friday 05 August 15:14 EDT
London    Friday 05 August 20:14 BST
Paris     Friday 05 August 21:14 CEST
Bangalore Saturday 06 August 00:44 IST
Tokyo     Saturday 06 August 04:14 JST
</pre>
<p>
The times in this Buffer update continuously as long as the Buffer is displayed
in a Window.  You can   <code>M-x</code> <code>customize-variable</code> <code>RET world-clock-list</code> to
choose your own preferred time zones.
</p>
</div>
</div>
<div id="outline-container-orge6846bf">
<h5 id="orge6846bf">Time Stamps in Files</h5>
<div id="text-orge6846bf">
<p>
You can have Emacs update a time-stamp line every time you save a file.  If you
enable this feature, then when you save this file:
</p>
<pre id="org938a60f">Meeting Notes
Time-stamp:

* Boring Topic
  Blah blah...
</pre>
<p>
the <code>Time-stamp:</code> line will be updated to today’s date:
</p>
<pre>Time-stamp: 2022-10-13 17:25:09
</pre>

<p>
If you edit and save the file again, the time-stamp will be updated.  The magic
string “Time-stamp:” and the format of the time and date are of course
customizable.  The facility can be enabled on a file-by-file basis.
</p>

<p>
It used to be common for programmers to have time-stamps in all their source
files, but in my opinion, this feature is pretty annoying now that we keep all
our files under <a href="#org53af7eb">version control</a>, and I no longer use it.  After all, your VCS
knows exactly when you last modified each file, and a
    <code>C-x v l</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/VC-Change-Log"><code>vc-print-log</code></a>﻿) will show you the time-stamp.  Also,
most typesetters will allow you to readily include the publication date in
formatted versions of your documents.
</p>

<p>
But, if you think this feature sounds useful, see
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Time-Stamps">“Time Stamps”</a> in the <i>Emacs</i> manual.
</p>
</div>
</div>
<div id="outline-container-org92a2d64">
<h5 id="org92a2d64">Timeclocks</h5>
<div id="text-org92a2d64">
<p>
Emacs also has several facilities for clocking your work hours and recording how
much time you spend on some task or project.  Just invoke
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Time-Intervals"><code>timeclock-in</code></a>﻿ when you start work—it’ll prompt you for a project
name—and when you’re done,   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Time-Intervals"><code>timeclock-out</code></a>﻿, or
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Time-Intervals"><code>timeclock-change</code></a>﻿ to switch to working on a different project.
</p>

<p>
The timeclock log is stored in the file named in
  <code>timeclock-file</code> in s simple format:
</p>
<pre id="org0636b52">i 2022/10/13 17:38:27 test1
o 2022/10/13 17:39:31
i 2022/10/13 17:39:33 test2
o 2022/10/13 17:41:21 done
</pre>
<p>
If you’re a programmer, you can whip up code to process that data easily enough,
but <a href="#org4a851ca">Org Mode</a> has a much more powerful timeclock facility that’s integrated with
your Org Agenda and includes report generation, effort estimates, and data
export to CSV for incorporation into external applications.
</p>

<blockquote>
<p>
I keep sticking to Emacs because it has one huge ace up its sleeve that other
editors simply cannot match.  Emacs has a package that helps me organize my
workflow, focus my note-taking and even keep a timeclock for how long I spend
working on tasks.  This package is called Org mode. — <a href="https://xeiaso.net/blog/org-mode-flow-2020-09-08">Christine Dodrill</a>
</p>
</blockquote>
</div>
</div>
</div>

</div>

<div id="outline-container-orgea33152">
<h3 id="orgea33152">Version Control <a id="org53af7eb"></a></h3>
<div id="text-orgea33152">
<p>
<i>Version control</i> is an essential component of software engineering and, I would
say, of any sort of authoring, from articles and essays to novels and oversized
books about Emacs.  I’ll assume you’re already using version control; if
not, I strongly encourage you to check out the <a href="https://en.wikipedia.org/wiki/Version_control">Wikipedia article</a> and get
started.
</p>

<p>
<i>Version control systems</i> (VCS) are nowadays almost synonymous with <a href="https://en.wikipedia.org/wiki/Git">Git</a>, but there
are in fact many other VCS’s to choose from.  I prefer <a href="https://en.wikipedia.org/wiki/Mercurial">Mercurial</a> (Hg) myself,
and I also still use the ancient <a href="https://en.wikipedia.org/wiki/Revision_Control_System">RCS</a> for certain cases.  But I have to use other
VCS’s occasionally (Git especially), when I’m working with other people’s code.
</p>

<p>
Though there are two broad categories of VCS’s—the modern <i>merge-based</i> style,
and the older <i>lock-based</i>—most VCS’s have analogous features.  But wildly
different user interfaces: keeping several of them straight is a daunting task.
</p>

<p>
Emacs to the rescue!  The Emacs version control interface,
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Version-Control">VC</a>, tries valiantly (and quite
successfully) to provide a common abstraction over these varying systems so
that, regardless of the system in use for a given file or directory, you can use
the same commands to perform the most common operations.  Most of the frequently
used commands work appropriately across all supported VCS’s, but some of them
aren’t consistently supported yet: you may need to occasionally pitch in with
the underlying commands via   <code>M-!</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Single-Shell"><code>shell-command</code></a>﻿) or
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Interactive-Shell"><code>shell</code></a>﻿.
</p>

<p>
There are some slight differences in the way VC commands work with older
lock-based systems like RCS; since few people use such VCS’s these days, I’ll
describe only merge-based systems in detail.  As always, the Manual has the
complete story.
</p>

<p>
From here on, <i>VC</i> refers to Emacs’s VC commands, and <i>VCS</i> to the underlying
version control system being used in any given case.
</p>
</div>
<div id="outline-container-orgbefb84c">
<h4 id="orgbefb84c">Supported Version Control Systems <a id="org070049c"></a></h4>
<div id="text-orgbefb84c">
<p>
Out of the box, Emacs VC supports nine version control systems; see Table
<a href="#orge9f66fe">53</a>.  Other systems (for example, <a href="https://en.wikipedia.org/wiki/Darcs">Darcs</a> and <a href="https://www.fossil-scm.org/home/doc/trunk/www/index.wiki">Fossil</a>) have support in the <a href="#orgc96889a">Package Manager</a>.
</p>
<table id="orge9f66fe">
<caption><span>Table 53:</span> Supported Version Control Systems</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Abbreviation</th>
<th scope="col">Version Control System</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>RCS</code></td>
<td>GNU RCS</td>
</tr>

<tr>
<td><code>CVS</code></td>
<td>Concurrent Versions System</td>
</tr>

<tr>
<td><code>SVN</code></td>
<td>Apache Subversion</td>
</tr>

<tr>
<td><code>SCCS</code></td>
<td>Source Code Control System</td>
</tr>

<tr>
<td><code>SRC</code></td>
<td>SRC<sup><a id="fnr.338" href="#fn.338" role="doc-backlink">338</a></sup></td>
</tr>

<tr>
<td><code>Bzr</code></td>
<td>GNU Bazaar</td>
</tr>

<tr>
<td><code>Git</code></td>
<td>Git</td>
</tr>

<tr>
<td><code>Hg</code></td>
<td>Mercurial</td>
</tr>

<tr>
<td><code>Mtn</code></td>
<td>Monotone</td>
</tr>
</tbody>
</table>

<p>
(Of course, you need to install the VCS’s themselves (any that you want to
use) outside of Emacs via your operating system’s package manager.)
</p>

<p>
It must be mentioned that one of the modern <a href="https://en.wikipedia.org/wiki/Killer_application"><i>killer apps</i></a> for Emacs is <a href="https://en.wikipedia.org/wiki/Magit">Magit</a>, a
bespoke version control package for Git (only).  People are fanatical about it,
and while I prefer the simpler VC abstraction for the limited amount of work I
need to do with Git, I’d be remiss not to mention it.  Just install it from the
<a href="#orgc96889a">Package Manager</a> as usual.  But from here on out, I’ll be discussing VC only, and
everything will apply equally to any of the above VCS’s.
</p>
</div>
</div>
<div id="outline-container-orgce10868">
<h4 id="orgce10868">VC “Modes”</h4>
<p>
VC provides two main modes of interacting with the underlying VCS, which I’ll
call File Mode and Project Mode.  File Mode applies when you issue VC commands
from a file-visiting Buffer, but <i>also</i> when you’re in a <a href="#orgcc42ce0">Dired</a> Buffer (where it
applies to the file at Point).  Project Mode applies when you’re in the
special   <code>vc-dir-mode</code> Buffer created by
    <code>C-x v d</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/VC-Directory-Mode"><code>vc-dir</code></a>﻿), which is for interacting with the whole
repo at once.  We’ll consider these two modes in separately.
</p>
</div>
<div id="outline-container-org1821f42">
<h4 id="org1821f42">VC File Mode in One Command</h4>
<div id="text-org1821f42">
<p>
The most frequent VCS actions are cleverly subsumed under one state-smart
command,     <code>C-x v v</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Basic-VC-Editing"><code>vc-next-action</code></a>﻿).  You can spend much of the
day issuing that one command repeatedly, and only occasionally delving into the
other VC commands.
</p>

<p>
<code>C-x v v</code> performs the appropriate next action on the file visited in the current
Buffer (or, if you’re in a Dired Buffer, the file at Point).  The action depends
on the version control state of the file in this order:
</p>
<table>


<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">File State</th>
<th scope="col"><code>C-x v v</code> Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>No Repository!</td>
<td>Initialize the repo</td>
</tr>

<tr>
<td>Unregistered</td>
<td>Register the file</td>
</tr>

<tr>
<td>Unmodified</td>
<td>No action</td>
</tr>

<tr>
<td>Modified</td>
<td>Commit changes</td>
</tr>
</tbody>
</table>
<p>
So suppose you’re working on a project in an existing VCS repository, and you
create a new file with     <code>C-x C-f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Visiting"><code>find-file</code></a>﻿) as usual.  After
typing in some content, you hit <code>C-x v v</code>; since the file is new, it gets
<i>registered</i> with the repo—corresponding to the <i>add</i> command of most systems.
</p>

<p>
After some more editing, you issue another <code>C-x v v</code>—this time, VC <i>commits</i> your
changes (corresponding to the <i>commit</i> or <i>check-in</i> command).  This pops up two new
Buffers in two new Windows: <code>*log-edit-files*</code>, which displays the names of the
files being committed (in the File Mode case, only one filename: that of the
file you’re editing) and <code>*vc-log*</code>.  The latter will be the selected Window, and
you’re expected to type in a commit message or summary of your changes<sup><a id="fnr.339" href="#fn.339" role="doc-backlink">339</a></sup>.
</p>

<p>
Typically the first line of the commit message is a short pithy summary, and you
can use any number of lines following it to describe your changes in as much
detail as you like.  When you’re done, just type the usual
    <code>C-c C-c</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>log-edit-done</code></a>﻿) and your changes are safely committed
to the repo; both of the Windows will vanish.  If you’ve changed your mind, you
can abort the commit with     <code>C-c C-k</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>log-edit-kill-buffer</code></a>﻿),
which will also clean up the Windows.
</p>

<p>
That’s it!  You can work for much of the day with just this one command.
</p>
</div>
</div>
<div id="outline-container-org09849b1">
<h4 id="org09849b1">More VC File Mode Commands</h4>
<div id="text-org09849b1">
<p>
If the only thing you ever did with your VCS is add and commit files, you could
dispense with the VCS entirely!  The whole point is that you occasionally need
to use other features of version control, primarily to save your butt when you
screw up.  The major categories of butt-saving include:
</p>
<ul>
<li>comparing the current state of your file to a previous state (a.k.a. <a href="#orgf51c17d"><i>diffing</i></a>)</li>
<li>blaming somebody else for problems in your file<sup><a id="fnr.340" href="#fn.340" role="doc-backlink">340</a></sup></li>
<li>reverting that person’s changes so you can fix them</li>
<li>getting an idea of the <i>history</i> of changes to the file (viewing the log)</li>
<li>restoring a previous version of your file</li>
<li>tagging revisions</li>
<li>pushing and pulling from remote repos</li>
<li>and the most complex, most annoying, and probably most important thing:
working with branches</li>
</ul>
<table id="org68bafb3">
<caption><span>Table 54:</span> VC File Mode Commands</caption>

<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">Category</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>C-x v v</code></td>
<td> </td>
<td>jack of all trades: DWIM</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C-x v i</code></td>
<td>Init</td>
<td>Initialize a repo or add a file</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C-x v ‍=</code></td>
<td>Diff</td>
<td>show diff of this file</td>
</tr>

<tr>
<td><code>M-x vc-ediff</code></td>
<td> </td>
<td>… in Ediff</td>
</tr>

<tr>
<td><code>C-x v D</code></td>
<td> </td>
<td>… of all files</td>
</tr>

<tr>
<td><code>C-x v h</code></td>
<td> </td>
<td>… of just this Region</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C-x v l</code></td>
<td>Log</td>
<td>show change Log of this file</td>
</tr>

<tr>
<td><code>C-x v L</code></td>
<td> </td>
<td>… of all files</td>
</tr>

<tr>
<td><code>M-x vc-log-search</code></td>
<td> </td>
<td>search the text of log entries</td>
</tr>

<tr>
<td><code>C-x v a</code></td>
<td> </td>
<td>update the <code>ChangeLog</code> file</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C-x v ~</code></td>
<td>View</td>
<td>show an older version in another buffer</td>
</tr>

<tr>
<td><code>C-x v g</code></td>
<td> </td>
<td>assign blame for each line (annotate)</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C-x v u</code></td>
<td>Revert</td>
<td>Undo changes to this file</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C-x v x</code></td>
<td>File</td>
<td>delete (X-out) this file via the VCS</td>
</tr>

<tr>
<td><code>M-x vc-rename-file</code></td>
<td> </td>
<td>rename a file</td>
</tr>

<tr>
<td><code>C-x v G</code></td>
<td> </td>
<td>ignore this file Glob</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C-x v I</code></td>
<td>Remote</td>
<td>describe (log) Incoming changes</td>
</tr>

<tr>
<td><code>C-x v +</code></td>
<td> </td>
<td>… pull (add) them in</td>
</tr>

<tr>
<td><code>C-x v O</code></td>
<td> </td>
<td>describe (log) Outgoing changes</td>
</tr>

<tr>
<td><code>C-x v P</code></td>
<td> </td>
<td>…. Push them out</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>C-x v r</code></td>
<td>Branch</td>
<td>checkout (Retrieve) a given branch</td>
</tr>

<tr>
<td><code>C-x v s</code></td>
<td> </td>
<td>tag this file</td>
</tr>

<tr>
<td><code>C-u C-x v s</code></td>
<td> </td>
<td>make current changeset a new branch</td>
</tr>

<tr>
<td><code>C-x v m</code></td>
<td> </td>
<td>merge in a given branch</td>
</tr>

<tr>
<td><code>C-x v M D</code></td>
<td> </td>
<td>show a diff of the common ancestor</td>
</tr>

<tr>
<td><code>C-x v M L</code></td>
<td> </td>
<td>show the log of the common ancestor</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org3012105">
<h4 id="org3012105">Initializing a Repository</h4>
<div id="text-org3012105">
<p>
When you’re beginning an entire new project, you need to choose which VCS you’re
going to use and create a new repository.  The first step is to create a new
project directory.  Just create your first project file in a non-existent
directory with <code>C-x C-f /new/directory/new-file</code>; as usual, Emacs will open a
Buffer visiting <code>new-file</code> and ask if it should create the directory
<code>/new/directory</code>—say yes, of course.  Now register the file with a simple <code>C-x v
v</code> (or if you’re feeling deliberate,     <code>C-x v i</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Registering"><code>vc-register</code></a>﻿),
which exists solely to register new files and repos).  Emacs will respond in the
<a href="#orga329460">Minibuffer</a> with:
</p>
<pre>/new/directory/new-file is not in a version controlled directory.
Use VC backend:
</pre>

<p>
and will offer all the supported backends for <a href="#org75fb6a2">Completion</a>: Bzr, Git, Hg, RCS, SCCS,
SRC, and SVN.  Choose the one you want and you now have a new repo.
</p>
</div>
</div>
<div id="outline-container-org8a434e8">
<h4 id="org8a434e8">Diffing and Comparing</h4>
<div id="text-org8a434e8">
<p>
It’s easy to compare the current file to the most recent checked-in version:
just do <code>C-x v ‍=</code> and you’ll get a colorized   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Diff-Mode"><code>diff-mode</code></a>﻿
Buffer; see <a href="#org4d9b857"><i>Diffing and Merging</i></a> for details.  <code>C-x v D</code> pops up a multi-file
Buffer with all the modified files in the project.  You can also diff the <a href="#org34ab2da">Region</a>
with <code>C-x v h</code> to avoid getting overwhelmed with detail.
</p>

<p>
The <code>diff-mode</code> Buffer features some 28-odd useful commands, but if you want
something fancier,   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Old-Revisions"><code>vc-ediff</code></a>﻿ shows the comparison via the
super-powerful <a href="#org4d9b857">Ediff</a> subsystem.  I rarely do this<sup><a id="fnr.341" href="#fn.341" role="doc-backlink">341</a></sup>; <code>diff-mode</code> itself is
pretty powerful.  Among the more useful commands are <code>C-c C-c</code> to jump from the
diff hunk at Point to its location in the file (visiting the file as needed),
and you can revert individual hunks in the file one-by-one; this is just a
<code>diff-mode</code> feature, so see <a href="#org90f0e6c"><i>Simple Diffing</i></a> for details.
</p>

<p>
All of these commands compare the saved files in the working directory with the
most recent checked-in versions.  With a <a href="#orgb0f6ffd">Prefix Arg</a>, you can specify any
previous version, identified however your VCS does it (revision numbers,
hexadecimal idents, tag names).  This can be more convenient to do from a VC log
Buffer.
</p>
</div>
</div>
<div id="outline-container-orga6d564c">
<h4 id="orga6d564c">Examining the Logs</h4>
<div id="text-orga6d564c">
<p>
Analogously to VC diffing, <code>C-x v l</code> shows the VCS log for the current file, and
<code>C-x v L</code> does the same for all the files in the project (the changesets).  There
are many handy commands to navigate and manipulate the log Buffer; be sure to do
    <code>C-h m</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Misc-Help"><code>describe-mode</code></a>﻿).  The one I use the most is <code>‍=</code>, which
generates a diff against the revision at Point.
</p>

<p>
<code>M-x vc-log-search</code> will search the text of log entries; this command is not
supported by all VCS’s.
</p>
</div>
</div>
<div id="outline-container-orgd34172d">
<h4 id="orgd34172d">Viewing Older Revisions</h4>
<div id="text-orgd34172d">
<p>
From a log Buffer you can pop up the complete text of the older version at Point
with     <code>f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>log-view-find-revision</code></a>﻿).  The text is popped up in a
new Buffer with a name in the form <code>FILENAME~VERSION~</code>.
</p>

<p>
Outside of the log Buffer, you can pop up a <code>FILENAME~VERSION~</code> buffer with <code>C-x v
~</code> (hence the mnemonic behind the key binding<sup><a id="fnr.342" href="#fn.342" role="doc-backlink">342</a></sup>), which prompts for a
version number, ident, or tag.
</p>

<p>
<code>C-x v g</code> annotates the file (or as I like to think of it, assigns blame).  It
pops up a buffer that shows, for each line of the file, who last changed it, the
revision id, and the date when it was changed.  Each line is colored via a heat-map
palette, with blue lines being the oldest and red the youngest.  From any given
line you can get a complete diff or jump to the location in the file; see Figure
<a href="#org11048bb">50</a>.
</p>

<div id="org11048bb">
<p><a href="https:./images/vc-blame.png" alt="Assigning Blame" title="Assigning Blame" width="100%"><img src="https://blog.veitheller.de/images/vc-blame.png" alt="Assigning Blame" title="Assigning Blame" width="100%"/></a>
</p>
<p><span>Figure 50: </span>Assigning Blame</p>
</div>
</div>
</div>

<div id="outline-container-orgadfffaa">
<h4 id="orgadfffaa">Discarding Changes</h4>
<p>
If you decide that all the changes you’ve made to your file, through whatever
number of saves, were a bad idea, you can revert the file to the most recent
checked-in version with <code>C-x v u</code>.  This is different from
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Reverting"><code>revert-buffer</code></a>﻿, which only reverts to the last saved version of
the file.  <code>C-x v u</code> actually replaces the file on disk with the checked-in
version, and <i>then</i> reverts the Buffer from it.
</p>
</div>
<div id="outline-container-org13f9126">
<h4 id="org13f9126">Other File Operations</h4>
<div id="text-org13f9126">
<p>
In addition to registering a new file, you can remove a file from version
control with <code>C-x v x</code>; this removes the file from the working directory and
informs the VCS of the fact that it’s no longer part of this changeset.  Of
course your VCS will allow you to recover older versions of the file at any time
in the future.
</p>

<p>
It’s also important to be able to tell the VCS to ignore certain files and not
consider them as part of the repo; this is typically done for build artifacts,
backup files, and the like (otherwise, your VCS will constantly be reminding you
to check these files in).  Unlike most of the other commands, <code>C-x v G</code> doesn’t
operate on the current file, but rather always prompts you for a filename or
glob pattern, and informs the VCS to ignore it from now on.  A Prefix argument
prompts for and removes a previously ignored pattern.
</p>
</div>
</div>
<div id="outline-container-orge3bc7de">
<h4 id="orge3bc7de">Tagging</h4>
<p>
You can tag the current checked-in version of your project with <code>C-x v s</code>.  To <i>tag</i>
means to give a symbolic name to a changeset.  You’ll be prompted for the name.
This command can also be used to create a new branch, as described next.
</p>
</div>
<div id="outline-container-orge88e7db">
<h4 id="orge88e7db">Branching and Merging</h4>
<div id="text-orge88e7db">
<p>
Modern VCS’s use <i>branches</i> to manage multiple independent lines of development
(your project might have a production branch, a development branch, and a bugfix
branch, say).  <i>Retrieving</i> a branch means replacing the files in your working
directory with those of a different branch.  You do this with <code>C-x v r</code>, which
prompts you for a branch label (what this is depends on your VCS; it can
typically be a version number or identifier, or a symbolic name).
</p>

<p>
You can’t retrieve any branches unless you’ve made some.  You can do this with
<code>C-u C-x v s</code>, which will make the current changeset a new branch of development.
If you want to branch off from an earlier changeset, first switch to that changeset
with <code>C-x v r</code>
</p>

<p>
Eventually, two branches will need to be <i>merged</i> together (say, to apply the code
from a tested bugfix branch into the production branch).  Merging is the most
complicated task a VCS can do, and VC’s <code>C-x v m</code> command just initiates the
process; you’ll have to handle overlap conflicts and the like manually,
undoubtedly with the help of the other VC commands we’ve discussed and the
various Emacs <a href="#org4d9b857">Diff</a> commands.  This includes <code>C-x v M D</code>, which shows a diff of the
common ancestor of the two branches being merged, and <code>C-x v M L</code>, which shows the
ancestor’s log.
</p>
</div>
</div>
<div id="outline-container-orgb0b4be3">
<h4 id="orgb0b4be3">Working With Remote Repositories</h4>
<div id="text-orgb0b4be3">
<p>
Modern distributed VCS’s (DVCS’s) have the potential to work with <i>remote</i> repos,
which may merely be in a different location in the file system but may also be
on a different host entirely.  You can check whether or not there are remote
changes to pull with <code>C-x v I</code>; if there are, a log Buffer pops up displaying
them.  <code>C-x v O</code> pops up a log of any outgoing changes.
</p>

<p>
If there are outgoing changes reported by <code>C-x v O</code>,  <code>C-x v P</code> will push them to
the remote, and if <code>C-x v I</code> reports incoming changes, <code>C-x v +</code> will pull them.<sup><a id="fnr.343" href="#fn.343" role="doc-backlink">343</a></sup>
</p>

<p>
But where is the remote?  Most DVCS’s record the current target for pushes and
pulls, and this is what will be used.  If a remote is not recorded, VC will
prompt you for the command to use.  A Prefix arg will always prompt for the
command.
</p>
</div>
</div>
<div id="outline-container-orge676bd4">
<h4 id="orge676bd4">VC Project Mode</h4>
<div id="text-orge676bd4">
<p>
Most of the VC File Mode commands we’ve discussed apply to the file visited in
the current Buffer (or to the file at Point in a Dired Buffer).  But sometimes
you want to perform VC actions on several or all of the files in your repository
at once.  This is the job of     <code>C-x v d</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/VC-Directory-Mode"><code>vc-dir</code></a>﻿).
</p>

<p>
This command pops up a special <code>*vc-dir*</code> Buffer for the directory you specify.
By default, this is the Buffer’s   <code>default-directory</code>.
Depending on your VCS, you may want to always work at the root directory of your
project; you can use     <code>C-x p v</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Project-File-Commands"><code>project-vc-dir</code></a>﻿) instead to make
sure you always invoke <code>vc-dir</code> in the root directory of your project.
</p>

<p>
When popped up, the <code>*vc-dir*</code> Buffer lists all the interesting files in the
repo—it’s like the <code>status</code> command of your VCS—that is, modified files,
unknown files (which you probably want to either add to the repo or ignore), and
those with a recently changed status.  In particular, files that are up-to-date
aren’t listed.
</p>

<p>
The Buffer has a header at the top that summarizes the state of the repo, and
then lists the files in a two-column form that might look like this:
</p>
<pre id="org58074f0">VC backend : Hg
Working dir: ~/txt/emacs-tutorial/
Parent     : 312:caa775acf936 tip
           :  VC: older revs, remotes
Branch     : default
Commit     : 2 modified, 2 unknown
Update     : (current)
Phases     : 5 draft

                         ./
    edited               TODO
    unregistered         cute-cat.jpg
    edited               emacs-tutorial.org
    unregistered         images/vc-blame.png
</pre>
<p>
The first column shows the VC status and the second, the file name.  You can see
that I’ve modified (“edited”) two files, and have two unknown (“unregistered”)
files.  <code>cute-cat.jpg</code> is probably an image file I accidentally saved to this
directory; I’ll want to eventually move it elsewhere with Dired, or I could
delete it from here with the <code>d</code> command<sup><a id="fnr.344" href="#fn.344" role="doc-backlink">344</a></sup>.  <code>images/vc-blame.png</code>, however,
is a new file that I want to add to this repo.
</p>

<p>
  <code>vc-dir-mode</code> has all the key bindings from <a href="#orgfa25f51">Special Mode</a>, a
number of commands for marking files, and a bunch of shorter keystrokes that are
equivalent to the <code>C-x v</code> File Mode commands.  You can use the <code>C-x v</code> File Mode key
bindings if you’re more used to them.  Table <a href="#org5e127d0">55</a> lists the key
commands (and their File Mode equivalents)<sup><a id="fnr.345" href="#fn.345" role="doc-backlink">345</a></sup>.  Typically you <i>mark</i> multiple
files (like you do in Dired for example) to form a <i>fileset</i>, and then use a
command to operate on the entire set.  Most of the commands apply to the entire
marked fileset, to the file at Point if no files are marked, or to all the files
in the <a href="#org34ab2da">Region</a> if it is Active.
</p>

<p>
As you’d expect, the mark command is <code>m</code> and the unmark command is <code>u</code>; marking a
directory line (including <code>./</code>) is equivalent to marking all the displayed files
in that directory.  <code>M</code> marks all the files with the same status, and <code>U</code> unmarks
them; with a Prefix arg, these two commands apply to all displayed files.
</p>
<table id="org5e127d0">
<caption><span>Table 55:</span> VC Dir Commands</caption>

<colgroup>
<col/>

<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col">Key</th>
<th scope="col">A.K.A</th>
<th scope="col">Category</th>
<th scope="col">Action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>m</code></td>
<td> </td>
<td>Marks</td>
<td>Mark this file (or all in active region)</td>
</tr>

<tr>
<td><code>M</code></td>
<td> </td>
<td> </td>
<td>Mark all files with this status</td>
</tr>

<tr>
<td><code>u</code></td>
<td> </td>
<td> </td>
<td>Unmark this file (or in active region)</td>
</tr>

<tr>
<td><code>U</code></td>
<td> </td>
<td> </td>
<td>Unmark all files with this status</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>v</code></td>
<td>C-x v v</td>
<td>Next</td>
<td>jack of all trades: DWIM</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>RET</code>, <code>e</code>, <code>f</code></td>
<td> </td>
<td>Visit</td>
<td>Find file(s) at point</td>
</tr>

<tr>
<td><code>o</code></td>
<td> </td>
<td> </td>
<td>… in Other window</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>S</code></td>
<td> </td>
<td>Search</td>
<td>Searches this file(s)</td>
</tr>

<tr>
<td><code>M-s a C-s</code></td>
<td> </td>
<td> </td>
<td>… isearch across them</td>
</tr>

<tr>
<td><code>M-s a C-M-s</code></td>
<td> </td>
<td> </td>
<td>… with a regexp</td>
</tr>

<tr>
<td><code>Q</code></td>
<td> </td>
<td>Replace</td>
<td>Query replace this file(s)</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>i</code></td>
<td><code>C-x v i</code></td>
<td>Init</td>
<td>add a file(s) to repo</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>=</code></td>
<td><code>C-x v ‍=</code></td>
<td>Diff</td>
<td>show diff of this file(s)</td>
</tr>

<tr>
<td><code>D</code></td>
<td><code>C-x v D</code></td>
<td> </td>
<td>… of all files</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>l</code></td>
<td><code>C-x v l</code></td>
<td>Log</td>
<td>show change Log of this file(s)</td>
</tr>

<tr>
<td><code>L</code></td>
<td><code>C-x v L</code></td>
<td> </td>
<td>… of all files</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>G</code></td>
<td> </td>
<td>Ignore</td>
<td>ignore this file(s)</td>
</tr>

<tr>
<td><code>d</code></td>
<td><code>C-x v x</code></td>
<td>Delete</td>
<td>Delete this file</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>I</code></td>
<td><code>C-x v I</code></td>
<td>Remote</td>
<td>describe (log) Incoming changes</td>
</tr>

<tr>
<td><code>+</code></td>
<td><code>C-x v +</code></td>
<td> </td>
<td>… pull them in</td>
</tr>

<tr>
<td><code>O</code></td>
<td><code>C-x v O</code></td>
<td> </td>
<td>describe (log) Outgoing changes</td>
</tr>

<tr>
<td><code>P</code></td>
<td><code>C-x v P</code></td>
<td> </td>
<td>… push them out</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>B s</code></td>
<td><code>C-x v r</code></td>
<td>Branch</td>
<td>checkout (Retrieve) a given branch</td>
</tr>

<tr>
<td><code>B c</code></td>
<td><code>C-x v s</code></td>
<td> </td>
<td>tag this file(s)</td>
</tr>

<tr>
<td><code>C-u B c</code></td>
<td><code>C-u C-x v s</code></td>
<td> </td>
<td>make Current changeset a new branch</td>
</tr>

<tr>
<td><code>B l</code></td>
<td> </td>
<td> </td>
<td>show Log for this branch</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>x</code></td>
<td> </td>
<td> </td>
<td>hide up-to-date and ignored files</td>
</tr>

<tr>
<td><code>C-c C-c</code></td>
<td> </td>
<td> </td>
<td>kill the running VCS command</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgbb69895">
<h4 id="orgbb69895">VC Grepping</h4>
<div id="text-orgbb69895">
<p>
You can <a href="#org3ffa52a">Isearch</a> and <a href="#orgb683e7c">Query Replace</a> from the <code>*vc-dir*</code> with the search and replace
commands in Table <a href="#org5e127d0">55</a>, but you can also invoke the <a href="#orgfdf7146">Grep</a> facility of your VCS.  VC
provides a command for Git (  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>vc-git-grep</code></a>﻿), but other VCS’s don’t
have this yet.  For Mercurial, I just do:
</p>
<pre>M-x grep RET hg grep -n REGEXP
</pre>

<p>
All the   <code>grep-mode</code> commands work, including <a href="#org8b8111c">Writable Grep</a>.
You can probably do something similar for another VCS.
</p>
</div>
</div>
</div>
<div id="outline-container-org44968da">
<h3 id="org44968da">Diffing and Merging <a id="orgf51c17d"></a></h3>
<div id="text-org44968da">
<p>
If you’re a programmer or system administrator, you probably spend a lot of time
comparing files, or as we call it, <i>diffing</i>.  Even non-programmers would benefit
from diffing, since anyone who creates and edits files ought to be using
<a href="#org53af7eb"><i>version control</i></a>, and version control implies diffing.
</p>

<p>
The basic Unix tool for diffing is <a href="https://en.wikipedia.org/wiki/Diff"><code>diff(1)</code></a> and its variants; the
<a href="https://www.gnu.org/software/emacs/manual/html_node/diffutils/Top">GNU implementations</a> are the standard.
</p>

<p>
Diffing is very simple: you run <code>diff(1)</code> on two files and eyeball the
output.  Emacs improves on this by providing excellent syntax highlighting and
colorization.  But diffing very often implies the need to <i>merge</i> the differences
to create a new, combined, file, and merging is <i>work</i>.  Emacs, in my opinion, has
the best merge tool: the Ediff subsystem.  I probably do at least one merge
every day—sometimes several—and when I’m occasionally forced to use some
other merge tool<sup><a id="fnr.346" href="#fn.346" role="doc-backlink">346</a></sup> I just want to crawl into a hole.
</p>
</div>
<div id="outline-container-orge0e739d">
<h4 id="orge0e739d">Simple Diffing <a id="org90f0e6c"></a></h4>
<div id="text-orge0e739d">
<p>
The simple Emacs front-end to <code>diff(1)</code> is   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Comparing-Files"><code>diff</code></a>﻿: it prompts for
two filenames, the <i>new</i> file and the <i>old</i><sup><a id="fnr.347" href="#fn.347" role="doc-backlink">347</a></sup>, and runs <code>diff(1)</code> on them.  It
pops up a Buffer named <code>*Diff*</code> with nicely colorized output.
</p>

<p>
There are three other main entry points to the Diff subsystem.
</p>

<p>
In a file-visiting Buffer,   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Comparing-Files"><code>diff-backup</code></a>﻿ diffs the file with its
<a href="#org0c51c8b">backup file</a>—this is way of answering the question, “what changes have I made
since the last time I saved it?”—while   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Comparing-Files"><code>diff-buffer-with-file</code></a>﻿
diffs the (possibly as yet unsaved) Buffer with its file on disk (I only
discovered this command recently and it’s very handy).  Finally,
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Comparing-Files"><code>diff-buffers</code></a>﻿ generates a diff of two Buffers, even if they
aren’t visiting files; this saves you from writing Buffers out to temporary
files, having to invent two file names and remember to clean them up afterwards.
</p>

<p>
Additionally, you can conveniently do a diff from <a href="#orgcc42ce0">Dired</a> with
    <code>=</code> (<code>dired-diff</code>), and from <a href="#org53af7eb">VC</a> with
    <code>C-x v =</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Old-Revisions"><code>vc-diff</code></a>﻿) and
    <code>C-x v D</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Old-Revisions"><code>vc-root-diff</code></a>﻿); various other Modes and Packages make
it easy to jump into Diff as well.
</p>
</div>
<div id="outline-container-org177cf11">
<h5 id="org177cf11">Diff Mode</h5>
<div id="text-org177cf11">
<p>
Let’s consider a file containing the text of Bertolt Brecht’s <i>Der Pflaumenbaum</i>:
</p>
<p>
Der Pflaumenbaum</p>
<p>
I copied the file and changed the text according to (my understanding of) the
<a href="https://en.wikipedia.org/wiki/German_orthography_reform_of_1996">German orthography reform of 1996</a>, and then I ran   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Comparing-Files"><code>diff</code></a>﻿ on the two
files; Figure <a href="#orgedaf18e">51</a> is the result.
</p>


<div id="orgedaf18e">
<p><a href="https:./images/simple-diff.png" alt="/Der Pflaumenbaum/ Diff" title="/Der Pflaumenbaum/ Diff" width="100%"><img src="https://blog.veitheller.de/images/simple-diff.png" alt="/Der Pflaumenbaum/ Diff" title="/Der Pflaumenbaum/ Diff" width="100%"/></a>
</p>
<p><span>Figure 51: </span><i>Der Pflaumenbaum</i> Diff</p>
</div>

<p>
Simple Diff Buffers are in   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Diff-Mode"><code>diff-mode</code></a>﻿, which does <i>a lot</i> more
than just colorful highlighting.  First let’s consider what a diff—also called
a <i>patch</i>— looks like.
</p>

<p>
A patch consists of a diff each for one or more pairs of files.  Each file pair
(here “file” for short) has a <i>file header</i> which is followed by the diff, which
consists of a set of <i>hunks</i>.
</p>

<p>
In Figure <a href="#orgedaf18e">51</a> the file header is this part:
</p>
<pre id="org2b16b08">diff -u /home/keith/txt/emacs-tutorial/brecht1 /home/keith/txt/emacs-tutorial/brecht2
--- /home/keith/txt/emacs-tutorial/brecht1	2022-07-05 18:43:44.497204554 -0500
+++ /home/keith/txt/emacs-tutorial/brecht2	2022-07-05 18:43:44.497204554 -0500
</pre>
<p>
File <code>brecht2</code> is the newer of the two files.  The header shows the exact <code>diff(1)</code>
command used and the files’ modification dates.  The <code>–––</code> and <code>+++</code> characters
relate the files to the lines of the <i>hunks</i>.
</p>

<p>
A <i>hunk</i> is a group of consecutive lines that differ between the pair of files;
the hunk always comes in the midst of a number of preceding and following lines
that the files have in common; these common lines provide useful context.<sup><a id="fnr.348" href="#fn.348" role="doc-backlink">348</a></sup>
</p>

<p>
In Figure <a href="#orgedaf18e">51</a> there’s only one hunk, which starts with:
</p>
<pre>@@ -4,8 +4,8 @@
</pre>

<p>
This means that the hunk consists of 8 lines starting at line 4 of the old file
(hence the <code>–</code>, as in the file header), and 8 lines starting at line 4 of the new file (the <code>+</code>).
</p>

<p>
In the hunk, lines beginning with <code>–</code> are only present in the <i>old</i> file, and lines
beginning with <code>+</code> are only present in the <i>new</i> file.  Lines beginning with spaces
are lines of context common to both files.
</p>

<p>
From the Diff Buffer, you can actually act on the hunks—undo them in the new
file one hunk at a time or apply them backwards to the old file.  But most of
these actions are easier to do via the very powerful Ediff subsystem.
</p>
</div>
</div>
</div>
<div id="outline-container-org8da4cf8">
<h4 id="org8da4cf8">Ediff <a id="org4d9b857"></a></h4>
<div id="text-org8da4cf8">
<p>
The biggest difference between the Ediff subsystem and the <a href="#org90f0e6c">simple Diff</a> commands
is that, instead of using a single Diff Buffer containing a patch as its
interface, Ediff presents multiple Buffers side-by-side, each containing a
colorized version of the old file or the new file.  Figure <a href="#orgad0f934">52</a> shows the
result of invoking   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/ediff/Major-Entry-Points"><code>ediff</code></a>﻿ <code>RET brecht1 RET brecht2</code>.
</p>

<div id="orgad0f934">
<p><a href="https:./images/ediff1.png" alt="/Der Pflaumenbaum/ Ediff" title="/Der Pflaumenbaum/ Ediff" width="100%"><img src="https://blog.veitheller.de/images/ediff1.png" alt="/Der Pflaumenbaum/ Ediff" title="/Der Pflaumenbaum/ Ediff" width="100%"/></a>
</p>
<p><span>Figure 52: </span><i>Der Pflaumenbaum</i> Ediff</p>
</div>

<p>
Ediff is much more intuitive.  There’s no need to interpret the syntax of the
output of <code>diff(1)</code>: the left window shows the file <code>brecht1</code> and the right,
<code>brecht2</code>, nicely colorized.  The reddish colors show the old hunks, and the
greenish the new.
</p>

<p>
There’s also a third window in this <a href="#org4dd50c2">Frame</a>, displaying a 1-line <code>*Ediff
Control Panel*</code> Buffer.  When you start up Ediff, this will be the
<a href="#org9409b46">selected Window</a>; the Buffer is in   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>ediff-mode</code></a>﻿ and
is typically where you issue commands to operate on the two file
Buffers.  If you type <code>?</code> in this Buffer, it will expand to show an
explanatory menu of Ediff commands that are valid in this Buffer
(only).  Each file Buffer will be in the <a href="#org5b21ef0">Major Mode</a> appropriate to the
file and you can in fact switch to either of the Buffers and edit
them.
</p>

<p>
When Ediffing two files it’s very common to want to copy bits of one file to the
other.  Suppose you’ve got the same file on two different machines; you may have
made changes to both the remote file and the local copy, but not exactly the
same changes: you’ve let the two files get out of sync!  Ediff makes it easy,
with a keystroke, to copy one diff from file A to file B, another from B to A,
and you can jump between the two file Buffers and make any editing tweaks you
like.  This is a simple way of merging two files.
</p>
</div>
<div id="outline-container-org4f3c879">
<h5 id="org4f3c879">Personal Preferences</h5>
<div id="text-org4f3c879">
<p>
I should mention that Figure <a href="#orgad0f934">52</a> isn’t what you’ll see out of the box if you
invoke   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/ediff/Major-Entry-Points"><code>ediff</code></a>﻿.  By default, the Control Panel will open in its
own dedicated Frame.  I absolutely hate this, and it’s frankly unusable with a
<a href="https://en.wikipedia.org/wiki/Tiling_window_manager">tiling window manager</a> like mine, so I configure it to open all Ediff windows in
the current Frame.
</p>

<p>
Also by default, the two file Windows are shown one above the other; I much
prefer them side-by-side as in Figure <a href="#orgad0f934">52</a>: as you move from diff to diff,
Ediff keeps them neatly aligned and it’s easier to visually compare them.
</p>

<p>
This <a href="#org2af3730">Init File</a> snippet imposes my preferences on you:
</p>
<div>
<pre><span>;; </span><span>don&#39;t use a separate Frame for the control panel</span>
(<span>setq</span> ediff-window-setup-function &#39;ediff-setup-windows-plain)
<span>;; </span><span>horizontal split is more readable</span>
(<span>setq</span> ediff-split-window-function &#39;split-window-horizontally)
</pre>
</div>

<p>
Ediff also radically changes your current <a href="#orgb729f11">Window Configuration</a>; when I quit Ediff, I
like to restore my windows to what they were before, with this code snippet:
</p>
<div>
<pre><span>;; </span><span>restore window config upon quitting ediff</span>
(<span>defvar</span> <span>ue-ediff-window-config</span> nil <span>&#34;Window config before ediffing.&#34;</span>)
(add-hook &#39;ediff-before-setup-hook
          (<span>lambda</span> ()
            (<span>setq</span> ue-ediff-window-config (current-window-configuration))))
(<span>dolist</span> (hook &#39;(ediff-suspend-hook ediff-quit-hook))
  (add-hook hook
            (<span>lambda</span> ()
              (set-window-configuration ue-ediff-window-config))))
</pre>
</div>

<p>
Finally, Ediff will often newly visit one or two files for the purpose of diffing,
which clutters up your Emacs.  I enable the Ediff Janitor, which will offer to
cleanup these files for you when you quit.
</p>
<div>
<pre><span>;; </span><span>offer to clean up files from ediff sessions</span>
(add-hook &#39;ediff-cleanup-hook (<span>lambda</span> () (ediff-janitor t nil)))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf07620e">
<h5 id="orgf07620e">Ediff Entry Points</h5>
<div id="text-orgf07620e">
<p>
Ediff has a dozen useful entry points, listed in Table <a href="#org0d504fb">56</a>.
</p>

<table id="org0d504fb">
<caption><span>Table 56:</span> Ediff Entry Points</caption>

<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col"><code>M-x ediff-files</code></th>
<th scope="col">Files</th>
<th scope="col">diff two files</th>
</tr>

<tr>
<th scope="col"><code>M-x ediff</code></th>
<th scope="col"> </th>
<th scope="col">… the same</th>
</tr>

<tr>
<th scope="col"><code>M-x ediff-files3</code></th>
<th scope="col"> </th>
<th scope="col">diff three files</th>
</tr>

<tr>
<th scope="col"><code>M-x ediff3</code></th>
<th scope="col"> </th>
<th scope="col">… the same</th>
</tr>

<tr>
<th scope="col"><code>M-x ediff-backup</code></th>
<th scope="col"> </th>
<th scope="col">diff this file with its backup file</th>
</tr>

<tr>
<th scope="col"><code>M-x ediff-current-file</code></th>
<th scope="col"> </th>
<th scope="col">diff this buffer with its file on disk</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>M-x ediff-buffers</code></td>
<td>Buffers</td>
<td>diff two Buffers</td>
</tr>

<tr>
<td><code>M-x ediff-buffers3</code></td>
<td> </td>
<td>diff three Buffers</td>
</tr>

<tr>
<td><code>M-x ediff-regions-linewise</code></td>
<td> </td>
<td>diff two Regions in 1 or 2 Buffers</td>
</tr>

<tr>
<td><code>M-x ediff-regions-wordwise</code></td>
<td> </td>
<td>… but word-by-word</td>
</tr>

<tr>
<td><code>M-x ediff-revision</code></td>
<td> </td>
<td>diff this Buffer with an older revision</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>M-x ediff-windows-linewise</code></td>
<td>Windows</td>
<td>diff two Windows line-by-line</td>
</tr>

<tr>
<td><code>M-x ediff-windows-wordwise</code></td>
<td> </td>
<td>… word-by-word</td>
</tr>
</tbody>
</table>
<p>
You can diff files, Buffers, Windows, distinct Regions of Buffers and Windows,
and directories (see <a href="#orgba333df">below</a>); you can also diff files and Buffers in terms of
their <a href="#org53af7eb">Version Control</a> revisions.  Ediff can compare two files, or three.  The
common use case for a three-file comparison is when two files share a common
ancestor.  This occurs frequently when you have a new branch of a project under
<a href="#org53af7eb">version control</a>—say, a bugfix branch—and you need to compare the file where
you’re fixing the bug with the original buggy version: both files will have a
common ancestor in their parent revision, and adding this ancestor to the
comparison allows Ediff to make very accurate guesses and predictions when
you’re <a href="#org56c767a">merging</a>.
</p>

<p>
Ediff can compare the contents of Buffers, whether the Buffers are visiting
files or not, and it can even compare two <a href="#org34ab2da">Regions</a>, whether in the same Buffer or
not.  Doing this sort of thing in the shell usually requires creating (and
cleaning up) temporary files; Ediff takes care of that for you.
</p>

<p>
Ediff can also compare Windows; this is sort of a shortcut for comparing Regions
of Buffers, and it’s also an easy way of comparing two parts of the same Buffer:
just split the Buffer into two Windows, and line up the parts you want to
compare at the tops of the two Windows.  When comparing Windows, you can compare
<i>wordwise</i> (which is nice and detailed) or <i>linewise</i> (which is more like a normal
diff).
</p>

<p>
Finally, Ediff can compare entire directories, and has powerful bookkeeping
features to help you keep track of where you are in the comparison; see <a href="#orgba333df">below</a>.
</p>
</div>
</div>
<div id="outline-container-org8c21c4d">
<h5 id="org8c21c4d">The Expanded <code>*Ediff Control Panel*</code></h5>
<div id="text-org8c21c4d">
<pre id="org81fd574">    Move around      |      Toggle features      |        Manipulate
=====================|===========================|=============================
p,DEL -previous diff |     | -vert/horiz split   |a/b -copy A/B&#39;s region to B/A
n,SPC -next diff     |     h -highlighting       | rx -restore buf X&#39;s old diff
    j -jump to diff  |     @ -auto-refinement    |  * -refine current region
   gx -goto X&#39;s point|    ## -ignore whitespace  |  ! -update diff regions
  C-l -recenter      |    #c -ignore case        |
  v/V -scroll up/dn  | #f/#h -focus/hide regions | wx -save buf X
  &lt;/&gt; -scroll lt/rt  |     X -read-only in buf X | wd -save diff output
    ~ -swap variants |     m -wide display       |
=====================|===========================|=============================
    R -show registry |     = -compare regions    |  M   -show session group
    D -diff output   |     E -browse Ediff manual|  G   -send bug report
    i -status info   |     ? -help off           |  z/q -suspend/quit
-------------------------------------------------------------------------------
For help on a specific command:  Click Button 2 over it; or
                                 Put the cursor over it and type RET.
</pre>
<p>
Whatever your Ediff entry point, everything is controlled from the <code>*Ediff
Control Panel*</code>.  Do as the one-line Panel Window suggests and hit <code>?</code> to
expand it.  Wherever the Panel refers to “X”, it means for you to type the
letter <code>A</code>, <code>B</code>, or <code>C</code> to specify one of the Buffers being compared.
</p>

<p>
Most of the “Move around” commands are obvious: you step back and forth through
the files, diff by diff, or jump to a diff by its number (shown in the Control
Panel’s <a href="#org6456ffd">Mode Line</a>.  You can scroll the file Windows pairwise, or bring the
current diff back to the center.  The     <code>~</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>ediff-swap-buffers</code></a>﻿)
command swaps the two files in the two Windows, so you can have the old file on
the left (where I expect it) or on the right.
</p>

<p>
The commands in the “Toggle features” section change the appearance of the files
or of the Windows.  The   <code>|</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>ediff-toggle-split</code></a>﻿) command
toggles the Windows between side-by-side (the default with my Init File) or
one-over-the-other, and     <code>m</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>ediff-toggle-wide-display</code></a>﻿)
full-screens the Ediff Frame.      <code>h</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>ediff-toggle-hilit</code></a>﻿) and
  <code>@</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>ediff-toggle-autorefine</code></a>﻿) cycle through a variety of
different ways to display the highlighting and refinement of the different words in
the diffs.     <code># #</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>ediff-toggle-skip-similar</code></a>﻿) and
    <code># c</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>ediff-toggle-ignore-case</code></a>﻿) toggle between ignoring
whitespace or case differences.  The
    <code># f</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>ediff-toggle-regexp-match</code></a>﻿) lets you <i>focus</i> on only the
diffs that match a <a href="#org19c6ad0">Regular Expression</a> (temporarily hiding the diffs that don’t),
and <code># h</code> is the inverse.  The letters <code>A</code>, <code>B</code>, and <code>C</code> toggle the read-only status of
the corresponding file Buffers.
</p>

<p>
The “Manipulate” section has the crucial commands for choosing and copying
individual diffs.  Lowercase <code>a</code> and <code>b</code> copy the current diff to the other file.
So in Figure <a href="#orgad0f934">52</a> typing <code>a</code> would cause file A’s diff number 1—with the
umlauts—to replace file B’s orthographic reform version.  Upon changing your
mind, you could then restore file B’s diff with the command <code>r b</code>.  Conversely,
typing <code>b</code> would replace file A’s umlauts with B’s umlaut-free version.
</p>

<p>
At any point, you can edit either file A or file B, so after copying a diff from
the other file, you can tweak it.  Invoking
    <code>*</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>ediff-make-or-kill-fine-diffs</code></a>﻿) (from the Control Panel
Buffer) will recompute the refinement colors of the current diff after
an edit, if necessary,
and   <code>!</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>ediff-update-diffs</code></a>﻿) will recompute all the diffs in
both files, just as if you had quit and re-invoked your Ediff command.
</p>

<p>
Sometimes a single diff can be quite large and you only want to copy bits of it
from one file to the other; in this case the <code>a</code> or <code>b</code> commands would require you
to do a bunch of manual editing after the copy.  When this happens, the
    <code>=</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>ediff-inferior-compare-regions</code></a>﻿) command can help.  It
invokes a new, recursive, Ediff session on just the text of the current diff,
within which you can copy the individual smaller differences using <code>a</code> and <code>b</code>
commands.  When you’re done, quit this recursive Ediff with <code>q</code>, and you’re back
in the parent Ediff, ready to continue.
</p>
</div>
</div>
</div>
<div id="outline-container-org8e44690">
<h4 id="org8e44690">Merging <a id="org56c767a"></a></h4>
<div id="text-org8e44690">

<div id="org76cebcd">
<p><a href="https:./images/emerge1.png" alt="/Der Pflaumenbaum/ Ediff Merge" title="/Der Pflaumenbaum/ Ediff Merge" width="100%"><img src="https://blog.veitheller.de/images/emerge1.png" alt="/Der Pflaumenbaum/ Ediff Merge" title="/Der Pflaumenbaum/ Ediff Merge" width="100%"/></a>
</p>
<p><span>Figure 53: </span><i>Der Pflaumenbaum</i> Ediff Merge</p>
</div>

<p>
Your version control system will frequently need you to manually merge two
conflicting files (typically from two branches); so will file synchronizers,
like <a href="https://en.wikipedia.org/wiki/Syncthing">Syncthing</a> and <a href="https://en.wikipedia.org/wiki/Unison_(software)">Unison</a><sup><a id="fnr.349" href="#fn.349" role="doc-backlink">349</a></sup> and some operating system package managers<sup><a id="fnr.350" href="#fn.350" role="doc-backlink">350</a></sup>.
The family of Ediff Merge commands is the way to perform these tasks.
</p>

<p>
In Figure <a href="#org76cebcd">53</a>, I’ve invoked:
</p>
<pre>M-x ediff-merge RET brecht1 RET brecht2
</pre>

<p>
It looks like the   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/ediff/Major-Entry-Points"><code>ediff</code></a>﻿ command of Figure <a href="#orgad0f934">52</a> but with an
extra window, called C, which is the result of the merge.  In this example,
Ediff has no way of guessing whether you’d prefer variant A or variant B so it
shows you both possibilities in Buffer C.  If you prefer one or the other, just
use the <code>a</code> or <code>b</code> commands.  With   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/ediff/Major-Entry-Points"><code>ediff</code></a>﻿, those commands update
either the A or B buffer, but with   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/ediff/Major-Entry-Points"><code>ediff-merge</code></a>﻿. they update the
C Buffer.
</p>

<p>
In the simplest case, you can just step through all the diffs between the two
files, choosing one from A or one from B in each case.  When you’re done, you
quit with     <code>q</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>ediff-quit</code></a>﻿) and then you can switch to the C
Buffer—your merge—and save it to a file.
</p>

<p>
Note that if you use neither the <code>a</code> nor the <code>b</code> command for a given diff, the
result of the merge will be the literal text you see in Buffer C, in our example:
</p>
<pre id="org38d832e">&lt;&lt;&lt;&lt;&lt;&lt;&lt; variant A
Der Kleine kann nicht größer wer&#39;n,
Ja - größer wer&#39;n, das möcht&#39; er gern!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; variant B
Der Kleine kann nicht groesser wer&#39;n,
Ja - groesser wer&#39;n, das moecht&#39; er gern!
======= end
</pre>
<p>
with the <code>&lt;‌&lt;‌&lt;‌&lt;</code> and <code>&gt;‌&gt;‌&gt;‌&gt;</code> characters and all the rest.  You can jump into Buffer C
to delete any of these bits, or mix and match the two variants however you like
(perhaps you want to keep the “größer”’s but use the “moecht” with them).
</p>

<p>
When you finish the merge with     <code>q</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>ediff-quit</code></a>﻿), Buffer C,
actually called <code>*ediff-merge*</code>, is the result of your merge: you generally want
to save it to a file with     <code>C-x C-w</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Save-Commands"><code>write-file</code></a>﻿).
</p>

<p>
If you expand the <code>*Ediff Control Panel*</code> you’ll see that there are a few extra
commands to help with merging.
</p>
</div>
<div id="outline-container-org9908281">
<h5 id="org9908281">Ediff Merge Entry Points</h5>
<div id="text-org9908281">
<p>
There are several entry points to the Merge subsystem; most are analogous to the
Ediff entry points.  But take special note of the <code>-with-ancestors</code> variants.
When the two files you’re merging are related to a common ancestor (typical
with version control system merges), you can use these variants and Ediff will
be able make educated guesses about which variant, A or B, to prefer.
</p>
<table id="org5d89ec8">
<caption><span>Table 57:</span> Ediff Merge Entry Points</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col"><code>M-x ediff-merge</code></th>
<th scope="col">merge two files</th>
</tr>

<tr>
<th scope="col"><code>M-x ediff-merge-files</code></th>
<th scope="col">… the same</th>
</tr>

<tr>
<th scope="col"><code>M-x ediff-merge-files-with-ancestor</code></th>
<th scope="col">… taking an ancestor into account</th>
</tr>

<tr>
<th scope="col"><code>M-x ediff-merge-with-ancestor</code></th>
<th scope="col">… the same</th>
</tr>

<tr>
<th scope="col"><code>M-x ediff-merge-revisions</code></th>
<th scope="col">merge this file with an older revision</th>
</tr>

<tr>
<th scope="col"><code>M-x ediff-merge-revisions-with-ancestor</code></th>
<th scope="col">… taking an ancestor into account</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>M-x ediff-merge-buffers</code></td>
<td>merge two buffers</td>
</tr>

<tr>
<td><code>M-x ediff-merge-buffers-with-ancestor</code></td>
<td>… taking an ancestor into account</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org1fb2e9a">
<h4 id="org1fb2e9a">Integrating Ediff into External Programs</h4>
<div id="text-org1fb2e9a">
<p>
Version Control Systems and such often have a configuration file in which you can
specify your <i>merge tool</i>.  You can set this to be Emacs running <code>ediff-merge</code> or,
better, <code>ediff-merge-files-with-ancestor</code>.  Here are two examples of how I do
this.
</p>

<p>
First, for my version control system, <a href="https://en.wikipedia.org/wiki/Mercurial">Mercurial</a>, I have this stanza in my config
file:
</p>
<pre id="orgb7b535a">[merge-tools]
emacs.executable = emacs
emacs.args = --no-desktop --eval &#39;(ediff-merge-files-with-ancestor &#34;$local&#34; &#34;$other&#34; &#34;$base&#34; nil &#34;$output&#34;)&#39;
</pre>
<p>
The magic strings <code>$local</code>, <code>$other</code>, <code>$base</code>, and <code>$output</code> are replaced by Mercurial
with appropriate file names when it invokes Emacs.  See <a href="#org0a69d0d"><i>Starting Emacs!</i></a> for
information about <code>--eval</code>.
</p>

<p>
I use <a href="https://en.wikipedia.org/wiki/Unison_(software)">Unison</a> as one of my file synchronizers, and this line in its preferences
file does the job:
</p>
<pre>merge = Name * -&gt; emacs --no-desktop --eval &#39;(ediff-merge-files &#34;CURRENT1&#34; &#34;CURRENT2&#34; nil &#34;NEW&#34;)&#39;
</pre>

<p>
Here the magic filenames are <code>CURRENT1</code>, <code>CURRENT2</code>, and <code>NEW</code>.  Note that Unison
doesn’t provide an ancestor file when it invokes the merge tool, so I use a
different Emacs function.
</p>

<p>
Also note that I invoke <code>emacs</code> here, with <a href="#org0a69d0d"><code>--no-desktop</code></a>, rather than <code>emacsclient</code>.  I
used to use <code>emacsclient</code> for a quicker startup but I found it to be too confusing
in the already confusing context of file merging—I prefer a totally clean,
empty Emacs!  You could invoke <code>emacs</code> with <code>-q</code> instead, which will skip loading
your <a href="#org2af3730">Init File</a> and get a very fast startup, as long as you can cope with an
uncustomized Emacs.  (My Emacs is so heavily customized that I can barely use an
Emacs invoked with <code>-q</code>, but YMMV.)
</p>
</div>
</div>
<div id="outline-container-org6d1d1cb">
<h4 id="org6d1d1cb">Comparing and Merging Directories <a id="orgba333df"></a></h4>
<div id="text-org6d1d1cb">
<p>
You can also Ediff two directories, comparing all pairs of files that have the
same basename.  You could of course just manually run
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/ediff/Major-Entry-Points"><code>ediff-files</code></a>﻿ on every pair of files yourself, but it would be
easy to miss a pair, or forget where you left off after a break.  The Ediff
Directories subsystem does all the bookkeeping for you.
</p>

<p>
When you fire up   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/ediff/Major-Entry-Points"><code>ediff-directories</code></a>﻿, you’ll be asked if you want
to narrow the files to be considered via a <a href="#org19c6ad0">Regular Expression</a>; just hit <code>RET</code> if
you want to consider all possible files.
</p>

<p>
You’ll be presented with a Buffer called <code>*Ediff Session Group Panel*</code> which lists
all the pairs of corresponding files; each pair is called a <i>session</i> because
you’ll (potentially) be doing a complete diff or merge on it.  <code>?</code> expands a helpful menu
of Session Group commands (see Table <a href="#org1dc19b9">58</a>).
</p>
<table id="org1dc19b9">
<caption><span>Table 58:</span> Ediff Session Group Commands</caption>

<colgroup>
<col/>

<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col"><code>D</code></th>
<th scope="col">Prep</th>
<th scope="col">show differences among directories</th>
</tr>

<tr>
<th scope="col">​<code>= =</code></th>
<th scope="col"> </th>
<th scope="col">for each session, show which files are identical</th>
</tr>

<tr>
<th scope="col"><code>= h</code></th>
<th scope="col"> </th>
<th scope="col">like =​=, but also marks sessions for hiding</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>h</code></td>
<td>Hiding</td>
<td>mark session for hiding (toggle)</td>
</tr>

<tr>
<td><code>x</code></td>
<td> </td>
<td>hide marked sessions</td>
</tr>

<tr>
<td><code>C-u x</code></td>
<td> </td>
<td>unhide marked sessions</td>
</tr>

<tr>
<td><code>u h</code></td>
<td> </td>
<td>unmark all sessions marked for hiding</td>
</tr>

<tr>
<td><code>= h</code></td>
<td> </td>
<td>like =​=, but also marks sessions for hiding</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>RET</code></td>
<td>Session</td>
<td>start Ediff session at Point</td>
</tr>

<tr>
<td><code>v</code></td>
<td> </td>
<td>… the same</td>
</tr>

<tr>
<td><code>q</code></td>
<td> </td>
<td>quit this session group</td>
</tr>
</tbody>
<tbody>
<tr>
<td><code>m</code></td>
<td>Marking</td>
<td>mark session for a non-hiding operation (toggle)</td>
</tr>

<tr>
<td><code>u m</code></td>
<td> </td>
<td>unmark all sessions marked for operation</td>
</tr>

<tr>
<td><code>= m</code></td>
<td> </td>
<td>like =​= =​=, but also marks sessions for operation</td>
</tr>

<tr>
<td><code>P</code></td>
<td> </td>
<td>collect custom diffs of all marked sessions</td>
</tr>
</tbody>
</table>

<p>
You generally want to start by preparing your Session Group.
    <code>D</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>ediff-show-dir-diffs</code></a>﻿) pops up a new Buffer that shows you
the remaining files in the two directories that <i>don’t</i> have corresponding
names.  You might want to copy any one of them to the other directory, which you
can do with a simple <code>C</code> command in this Buffer.
</p>

<p>
We now want to <i>hide</i>, i.e. exclude from diffing, as many files as possible.
</p>

<p>
You should run     <code>=​ h</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>ediff-meta-mark-equal-files</code></a>﻿), which will
do a quick comparison of the pairs of files in all the sessions, and mark, for
hiding, the ones that are identical (why waste time running Ediff on these
pairs?).
</p>

<p>
You should now mark for hiding any non-identical pairs that you’re just not
interested in.  A good example would be a version control subdirectory (like a
<code>.git</code> or <code>.hg</code> directory).  Just navigate to these pairs and hit
    <code>h</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>ediff-mark-for-hiding-at-pos</code></a>﻿).
</p>

<p>
Now hide all those pairs with     <code>x</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>ediff-hide-marked-sessions</code></a>﻿),
and you’re ready to start Ediffing.  Just navigate to each pair in turn and hit
<code>RET</code> to fire up a normal Ediff session.  When you’re done (having quit the diff
session with <code>q</code>), you’ll be taken back
to the Session Group and that Session will be marked as finished.
</p>

<p>
<a id="org2fcb341"></a>
You can also mark pairs with the Mark commands and then run
    <code>P</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Glossary"><code>ediff-collect-custom-diffs</code></a>﻿) to get a <a href="#org90f0e6c">simple Diff</a> Buffer
giving you an overview of the differences amongst all the marked files.  This is
also a handy way of generating a <a href="#orgdc3d708">patch</a>.
</p>

<p>
If your selected pairs include any directories, they will be diffed recursively,
creating their own Session Groups.
</p>

<p>
The bookkeeping done by the Session Groups is invaluable for managing an
otherwise tedious and annoying task.  You can easily take a break from diffing
and rejoin your sessions again later; just run
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/ediff/Other-Session-Commands"><code>ediff-show-registry</code></a>﻿.  The Ediff Registry shows you all Ediff
sessions you have running.  Sadly however, Ediff sessions aren’t preserved if
you quit your Emacs (not even if you’re using <a href="#orgf2e3965">Desktop Mode</a>).
</p>

<p>
There are several other entry points, which determine which Ediff command is
used on each pair of files.
</p>
<table id="orgeed1a51">
<caption><span>Table 59:</span> Ediff Directories Entry Points</caption>

<colgroup>
<col/>

<col/>
</colgroup>
<thead>
<tr>
<th scope="col"><code>M-x ediff-directories</code></th>
<th scope="col">diff common files in two directories</th>
</tr>

<tr>
<th scope="col"><code>M-x ediff-directories3</code></th>
<th scope="col">diff common files in three directories</th>
</tr>

<tr>
<th scope="col"><code>M-x ediff-directory-revisions</code></th>
<th scope="col">… only files under version control</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>M-x ediff-merge-directories</code></td>
<td>merge common files in two directories</td>
</tr>

<tr>
<td><code>M-x ediff-merge-directories-with-ancestor</code></td>
<td>… using ancestors from a third directory</td>
</tr>

<tr>
<td><code>M-x ediff-merge-directory-revisions</code></td>
<td>merge common files in two directories</td>
</tr>

<tr>
<td><code>M-x ediff-merge-directory-revisions-with-ancestor</code></td>
<td>… with ancestors</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org0256054">
<h4 id="org0256054">Patching <a id="orgdc3d708"></a></h4>
<div id="text-org0256054">
<p>
In addition to merging, there’s also <i>patching</i>.  Suppose Amy and Bridget each
have a copy of the file <code>foo</code>.  Amy makes some changes to <code>foo</code> that Bridget wants,
and instead of giving Bridget the changed file, Amy gives Bridget a diff<sup><a id="fnr.351" href="#fn.351" role="doc-backlink">351</a></sup> of
Amy’s old <code>foo</code> against her new <code>foo</code>.  In this context, the diff output is called a
<a href="https://en.wikipedia.org/wiki/Patch_(computing)"><i>patch</i></a>, and Bridget wants to <i>apply</i> the patch to her own <code>foo</code> in order to
transform it into Amy’s new version.
</p>

<p>
This may sound crazy—why doesn’t Amy just give Bridget the new <code>foo</code>?  But this
actually does happen fairly frequently, especially when Amy and Bridget are
programmers working on a program together, or system administrators dealing with
a security patch that needs to be quickly applied.  Bridget may have made her
own changes to <code>foo</code> which she wants to keep; applying Amy’s patch preserves
Bridget’s changes while applying Amy’s (unless there are line by line conflicts).
</p>

<p>
A single patch often contains diffs of several files and all should be applied
at once.  Applying patches used to be a lot of work until <a href="https://en.wikipedia.org/wiki/Larry_Wall">Larry Wall</a> wrote
<a href="https://en.wikipedia.org/wiki/Patch_(Unix)"><code>patch(1)</code></a>.  Ediff has a helpful interface to <code>patch(1)</code>.
</p>

<p>
Either of   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/ediff/Major-Entry-Points"><code>ediff-patch-file</code></a>﻿ or   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/ediff/Major-Entry-Points"><code>ediff-patch-buffer</code></a>﻿
will run <code>patch(1)</code> and then pop up an Ediff showing you the changes that have
been applied<sup><a id="fnr.352" href="#fn.352" role="doc-backlink">352</a></sup>.  You can approve the changes or make any necessary tweaks.
</p>

<p>
Emacs also makes it easy to <i>generate</i> a patch for one file.  You can do it from
<a href="#orgcc42ce0">Dired</a>: just mark the pair of files you want to be in the patch and say
  <code>!</code> (<code>dired-do-shell-command</code>) with the command <code>diff -u *</code> and
then save the <code>*Shell Command Output*</code> Buffer to a file (or email it directly from
Emacs).  The easiest way to generate a patch containing multiple files is from
the <code>ediff-directories</code> <a href="#org2fcb341">Session Group Buffer</a>.
</p>
</div>
</div>
<div id="outline-container-org6c3f023">
<h4 id="org6c3f023">Emerge</h4>
<p>
Emacs has another, older, subsystem for merging files called
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Emerge">Emerge</a>.  All the Emerge commands begin
with <code>emerge-</code>; don’t confuse the two.  Personally I think the Ediff Merge
subsystem is far superior, and I haven’t used Emerge in years, but it <i>is</i> a
powerful system in its own right.  YMMV.
</p>
</div>
<div id="outline-container-org36918d1">
<h4 id="org36918d1">Simple Window Comparison</h4>
<div id="text-org36918d1">
<p>
You can also do a simple comparison of two windows with
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Comparing-Files"><code>compare-windows</code></a>﻿.  Arrange your Frame so it’s only displaying the
two Windows you want to compare.  In each Window, set Point at the beginning of
the part of the text you want to compare (perhaps just do
    <code>M-&lt;</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Moving-Point"><code>beginning-of-buffer</code></a>﻿) in each).  Now invoke
<code>compare-windows</code>.
</p>

<p>
Point in each Window will be moved to the first spot in each Window where the
two Buffers differ.  Reinvoking <code>compare-windows</code> jumps to the next difference.  In
between invocations you can make any changes you like in either Window.
</p>

<p>
With a prefix argument, <code>compare-windows</code> will ignore differences in whitespace.
</p>

<p>
In writing this description I discovered that this apparently simple command is
really quite complex and powerful; see   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-group</code></a>﻿
<code>compare-windows</code>.
</p>
</div>
</div>

</div>

<div id="outline-container-org4f4168c">
<h3 id="org4f4168c"><a id="orgcbc7d14"></a> Playing Music</h3>
<div id="text-org4f4168c">
<p>
Another application domain for Emacs is as a music player.  This mostly means
playing from a collection of audio files (mp3s, flacs, oggs).  Nowadays most
people use commercial streaming services (Spotify, Bandcamp, YouTube, Amazon, etc) to play
music and may well own neither any audio files nor even physical CDs or vinyl;
while there are a few Emacs interfaces to such services, the very idea goes
against the grain of the Emacs predilection for free and open file formats and
protocols.  If you own your own data, no corporate entity can take it from you,
start charging you (more) money, or just vanish in a corporate bankruptcy.
</p>

<p>
Audio data is complex and multifarious, and I know of no Emacs packages that
manipulate the data directly in Elisp.<sup><a id="fnr.353" href="#fn.353" role="doc-backlink">353</a></sup>  That means that Emacs music players are
generally interfaces to external programs that you’ll need to install via your
operating system’s package manager.
</p>
</div>
<div id="outline-container-org7eb90fa">
<h4 id="org7eb90fa"><a id="org7fd78c3"></a> EMMS: Emacs Multimedia System</h4>
<div id="text-org7eb90fa">
<p>
My preferred music player is <a href="https://www.gnu.org/software/emacs/manual/html_node/emms/Top">EMMS</a>, the
Emacs Multimedia System.  It has a
4,097-line <a href="#orga6bbd55">Info</a> manual, will work with
almost any audio players you happen to have installed, and is
perhaps the most Emacs-native of all the music players I’ve tried: that is, it’s
well-integrated with other Emacs systems, lets you manage its buffers and
windows however you like (rather than requiring a bespoke multi-paned layout),
is massively customizable, and everything about it is plain text.
</p>

<p>
First you need to use your operating system’s package manager to install at
least one audio player.  I recommend just installing <a href="http://www.mplayerhq.hu/"><code>mplayer</code></a>, since it plays
some 200-odd audio formats.  (But see below for <a href="#org605e809">MPD</a>.)
</p>

<p>
Next, you need to install EMMS itself via the Emacs package manager.  Just give
this command once:
</p>
<pre>M-x package-install RET emms RET
</pre>

<p>
(See <a href="#orgc96889a"><i>The Package Manager</i></a> for more information, including updating your packages.)
</p>

<p>
Now you need to configure EMMS in your <a href="#org2af3730">Init File</a>.  You can read the disquisition
in the manual, but here’s a configuration I used before switching to MPD:
</p>
<div>
<pre>(autoload &#39;emms <span>&#34;emms&#34;</span> nil t nil)
(autoload &#39;emms <span>&#34;emms-browser&#34;</span> nil t nil)
(<span>with-eval-after-load</span> &#39;emms
  (<span>require</span> &#39;<span>emms-setup</span>)
  (emms-all)
  (<span>setq</span> emms-player-list &#39;(emms-player-mplayer))
  (<span>setq</span> emms-source-file-default-directory (file-name-as-directory <span>&#34;~/mp3s&#34;</span>))
  (define-key emms-browser-mode-map (kbd <span>&#34;SPC&#34;</span>) #&#39;emms-browser-toggle-subitems-recursively)
  (<span>when</span> (memq system-type &#39;(gnu gnu/linux gnu/kfreebsd))
    <span>;; </span><span>use GNU find for extra speed when possible</span>
    (<span>setq</span> emms-source-file-gnu-find find
          emms-source-file-directory-tree-function &#39;emms-source-file-directory-tree-find)))
</pre>
</div>
<p>
You’ll need to change <code>~/mp3s</code> to the directory where you keep your audio files
(EMMS will work with multiple directories; this is just the default.)
</p>

<p>
Now restart your Emacs<sup><a id="fnr.354" href="#fn.354" role="doc-backlink">354</a></sup>, and say   <code>M-x</code> <code>emms-add-directory-tree</code>;
either hit return to add your default music directory (defined above), or pick
any other directory of music files (whether under your default directory, or
elsewhere).  This populates the default playlist with all the files in that
directory (recursively).  If you’ve chosen a directory with, say, thousands of
audio files, it may take a while to populate the playlist (and especially to
convert simple filenames to Artist–Title format), but it runs in the background
so you can start using EMMS right away, and the data will be cached, so the next
time you start up EMMS, it will all be loaded quickly.
</p>

<p>
Now say   <code>M-x</code> <code>emms</code> and in the <code>*EMMS Playlist*</code> buffer just move Point
to the song you want to play and hit <code>RET</code>.  Of course you can just use
    <code>C-s</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Basic-Isearch"><code>isearch-forward</code></a>﻿) or   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Other-Repeating-Search"><code>occur</code></a>﻿ or whatever
you like to find your way around, until you get comfortable with the EMMS
searching and browsing commands.
</p>

<p>
Be sure to check out the manual to learn the basic commands, how to work with
multiple playlists, how to use the browser, display album covers and lyrics,
mark tracks in playlists for bulk operations, use the tag editor to fix
metadata, set bookmarks, play streaming audio and internet radio, and much more.
</p>
</div>
</div>
<div id="outline-container-org0caa3fc">
<h4 id="org0caa3fc">Music Player Daemon (MPD) <a id="org605e809"></a></h4>
<div id="text-org0caa3fc">
<p>
One of the most popular music players for Unix nerds is <a href="https://www.musicpd.org/">Music Player Daemon</a> (MPD).
I’m a big fan of MPD, but its disadvantage is that it’s somewhat complex to set
up and configure.  It implements a client-server interface: the server knows
about your music files and your audio hardware, and any number of clients (CLI,
TUI, and GUI) exist that can talk to the server to control it (play this track,
stop playing, randomly play all my Math Rock tracks…).  This design means that
there are many MPD clients, and that the server and client can be on different
machines (so, you can use an MPD client on your phone to control the server on
the <a href="https://en.wikipedia.org/wiki/Raspberry_Pi">Raspberry Pi</a> that’s connected to your home stereo).
</p>

<p>
If you’re already using MPD, EMMS can use it instead of the above <code>mplayer</code> setup
and I would recommend that; see below for a possible configuration.
</p>

<p>
Emacs also has several other MPD clients; one is built-in:   <code>M-x</code> <code>mpc</code>.
</p>

<div id="org2c772a9">
<p><a href="https:./images/mpc.png" alt="=M-x mpc=" title="=M-x mpc=" width="100%"><img src="https://blog.veitheller.de/images/mpc.png" alt="=M-x mpc=" title="=M-x mpc=" width="100%"/></a>
</p>
<p><span>Figure 54: </span><code>M-x mpc</code></p>
</div>

<p>
I don’t like its interface: it’s completely undocumented and it pops up an
arrangement of five windows that I just find confusing.  You can instead install
  <code>ampc</code> from the <a href="#orgc96889a">Package Manager</a><sup><a id="fnr.355" href="#fn.355" role="doc-backlink">355</a></sup> and run
  <code>M-x</code> <code>ampc</code> — you’ll get an extremely similar bunch of windows (six
this time) but <code>ampc</code> actually has documentation (do <code>C-h P ampc</code>, which you can do
before installing it) and I find it less confusing.  There are at least three
more MPD clients in the <a href="#orgc96889a">MELPA package repository</a> (<code>mpdel</code>, <code>elmpd</code>, and <code>mpdmacs</code>)
that I haven’t investigated.<sup><a id="fnr.356" href="#fn.356" role="doc-backlink">356</a></sup>
</p>

<p>
Here’s the EMMS configuration I use with MPD:
</p>
<div>
<pre>(autoload &#39;emms <span>&#34;emms&#34;</span> nil t nil)
(autoload &#39;emms <span>&#34;emms-browser&#34;</span> nil t nil)
(<span>with-eval-after-load</span> &#39;emms
  (<span>require</span> &#39;<span>emms-setup</span>)
  (<span>require</span> &#39;<span>emms-player-mpd</span>)
  (emms-all)
  (add-to-list &#39;emms-info-functions &#39;emms-info-mpd)
  (<span>setq</span> emms-player-list &#39;(emms-player-mpd))
  (<span>setq</span> emms-player-mpd-music-directory <span>&#34;~/mp3s&#34;</span>)
  (emms-cache-set-from-mpd-all)
  (<span>ignore-errors</span>
    (call-process <span>&#34;mpc&#34;</span> nil nil nil <span>&#34;consume&#34;</span> <span>&#34;off&#34;</span>)))
</pre>
</div>
</div>
</div>
<div id="outline-container-org615d012">
<h4 id="org615d012">References</h4>
<p>
Free Software Foundation. 2020. <i>Emms Manual.</i> Cambridge, MA: Free Software Foundation..
Read in Emacs with <code>M-x info-display-manual RET emms RET</code>.
</p>
</div>
</div>
<div id="outline-container-org47c704f">
<h3 id="org47c704f"><span>UNFINISHED</span> Mail, News, and Feeds <a id="org5e201bd"></a></h3>
<div id="text-org47c704f">
<p>
One of the big application domains for Emacs is as a <a href="https://en.wikipedia.org/wiki/Email_client">Mail User Agent (MUA)</a>, or
what we loosely call a <i>mailer</i>.  Rather than using the usual web-based interface
to Gmail, Outook, or the like; a traditional GUI mailer like <a href="https://www.thunderbird.net/en-US/">Thunderbird</a>; or a
command-line client like <a href="http://www.mutt.org/">Mutt</a>; you can leverage all the things Emacs does for
you by reading your mail in Emacs.
</p>

<p>
A decade or two ago, reading mail in Emacs was more common; in our modern age,
when Email is a commodity run by multinational megacorporations like Google,
Apple, and Microsoft, Emacs mail definitely isn’t for everybody.  That said,
you’ll have to pry my Emacs mailer out of my cold, dead hands.
</p>

<p>
Even if you don’t want to commit to using Emacs as your MUA, the Emacs mailers
can still be useful.  I have a friend who uses Gmail as his MUA but hit the
maximum space limit.  Rather than pay for more space, he exported (and then
deleted) all his old mail (Google uses <a href="#org66a479f">Mbox</a> format for this) and now happily
uses <a href="#org8f83f4f">Notmuch</a> in Emacs to search and read his decade’s worth of archival mail.<sup><a id="fnr.357" href="#fn.357" role="doc-backlink">357</a></sup>
Also, internet mailing lists often make their archives available as downloadable
Mbox files and Emacs makes a great browser for these.
</p>
</div>

<div id="outline-container-org1116a51">
<h4 id="org1116a51">Sending Mail</h4>
<p>
Being able to compose and send mail directly from Emacs is useful even if you
don’t use Emacs to <i>read</i> your mail, and it’s easy to set up.  If you’re doing all
your computing in the Lisp Machine, it’s very annoying to have paste a bunch of
text into a web browser (or worse, <i>compose</i> your text directly in a browser), and
probably see it get mangled into HTML in the bargain.
</p>

<div id="outline-container-org756ffc9">
<h5 id="org756ffc9">Configuring SMTP</h5>
<div id="text-org756ffc9">
<p>
There are a lot of ways to send email but the most common nowadays is
<i>remote <a href="https://en.wikipedia.org/wiki/Smtp">SMTP</a></i>.  If you use Gmail, Apple, Microsoft, or the like for your email,
you can use their SMTP server to send mail from Emacs.  You’ll need to know:
</p>

<ul>
<li>your SMTP server name, something like <code>smtp.gmail.com</code> or <code>smtp.office365.com</code></li>
<li>your user name</li>
<li>your password</li>
</ul>

<p>
Some providers may have additional settings you need to specify (at this
writing, these three are sufficient for Gmail).  You may also need to tweak
settings in your provider’s web interface (e.g., Gmail requires you to enable
mail access for “less secure apps”; be sure you understand the ramifications of
this<sup><a id="fnr.358" href="#fn.358" role="doc-backlink">358</a></sup>).
</p>

<p>
You don’t have to configure these via <a href="#org27e6769">Customize</a> or in your <a href="#org2af3730">Init File</a>; when you
send your first email, you’ll be prompted for them, and Emacs will remember your
responses.  However, you might want to use   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Specific-Customization"><code>customize-option</code></a>﻿ to
configure these two <a href="#orge6fb506">User Options</a> ahead of time: it will save you some future
typing:
</p>

<dl>
<dt><code>user-mail-address</code></dt><dd>your email address (to be filled-in to the emails you
send) in the form <code>user@example.com</code></dd>
<dt><code>user-full-name</code></dt><dd>your name, in the form <code>Joe Blow</code></dd>
</dl>
</div>
</div>

<div id="outline-container-org4bfca05">
<h5 id="org4bfca05">Composing Email</h5>
<div id="text-org4bfca05">
<p>
Before you can send an email, you need to compose it.  The basic command to pop
up a mail composition Buffer is     <code>C-x m</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Sending-Mail"><code>compose-mail</code></a>﻿); it has
as variants     <code>C-x 4 m</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Sending-Mail"><code>compose-mail-other-window</code></a>﻿) and
    <code>C-x 5 m</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Sending-Mail"><code>compose-mail-other-frame</code></a>﻿).  The Buffer is called
<code>*unsent mail*</code>, will be in   <code>message-mode</code>, and will be
initialized with some text similar to this (you’re Joe in this scenario):
</p>
<pre id="orgb3419be">To:
Subject:
From: Joe Blow &lt;joe@example.com&gt;
--text follows this line--

</pre>
<p>
As you’d expect, this is in every way a normal Buffer with some appropriate key
bindings and colorization due to <code>message-mode</code>.  (The <code>From:</code> line may look strange
if you haven’t yet configured your email address and name, as above (you can
always just edit the <code>From:</code> line manually).
</p>

<p>
Now just fill out your message: add an email address to the <code>To:</code> line (I’d
recommend your own email address for this first test message, so you can tell if
it worked), add a subject to the <code>Subject:</code> line, correct the email address in the
<code>From:</code> line if necessary, and type the body of your message after <code>--text follows
this line--</code> (don’t mess up that line, it’s significant).  The word “test” is
sufficient as the body for this test message.
</p>

<p>
In order to send the email, you need to have network connectivity at that
moment: in other words, your wifi needs to be up (if your computer doesn’t have
a wired Ethernet connection).
</p>

<p>
Now send the message with     <code>C-c C-c</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/message/Sending"><code>message-send-and-exit</code></a>﻿).
This first time (and this time only) Emacs will have some questions for you —
probably only two:
</p>

<ol>
<li><p>
<code>Send mail via (default mail client):</code>
</p>

<p>
Enter <code>smtp</code> here.
</p></li>
<li><p>
<code>Outgoing SMTP mail server:</code>
</p>

<p>
Type your mail provider’s SMTP hostname here.
</p></li>
</ol>

<p>
While this is happening, Emacs is actually negotiating with your provider’s SMTP
server; if the provider asks Emacs for more information, Emacs will pass those
questions on to you (it will certainly ask for your user name and password here).
</p>

<p>
When you enter your password, Emacs will ask if you want to save it for later
use.  If you say yes, it will be saved in the file <code>~/.authinfo</code> in plain text,
meaning anyone with access to this file on your computer can read it to see your
password.  In my opinion you should set up this file to be encrypted, and it’s
easiest to do this ahead of time; see <a href="#orgb9ccb9b"><i>Authentication</i></a>, <a href="#orgc045bbb"><i>Encrypted Files</i></a>, and
<a href="#orga76f459"><i>EasyPG Assistant</i></a> for more information.
</p>

<p>
If there are questions that you don’t understand or don’t know the answer to,
just use     <code>C-g</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Quitting"><code>keyboard-quit</code></a>﻿) to abort the sending, and read
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Mail-Sending">“Mail Sending”</a> in the <i>Emacs</i> manual.
</p>
</div>
</div>
</div>
<div id="outline-container-orgeabe54d">
<h4 id="orgeabe54d">Reading Mail <a id="org9017fdf"></a></h4>
<div id="text-orgeabe54d">
<p>
The next step after sending mail is to read your mail.  Emacs has half a dozen
mailers to choose from, but only three are built-in, and of the three, only
<a href="https://www.gnu.org/software/emacs/manual/html_node/gnus/Top">Gnus</a> directly supports remote mail.  Gnus is
my favorite mailer and I highly recommend it, though it’s not for the faint of
heart.
</p>
<blockquote>
<p>
If you are used to traditional mail readers, but have decided to switch
to reading mail with Gnus, you may find yourself experiencing something
of a culture shock. — Lars Magne Ingebrigtsen, Gnus author
</p>
</blockquote>

<p>
Properly speaking, Gnus is a <i>newsreader</i>.  In this context, “news” means <a href="https://en.wikipedia.org/wiki/Usenet">Usenet</a>
and its protocol, <a href="https://en.wikipedia.org/wiki/Network_News_Transfer_Protocol">NNTP</a>.  Usenet (1980) is what preceded Internet Web Forums (and
AOL, and most BBS’s), and was of tremendous cultural importance<sup><a id="fnr.359" href="#fn.359" role="doc-backlink">359</a></sup>.  Imagine
if instead of having to go to a different web site for every forum, they all
came together (thanks to the open protocol NNTP) as <i>newsgroups</i> readable in your
choice of many special <i>newsreader</i> programs.  In addition, the newsreader would
keep of track of which postings you’ve read in each newsgroup.  No more plowing
through dozens of messages you’ve already read to find the newest ones; no more
reading in reverse order.  Wow.
</p>

<p>
Since you read all these newsgroups in one program, they all had exactly the
same interface (wow), and if you didn’t like that interface, you could choose a
different newsreader, or write your own.
</p>

<p>
The first Emacs newsreader that I used was Gnews by Matthew P. “Weemba” Wiener
(definitely before 1988).  At some point I switched to Masanobu Umeda’s GNUS
(1988-1992), which <a href="https://lars.ingebrigtsen.no/">Lars Magne Ingebrigtsen</a> rewrote under the slightly
differently-spelled name Gnus in 1994.
</p>

<p>
Gnus was definitely the best newsreader I had ever used, inside or outside of
Emacs.  And since any single post (“news message”) in a newsgroup was almost exactly
like an email, Lars made it possible to just treat all your actual email as
news.  Your mail folders would be treated as newsgroups.  Sending an email would
be like posting to a newsgroup.  Now you have the same interface to both news
and mail, and since Gnus is the most crazily powerful and extensible news reader
of all time, it makes an amazing mailer.  It’s possible that I’ve been
using Gnus as my main mailer since about 1996 (with various breaks to
experiment with other Emacs mailers, none of which were up to the challenge).
</p>

<p>
Gnus ships as part of Emacs and is a very large and complex system.  It has a
32,902-line manual, which is very
entertaining (makes great bedtime reading!), well-written and covers everything
you need to know.  Figuring it all out will be something of a project…  But
fortune favors the bold!
</p>
</div>
<div id="outline-container-org1556987">
<h5 id="org1556987">Other Emacs Mailers <a id="orge3f2229"></a></h5>
<div id="text-org1556987">
<p>
There are half a dozen other mailers to choose from; most of them are
third-party packages but three are built-in.  All of these mailers, listed here
in chronological order, are completely usable if they meet your requirements.
My recommendations below are strictly personal preference.  But first, some
terminology.
</p>
<dl>
<dt>Remote Mail</dt><dd>This is the normal way people read mail nowadays.  Some service
provider, like Gmail or Outlook, receives and hosts your mail for you, which
you read “remotely”.  That is, your MUA (say, the Gmail app on your phone)
fetches each email over the network each time you click to read it: you don’t
actually have copies of all your mail.  The protocol that enables remote mail
is called <a href="https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol"><i>IMAP</i></a>.</dd>
<dt>Local Mail</dt><dd>This means that your mail is delivered directly to your
computer, the messages are stored on your local disk, and your MUA never makes
a network connection.  This is the way email originally worked when people
logged into servers from terminals.  It assumes your computer is always on
because mail can arrive at any moment (and if your computer is down, the mail
will bounce), and so usually only servers with system
administrators do this.  But there’s a hybrid approach: you can use a <i>Mail
Retrieval Agent (MRA)</i> to fetch your mail from a remote provider (like Gmail)
to your computer’s disk, as if it had been delivered there directly;
examples of MRAs include <a href="https://marlam.de/msmtp/"><code>msmtp</code></a>, <a href="https://mailutils.org/wiki/Fetching_Mail_with_Movemail"><code>movemail</code></a>, <a href="https://isync.sourceforge.io/"><code>isync</code></a>, <a href="https://marlam.de/mpop/"><code>mpop</code></a>, <a href="https://www.fetchmail.info/"><code>fetchmail</code></a>, and <a href="http://offlineimap.org/"><code>offlineimap</code></a>.</dd>
</dl>
</div>
</div>

<div id="outline-container-org288d223">
<h5 id="org288d223">The Mailers</h5>
<div id="text-org288d223">
<p>
Some of these mailers don’t do the IMAP protocol; using them may require a
certain amount of comfort with installing and running external software, and
setting up an ecosystem where you can read your mail both in Emacs and also on
your phone can be something of a challenge, depending on how particular you are.
</p>

<dl>
<dt><a href="https://blog.veitheller.de/%28emacs%29%20Rmail.html#Top">Rmail</a></dt><dd>The oldest Emacs mailer (1985; it actually predates GNU Emacs and was
present in <a href="#orgf0a0641">ITS TECO Emacs</a> in 1975); built-in; still supported and updated; only
local mail is supported.  Rmail is pretty basic, but if you configure
your MRA to split your mail into reasonably-sized folders, that may be
sufficient for your needs.  Even if you don’t commit to Rmail as your MUA, it
makes an excellent browser for random Mbox files you may have laying around
(like those you can download from mailing list archives).</dd>
<dt><a href="https://mh-e.sourceforge.io/">MH-E</a></dt><dd>A front-end to <a href="https://www.nongnu.org/nmh/"><code>nmh</code></a>, the modern replacement for the <a href="https://en.wikipedia.org/wiki/MH_Message_Handling_System">Rand Mail Handler (MH)</a>,
a historic (1979) command-line MUA.  MH-E is a mature program last updated
in 2016.  The Emacs package is built-in, but depends on <code>nmh</code> being installed.
Local mail only.  Not recommended.</dd>
<dt><a href="https://www.nongnu.org/viewmail/">VM</a></dt><dd>A mature program last updated in 2010; neither built-in nor available in
the package manager; needs to be manually installed.  Both local and remote
mail are supported.  Not recommended.</dd>
<dt><a href="http://www.mew.org/en/">Mew</a></dt><dd>A very nice MUA with a lovely Mime composition facility; probably my
second-favorite Emacs mailer, though I haven’t used it for many years.  Both
local and remote mail are supported.  Available in the package manager from
MELPA.</dd>
<dt><a href="https://github.com/wanderlust/wanderlust/">Wanderlust</a></dt><dd>A capable MUA; both local and remote mail are supported.
But it’s not in the package manager and is typically installed outside of
Emacs via the OS package manager (available to my knowledge on Arch Linux
and FreeBSD at least); depends on three other Elisp packages that are also
not available in the package manager.  I find that this means that
Wanderlust easily goes out-of-sync with Emacs updates and for this reason
I don’t recommend it.</dd>
<dt><a id="org8f83f4f"></a> <a href="https://notmuchmail.org/">Notmuch</a></dt><dd>A very unusual, elegant, and minimalist mailer based
completely on search, with tagging completely replacing folders; available in
the package manager from MELPA.  The downsides are that Notmuch depends
completely on a standalone command-line application (called <code>notmuch</code>) which
indexes, searches, and manages the tags, and that it does local mail only.</dd>
<dt><a href="https://www.djcbsoftware.nl/code/mu/mu4e.html">Mu4e</a></dt><dd>Similar in design to <code>notmuch</code>, but based on the <a href="https://www.djcbsoftware.nl/code/mu/"><code>mu</code></a> mail indexing
program.  Local mail only.  Same caveats as Notmuch.  (I haven’t ever used
this mailer, but it’s well-liked.)</dd>
</dl>
</div>
</div>
</div>
<div id="outline-container-orgcc6155c">
<h4 id="orgcc6155c">Browsing Mbox Files <a id="org66a479f"></a></h4>
<div id="text-orgcc6155c">
<p>
Even if you aren’t using <a href="https://blog.veitheller.de/Rmail.html#Top">Rmail</a> as your mailer,   ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Rmail"><code>rmail-mode</code></a>﻿
makes an excellent <a href="#org5b21ef0">Major Mode</a> for viewing <a href="https://en.wikipedia.org/wiki/Mbox">Mbox files</a>, if you happen to have any.
You can make this your default with this <a href="#org2af3730">Init File</a> snippet:
</p>
<div>
<pre>(add-to-list &#39;auto-mode-alist &#39;(<span>&#34;\\.mbox\\&#39;&#34;</span> . rmail-mode))
</pre>
</div>
</div>
</div>
<div id="outline-container-org5ccdaab">
<h4 id="org5ccdaab"><span>UNFINISHED</span> Web and News Feeds (Syndication) <a id="orgd4a6bd8"></a></h4>
</div>

</div>

<div id="outline-container-orgf27f6ce">
<h3 id="orgf27f6ce"><span>UNFINISHED</span> Address Book: The Insidious Big Brother Database (BBDB) <a id="org9ba396f"></a></h3>
</div>
<div id="outline-container-org40902b9">
<h3 id="org40902b9"><span>UNFINISHED</span> Drawing Pictures <a id="orgd014c8d"></a></h3>

<p id="outline-container-orge6674b7">
<h4 id="orge6674b7">Picture Mode</h4>
</p>
<p id="outline-container-org6c15ae2">
<h4 id="org6c15ae2">Artist Mode</h4>
</p>
</div>

<div id="outline-container-org8cf2441">
<h3 id="org8cf2441"><span>UNFINISHED</span> EUDC: Emacs Unified Directory Client (LDAP) <a id="org0f7af90"></a></h3>

<div id="outline-container-org536d1b5">
<h4 id="org536d1b5">References</h4>
<p>
Free Software Foundation. 2022. <i>Emacs Unified Directory Client.</i> Cambridge, MA: Free Software Foundation..
Read in Emacs with <code>M-x info-display-manual RET eudc RET</code>.
</p>
</div>
</div>

<p id="outline-container-org507afcd">
<h3 id="org507afcd"><span>UNFINISHED</span> FTP (File Transfer Protocol)</h3>
</p>
<div id="outline-container-orgf6f9ce3">
<h3 id="orgf6f9ce3"><span>UNFINISHED</span> Editing Processes with <code>proced</code> <a id="orgf52231b"></a></h3>
<p>
See   <code>M-x</code> <code>proced</code>.
</p>
</div>
<p id="outline-container-org1fe86f0">
<h3 id="org1fe86f0"><span>UNFINISHED</span> Unix Manual Pages</h3>
</p>
<div id="outline-container-org0d2e942">
<h3 id="org0d2e942"><span>UNFINISHED</span> Calc <a id="orgb2b6b30"></a></h3>

<p id="outline-container-org79bf84e">
<h4 id="org79bf84e">Interactive Tutorial</h4>
</p>
<p id="outline-container-org5713e6d">
<h4 id="org5713e6d">Embedded Mode</h4>
</p>
<div id="outline-container-org46a2d4c">
<h4 id="org46a2d4c">Unit Conversion</h4>
<p>
<code>calc</code> knows many different units: meters and inches and feet; liters and fluid
ounces; days, weeks, and years and hours, minutes, and seconds; miles per hour;
and furlongs, footlamberts, and muon rest masses, among about 150 more (say <code>u v</code>
when in <code>calc-mode</code>).
</p>
</div>

</div>
<div id="outline-container-org532913b">
<h3 id="org532913b"><span>UNFINISHED</span> EasyPG Assistant <a id="orga76f459"></a> <a id="orgf4343bc"></a> <a id="org56dbe9f"></a></h3>
<div id="text-org532913b">
<p>
To create a brand new symmetrically encrypted file, simply visit a file with a
<code>.gpg</code> extension tacked onto any other extension you might want, e.g. <code>C-x C-f
foo.org.gpg</code>.  When you save this new file, a window will pop up listing the
contents of your <i>public key ring</i>; if you haven’t configured public key
encryption in GnuPG, the list of recipients will be empty and the buffer will look like this:
</p>
<pre id="org1734e55">Select recipients for encryption.
If no one is selected, symmetric encryption will be performed.
- ‘m’ to mark a key on the line
- ‘u’ to unmark a key on the line
[Cancel][OK]
</pre>
<p>
Whether empty or not, if you click the <code>[OK]</code> button without marking any
encryption keys, Emacs will use symmetric encryption for this file, and you’ll
be prompted for an encryption passphrase, which can be anything you like (be
sure to remember it; you won’t be able to decrypt the file without it!).  The
passphrase prompt will probably come from a GUI popup window rather than from
Emacs itself: this is the <code>gpg-agent</code>, which is commonly started up by your OS or
else by GnuPG itself.
</p>
</div>

<div id="outline-container-orgad232a0">
<h4 id="orgad232a0">References</h4>
<div id="text-orgad232a0">
<ul>
<li>Ashley, Mike. 1999. <i>The GNU Privacy Handbook.</i> Cambridge, MA: Free Software Foundation. <a href="https://www.gnupg.org/documentation/guides.html">https://www.gnupg.org/documentation/guides.html</a>.</li>
</ul>


<ul>
<li>Free Software Foundation. 2017. <i>The GNU Privacy Guard Manual.</i> Cambridge, MA: Free Software Foundation..
Read in Emacs with <code>M-x info-display-manual RET gnupg RET</code>.</li>
</ul>
</div>
</div>
</div>
<p id="outline-container-org407a3bd">
<h3 id="org407a3bd"><span>UNFINISHED</span> Emacs Speaks Statistics: Data Analysis</h3>
</p>
<p id="outline-container-orgb427cd5">
<h3 id="orgb427cd5"><span>UNFINISHED</span> Maps</h3>
</p>
<div id="outline-container-orgedb782b">
<h3 id="orgedb782b"><span>UNFINISHED</span> Chat <a id="org10a8259"></a></h3>

<div id="outline-container-orgbb48e07">
<h4 id="orgbb48e07">Internet Relay Chat (IRC) <a id="orgb7574d2"></a></h4>
</div>
<p id="outline-container-orgd6360f8">
<h4 id="orgd6360f8">Jabber</h4>
</p>
</div>
<p id="outline-container-org4d5caa6">
<h3 id="org4d5caa6"><span>UNFINISHED</span> Emacs as Window Manager</h3>
</p>
<div id="outline-container-org7cfd197">
<h3 id="org7cfd197">Games and Amusements <a id="org4041080"></a></h3>
<p>
Emacs comes with 24 built-in games and amusements, and there are at least
39 more in the <a href="#orgc96889a">Package Manager</a>.
If any of the games I mention aren’t available in your Emacs, just search them
in the Package Manager.  I’ve divided them into several categories.
</p>
<div id="outline-container-org7db2042">
<h4 id="org7db2042">Actual Games</h4>
<div id="text-org7db2042">
<p>
By this I mean games with a computer opponent that you play against, or classic
computer games in which you try to get a better score than the last time.  The
only true built-in games with a computer opponent are   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Amusements"><code>gomoku</code></a>﻿,
which plays <a href="https://en.wikipedia.org/wiki/Gomoku">Gomoku</a> or Five-in-a-Row,   <code>M-x</code> <code>chess</code>, and
  <code>M-x</code> <code>gnugo</code> which is a front-end to the <a href="https://www.gnu.org/software/gnugo/">GNU Go</a> engine (which you’ll have
to install via your OS package manager).
</p>

<p>
<code>chess</code> has a very weak game engine implemented in Emacs Lisp so you can play it
right away, but if you install any of several strong chess engines via your OS
package manager, like <code>gnuchess</code> or <code>stockfish</code>, <code>M-x chess</code> will detect it and you
can play against a much stronger opponent.  The default chessboard is a simple
ASCII representation, but you can install optional graphics for a more
traditional look; see the documentation.    <code>M-x</code> <code>chess-ics</code> lets you
play against human opponents elsewhere on the Internet via an <a href="https://en.wikipedia.org/wiki/Internet_chess_server">Internet Chess
Server</a>.
</p>

<p>
In the computer-game category we have   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Amusements"><code>dunnet</code></a>﻿, a text adventure
in the mold of the classic <a href="https://en.wikipedia.org/wiki/Colossal_Cave_Adventure">Advent</a> a.k.a. Colossal Cave Adventure<sup><a id="fnr.360" href="#fn.360" role="doc-backlink">360</a></sup>.  Dunnet is perhaps
unique among all Emacs programs of any kind in that it can be run in batch mode,
from a terminal outside of Emacs!<sup><a id="fnr.361" href="#fn.361" role="doc-backlink">361</a></sup>  We also have <a href="https://en.wikipedia.org/wiki/Tetris"><code>tetris</code></a>, <a href="https://en.wikipedia.org/wiki/Snake_(video_game_genre)"><code>snake</code></a>, and
<a href="https://en.wikipedia.org/wiki/Pong"><code>pong</code></a>—just <code>M-x</code> any of them.  You can also install <a href="https://en.wikipedia.org/wiki/Pac-Man">Pac-Man</a> from the Package
Manager under the name <code>pacmacs</code>.
</p>
</div>
</div>
<div id="outline-container-org1064210">
<h4 id="org1064210">Puzzles</h4>
<p>
There are a number of puzzles or solitaires.    <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Amusements"><code>blackbox</code></a>﻿ plays
Eric Solomon’s famous <a href="https://en.wikipedia.org/wiki/Black_Box_(game)">Black Box</a> game (as a “game” it’s really a competitive
solitaire).    <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Amusements"><code>solitaire</code></a>﻿ plays <a href="https://en.wikipedia.org/wiki/Peg_solitaire">Peg Solitaire</a>,
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Amusements"><code>bubbles</code></a>﻿ is an implementation of <a href="https://en.wikipedia.org/wiki/SameGame">Same Game</a>, and
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Amusements"><code>5x5</code></a>﻿ is a puzzle with several different automatic solvers which
you can watch (which may put this in the category of <a href="#orgcd1acd7">Display Hacks</a>).  Finally
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Amusements"><code>mpuz</code></a>﻿ is a multiplication puzzle.
</p>
</div>
<div id="outline-container-org534ad52">
<h4 id="org534ad52">Cryptography</h4>
<div id="text-org534ad52">
<p>
There are several commands related to traditional cryptography<sup><a id="fnr.362" href="#fn.362" role="doc-backlink">362</a></sup>.  Emacs
supports <a href="https://en.wikipedia.org/wiki/ROT13">ROT13</a>, the traditional <a href="https://en.wikipedia.org/wiki/Caesar_cipher">Caesar cipher</a> of <a href="#org9017fdf">Usenet</a>, still occasionally used
as it was then to obfuscate punch lines.    <code>M-x</code> <code>rot13-region</code> and
friends will encode or decode ROT13, since it’s its own inverse.
</p>
<blockquote>
<p>
Two conspiracy theorists walk into a bar.
Lbh pna’g gryy zr gung jnf whfg n pbvapvqrapr…
</p>
</blockquote>
<p>
Finally, there’s the very impressive   <code>M-x</code> <code>decipher-mode</code>, which provides
assistance in decrypting monoalphabetic substitution ciphers.
Insert your ciphertext in a new Buffer and invoke   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Amusements"><code>decipher</code></a>﻿,
which will set the Buffer up and invoke the Mode.  Special commands will list
letter and digram frequencies, show adjacency lists, and the like.
</p>

<p>
Of course Emacs can handle <a href="https://en.wikipedia.org/wiki/Morse_code">Morse code</a>:<sup><a id="fnr.363" href="#fn.363" role="doc-backlink">363</a></sup> just set the <a href="#org34ab2da">Region</a> around this
message and invoke   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Amusements"><code>unmorse-region</code></a>﻿; encode your own messages with
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Amusements"><code>morse-region</code></a>﻿.
</p>
<pre id="org3837076">.--/..../.-/- ..../.-/-/.... --./---/-.. .--/.-./---/..-/--./..../-
</pre>
</div>
</div>
<div id="outline-container-org8a4c024">
<h4 id="org8a4c024">Display Hacks <a id="orgcd1acd7"></a></h4>
<div id="text-org8a4c024">
<p>
There are a number of amusements that fall into the category of <a href="https://foldoc.org/display+hacks"><i>display hacks</i></a>
(i.e. fun things to stare at).    <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Amusements"><code>hanoi</code></a>﻿ implements the <a href="https://en.wikipedia.org/wiki/Tower_of_Hanoi">Towers of
Hanoi</a> puzzle, well-known to programmers for its simple recursive solution.
</p>

<p>
Infinitely more interesting is   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Amusements"><code>life</code></a>﻿, an implementation of
Conway’s famous <a href="https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life">cellular automaton</a>.  One of
17 starting patterns is
randomly chosen. It’s not hard to add your own, but check out the <a href="https://conwaylife.com/ref/lexicon/lex_home.htm">Life Lexicon</a>
for everything you could possibly want to know about patterns, and
additional Elisp code.
</p>

<p>
Emacs also has its own screensaver.  Just say   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Amusements"><code>zone</code></a>﻿ and your
Emacs will zone-out randomly.  It’s hard to describe, but either something
disturbing but very subtle will happen, or something <i>very</i> disturbing and
extremely in-your-face will.  Regardless of how messed up your precious text
looks, I assure you that nothing is really happening.  Give any Emacs command at
all, and the zoning will stop and all apparent destruction will vanish.
Definitely one of the best things in Emacs.
</p>
</div>
</div>
<div id="outline-container-org85a2159">
<h4 id="org85a2159">Jokes / Wackiness</h4>
<div id="text-org85a2159">
<p>
Finally we have a motley assortment of oddities.  I mentioned at the very
beginning that Emacs comes with a Rogerian therapist; you might need one after
watching   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Amusements"><code>zone</code></a>﻿.  Just invoke   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Amusements"><code>doctor</code></a>﻿ if you feel
the need to talk things out; it’s an Elisp implementation of Weizenbaum’s famous
<a href="https://en.wikipedia.org/wiki/ELIZA">ELIZA</a> program from the MIT AI Lab in 1966: the first chatbot.
</p>

<p>
ELIZA was more of an early Natural Language Processing project than a psychology
one.  Another Emacs function from the domain of NLP is
  <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Amusements"><code>dissociated-press</code></a>﻿, which uses a stochastic process to generate
new text from old.  Just invoke it in a Buffer of relatively plain text and
you’ll get a new <code>*Dissociation*</code> Buffer full of text that will seem like a
parody.  You might run it on <i>War and Peace</i> from an <a href="">EWW</a> Buffer:
</p>
<pre>M-x eww RET https://www.gutenberg.org/files/2600/2600-0.txt
</pre>

<p>
What gems might emerge?
</p>
<blockquote>
<p>
Anna Pavlovna’s presentiment was in fact fulfilled. Next day during
the old fellow was not much good and for their own benefit to follow
the example and instruction of the night was dark but starry, the road
showed black horse with trappings that glittered in the sun or the
earth by English gold and paper money, and he was keeping the
bank. Rostov had not seen him. Before he had said quite the contrary
it is a very mild expression of the contradictory news, false as usual
and therefore variously interpreted.
</p>
</blockquote>
<p>
Unix systems have had a <a href="https://en.wikipedia.org/wiki/Fortune_(Unix)"><i>fortune cookie</i> program</a> since 1979, which prints a
random quip, quotation, or joke every time it’s run.    <code>M-x</code> <code>fortune</code>
does the same thing for Emacs<sup><a id="fnr.364" href="#fn.364" role="doc-backlink">364</a></sup>.
</p>

<p>
In honor of several <a href="https://xkcd.com/378/">XKCD comics</a> on the topic of Emacs, we have the otherwise
inexplicable   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Amusements"><code>butterfly</code></a>﻿ (you’ll have to bind it to <code>C-x M-c
M-butterfly</code> yourself).
</p>
</div>
</div>
<div id="outline-container-orga28eb72">
<h4 id="orga28eb72">References</h4>
<p>
Poundstone, William. 1985. <i>The Recursive Universe: Cosmic Complexity and the Limits of Scientific Knowledge.</i> Chicago: Contemporary Books..
</p>
</div>
</div>
</div><div id="outline-container-org82d92b7">
<h2 id="org82d92b7"><b>EMACS FOR…</b></h2>

<div id="outline-container-org6ca77f6">
<h3 id="org6ca77f6"><span>UNFINISHED</span> Emacs for Writers <a id="org6412830"></a></h3>
<div id="text-org6ca77f6">
<blockquote>
<p>
Writing should be all about the words.  But word processors like
Microsoft Word, Google Docs, or Apple’s Pages force you to think about
formatting as you compose. — Ashton Wiersdorf
</p>
</blockquote>
</div>
<p id="outline-container-orgc4542d0">
<h4 id="orgc4542d0"><span>UNFINISHED</span> Text Mode</h4>
</p>
<div id="outline-container-org921022f">
<h4 id="org921022f"><span>UNFINISHED</span> Filling <a id="org890316d"></a></h4>

<div id="outline-container-org8101543">
<h5 id="org8101543">Breakable and Non-breakable Space <a id="org80c565b"></a></h5>
</div>
</div>
<p id="outline-container-orga0275bd">
<h4 id="orga0275bd"><span>UNFINISHED</span> Word Wrap</h4>
</p>
<div id="outline-container-org4702d95">
<h4 id="org4702d95"><span>UNFINISHED</span> Electric Quotes</h4>

</div>

<div id="outline-container-org54b303f">
<h4 id="org54b303f"><span>UNFINISHED</span> Dictionaries and Thesauri <a id="org75022c7"></a></h4>
</div>
<p id="outline-container-org214258c">
<h4 id="org214258c"><span>UNFINISHED</span> Footnote Minor Mode</h4>
</p>
</div>
<div id="outline-container-org905f170">
<h3 id="org905f170"><span>UNFINISHED</span> Emacs for Programmers</h3>

<p id="outline-container-org5ae199d">
<h4 id="org5ae199d"><span>UNFINISHED</span> Emacs: Text Editor or IDE?  Yes.</h4>
</p>
<div id="outline-container-org6b9f1e6">
<h4 id="org6b9f1e6"><span>UNFINISHED</span> Commenting and Uncommenting <a id="orga31f0ee"></a></h4>
</div>

<div id="outline-container-org0948e01">
<h4 id="org0948e01"><span>UNFINISHED</span> Compiling Code <a id="org76cafbe"></a></h4>
</div>
<div id="outline-container-org423a04e">
<h4 id="org423a04e"><span>UNFINISHED</span> Managing Projects <a id="orga12fa37"></a></h4>

</div>
<div id="outline-container-org424b922">
<h4 id="org424b922"><span>UNFINISHED</span> On-the-Fly Syntax Checking</h4>

</div>
<div id="outline-container-orgbd0b083">
<h4 id="orgbd0b083"><span>UNFINISHED</span> <a id="orgdd5fd7e"></a> <a id="org922bfe4"></a> Tags and The Xref Subsystem</h4>
</div>
<div id="outline-container-org4b25a19">
<h4 id="org4b25a19"><span>UNFINISHED</span> Elisp Programming</h4>


</div>
</div>
</div><div id="outline-container-orge4b57f7">
<h2 id="orge4b57f7"><b>THE BACK OF THE BOOK</b></h2>

<div id="outline-container-orgaa34281">
<h3 id="orgaa34281">Appendices</h3>

<div id="outline-container-org646c534">
<h4 id="org646c534">Varieties of Emacs: A History <a id="orgf0a0641"></a></h4>
<div id="text-org646c534">
<p>
“Emacs”<sup><a id="fnr.365" href="#fn.365" role="doc-backlink">365</a></sup> is actually the name of a family of text editors that are either
descended from or inspired by one another.  The original Emacs was written at
the MIT AI Lab in 1976 by famous Lisp hackers <a href="https://en.wikipedia.org/wiki/David_A._Moon">Dave Moon</a> and <a href="https://en.wikipedia.org/wiki/Guy_L._Steele_Jr.">Guy L. Steele Jr</a>.
It was implemented in the famously cryptic<sup><a id="fnr.366" href="#fn.366" role="doc-backlink">366</a></sup> command language of the command-line
text editor <a href="https://en.wikipedia.org/wiki/TECO_(text_editor)">TECO</a> to provide it (TECO, that is) with a collection of useful
macros and an enhanced visual mode.  This Emacs ran on a <a href="https://en.wikipedia.org/wiki/PDP-6">DEC PDP-6</a> under the
<a href="https://en.wikipedia.org/wiki/Incompatible_Timesharing_System">Incompatible Timesharing System</a>.
</p>

<p>
For an editor to deserve the name “emacs” the main requirement is that it be
fully extensible with a real programming language.  For GNU Emacs, this language
is Lisp.  Other Emacsen have used TECO, Scheme, a dialect of <a href="https://en.wikipedia.org/wiki/TRAC_(programming_language)">Trac</a> called Mint,
interpreted C-like languages, etc.
</p>

<p>
TECO, and thus the original Emacs, was implemented in PDP-6 assembly language,
and so wasn’t readily portable to other computer architectures (except perhaps
the related PDP-10).  But seemingly everyone who’d ever used Emacs insisted on
having it, so many completely new reimplementations were created.  The first new
version, by Dan Weinreb, was also the first Emacs implemented in Lisp, for the
MIT Lisp Machine.  This was EINE, which stood for “EINE Is Not Emacs” (which was
probably the first recursive acronym).
</p>

<p>
In 1978, Bernie Greenberg implemented Multics Emacs for the Honeywell 6180
running the <a href="https://en.wikipedia.org/wiki/Multics">Multics</a> operating system;
this Emacs was implemented in Maclisp.  At the same time a new version for the
Lisp Machine was released, the wonderfully-named ZWEI (“ZWEI Was EINE,
Initially”).  From this point on, there was a specially-built Emacs or
Emacs-alike of some sort for many other machines and operating systems (e.g.,
SunOS, VMS, MS-DOS, CP/M, etc).
</p>

<p>
The software portability enabled by the Unix operating system and the C
programming language, and the gradual dominance of Unix, finally somewhat tamped
down the fecund growth of this Emacs ecosystem.
</p>

<p>
The first Emacs for Unix was Gosling Emacs (a.k.a. <i>Gosmacs</i>) in 1981.  It was
written in portable <a href="https://en.wikipedia.org/wiki/C_(programming_language)">C</a>, but its extension language, Mocklisp, was only
superficially similar to Lisp and couldn’t be considered a serious programming
language.
</p>

<p>
Gosmacs was initially freely redistributable, but went commercial in 1983 as
Unipress Emacs.
</p>

<p>
GNU Emacs, released in 1985, was written (also in C) by <a href="https://en.wikipedia.org/wiki/Richard_Stallman">Richard Stallman</a>, arch
hacker and Chief GNUisance, an early contributor to and maintainer of the
original TECO Emacs.  He started with the freely-redistributable code of
Gosmacs, but replaced Mocklisp with a true Lisp interpreter (implemented in C),
changing virtually all the Gosmacs code in doing so.  Unipress complained about
the remainder of the original Gosmacs code in the freely-redistributable GNU
Emacs, and within a few months, Stallman had replaced it all with his own
original code.
</p>

<p>
As microcomputers encroached on the province of time-shared mainframes and
minicomputers in the 1980s, microcomputer Emacsen began to appear.  Due to
memory limitations, most of these were not true Emacsen and had sub-standard, if
any, extension languages.  Still, they were way better than <a href="https://en.wikipedia.org/wiki/Edlin"><code>edlin</code></a>.  Notable
examples, among many others, include MINCE (1981), which ran on 8-bit <a href="https://en.wikipedia.org/wiki/Zilog_Z80">Z80</a>’s
running <a href="https://en.wikipedia.org/wiki/CP/M">CP/M</a>; JOVE (1983), MicroEmacs (1985), mg (1986), and probably the
closest of them all to a true Emacs, Russ Nelson’s <a href="https://en.wikipedia.org/wiki/Freemacs">Freemacs</a> (1986), a 21K MS-DOS
executable with a real extension language, MINT (“MINT Is Not <a href="https://en.wikipedia.org/wiki/TRAC_(programming_language)">TRAC</a>”). Freemacs was
written in a combination of 304,470 bytes of 8086 assembly language and a
whopping 294,976 bytes of MINT.
</p>

<p>
These early Emacsen were all non-graphical text-mode applications.  In 1989,
work was begun at the University of Illinois on a graphical-mode <a href="https://en.wikipedia.org/wiki/Fork_(software_development)"><i>fork</i></a> of GNU
Emacs for the <a href="https://en.wikipedia.org/wiki/X_Window_System">X Window System</a>, called Epoch.  Lucid, Inc. needed more than Epoch
provided and started their own fork, originally called Lucid Emacs but better
known as <a href="https://en.wikipedia.org/wiki/XEmacs">XEmacs</a>.  The graphical features were intended to be merged into GNU
Emacs, but there was disagreement on the implementation issues, and the XEmacs
fork became more of a schism: XEmacs was permanently divorced from GNU Emacs;
The two projects coexisted for close to twenty years.  XEmacs development ceased
in 2009.
</p>

<p>
Nowadays, most other Emacsen are versions or forks of GNU Emacs, like the GNU
version for Microsoft Windows, or <a href="https://en.wikipedia.org/wiki/Aquamacs">Aquamacs</a>, a version for Mac OS that uses the
native Cocoa API.  Today, GNU Emacs effectively <i>is</i> Emacs.
</p>
</div>
</div>

<div id="outline-container-org15771de">
<h4 id="org15771de">Emacs vs. The Unix Philosophy</h4>
<div id="text-org15771de">
<p>
Emacs has often been criticized by Unix purists as being diametrically opposed
to the <a href="https://en.wikipedia.org/wiki/Unix_philosophy">Unix Philosophy</a>.  Unix is supposed to consist of many small, simple
commands that each do one thing well, whose power comes from their composabilty
via shell pipelines, while Emacs is the ultimate monolithic application:
one enormous program that tries to do everything itself.
</p>

<p>
This is seen as a violation of a key precept of the Philosophy:
</p>

<blockquote>
<p>
Make each program do one thing well.  To do a new job, build afresh rather than
complicate old programs by adding new “features”. — Doug McIlroy, “UNIX
Time-Sharing System”
</p>
</blockquote>

<p>
I would like to suggest that Emacs is actually a <i>better</i> manifestation of the
Unix Philosophy.  The ideal Unix system consists of many small programs written
mainly in C, run by the kernel; Emacs consists of many <i>functions</i> written mainly
in Elisp, any of which will be even smaller than the smallest Unix programs, run
by the Lisp kernel.
</p>

<p>
Ideal Unix programs are composable via pipes: the output of one program can be
the input to another.  Emacs Lisp functions are inherently composable.
</p>

<p>
Unix programmers are exhorted to “write programs to handle text streams, because
that is a universal interface.”  Flat text streams are just a stream of
bytes with at best a minimal two-dimensional structure of lines of characters;
any additional structure has to be imposed on that.  But there’s no standard for
any extra structure, and so every program comes up with something different
(colon-separated fields?  CSV?  XML?  JSON?).  Even in 1978 McIlroy felt the
need to warn the programmer not to “clutter output with extraneous information”
and “avoid stringently columnar or binary input formats” in attempt to mitigate
the problem.
</p>

<p>
Calling an Emacs function is of course <i>much</i> lighter-weight than forking and
exec’ing even the smallest compiled C program, and all the programs in a
pipeline need to parse and re-parse each others flat text data over and over.
In contrast, Elisp functions all share a single, recursive tree-structured data
format that doesn’t need to be parsed in between the “pipelines” of functions.
</p>

<p>
Emacs consistently excels at meeting other precepts of the Philosophy:
</p>

<ul>
<li>“Don’t insist on interactive input” (McIlroy).  Elisp interactive commands can
always be composed with non-interactive functions.</li>
<li>“Design and build software, even operating systems, to be tried early, ideally
within weeks.  Don’t hesitate to throw away the clumsy parts and rebuild
them” (McIlroy).  The Emacs user is continually modifying their system as they work.</li>
<li>“Use tools in preference to unskilled help to lighten a programming task, even
if you have to detour to build the tools”  (McIlroy).  Nothing could be more
of an Emacs cliché than devoting time to building and enhancing tools!</li>
<li>“Self-supporting system: all Unix software is maintained under Unix” (Thompson
&amp; Ritchie).  Emacs is developed and maintained inside of Emacs, including
documentation, debuggers, and packaging.</li>
<li>“Make it easy to write, test, and run programs” (Thompson &amp; Ritchie).  Any
Elisp function that throws an error can pop you directly into the ever-present
built-in debugger; the entire state of Emacs at the moment of the error is
introspectable; and you can fix the bug and continue your work without so much
as restarting.</li>
<li>“Write abstract programs that generate code instead of writing code by hand”
(Raymond).  Lisp programming at its most advanced is all about writing Lisp
code to generate Lisp code (via macros); see Graham and Hoyte.</li>
<li>“Write flexible and open programs” (Raymond).  Elisp programs are customizable
via the <a href="#org27e6769">Customize Facility</a>, and their behavior can be changed by Buffer Local
Variables, dynamic binding, and function advice (see <a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Advising-Functions">“Advising Functions”</a> in the <i>Elisp</i> manual).</li>
</ul>

<p>
A key innovation of Unix was the interactive shell that allowed users to glue
programs together interactively, and to easily make new programs out of shell
scripts.  Emacs is a shell for Elisp functions, without the disadvantages of
shell scripts—the difficulties of quoting and the dangers of rescanning
commands, weak error handling, poor data structures, poor portability,
and inefficient execution due to a lack of compilation.
</p>
</div>
<div id="outline-container-org22bc734">
<h5 id="org22bc734">References</h5>
<div id="text-org22bc734">
<ul>
<li>Graham, Paul. 1994. <i>On Lisp: Advanced Techniques for Common Lisp.</i> Englewood Cliffs, NJ: Prentice Hall..</li>
</ul>


<ul>
<li>Hoyte, Doug. 2008. <i>Let Over Lambda: 50 Years of Lisp.</i> <a href="https://letoverlambda.com/">https://letoverlambda.com/</a>.</li>
</ul>


<ul>
<li>McIlroy, M.D., E.N. Pinson and B.A. Tague. July-August 1978. “UNIX Time-Sharing System: Forward.” <i>Bell System Technical Journal</i> 57, no. 6: 1899-1904. <a href="https://archive.org/details/bstj57-6-1899/page/n1/mode/2up">https://archive.org/details/bstj57-6-1899/page/n1/mode/2up</a>.</li>
</ul>


<ul>
<li>Raymond, Eric S,. 2004. <i>The Art of Unix Programming.</i> Boston: Addison-Wesley..</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org681449c">
<h4 id="org681449c"><span>UNFINISHED</span> Compilation Mode and its Many Descendants <a id="orga92f8d1"></a></h4>
</div>

<div id="outline-container-orgc4fbf5d">
<h4 id="orgc4fbf5d"><a id="orgc715b4b"></a> The Great Sentence-Ending Controversy</h4>
<div id="text-orgc4fbf5d">
<blockquote>
<p>
“Typing two spaces after a period is totally, completely, utterly, and
inarguably wrong,” Farhad Manjoo wrote in <a href="http://www.slate.com/articles/technology/technology/2011/01/space_invaders.html">Slate</a> in 2011.  “You can have my
double space when you pry it from my cold, dead hands,” Megan McArdle wrote in
<a href="https://www.theatlantic.com/entertainment/archive/2011/01/you-can-have-my-double-space-when-you-pry-it-from-my-cold-dead-hands/69592/">the Atlantic</a> the same year. — Avi Selk
</p>
</blockquote>
<p>
The Emacs default of ending sentences with two spaces comes from the era of
typewriters: in the monospace font of the typewriter, two spaces made sentence
endings easier to see and improved readability.  In the early days of computing,
anything you looked at on a terminal screen or printed from a computer would
come out in a monospace font, too.
</p>

<p>
Nowadays, most of the computer-generated text that we read is digitally typeset
and formatted with proportional fonts for a web browser or a PDF viewer.  When
you generate text like this from Emacs (say, via <a href="#org4a851ca">Org Mode</a>), it doesn’t matter at
all how many spaces you put after your periods, or even between words: the
typesetting process will arrange for an appropriate amount of spacing.  So
spaces after sentences only affect motion and paragraph filling (also not
usually a concern when you’re typesetting).
</p>

<p>
If you’re in the habit of using two spaces, like Megan and I, the Emacs <a href="#org0fca16b">sentence
commands</a> are ready for you.  If you’re a one-spacer like Farhad, you can set
  <code>sentence-end-double-space</code> to <code>nil</code> in your <a href="#org2af3730">Init File</a>:
</p>
<div>
<pre>(<span>setq</span> sentence-end-double-space nil)
</pre>
</div>
<p>
but note that the sentence commands will then have to assume abbreviations (e.g. “e.g.”)
end your sentences, making the commands less useful.  Which is why I use two spaces.
</p>

<p>
If you’re a two-spacer, you will find yourself facing a lot of one-spaced
sentences as you edit other people’s files, emails, and the like.  In this
situation,   <code>M-x</code> <code>repunctuate-sentences</code> is a lifesaver: it will convert
these sentences to the more useful two-space format.
</p>
</div>
</div>
<div id="outline-container-orgfcf48eb">
<h4 id="orgfcf48eb"><span>UNFINISHED</span> Install Emacs on ChromeOS <a id="org8e6858e"></a></h4>
<div id="text-orgfcf48eb">
<p>
Chrome OS now runs Linux in a VM, and the Emacs you install there is the real
thing (though not the latest version).  Once you’ve installed and fired it up,
Emacs can be run from the launch bar like any other ChromeOS app.
</p>

<p>
Installing Emacs on a (post-2018) Chromebook is easy but there are a few steps.
</p>

<p>
Go to Settings and in the Device tab, click on “Linux (Beta)”, then “Turn on”.
</p>

<p>
Click “Install” in the pop-up dialog (the defaults are probably fine).
</p>

<p>
If after installation completes, a Linux terminal window does not appear, click
on the new Unix Prompt (“&gt;_”) icon in the launch bar (or, if that’s missing,
fire up the Terminal app from the launcher) and wait for the VM to start up.
</p>

<p>
At the shell prompt in the VM window, run:
</p>
<div>
<pre>sudo apt update
sudo apt uprade
sudo apt install emacs25
</pre>
</div>

<p>
Now run Emacs from the shell prompt:
</p>
<pre>emacs
</pre>


<p>
With Emacs running, you should see a new icon for it in the launch
bar (a script “E”); Alt-click on the icon and select “pin” from the menu.
Just to make sure everything’s working, exit Emacs (click the
“X” in the window’s title bar (or use     <code>C-x C-c</code> (﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Exiting"><code>save-buffers-kill-terminal</code></a>﻿)).
You can minimize the Linux shell window.
</p>

<p>
Click the icon to start up a new Emacs.  You can start Emacs like
this in the future; it will start up the Linux VM if necessary
(which makes the first start-up after a reboot pretty slow).
</p>

<p>
If you have Linux skills, you can fiddle with the package manager to
get a more up-to-date version of Emacs.
</p>

<p>
The biggest problem is not with the Emacs per se; it’s that the VM’s file system
and the Chrome OS file system are mostly separate.  If Chrome is your only
machine, no problem (you can backup your data manually via Settings / Linux
(Beta)).
</p>

<p>
But if your Chromebook is just one of several machines, and you want
to clone your config from another OS, you’ll have to jump through some
hoops, either loading it from a web URL, or via Tramp from a host on
the network, or synchronize it via <code>rsync(1)</code>, <code>unison(1)</code>, or the like.
Syncing at the file system level is also possible with <code>syncthing(1)</code>,
<code>sshfs(1)</code>, or any of many other tools.  The same thing goes for your
data.
</p>
</div>
</div>
<div id="outline-container-org8e15afa">
<h4 id="org8e15afa">The Famous Canards <a id="org81d2eb2"></a></h4>
<div id="text-org8e15afa">
<p>
Many people will argue that you shouldn’t use Emacs.
</p>

<p>
One of the oldest arguments is that Emacs is too big; an old saw goes:
</p>
<blockquote>
<p>
EMACS: Eight Megabytes And Constantly Swapping<sup><a id="fnr.367" href="#fn.367" role="doc-backlink">367</a></sup>
</p>
</blockquote>
<p>
but this dates from days of old when 8M was a <i>lot</i> of memory.  Nowadays, that’s
about the size of one pop song in digital form.  A modern Emacs takes 26M (52M
graphical) of memory; that’s a mere 3% of the space my web browser is using at this
moment, and in <a href="#org22671bb">Client / Server</a> usage, this is the only instance of Emacs that
will be running on your 8G laptop.
</p>

<p>
Another argument is that Emacs takes too long to start up.  On my
10-year-old laptop, it starts up in 0.1 seconds (0.5
graphical), which I think is plenty fast enough.  If you heavily customize your
Emacs and don’t take care to make your customizations lazy, you can indeed
achieve much slower startup times (perhaps on the order of several
seconds — with my 1,120-line <a href="#org2af3730">Init File</a> it takes 2.4 seconds to start).  Since
I run the Emacs server, I only pay this cost once, just after I’ve rebooted;
then I can connect to the server, from various terminals and shells, with the
Emacs client in less than 0.01 seconds.  See <a href="#org22671bb">Client / Server</a>.
</p>
</div>
</div>

<div id="outline-container-org961f8d0">
<h4 id="org961f8d0">The Troublesome Meta Key <a id="orgdf13a75"></a>  <a id="orgb48c40d"></a></h4>
<div id="text-org961f8d0">
<p>
The Meta key is a <i>modifier key</i> which works exactly like a Control key or a Shift
key in that it generates no character by itself, but rather modifies another
key struck while it’s being held down.
</p>

<p>
What key is the Meta key?  On “standard” keyboards, it will be either the Alt
key or the <a href="https://en.wikipedia.org/wiki/Windows_key">Windows</a> key.  On Apple keyboards, it will be either the Option
key or the Command key.  You’ll just have to try them and see!
</p>

<p>
Fire up Emacs with <code>emacs --no-splash</code>.  Type a word, and then type <code>Alt-b</code> using
the Alt key.  If your cursor moves backwards to the beginning of the word you
just typed, Alt is your Meta!  If not, try <code>Windows-b</code> using the Windows key; this
should work, and indicates that Windows is your Meta.  Likewise for Command and
Option on a Mac keyboard.
</p>

<p>
Other programs can steal the Meta key; for example, your X window manager might
be using it for its own purposes, in which case Emacs may never see you type
it.  When this happens, you either have to change Emacs’s notion of the meta
key, or change the window manager’s notion of <i>its</i> key.
</p>

<p>
You can also change which key Emacs uses as Meta for any reason (either
necessity or if another key just feels better to you).  Whichever key turns out
to be your Meta, the <i>other</i> key is known as the <i>Super</i> key.  If your Meta is Alt
(Command), your Super is probably the Windows key (Option key).  On Unix systems
running X11, the Super key is usually used to control your window manager,
leaving Meta for Emacs (unless you choose to swap them).
</p>

<p>
For more help solving Meta key problems, see <a href="https://www.emacswiki.org/emacs/MetaKeyProblems">the Emacs Wiki</a>.<sup><a id="fnr.368" href="#fn.368" role="doc-backlink">368</a></sup>
</p>
</div>
</div>

<div id="outline-container-org7a1e474">
<h4 id="org7a1e474">The <code>ESC</code> Prefix <a id="org9c96f37"></a></h4>
<div id="text-org7a1e474">
<p>
There’s one other prefix command that’s both very important and completely
redundant: the <code>ESC</code> prefix.  This is the key labeled “esc” on your keyboard; that
key lets you type the ASCII Escape (which is a control character: actually it’s
exactly the same character sent by <code>C-[</code>, so you can type that if you prefer).
</p>

<p>
As described above, not all keyboards provide a suitable Meta key, or it may be
reserved or stolen by your desktop or the operating system.  If this applies to
you, all is not lost.  You just use the <code>ESC</code> key instead.  <code>M-a</code> becomes <code>ESC a</code>;
<code>C-M-f</code> becomes <code>ESC C-f</code> (remember the equivalence of <code>C-M-f</code> and <code>M-C-f</code> and this will
make sense).<sup><a id="fnr.369" href="#fn.369" role="doc-backlink">369</a></sup>
</p>

<p>
There’s only one trick: <code>ESC</code> is actually an ASCII character, not a shift-like
modifier key.  If you type Alt, say, without then typing another key
simultaneously, nothing happens: Emacs doesn’t see that you hit Alt.  No key
code is sent to Emacs at all.  But when you hit <code>ESC</code>, you’ve immediately sent the
ASCII Escape character to Emacs.  It’s just like hitting <code>Z</code> or <code>*</code>.  This means that
you don’t try to hold down <code>ESC</code> at the same time as the other key: use it as a
prefix character and type it separately and distinctly.
</p>

<p>
A true Meta is a wonderful thing for Emacs (it makes typing much faster), but I
used ESC for years.  (When Emacs was born in 1976, hardly any keyboard had any
modifier key besides Control and Shift, and everybody used <code>ESC</code>.)
</p>
</div>
</div>

<div id="outline-container-org13ca444">
<h4 id="org13ca444"><span>UNFINISHED</span> Emacs on Your Phone <a id="orgdbf8f55"></a></h4>

<p id="outline-container-org1212c02">
<h5 id="org1212c02">Org Mode on Your Phone</h5>
</p>
</div>
<div id="outline-container-org6edd19b">
<h4 id="org6edd19b">An Initial Init File <a id="org76237ea"></a></h4>
<div id="text-org6edd19b">
<p>
Throughout this book I’ve given a number of recommended snippets for a minimal
Init File designed for a beginning Emacs user following along with the text.
All these snippets are gathered together in this appendix.  You can download them as a
usable Init File <a href="https://www2.lib.uchicago.edu/keith/emacs/init.el">here</a>.
</p>

<p>
Remember that this Init File is designed in accordance with <a href="#orgceb37e2">my notion</a> that you
should learn Emacs with as few changes from the defaults as possible.  This is
definitely not the Init File that I use (mine is 13 times
as large)!  If you start with this one, you’ll slowly change it to suit your
needs and preferences and, eventually, will no longer recognize it!
</p>

<p>
Ask Emacs where to install this file with <code>C-h v user-emacs-directory</code>; this will
give you the path to a correct directory; make sure that directory exists, and
install the Init File in it, named “<code>init.el</code>”.  On Unix systems, you can use
<code>~/.emacs.d/init.el</code>, but under other OS’s you should check.  See
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Init-File">“Init File”</a> in the <i>Emacs</i> manual if there’s any confusion.
</p>

<p>
If you already have your own Init File, you don’t have to replace it.  Instead,
download the Init File to your <code>user-emacs-directory</code>, renaming the file to, say,
<code>use-gnu-emacs.el</code>, and now you can simply add this line to your existing Init File to
include my recommendations:
</p>
<div>
<pre>(<span>with-demoted-errors</span> <span>&#34;%S&#34;</span> (load-file (concat user-emacs-directory <span>&#34;use-gnu-emacs.el&#34;</span>)))
</pre>
</div>

<p>
If you add this line at the beginning of your existing Init File, the rest of
your Init File will trump any conflicting settings; vice-versa if you add this
line at the end.
</p>
</div>
<div id="outline-container-org7a7cd69">
<h5 id="org7a7cd69">The Init File</h5>
<div id="text-org7a7cd69">
<div>
<pre><span>;; </span><span>Recommended minimal starting Emacs Init File</span>
<span>;; </span><span>extracted from the book:</span>
<span>;; </span><span>/Use GNU Emacs: The Plain Text Computing Environment/</span>
<span>;; </span><span>by Keith Waclena</span>
<span>;; </span><span>https://www2.lib.uchicago.edu/keith/emacs/</span>
<span>;;</span>
(<span>require</span> &#39;<span>package</span>)


<span>;; </span><span>thanks to an anonymous EmacsWiki coder</span>
(<span>defun</span> <span>undo-yank</span> (arg)
  <span>&#34;Undo the yank you just did.  Really, adjust just-yanked text</span>
<span>like \\[</span><span>yank-pop</span><span>] does, but in the opposite direction.&#34;</span>
  (<span>interactive</span> <span>&#34;p&#34;</span>)
  (yank-pop (- arg)))
(global-set-key (kbd <span>&#34;C-M-Y&#34;</span>) &#39;undo-yank)

(<span>setq</span> enable-recursive-minibuffers t)

(<span>with-eval-after-load</span> &#39;chistory
  (<span>setq</span> list-command-history-max 120)
  (define-key command-history-map (kbd <span>&#34;&lt;return&gt;&#34;</span>) &#39;command-history-repeat))

(<span>setq</span> completion-styles &#39;(partial-completion substring flex))
(<span>unless</span> (package-installed-p &#39;vertico)
  (<span>with-demoted-errors</span> <span>&#34;%s&#34;</span>
    (<span>unless</span> package-archive-contents
      (package-refresh-contents))
    (package-install &#39;vertico)))
(<span>with-demoted-errors</span> <span>&#34;%s&#34;</span> (vertico-mode +1))

(<span>unless</span> (package-installed-p &#39;marginalia)
  (<span>with-demoted-errors</span> <span>&#34;%s&#34;</span>
    (<span>unless</span> package-archive-contents
      (package-refresh-contents))
    (package-install &#39;marginalia)))
(<span>with-demoted-errors</span> <span>&#34;%s&#34;</span> (marginalia-mode +1))

(<span>unless</span> (package-installed-p &#39;windmove)
  (<span>with-demoted-errors</span> <span>&#34;%s&#34;</span>
    (<span>unless</span> package-archive-contents
      (package-refresh-contents))
    (package-install &#39;windmove)))
<span>;; </span><span>&lt;S-{left,right,up,down}&gt; switches windows</span>
(<span>with-demoted-errors</span> <span>&#34;%s&#34;</span> (windmove-default-keybindings))

(winner-mode 1)                       <span>; </span><span>undo window config changes</span>
<span>;; </span><span>add more felicitous bindings</span>
(define-key winner-mode-map [(control c) (control left)] &#39;winner-undo)
(define-key winner-mode-map [(control c) (control right)] &#39;winner-redo)

(global-set-key (kbd <span>&#34;C-{&#34;</span>) &#39;shrink-window-horizontally)
(global-set-key (kbd <span>&#34;C-}&#34;</span>) &#39;enlarge-window-horizontally)
(global-set-key (kbd <span>&#34;C-^&#34;</span>) &#39;enlarge-window)

(global-set-key (kbd <span>&#34;C-&lt;&#34;</span>) &#39;scroll-left)
(global-set-key (kbd <span>&#34;C-&gt;&#34;</span>) &#39;scroll-right)

(<span>setq</span> large-file-warning-threshold (* 100 1024 1024)) <span>; </span><span>100MB</span>

(<span>when</span> (version&lt;= <span>&#34;27.1&#34;</span> emacs-version)  <span>; </span><span>only available recently...</span>
  (global-so-long-mode +1))    <span>; </span><span>speed up long lines</span>

(<span>setq</span> view-read-only t)

(add-hook &#39;doc-view-mode-hook &#39;auto-revert-mode)

(add-hook &#39;pdf-view-mode-hook &#39;auto-revert-mode)

(add-hook &#39;dired-load-hook (<span>lambda</span> () (<span>require</span> &#39;<span>dired-x</span>)))

(<span>setq</span> dired-dwim-target t)  <span>; </span><span>suggest other visible dired buffer</span>

(<span>unless</span> (package-installed-p &#39;wgrep)
  (<span>with-demoted-errors</span> <span>&#34;%s&#34;</span>
    (<span>unless</span> package-archive-contents
      (package-refresh-contents))
    (package-install &#39;wgrep)))

(add-hook &#39;kill-emacs-query-functions
          &#39;custom-prompt-customize-unsaved-options)

(<span>when</span> (&lt; emacs-major-version 24)
  <span>;; </span><span>For important compatibility libraries like cl-lib</span>
  (add-to-list &#39;package-archives &#39;(<span>&#34;gnu&#34;</span> . <span>&#34;https://elpa.gnu.org/packages/&#34;</span>)))
(<span>when</span> (version&lt; emacs-version <span>&#34;26.3&#34;</span>)
  <span>;; </span><span>older emacsen &lt; 26.3 may need this</span>
  (<span>setq</span> gnutls-algorithm-priority <span>&#34;NORMAL:-VERS-TLS1.3&#34;</span>))
(<span>with-eval-after-load</span> &#39;package
  (<span>dolist</span> (arc &#39;((<span>&#34;nongnu&#34;</span> . <span>&#34;https://elpa.nongnu.org/nongnu/&#34;</span>)
                 (<span>&#34;melpa-stable&#34;</span> . <span>&#34;https://stable.melpa.org/packages/&#34;</span>)
                 (<span>&#34;melpa&#34;</span> . <span>&#34;https://melpa.org/packages/&#34;</span>)))
    (add-to-list &#39;package-archives arc t))
  (<span>setq</span> package-archive-priorities
        &#39;((<span>&#34;gnu&#34;</span> . 10) (<span>&#34;nongnu&#34;</span> . 9) (<span>&#34;melpa-stable&#34;</span> . 8) (<span>&#34;melpa&#34;</span> . 7))))

(desktop-save-mode 1)   <span>; </span><span>restore files from previous session</span>

(<span>defun</span> <span>kw-filename-to-register</span> (filename register)
  <span>&#34;Store a filename in a register.</span>
<span>Interactively, if a prefix arg, prompt for FILENAME.  With no</span>
<span>prefix arg, use `</span><span>ffap-file-at-point</span><span>&#39; to get the filename at point; if</span>
<span>that fails, use the buffer file name; if there is none, prompt for the</span>
<span>filename.  Reads the REGISTER using ‘</span><span>register-read-with-preview</span><span>’.&#34;</span>
  (<span>interactive</span>
   (list
    (<span>setq</span> filename
          (<span>if</span> current-prefix-arg
              (read-file-name <span>&#34;Filename: &#34;</span>)
            (<span>or</span>
             (<span>progn</span>
               (<span>require</span> &#39;<span>ffap</span>)
               (ffap-file-at-point))
             (buffer-file-name)
             (read-file-name <span>&#34;Filename: &#34;</span>))))
    (register-read-with-preview
     (format <span>&#34;Filename %s to register: &#34;</span> filename))))
  (set-register register `(file . ,filename)))
 (global-set-key (kbd <span>&#34;C-x r C-f&#34;</span>) &#39;kw-filename-to-register)

(save-place-mode 1)   <span>; </span><span>come back to where we were in that file</span>

(global-set-key (kbd <span>&#34;C-+&#34;</span>) &#39;text-scale-adjust) <span>; </span><span>embiggen font</span>

(<span>setq-default</span> indent-tabs-mode nil)      <span>; </span><span>don&#39;t insert tabs</span>

(<span>defun</span> <span>ue-auto-selective-display</span> (arg)
  <span>&#34;Hide lines with greater indentation than this one.</span>
<span>With a prefix ARG, reveal all lines.</span>
<span> This function simply sets `</span><span>selective-display</span><span>&#39;.&#34;</span>
  (<span>interactive</span> <span>&#34;P&#34;</span>)
  (<span>if</span> arg
      (<span>setq</span> selective-display nil)
    (<span>save-match-data</span>
      (<span>save-excursion</span>
        (forward-line 0)
        (<span>if</span> (looking-at (<span>rx</span> (+ space)))
            (<span>setq</span> selective-display (1+ (length (match-string 0))))
          (<span>setq</span> selective-display 1))))))

(<span>setq</span> async-shell-command-buffer &#39;new-buffer) <span>;</span><span>multiple async commands ok!</span>
(<span>setq</span> async-shell-command-display-buffer nil) <span>;</span><span>don&#39;t pop up the buffer</span>

(<span>setq</span> comint-buffer-maximum-size 65336) <span>; </span><span>must be able to cat War and Peace!</span>
(add-hook &#39;comint-output-filter-functions &#39;comint-truncate-buffer)

<span>;; </span><span>goto-address-mode is handy in these modes</span>
(<span>dolist</span> (hook &#39;(shell-mode-hook eshell-mode-hook))
  (add-hook hook #&#39;goto-address-mode))
(add-hook &#39;prog-mode-hook #&#39;goto-address-prog-mode)

(<span>setq</span> calendar-mark-holidays-flag t        <span>; </span><span>colorize holidays in the calendar</span>
      calendar-mark-diary-entries-flag t)  <span>; </span><span>also diary entries</span>

(<span>setq</span> org-agenda-include-diary t)  <span>; </span><span>incorporate the diary into the agenda</span>

(appt-activate +1)        <span>; </span><span>appointment notifications, please</span>
(<span>require</span> &#39;<span>notifications</span>)  <span>; </span><span>also via desktop notifications</span>

<span>;; </span><span>don&#39;t use a separate Frame for the control panel</span>
(<span>setq</span> ediff-window-setup-function &#39;ediff-setup-windows-plain)
<span>;; </span><span>horizontal split is more readable</span>
(<span>setq</span> ediff-split-window-function &#39;split-window-horizontally)

<span>;; </span><span>restore window config upon quitting ediff</span>
(<span>defvar</span> <span>ue-ediff-window-config</span> nil <span>&#34;Window config before ediffing.&#34;</span>)
(add-hook &#39;ediff-before-setup-hook
          (<span>lambda</span> ()
            (<span>setq</span> ue-ediff-window-config (current-window-configuration))))
(<span>dolist</span> (hook &#39;(ediff-suspend-hook ediff-quit-hook))
  (add-hook hook
            (<span>lambda</span> ()
              (set-window-configuration ue-ediff-window-config))))
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org7d4d555">
<h3 id="org7d4d555">Bibliography <a id="orgd801ff7"></a></h3>
<div id="text-org7d4d555">
<ul>
<li><p>
Abelson, Harold, Gerald Jay Sussman, Julie Sussman, Lytha Ayth and Neil Van Dyke. 1996. <i>Structure and Interpretation of Computer Programs, Second Edition.</i> Cambridge, MA: MIT Press. <a href="https://www.neilvandyke.org/sicp-texi/">https://www.neilvandyke.org/sicp-texi/</a>
</p>

<p>
The famous Wizard Book, converted to Texinfo by Lytha Ayth and Neil Van Dyke.  Install this and you can read the book in Emacs with hyperlinks, indexing, full-text search Emacs-style, easy-to-evaluate Scheme code, and last but not least, ASCII diagrams.
</p></li>
</ul>


<ul>
<li><p>
Ashley, Mike. 1999. <i>The GNU Privacy Handbook.</i> Cambridge, MA: Free Software Foundation. <a href="https://www.gnupg.org/documentation/guides.html">https://www.gnupg.org/documentation/guides.html</a>
</p>

<p>
A tutorial introduction to GNU Privacy Guard (a.k.a. GnuPG or GPG).  Emacs can use GnuPG to work transparently with encrypted files.
</p></li>
</ul>


<ul>
<li><p>
Auerbach, David. May 9, 2014. “The Oldest Rivalry in Computing.” <i>Slate</i>. <a href="https://slate.com/technology/2014/05/oldest-software-rivalry-emacs-and-vi-two-text-editors-used-by-programmers.html">https://slate.com/technology/2014/05/oldest-software-rivalry-emacs-and-vi-two-text-editors-used-by-programmers.html</a>
</p>

<p>
An excellent overview of the perennial Editor Wars and the bitter Emacs / Vi rivalry.
</p></li>
</ul>


<ul>
<li><p>
Ballantyne, Tony. 2018. <i>My Emacs Writing Setup.</i> <a href="https://www.tonyballantyne.com/EmacsWritingTips.html">https://www.tonyballantyne.com/EmacsWritingTips.html</a>
</p>

<p>
Good companion to Wood’s <i>Guide to Emacs for Writers</i>, this one by a novelist, with lots of Org Mode tips.
</p></li>
</ul>


<ul>
<li><p>
Batsov, Bozhidar. 2011. <i>Why Emacs?</i> <a href="https://batsov.com/articles/2011/11/19/why-emacs/">https://batsov.com/articles/2011/11/19/why-emacs/</a>
</p>

<p>
A nice testimonial from the author of the Emacs Prelude starter kit.
</p></li>
</ul>


<ul>
<li><p>
Borkowski, Marcin. 2018. “TEXing in Emacs.” <i>TUGboat</i> 39, no. 1. <a href="https://www.tug.org/TUGboat/tb39-1/tb121borkowski-emacs.pdf">https://www.tug.org/TUGboat/tb39-1/tb121borkowski-emacs.pdf</a>
</p>

<p>
An introduction to Emacs for TeX and LaTeX users, including Org Mode and a little Elisp programming.
</p></li>
</ul>


<ul>
<li><p>
Cameron, Debra, James Elliott, Marc Loy, Eric S. Raymond and Bill Rosenblatt. 2004. <i>Learning GNU Emacs, 3rd Edition.</i> Sebastopol, CA: O’Reilly Media. <a href="https://www.oreilly.com/library/view/learning-gnu-emacs/0596006489/">https://www.oreilly.com/library/view/learning-gnu-emacs/0596006489/</a>
</p>

<p>
Very out-of-date, but not uselessly so; covers Emacs version 21.3.  A typical O’Reilly manual.
</p></li>
</ul>


<ul>
<li><p>
Chassell, Robert J. 2020. <i>An Introduction to Programming in Emacs Lisp.</i> Cambridge, MA: Free Software Foundation. <a href="https://www.gnu.org/software/emacs/manual/eintr.html">https://www.gnu.org/software/emacs/manual/eintr.html</a>
</p>

<p>
Read in Emacs with <code>M-x info-display-manual RET eintr RET</code>.
</p>

<p>
A tutorial introduction to Elisp “written as an elementary introduction for people who are not programmers”.  Designed to be read in Info, where you can evaluate and run all the code examples.
</p></li>
</ul>


<ul>
<li><p>
Chua, Sacha. 2016. <i>How to Learn Emacs: A Hand-drawn One-pager for Beginners.</i> <a href="https://sachachua.com/blog/2013/05/how-to-learn-emacs-a-hand-drawn-one-pager-for-beginners/">https://sachachua.com/blog/2013/05/how-to-learn-emacs-a-hand-drawn-one-pager-for-beginners/</a>
</p>

<p>
A sketch-guide to the very basics.
</p></li>
</ul>


<ul>
<li>Finseth, Craig A. 1991. <i>The Craft of Text Editing, or, A Cookbook for an Emacs.</i> Berlin: Springer-Verlag. <a href="http://www.finseth.com/craft/">http://www.finseth.com/craft/</a></li>
</ul>


<ul>
<li><p>
Free Software Foundation. 2021. <i>Comparing and Merging Files.</i> Cambridge, MA: Free Software Foundation. <a href="https://www.gnu.org/software/diffutils/manual/diffutils.html">https://www.gnu.org/software/diffutils/manual/diffutils.html</a>
</p>

<p>
Read in Emacs with <code>M-x info-display-manual RET diffutils RET</code>.
</p>

<p>
Complete documentation for the GNU diff, diff3, cmp, and sdiff programs.
</p></li>
</ul>


<ul>
<li><p>
Free Software Foundation. 2022. <i>Emacs auth-source.</i> Cambridge, MA: Free Software Foundation. <a href="https://www.gnu.org/software/emacs/manual/auth.html">https://www.gnu.org/software/emacs/manual/auth.html</a>
</p>

<p>
Read in Emacs with <code>M-x info-display-manual RET auth RET</code>.
</p>

<p>
Centralized management of authentication information (usernames, hosts, passwords) via any of several backends; used by most Emacs applications that need to connect to external services (Tramp, Gnus, GnuPG, etc).
</p></li>
</ul>


<ul>
<li><p>
Free Software Foundation. 2022. <i>Message.</i> Cambridge, MA: Free Software Foundation.
</p>

<p>
Read in Emacs with <code>M-x info-display-manual RET message RET</code>.
</p>

<p>
Documents the Emacs email message composition mode, used to compose emails (or, if you go back in time, news postings).
</p></li>
</ul>


<ul>
<li><p>
Free Software Foundation. 2022. <i>Emacs Unified Directory Client.</i> Cambridge, MA: Free Software Foundation.
</p>

<p>
Read in Emacs with <code>M-x info-display-manual RET eudc RET</code>.
</p>

<p>
Documents the Emacs Unified Directory Client, an interface to directory services (LDAP) and contacts (BBDB, macOS Contacts).
</p></li>
</ul>


<ul>
<li><p>
Free Software Foundation. 2022. <i>TRAMP User Manual.</i> Cambridge, MA: Free Software Foundation.
</p>

<p>
Read in Emacs with <code>M-x info-display-manual RET tramp RET</code>.
</p>

<p>
Documents the remote file editing capabilities of Emacs.
</p></li>
</ul>


<ul>
<li><p>
Free Software Foundation. 2017. <i>The GNU Privacy Guard Manual.</i> Cambridge, MA: Free Software Foundation.
</p>

<p>
Read in Emacs with <code>M-x info-display-manual RET gnupg RET</code>.
</p>

<p>
The complete documentation for GnuPG.
</p></li>
</ul>


<ul>
<li><p>
Free Software Foundation. 2020. <i>Emms Manual.</i> Cambridge, MA: Free Software Foundation.
</p>

<p>
Read in Emacs with <code>M-x info-display-manual RET emms RET</code>.
</p>

<p>
Documentation for the Emacs Multimedia System (in short, music player), EMMS.
</p></li>
</ul>


<ul>
<li><p>
Free Software Foundation. 2020. <i>EWW.</i> Cambridge, MA: Free Software Foundation. <a href="https://www.gnu.org/software/emacs/manual/eww.html">https://www.gnu.org/software/emacs/manual/eww.html</a>
</p>

<p>
Read in Emacs with <code>M-x info-display-manual RET eww RET</code>.
</p>

<p>
Documentation for the Emacs web browser, EWW.
</p></li>
</ul>


<ul>
<li><p>
Free Software Foundation. 2020. <i>Ediff.</i> Cambridge, MA: Free Software Foundation. <a href="https://www.gnu.org/software/emacs/manual/ediff.html">https://www.gnu.org/software/emacs/manual/ediff.html</a>
</p>

<p>
Read in Emacs with <code>M-x info-display-manual RET ediff RET</code>.
</p>

<p>
Complete documentation for the powerful Ediff family of diffing and merging tools.
</p></li>
</ul>


<ul>
<li><p>
Free Software Foundation. 2020. <i>Interactive Do.</i> Cambridge, MA: Free Software Foundation. <a href="https://www.gnu.org/software/emacs/manual/ido.html">https://www.gnu.org/software/emacs/manual/ido.html</a>
</p>

<p>
Read in Emacs with <code>M-x info-display-manual RET ido RET</code>.
</p>

<p>
Documents the Ido completion framework.
</p></li>
</ul>


<ul>
<li><p>
Free Software Foundation. 2020. <i>Autotyping.</i> Cambridge, MA: Free Software Foundation. <a href="https://www.gnu.org/software/emacs/manual/autotype.html">https://www.gnu.org/software/emacs/manual/autotype.html</a>
</p>

<p>
Read in Emacs with <code>M-x info-display-manual RET autotype RET</code>.
</p>

<p>
One of the often overlooked Emacs manuals, documenting convenient features for text that you enter frequently in Emacs, such as expanded text templates (via Skeletons), file boilerplate, copyright statements, timestamps, URLs, and the like.
</p></li>
</ul>


<ul>
<li><p>
Free Software Foundation. 2020. <i>GNU Emacs Reference Card.</i> Cambridge, MA: Free Software Foundation. <a href="https://www.gnu.org/software/emacs/refcards/index.html">https://www.gnu.org/software/emacs/refcards/index.html</a>
</p>

<p>
A classic-style, one-page, double-sided, tri-fold reference card for your vest pocket (slip behind your pocket protector); available in eight languages.  The digital version is up-to-date, but the printed (on card stock) version is currently stuck at v25.  (At the level of detail covered in card form, it can be pretty out-of-date and still be perfectly fine.)  At the URL there are also refcards for Calc, Dired, Gnus, Org, and more.
</p></li>
</ul>


<ul>
<li><p>
Free Software Foundation. 2020. <i>The Org Manual.</i> Cambridge, MA: Free Software Foundation. <a href="https://www.gnu.org/software/emacs/manual/org.html">https://www.gnu.org/software/emacs/manual/org.html</a>
</p>

<p>
Read in Emacs with <code>M-x info-display-manual RET org RET</code>.
</p>

<p>
The authoritative reference on Org Mode.
</p></li>
</ul>


<ul>
<li><p>
Friedl, Jeffrey E. F. 2002. <i>Mastering Regular Expressions.</i> Sebastopol, CA: O’Reilly.
</p>

<p>
The standard book-length work on using regular expressions.
</p></li>
</ul>


<ul>
<li><p>
Gillespie, Dave. 2020. <i>The GNU Emacs Calculator.</i> Cambridge, MA: Free Software Foundation. <a href="https://www.gnu.org/software/emacs/manual/calc.html">https://www.gnu.org/software/emacs/manual/calc.html</a>
</p>

<p>
Read in Emacs with <code>M-x info-display-manual RET calc RET</code>.
</p>

<p>
Extensive documentation for the powerful Emacs calculator and computer algebra system.
</p></li>
</ul>


<ul>
<li><p>
Glickstein, Bob. 1997. <i>Writing GNU Emacs Extensions.</i> Sebastopol, CA: O’Reilly Media.
</p>

<p>
Probably describes Emacs version 19, so very out of date, but may still be useful.  Covers Emacs customization in the init file, and implementing things like major and minor modes.
</p></li>
</ul>


<ul>
<li>Graham, Paul. 1994. <i>On Lisp: Advanced Techniques for Common Lisp.</i> Englewood Cliffs, NJ: Prentice Hall.</li>
</ul>


<ul>
<li><p>
Guerry, Bastien. 2013. <i>Learn Emacs Lisp in 15 minutes.</i> <a href="https://learnxinyminutes.com/docs/elisp/">https://learnxinyminutes.com/docs/elisp/</a>
</p>

<p>
Describes Emacs version 24.3, but almost certainly compatible with the latest version.
</p></li>
</ul>


<ul>
<li><p>
Hinman, Lee. 2017. <i>Clocking Time with Org-mode.</i> <a href="https://writequit.org/denver-emacs/presentations/2017-04-11-time-clocking-with-org.html">https://writequit.org/denver-emacs/presentations/2017-04-11-time-clocking-with-org.html</a>
</p>

<p>
An overview of and tutorial for Org Mode’s timeclock facility.
</p></li>
</ul>


<ul>
<li>Hoyte, Doug. 2008. <i>Let Over Lambda: 50 Years of Lisp.</i> <a href="https://letoverlambda.com/">https://letoverlambda.com/</a></li>
</ul>


<ul>
<li><p>
Ingebrigtsen, Lars Magne. 2020. <i>The Gnus Newsreader.</i> Cambridge, MA: Free Software Foundation. <a href="https://www.gnu.org/software/emacs/manual/gnus.html">https://www.gnu.org/software/emacs/manual/gnus.html</a>
</p>

<p>
Read in Emacs with <code>M-x info-display-manual RET gnus RET</code>.
</p>

<p>
Complete documentation for the Gnus newsreader and Mail User Agent.  Includes a comprehensive discussion of how to program the Gnus API in Elisp.  Lars’s writing style is inimitable and the huge manual is unexpectedly hilarious.
</p></li>
</ul>


<ul>
<li><p>
Kaludercic, Philip. June 2, 2020. <i>Rmail is a Usable Emacs Mail Client.</i> <a href="http://ruzkuku.com/texts/rmail.html">http://ruzkuku.com/texts/rmail.html</a>
</p>

<p>
A good overview of the Rmail Mail User Agent.
</p></li>
</ul>


<ul>
<li><p>
Krawitz, Robert, Bil Lewis, Dan LaLiberte, Richard M. Stallman and Chris Welty. 2019. <i>GNU Emacs Lisp Reference Manual.</i> Cambridge, MA: Free Software Foundation. <a href="https://www.gnu.org/software/emacs/manual/elisp.html">https://www.gnu.org/software/emacs/manual/elisp.html</a>
</p>

<p>
Read in Emacs with <code>M-x info-display-manual RET elisp RET</code>.
</p>

<p>
The bible of Emacs Lisp; complete Elisp details for writing config files and extensions, and general purpose programming.
</p></li>
</ul>


<ul>
<li><p>
Kremer, Sebastian and Free Software Foundation. 2022. <i>Dired Extra.</i> Cambridge, MA: Free Software Foundation.
</p>

<p>
Read in Emacs with <code>M-x info-display-manual RET dired-x RET</code>.
</p>

<p>
Documents additional features for Dired.
</p></li>
</ul>


<ul>
<li>McIlroy, M.D., E.N. Pinson and B.A. Tague. July-August 1978. “UNIX Time-Sharing System: Forward.” <i>Bell System Technical Journal</i> 57, no. 6: 1899-1904. <a href="https://archive.org/details/bstj57-6-1899/page/n1/mode/2up">https://archive.org/details/bstj57-6-1899/page/n1/mode/2up</a></li>
</ul>


<ul>
<li><p>
Mendler, Daniel. [2021]. <i>vertico.el—VERTical Interactive COmpletion.</i> <a href="https://github.com/minad/vertico/blob/main/README.org">https://github.com/minad/vertico/blob/main/README.org</a>
</p>

<p>
A very modern, minimal, and extensible incremental narrowing completion framework for the Minibuffer.  Available from GNU ELPA.
</p></li>
</ul>


<ul>
<li><p>
Monnier, Stefan and Michael Sperber. 2020. “Evolution of Emacs Lisp.” <i>Proceedings of the ACM on Programming Languages</i> 4, HOPL Article 74. <a href="https://doi.org/10.1145/3386324">doi:10.1145/3386324</a>
</p>

<p>
Detailed technical article on the history of the Emacs Lisp programming language, with particular attention paid to its unique features.
</p></li>
</ul>


<ul>
<li><p>
Murphy, Dan. 2009. “The Beginnings of TECO.” <i>IEEE Annals of the History of Computing</i> 31, no. 4: 110–115. <a href="http://tenex.opost.com/anhc-31-4-anec.pdf">http://tenex.opost.com/anhc-31-4-anec.pdf</a>
</p>

<p>
History of the TECO text editor, both Emacs’s direct predecessor and its first implementation language.  A fascinating must-read!
</p></li>
</ul>


<ul>
<li><p>
Pereira, Murilo. January 3, 2021. <i>How to Open a File in Emacs.</i> <a href="https://www.murilopereira.com/how-to-open-a-file-in-emacs/">https://www.murilopereira.com/how-to-open-a-file-in-emacs/</a>
</p>

<p>
A thoughtful consideration of the state of Emacs, its core values, and possible futures.  Begins with a tour-de-force demonstration of Emacs the Lisp Machine via a debugging problem.
</p></li>
</ul>


<ul>
<li><p>
Petersen, Mickey. <i>n.d.</i> <i>Mastering Emacs.</i> <a href="https://www.masteringemacs.org/">https://www.masteringemacs.org/</a>
</p>

<p>
I haven’t seen this commercial e-book, but based on the articles on Petersen’s blog, it looks superb.  Petersen seems to always have a new version of the book ready whenever a new version of Emacs is released.
</p></li>
</ul>


<ul>
<li><p>
Post, Ed. July 1983. “Real Programmers Don’t Use Pascal.” <i>Datamation</i>. <a href="https://www.ee.ryerson.ca/~elf/hack/realmen.html">https://www.ee.ryerson.ca/~elf/hack/realmen.html</a>
</p>

<p>
Hilarious send-up of programming stereotypes, circa the early days of Emacs.
</p></li>
</ul>


<ul>
<li><p>
Poundstone, William. 1985. <i>The Recursive Universe: Cosmic Complexity and the Limits of Scientific Knowledge.</i> Chicago: Contemporary Books.
</p>

<p>
The best published examination of Conway’s cellular automaton, Life.  Poundstone considers computers, algorithms, complexity, and shows how to build a computer out of a “game” with four trivial rules.  Great stuff.
</p></li>
</ul>


<ul>
<li><p>
Raymond, Eric S,. 2004. <i>The Art of Unix Programming.</i> Boston: Addison-Wesley.
</p>

<p>
Book-length treatment of the Unix Philosophy and the Open Source movement.
</p></li>
</ul>


<ul>
<li><p>
Raymond, Eric S. and Guy L. Steele. 1996. <i>The New Hacker’s Dictionary, 3rd edition.</i> Cambridge, MA: MIT Press. <a href="http://www.catb.org/~esr/jargon/">http://www.catb.org/~esr/jargon/</a>
</p>

<p>
Raymond’s controversial update of the <i>The Hacker’s Dictionary</i> to include more recent entries from the world of Usenet, Unix, microcomputers, and the nascent World Wide Web.
</p></li>
</ul>


<ul>
<li><p>
Reid, Brian, Jim Larus, Stephen Gildea and Bill Wohler. 2016. <i>The MH-E Manual.</i> Cambridge, MA: Free Software Foundation. <a href="https://www.gnu.org/software/emacs/manual/mh-e.html">https://www.gnu.org/software/emacs/manual/mh-e.html</a>
</p>

<p>
Read in Emacs with <code>M-x info-display-manual RET mh-e RET</code>.
</p>

<p>
Complete documentation for the MH-E Mail User Agent.
</p></li>
</ul>


<ul>
<li><p>
Reingold, Edward M. and Nachum Dershowitz. 2018. <i>Calendrical Calculations: The Ultimate Edition.</i> Cambridge, UK: Cambridge University Press.
</p>

<p>
The basic reference on algorithms for calculations on dates and calendars, this book originates in Emacs Lisp code written by mathematician Reingold for the Emacs Calendar subsystem.
</p></li>
</ul>


<ul>
<li><p>
Ritchie, Dennis. February 12, 2004. <i>An incomplete history of the QED Text Editor.</i> Murray Hill, NJ: Bell Labs. <a href="https://www.bell-labs.com/usr/dmr/www/qed.html">https://www.bell-labs.com/usr/dmr/www/qed.html</a>
</p>

<p>
Interesting history of the many versions of the QED text editor in which Ken Thompson first implemented regular expressions.
</p></li>
</ul>


<ul>
<li><p>
Schulte, Eric, Dan Davison, Thomas Dye and Carsten Dominik. 2012. “A Multi-Language Computing Environment for Literate Programming and Reproducible Research.” <i>Journal of Statistical Software</i> 46, no. 3: 1–24. <a href="https://doi.org/10.18637/jss.v046.i03">doi:10.18637/jss.v046.i03</a> <a href="https://doi.org/10.18637/jss.v046.i03">https://doi.org/10.18637/jss.v046.i03</a>
</p>

<p>
Good overview of using Org Mode for scientific research, covering publication, statistical analysis, and embedded data and source code for reproducible research,
</p></li>
</ul>


<ul>
<li>Selk, Avi. May 4, 2018. “One space between each sentence, they said.  Science just proved them wrong.” <i>The Washington Post</i>. <a href="https://www.washingtonpost.com/news/speaking-of-science/wp/2018/05/04/one-space-between-each-sentence-they-said-science-just-proved-them-wrong-2/">https://www.washingtonpost.com/news/speaking-of-science/wp/2018/05/04/one-space-between-each-sentence-they-said-science-just-proved-them-wrong-2/</a></li>
</ul>


<ul>
<li><p>
Stallman, Richard M. 28 Oct 2002. <i>My Lisp Experiences and the Development of GNU Emacs.</i> San Francisco: International Lisp Conference. <a href="https://www.gnu.org/gnu/rms-lisp.html">https://www.gnu.org/gnu/rms-lisp.html</a>
</p>

<p>
Stallman’s personal history with Lisp and how it fits into the Emacs story.
</p></li>
</ul>


<ul>
<li><p>
Stallman, Richard M. 1981. <i>EMACS: The Extensible, Customizable, Self-Documenting Display Editor.</i> <a href="https://www.gnu.org/software/emacs/emacs-paper.html">https://www.gnu.org/software/emacs/emacs-paper.html</a>
</p>

<p>
An extremely interesting article on the design of Emacs.  Predates GNU Emacs; covers the original TECO Emacs and Lisp Machines Emacs.
</p></li>
</ul>


<ul>
<li><p>
Stallman, Richard M. 2020. <i>GNU Emacs Manual.</i> Cambridge, MA: Free Software Foundation. <a href="https://www.gnu.org/software/emacs/manual/emacs.html">https://www.gnu.org/software/emacs/manual/emacs.html</a>
</p>

<p>
Read in Emacs with <code>M-x info-display-manual RET emacs RET</code>.
</p>

<p>
The authoritative user’s reference; also a fine introduction.  The complete text is available in Emacs via Info; type <code>C-h r</code> to read it.
</p></li>
</ul>


<ul>
<li><p>
Steele, Guy L., Jr., Donald R. Woods, Raphael A. Finkel, Mark R. Crispin, Richard M. Stallman and Geoffrey S. Goodfellow. 1983. <i>The Hacker’s Dictionary: A Guide to the World of Computer Wizards.</i> New York: Harper &amp; Row. <a href="http://www.catb.org/~esr/jargon/">http://www.catb.org/~esr/jargon/</a>
</p>

<p>
The first published book version of the famous Jargon File, the glossary of the lingo of the hackers of the Arpanet era, including MIT’s TECO and Emacs hackers.  An amazing, hilarious, and important historical document.  See also Raymond’s <i>New Hacker’s Dictionary</i>; the URL points to his online version.
</p></li>
</ul>


<ul>
<li>Stephenson, Neal. 1999. <i>In the Beginning … Was the Command Line.</i> New York: Avon Books. <a href="https://web.archive.org/web/20180218045352/http://www.cryptonomicon.com/beginning.html">https://web.archive.org/web/20180218045352/http://www.cryptonomicon.com/beginning.html</a></li>
</ul>


<ul>
<li>Thompson, Silvanus P. 1911. <i>Calculus Made Easy: Being a Very-simplest Introduction to Those Beautiful Methods of Reckoning Which Are Generally Called By the Terrifying Names of the Differential Calculus and the Integral Calculus.</i> London: Macmillan.</li>
</ul>


<ul>
<li><p>
Wiegley, John. 2020. <i>Eshell.</i> Cambridge, MA: Free Software Foundation. <a href="https://www.gnu.org/software/emacs/manual/eshell.html">https://www.gnu.org/software/emacs/manual/eshell.html</a>
</p>

<p>
Read in Emacs with <code>M-x info-display-manual RET eshell RET</code>.
</p>

<p>
The authoritative reference on Eshell.
</p></li>
</ul>


<ul>
<li><p>
Wood, Randall. 2011. <i>The Woodnotes Guide to Emacs for Writers.</i> <a href="http://therandymon.com/woodnotes/emacs-for-writers/emacs-for-writers.html">http://therandymon.com/woodnotes/emacs-for-writers/emacs-for-writers.html</a>
</p>

<p>
Probably describes Emacs version 23.2.  A tutorial specifically for non-programmers, emphasizing topics like “Foreign Languages and Foreign Characters,” “Occasional Diacriticals,” “Writing in a Foreign Alphabet,” “Inserting Special Characters ,” “Word wrap,” “Reformatting Hard Wrapped Documents,” “Cleaning Up Spacing”.
</p></li>
</ul>


<ul>
<li><p>
Zawinski, Jamie. 2000. <i>Tabs Versus Spaces: An Eternal Holy War.</i> <a href="https://www.jwz.org/doc/tabs-vs-spaces.html">https://www.jwz.org/doc/tabs-vs-spaces.html</a>
</p>

<p>
The authoritative explanation of the debate.
</p></li>
</ul>


<ul>
<li><p>
[Krehel, Oleh]. <i>n.d.</i> <i>Ivy User Manual.</i> <a href="https://oremacs.com/swiper/">https://oremacs.com/swiper/</a>
</p>

<p>
Read in Emacs with <code>M-x info-display-manual RET ivy RET</code>.
</p>

<p>
Documentation for the Ivy incremental narrowing completion framework for the Minibuffer.  Available from GNU ELPA.
</p></li>
</ul>
</div>
</div>
<div id="outline-container-orgb2ef1b0">
<h3 id="orgb2ef1b0">Colophon <a id="orge9d3a1c"></a></h3>
<div id="text-orgb2ef1b0">
<p>
The version number of this book is 28.2.43; the first two
components are the major and minor components of the version number of the Emacs
which was used to publish the book, and the third component is the patch-level
of the book.
</p>

<p>
This book is written in and published from GNU Emacs.  The text consists of
19,087 lines of <a href="#org4a851ca">Org Mode</a> markup, which, with some helpers,
generates all three published versions of the book:
</p>

<ul>
<li>the PDF version is compiled by Emacs from Org to LaTeX and then typeset
with the <a href="https://www.ctan.org/pkg/tufte-latex">tufte-latex</a> classes (inspired by the beautiful typography of <a href="https://www.edwardtufte.com/tufte/">Edward
Tufte</a>);</li>
<li>the HTML version (which uses <a href="http://www.pirilampo.org/">Fabrice Niessen</a>’s <a href="https://github.com/fniessen/org-html-themes#readtheorg">ReadTheOrg</a>) is compiled by Emacs from Org;</li>
<li>and the EPUB ebook is built via Mark Meyer’s <a href="https://github.com/ofosos/org-epub"><code>ox-epub</code></a>.</li>
</ul>

<p>
Org Mode’s multi-language <a href="https://en.wikipedia.org/wiki/Metaprogramming">metaprogramming</a> facility, <a href="https://orgmode.org/worg/org-contrib/babel/intro.html">Babel</a>, is used heavily to
automate indexing, hypertext links to the web version of the Emacs manuals, and
the many bits of statistical information in the book.  The original 1997 version
of this book (written in HTML preprocessed by the <a href="https://www.gnu.org/software/m4/">GNU m4</a> macro processor) was
rapidly plagued by broken web links and obsolete claims about Emacs; with Babel,
all these things are computed automatically every time the document is updated,
so the useful lifetime of this new edition should be considerably lengthened.
</p>

<p>
There are 1,294 lines of Babel code in
5 languages (emacs-lisp, dot, ditaa, shell, python),
supported by 742 more lines of custom Emacs Lisp code.
</p>

<p>
Everywhere in this book that you see very precise numbers (e.g.,
“1,294 lines of Babel code”, “395,759 lines of
hypertext reference manuals”), those numbers are probably computed by Babel code
during publication.  (Nice round numbers (e.g. “30,000 lines of Magit source
code”) are probably looked up or hand-estimated.)
</p>

<p>
<a href="https://www.graphviz.org/">Graphviz</a> and <a href="https://github.com/stathissideris/ditaa">Ditaa</a> were used for some of the diagrams.
</p>

<p>
The bibliographic data is maintained in <a href="https://en.wikipedia.org/wiki/Refer_(software)">Refer format</a> and the <a href="#orgd801ff7">bibliography</a> is
generated by code in my <a href="https://www.lib.uchicago.edu/keith/software/emacs/"><code>refer-mode</code></a> package.
</p>

<p>
Version control is handled by <a href="https://www.mercurial-scm.org/">Mercurial</a> via Emacs’s <code>VC</code> (<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Version-Control">“Version Control”</a> in the <i>Emacs</i> manual).
</p>

<p>
The publication process is orchestrated by <a href="https://www.gnu.org/software/make">GNU Make</a> and   <code>M-x</code> ﻿<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Compilation"><code>compile</code></a>﻿.
</p>

<p>
It takes about three minutes to regenerate any of the versions of this
559 page book after an edit.
</p>
</div>
</div>
<div id="outline-container-org1bb90b8">
<h3 id="org1bb90b8">Acknowledgments</h3>
<div id="text-org1bb90b8">
<p>
I’d like to thank Dave Moon and Guy Steele for inventing Emacs,
Richard Stallman for GNU Emacs, Lars Ingebrigtsen for Gnus, Carsten
Dominik for Org, and all the dedicated maintainers of and contributors
to GNU Emacs.
</p>

<p>
Closer to home, I’d like to thank Matt Teichman and Elisabeth Long for
encouraging me to write this book, and especially Ann Lindsey for
being my Emacs games beta tester and for everything else.
</p>
</div>
</div>
<div id="outline-container-orgd546957">
<h3 id="orgd546957">About the Author</h3>
<div id="text-orgd546957">
<p>
Keith Waclena used the TECO programming language for his first paid programming
job on a DECsystem-10 at Syracuse University in 1979, and discovered the
original TECO Emacs shortly thereafter.  He tried to use only Emacs or at worst
Emacs-like editors from that point on, continuing to use TECO Emacs on
DECSYSTEM-20’s at the University of Chicago, MINCE on a Z80 running ZCPR3,
Freemacs on a 286 running MS-DOS, Gosling and Unipress Emacs on a Sun 3/60 and
NeXT cube, and finally GNU Emacs (with a temporary excursion into Epoch and
Xemacs) on every computer since.  He’s been using Emacs daily for
44 years, and even after writing this book, feels like
he’s only scratched the surface.
</p>

<p>
He is currently a programmer at the University of Chicago Library, coding mostly
in OCaml for work purposes but mostly in Emacs Lisp for personal projects.
</p>
</div>
</div>
</div></div>
  </body>
</html>
