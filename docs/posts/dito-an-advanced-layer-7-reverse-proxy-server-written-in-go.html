<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/andrearaponi/dito">Original</a>
    <h1>Dito – an advanced Layer 7 reverse proxy server written in Go</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto"><strong>Dito</strong> is an advanced Layer 7 reverse proxy server written in Go. It provides flexible middleware support, custom certificate handling for backend connections, dynamic configuration reloading, and distributed caching and rate limiting with Redis.</p>

<ul dir="auto">
<li>Layer 7 reverse proxy for handling HTTP requests</li>
<li>Dynamic configuration reloading (<code>hot reload</code>)</li>
<li>Middleware support (e.g., an example of authentication, rate limiting, caching)</li>
<li>Distributed rate limiting with Redis</li>
<li>Distributed caching with Redis</li>
<li>Custom TLS certificate management for backends (mTLS support)</li>
<li>Header manipulation (additional headers, excluded headers)</li>
<li>Logging support with detailed request and response logs</li>
</ul>

<ul dir="auto">
<li><code>cmd/</code>: Entry point for the application.</li>
<li><code>app/</code>: Core application logic.</li>
<li><code>client</code>: Redis client for caching and rate limiting.</li>
<li><code>config/</code>: Configuration-related utilities (loading, hot-reload).</li>
<li><code>handlers/</code>: Core handlers for request routing and reverse proxy logic.</li>
<li><code>middlewares/</code>: Custom middleware implementations (e.g., authentication, caching, rate limiting).</li>
<li><code>transport/</code>: HTTP transport customization (including TLS management).</li>
<li><code>writer/</code>: Custom HTTP response writers for capturing status codes.</li>
<li><code>logging/</code>: Utilities for logging requests and responses.</li>
</ul>

<p dir="auto">Make sure you have Go installed (version 1.16 or later).</p>
<ol dir="auto">
<li>
<p dir="auto">Clone the repository:</p>
<div dir="auto" data-snippet-clipboard-copy-content="git clone https://github.com/andrearaponi/dito.git
cd dito"><pre>git clone https://github.com/andrearaponi/dito.git
<span>cd</span> dito</pre></div>
</li>
<li>
<p dir="auto">Build the application:</p>

</li>
</ol>

<p dir="auto">You can run Dito by simply executing the binary. By default, it looks for <code>config.yaml</code> in the current working directory.</p>


<ul dir="auto">
<li><code>-f &lt;path/to/config.yaml&gt;</code>: Specify a custom configuration file.</li>
</ul>
<p dir="auto">Example:</p>
<div dir="auto" data-snippet-clipboard-copy-content="./dito -f /path/to/custom-config.yaml"><pre>./dito -f /path/to/custom-config.yaml</pre></div>

<p dir="auto">The configuration is defined in a <code>yaml</code> file, which can be dynamically reloaded if the <code>hot_reload</code> option is enabled. Here’s an example of a basic configuration:</p>
<div dir="auto" data-snippet-clipboard-copy-content="port: &#39;8081&#39;  # The port on which the server listens
hot_reload: true  # Enable hot-reload of configuration

logging:
  enabled: true  # Enable or disable logging
  verbose: false  # Enable verbose logging

redis:
  enabled: true  # Enable Redis for caching and rate limiting
  address: &#34;localhost:6379&#34;
  password: &#34;yourpassword&#34;
  db: 0

locations:
  - path: &#34;^/api$&#34;
    target_url: https://example.com
    replace_path: true
    additional_headers:
      X-Custom-Header: &#34;my-value&#34;
      il-molise: &#34;non-esiste&#34;
    excluded_headers:
      - Cookie
    middlewares:
      - auth
      - rate-limiter-redis
      - cache
    cache_config:
      enabled: true
      ttl: 60  # Cache time-to-live in seconds
    rate_limiting:
      enabled: true
      requests_per_second: 5
      burst: 10
    cert_file: &#34;certs/client-cert.pem&#34;
    key_file: &#34;certs/client-key.pem&#34;
    ca_file: &#34;certs/ca-cert.pem&#34;"><pre><span>port</span>: <span><span>&#39;</span>8081<span>&#39;</span></span>  <span><span>#</span> The port on which the server listens</span>
<span>hot_reload</span>: <span>true  </span><span><span>#</span> Enable hot-reload of configuration</span>

<span>logging</span>:
  <span>enabled</span>: <span>true  </span><span><span>#</span> Enable or disable logging</span>
  <span>verbose</span>: <span>false  </span><span><span>#</span> Enable verbose logging</span>

<span>redis</span>:
  <span>enabled</span>: <span>true  </span><span><span>#</span> Enable Redis for caching and rate limiting</span>
  <span>address</span>: <span><span>&#34;</span>localhost:6379<span>&#34;</span></span>
  <span>password</span>: <span><span>&#34;</span>yourpassword<span>&#34;</span></span>
  <span>db</span>: <span>0</span>

<span>locations</span>:
  - <span>path</span>: <span><span>&#34;</span>^/api$<span>&#34;</span></span>
    <span>target_url</span>: <span>https://example.com</span>
    <span>replace_path</span>: <span>true</span>
    <span>additional_headers</span>:
      <span>X-Custom-Header</span>: <span><span>&#34;</span>my-value<span>&#34;</span></span>
      <span>il-molise</span>: <span><span>&#34;</span>non-esiste<span>&#34;</span></span>
    <span>excluded_headers</span>:
      - <span>Cookie</span>
    <span>middlewares</span>:
      - <span>auth</span>
      - <span>rate-limiter-redis</span>
      - <span>cache</span>
    <span>cache_config</span>:
      <span>enabled</span>: <span>true</span>
      <span>ttl</span>: <span>60</span>  <span><span>#</span> Cache time-to-live in seconds</span>
    <span>rate_limiting</span>:
      <span>enabled</span>: <span>true</span>
      <span>requests_per_second</span>: <span>5</span>
      <span>burst</span>: <span>10</span>
    <span>cert_file</span>: <span><span>&#34;</span>certs/client-cert.pem<span>&#34;</span></span>
    <span>key_file</span>: <span><span>&#34;</span>certs/client-key.pem<span>&#34;</span></span>
    <span>ca_file</span>: <span><span>&#34;</span>certs/ca-cert.pem<span>&#34;</span></span></pre></div>

<p dir="auto">Dito supports custom middlewares, which can be specified in the configuration. Currently available middleware includes:</p>
<ul dir="auto">
<li><code>auth</code>: Adds authentication logic.</li>
<li><code>rate-limiter</code>: Limits the number of requests per IP using an in-memory approach.</li>
<li><code>rate-limiter-redis</code>: Limits the number of requests per IP using Redis for distributed management.</li>
<li><code>cache</code>: Caches responses using Redis, improving performance for idempotent responses (e.g., GET).</li>
</ul>


<p dir="auto">Dito supports distributed rate limiting using Redis. The rate limiter can be configured per location with parameters like <code>requests_per_second</code> and <code>burst</code> to control the request flow.</p>

<p dir="auto">The <code>cache</code> middleware uses Redis to store responses. It helps in reducing load on backends by caching responses for a configurable <code>ttl</code> (time-to-live). The cache can be invalidated based on request headers or specific conditions.</p>
<div dir="auto"><h3 tabindex="-1" dir="auto">Implementing a New Middleware</h3><a id="user-content-implementing-a-new-middleware" aria-label="Permalink: Implementing a New Middleware" href="#implementing-a-new-middleware"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">To implement a new middleware, place your logic in the <code>middlewares/</code> directory and reference it in the configuration.</p>

<p dir="auto">Dito supports mTLS (mutual TLS) for secure connections to backends. You can specify:</p>
<ul dir="auto">
<li><code>cert_file</code>: The client certificate.</li>
<li><code>key_file</code>: The client private key.</li>
<li><code>ca_file</code>: The certificate authority (CA) for verifying the backend.</li>
</ul>

<p dir="auto">This project is licensed under the MIT License. See the <a href="https://alanza.xyz/andrearaponi/dito/blob/main/LICENSE">LICENSE</a> file for details.</p>
</article></div></div>
  </body>
</html>
