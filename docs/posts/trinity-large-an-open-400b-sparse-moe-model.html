<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.arcee.ai/blog/trinity-large">Original</a>
    <h1>Trinity large: An open 400B sparse MoE model</h1>
    
    <div id="readability-page-1" class="page"><div global-animation="on"><div><p><a href="https://www.arcee.ai/blog/the-trinity-manifesto">Two months ago I wrote</a> about why we decided to stop treating pretraining like someone else&#39;s job.</p><p>At the time, Trinity Nano Preview and Trinity Mini had just released, and Trinity Large had started training. We were in the middle of our first run so big that you either laughed or got nauseous. Frankly, I felt either we’d end up with a really great base model or fall flat on our faces with a tired wallet.</p><p>Little did I know, we’d get both.</p><p>Here’s what we’re shipping, what surprised us, what broke, and what it took to make a 400B sparse MoE behave.</p><p>We&#39;re putting out three variants: Trinity-Large-<strong>Preview</strong> is lightly post-trained and chat-ready, Trinity-Large-<strong>Base</strong> is our best pretraining checkpoint after the full 17T recipe, and <strong>TrueBase</strong> is an early checkpoint from the same run at 10T tokens, without any instruct data or LR anneals. What many would consider a <em>true</em> base model.</p><p>Trinity-Large is a 400B parameter sparse MoE with <strong>13B active parameters per token</strong>. It uses <strong>256 experts</strong> with <strong>4 experts active per token</strong>. That sparsity ratio is pretty high compared to our peers, save for Llama-4-Maverick:</p><div>
<div><table><thead>
  <tr>
    <th>Model</th>
    <th>Routing (k-of-N)</th>
    <th>Routing fraction</th>
  </tr></thead>
<tbody>
  <tr>
    <td>Trinity Large</td>
    <td>4-of-256</td>
    <td>1.56%</td>
  </tr>
  <tr>
    <td>DeepSeek-V3</td>
    <td>8-of-256</td>
    <td>3.13%</td>
  </tr>
  <tr>
    <td>MiniMax-M2</td>
    <td>8-of-256</td>
    <td>3.13%</td>
  </tr>
  <tr>
    <td>GLM-4.5</td>
    <td>8-of-160</td>
    <td>5.0%</td>
  </tr>
  <tr>
    <td>Qwen3-235B-A22B</td>
    <td>8-of-128</td>
    <td>6.25%</td>
  </tr>
  <tr>
    <td>Llama 4 Maverick</td>
    <td>1-of-128</td>
    <td>0.78%</td>
  </tr>
</tbody>
</table></div></div><p>We originally aimed for a slightly different total size (420B), but we ended up increasing the number of dense layers (from 3 to 6) to help keep routing stable at this sparsity.</p><p>
  <a href="https://45777467.fs1.hubspotusercontent-na1.net/hubfs/45777467/Base%20Benchmarks%20-%20White%20BG.png.png" target="_blank" rel="noopener">
    <img src="https://45777467.fs1.hubspotusercontent-na1.net/hubfs/45777467/Base%20Benchmarks%20-%20White%20BG.png.png" alt="Trinity Large Base Model Comparison" loading="lazy"/>
  </a>
</p><p>Trinity-Large-Base is a true frontier-class foundation model. We match and exceed our peers in open-base models across a wide range of benchmarks, including math, coding, scientific reasoning, and raw knowledge absorption.</p><h5>Inference efficiency</h5><p>We trained on 2048 Nvidia B300 GPUs. As far as we can tell, it’s the largest (publicly stated, at least) pretraining run done on these machines. That means two things:</p><ol role="list"><li>They’re wicked fast.</li><li>They’re not cheap.</li></ol><p>Therefore, we had to make the most of the money we allotted to these machines, which was just over <em>30</em> days. Ridiculously fast for a run of this scale, so efficient training was the name of the game. Hence, the level of sparsity referred to above. Combined with our efficient attention outlined in our <a href="https://github.com/arcee-ai/trinity-large-tech-report/">technical report</a>, this enabled us to train and, by extension, run <em>inference</em> much faster than our peers in the same weight class. All while not sacrificing performance. Roughly 2-3x faster for the same hardware.</p><p>
  <a href="https://45777467.fs1.hubspotusercontent-na1.net/hubfs/45777467/Trinity%20Large%20Inference%20Throughput%20Comparison.png" target="_blank" rel="noopener">
    <img src="https://45777467.fs1.hubspotusercontent-na1.net/hubfs/45777467/Trinity%20Large%20Inference%20Throughput%20Comparison.png" alt="Trinity Large Inference Throughput Comparison" loading="lazy"/>
  </a>
</p><h4>Momentum-based expert load balancing</h4><p>We keep MoE routing under control by nudging each expert’s router bias up or down depending on whether that expert is being over- or under-used. The update is capped with a tanh clip so it stays bounded, and we add momentum to smooth it across steps and avoid step-to-step ping-pong. On top of that, we include a small per-sequence balance loss so load is not only balanced in expectation across the batch, but also within individual sequences.</p><h4>z-loss</h4><p>We use z-loss to stop the LM-head logits from drifting upward during training. It is a lightweight regularizer that keeps logit scale from creeping up without bound. We also log basic logit stats (for example max and mean) as a simple early warning for instability.</p><p>The exact equations are in the <a href="https://github.com/arcee-ai/trinity-large-tech-report/">technical report</a>.</p><p>Our fastest configuration was HSDP with expert parallelism set to 8, which gave us 2048 data-parallel ranks. In that setup, we pushed throughput further by increasing batch size after 5T tokens of training. We were comfortable doing that because the model is highly sparse, Muon supports a larger critical batch size than AdamW, and the MiniMax-01 paper suggests batch-size scaling remains workable in this regime.</p><p>In the main run, once we had stability dialed in, the loss curve stayed smooth the whole way through. You can see clear phase transitions, no spikes, and a steady march to the end.</p><p>
  <a href="https://45777467.fs1.hubspotusercontent-na1.net/hubfs/45777467/Tokens%20vs.%20Loss.png" target="_blank" rel="noopener">
    <img src="https://45777467.fs1.hubspotusercontent-na1.net/hubfs/45777467/Tokens%20vs.%20Loss.png" alt="Tokens vs. Loss" loading="lazy"/>
  </a>
</p><p>The full pretraining run finished in 33 days. That&#39;s pre-training only; it doesn&#39;t include context extension or post-training.</p><h5>Data</h5><p>Trinity Large was trained on 17T tokens of data curated by <a href="https://www.datologyai.com/">DatologyAI</a>, split across three phases of 10T, 4T, and 3T tokens. This mix uses state-of-the art programming, STEM, reasoning, and multilingual data curation, targeting 14 non-English languages. Notably, over 8 <em>trillion</em> tokens of synthetic data were generated for this dataset across web, code, math, reasoning, and multilingual domains, using a breadth of state-of-the-art rephrasing approaches.</p><p>A less advanced version of this curation approach worked well for smaller models like Trinity Nano and Trinity Mini, but we wanted to shoot for the moon with Trinity Large. So DatologyAI delivered a number of curation advancements specifically for inclusion into Trinity Large. There’s always a leap of faith when doing something for the first time in public, but the effectiveness of the curation approach as a whole is reflected in the downstream evaluations, where the Trinity Large-Base demonstrates frontier-level performance across the targeted capability domains.</p><h5>Trinity-Large-Preview</h5><p>The preview we’re releasing today is <em>not</em> a reasoning model. A benefit beyond production inference efficiency is that it also carries over into RL, enabling quicker rollouts for a given total parameter size. But it’s equally as sensitive as pretraining was, and while it’s currently undergoing further post-training and will be a full-fledged reasoning model upon release, we believe there’s a fine line between intelligence and <em>usefulness</em>, and while the reasoning variant is very intelligent, it needs longer in training before it becomes maximally useful given the extra tokens per output.</p><p>As such, to maximize usefulness and provide an early checkpoint, Preview is a non-reasoning, or “instruct,” model. It’s a particularly <em>light</em> post-training, as most of our compute went towards pre-training and is continuing with the reasoning version. It is an extremely capable model for its size and gave us the opportunity to flex some old-school post-training muscles we haven’t had the chance to flex in quite some time. It excels in creative writing, storytelling, role-play, chat scenarios, and real-time voice assistance, better than your average reasoning model usually can. But we’re also introducing some of our newer agentic performance. It was trained to navigate well in agent harnesses like OpenCode, Cline, and Kilo Code, and to handle complex toolchains and long, constraint-filled prompts. It certainly isn’t perfect, but we cannot wait to see what you do with it. It’s free in OpenRouter until Large (non-preview) fully releases.</p><div>
<div><table><thead>
  <tr>
    <th>Benchmark</th>
    <th>Llama 4 Maverick</th>
    <th>Trinity-Large Preview</th>
  </tr></thead>
<tbody>
  <tr>
    <td>MMLU</td>
    <td>85.5</td>
    <td>87.2</td>
  </tr>
  <tr>
    <td>MMLU-Pro</td>
    <td>80.5</td>
    <td>75.2</td>
  </tr>
  <tr>
    <td>GPQA-Diamond</td>
    <td>69.8</td>
    <td>63.3</td>
  </tr>
  <tr>
    <td>AIME 2025</td>
    <td>19.3</td>
    <td>24.0</td>
  </tr>
</tbody>
</table></div></div><p>It’s currently roughly in line with Llama-4-Maverick’s Instruct model across standard academic benchmarks, and we’ll update this blog over time with more evaluations.</p><p>But we like to tease, so I’ll leave you with some early evaluations of the reasoning Trinity-Large. These are not exhaustive, and by no means representative of the full capabilities of any of these models, but it is a fun look at how we plan to take this model.</p><p>
  <a href="https://45777467.fs1.hubspotusercontent-na1.net/hubfs/45777467/MMLU-Pro%20%20AIME%202025%20%20GPQA-Diamond.png" target="_blank" rel="noopener">
    <img src="https://45777467.fs1.hubspotusercontent-na1.net/hubfs/45777467/MMLU-Pro%20%20AIME%202025%20%20GPQA-Diamond.png" alt="Trinity Large Benchmark Comparison" loading="lazy"/>
  </a>
</p><h5>Cost</h5><p>When we started this run, we had never pretrained anything remotely like this before.</p><p>There was no guarantee this would work. Not the modeling, not the data, not the training itself, not the operational part where you wake up, and a job that costs real money is in a bad state, and you have to decide whether to restart or try to rescue it.</p><p>All in—compute, salaries, data, storage, ops—we pulled off this entire effort for <strong>$20 million</strong>. 4 Models got us here in 6 months.</p><p>That number is big for us. It&#39;s also small compared to what frontier labs spend just to keep the lights on. We don&#39;t have infinite retries.</p><h5>What is TrueBase?</h5><p>One more thing about Trinity-Large-TrueBase.</p><p>Most &#34;base&#34; releases have some instruction data baked in. TrueBase doesn&#39;t. It&#39;s 10T tokens of pretraining on a 400B sparse MoE, with no instruct data and no LR annealing.</p><p>If you&#39;re a researcher who wants to study what high-quality pretraining produces at this scale—before any RLHF, before any chat formatting—this is one of the few checkpoints where you can do that. We think there&#39;s value in having a real baseline to probe, ablate, or just observe. What did the model learn from the data alone? TrueBase is where you answer that question.</p><h5>Where to use it</h5><p><strong>OpenRouter</strong> has Trinity-Large-Preview available now, free during the preview period (through at least February 2026). If you want to kick the tires without spinning up infrastructure, that&#39;s the fastest path.</p><p>We also worked with <strong>Kilo Code</strong>, <strong>Cline</strong>, and <strong>OpenCode</strong> to have integrations ready at launch. If you&#39;re already using one of those for coding, Trinity Large should show up as an option. This is an extremely young post-train, in the scheme of RL runs that go on for months at a time, like our peers. We’ll get there soon, but we’re oh-so-proud to have our own model to do it with. Expect rough edges, specifically in coding agents. For everyday agents, though, it’s outstanding.</p><h5>Context and hosting</h5><p>Trinity Large natively supports <strong>512k context</strong>.</p><p>The preview API is running at 128k context with 8-bit quantization as we tune our inference infrastructure. This release is as much a preview of our hosting platform as it is a model launch.</p><h4>Try Trinity Large</h4><ul role="list"><li>Weights:</li><li>API / chat: <a href="http://chat.arcee.ai">chat.arcee.ai</a> </li><li>Docs: <a href="https://docs.arcee.ai/">docs.arcee.ai</a></li><li>OpenRouter: <a href="https://openrouter.ai/arcee-ai/trinity-large-preview">https://openrouter.ai/arcee-ai/trinity-large-preview</a></li></ul><p>If you put this model into something real and it breaks, tell us. The fastest way for open models to get better is for people to actually use them, hard, in places that don&#39;t look like benchmarks.</p><p>We like to say that we built Trinity so you can own it. Being able to say that about a frontier-level model is something we’re immeasurably proud of.</p></div></div></div>
  </body>
</html>
