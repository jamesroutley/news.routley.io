<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://mathoverflow.net/questions/207321/how-did-cole-factor-267-1-in-1903">Original</a>
    <h1>How did Cole factor 2^67−1 in 1903?</h1>
    
    <div id="readability-page-1" class="page"><div>

        

            
            <div>
                    <p><span>Asked</span>
                        <time itemprop="dateCreated" datetime="2015-05-22T15:33:09">7 years, 6 months ago</time>
                    </p>
                    
                    <p><span>Viewed</span>
                        25k times
                    </p>
            </div>
            <div id="mainbar" role="main" aria-label="question and answers">

                
<div data-questionid="207321" data-position-on-page="0" data-score="109" id="question">

    <div>
        

        

<div>
    <p><span>$\begingroup$</span></p><div itemprop="text">
                
<p>I just heard a <a href="http://www.thisamericanlife.org/radio-archives/episode/450/so-crazy-it-just-might-work" rel="noreferrer">This American Life episode</a> which recounted the famous anecdote about Frank Nelson Cole factoring <span>$N:=2^{67}-1$</span> as <span>$193{,}707{,}721\times 761{,}838{,}257{,}287$</span>. There doesn&#39;t seem to be a historical record of how Cole achieved this; all we have I could find his statement that it took &#34;three years of Sundays&#34;. Ira Glass&#39;s guest, Paul Hoffman, suggests that this was done by trial division.</p>

<p>But this is nuts, unless I am missing something. Three years of Sundays is <span>$156$</span> days. If he works <span>$10$</span> hours a day, that&#39;s <span>$93{,}600$</span> minutes. There are <span>$10{,}749{,}692$</span>  primes up to 
<span>$193{,}707{,}721$</span>. So that is more than <span>$100$</span> trial divisions a minute. Worse than that, existing prime tables didn&#39;t go high enough: According to Chapter XIII of Dickson&#39;s <a href="https://archive.org/details/historyoftheoryo01dick" rel="noreferrer">History of the Theory of Numbers</a>, existing tables of primes only ran to something like <span>$10{,}000{,}000$</span> (<span>$664{,}579$</span> primes), so for the vast majority of the trial divisions, he&#39;d have to find the primes first. (Lehmer, in 1914, went up to <span>$10{,}006{,}721$</span>.)</p>

<p>But I&#39;m puzzled thinking what else Cole could have done. I skimmed Chapter XIV in Dickson. The methods which seem to have existed at the time are:</p>

<ul>
<li><p>Various ways to speed up trial division for the first <span>$1000$</span>&#39;s of prime numbers. That only helps at the start.</p></li>
<li><p>Writing <span>$N$</span> as <span>$x^2-y^2$</span>. But <span>$y$</span> would be <span>$380{,}822{,}274{,}783$</span>, which is an even larger search.</p></li>
<li><p>Since <span>$2$</span> is a square modulo <span>$N$</span> (namely, <span>$(2^{34})^2 \equiv 2 \mod N$</span>), we know that all prime factors must be <span>$\pm 1 \bmod 8$</span>, which cuts the time in half. But that&#39;s only a factor of <span>$2$</span>. </p></li>
<li><p>Since <span>$N \equiv 3 \mod 4$</span>, there must be a prime factor which is <span>$3 \bmod 4$</span>, so we could try only checking those primes. But this turns out to make things worse, since the SMALL factor is the one which is <span>$1 \bmod 4$</span>. </p></li>
<li><p>If we could write <span>$N$</span> as a sum of squares in two ways, we&#39;d be done. But <span>$N$</span> isn&#39;t a sum of squares, since it is <span>$3 \bmod 4$</span>. Generalizations to other positive definite quadratic forms were known at the time, but how would Cole know which quadratic form to try?</p></li>
<li><p>A variant of the above would be to use the quadratic form <span>$2x^2-y^2$</span>, since we already have one solution. Dickson doesn&#39;t mention any work using mixed signature forms, but it would work. And since <span>$\mathbb{Z}[\sqrt{2}]$</span> is a PID, there must be a second way to write <span>$N$</span> as <span>$2x^2-y^2$</span>, not related to the previous by units of <span>$\mathbb{Z}[\sqrt{2}]$</span>. I&#39;m not sure how large this second solution is.</p></li>
</ul>

<p>So, my question is:</p>

<blockquote>
  <p>How could someone find the prime factors of <span>$N$</span> in <span>$100{,}000$</span> minutes of hand computation?</p>
</blockquote>
    </div>

        

    <div>
        <div>
            

                <div>
<div>
    
    <div>
        <a href="https://mathoverflow.net/users/7460/francesco-polizzi"><p><img src="https://i.stack.imgur.com/9CmoG.jpg?s=64&amp;g=1" alt="Francesco Polizzi&#39;s user avatar" width="32" height="32"/></p></a>
    </div>
    
</div>
                </div>
            <div>
                <div>
    <p>
        asked <span title="2015-05-22 15:33:09Z">May 22, 2015 at 15:33</span>
    </p>
    <div>
        <a href="https://mathoverflow.net/users/297/david-e-speyer"><p><img src="https://i.stack.imgur.com/MJIIi.jpg?s=64&amp;g=1" alt="David E Speyer&#39;s user avatar" width="32" height="32"/></p></a>
    </div>
    <div itemprop="author" itemscope="" itemtype="http://schema.org/Person">
        <p><a href="https://mathoverflow.net/users/297/david-e-speyer">David E Speyer</a><span itemprop="name">David E Speyer</span></p><p><span title="reputation score 141,733" dir="ltr">142k</span><span title="13 gold badges" aria-hidden="true"><span></span><span>13</span></span><span>13 gold badges</span><span title="371 silver badges" aria-hidden="true"><span></span><span>371</span></span><span>371 silver badges</span><span title="697 bronze badges" aria-hidden="true"><span></span><span>697</span></span><span>697 bronze badges</span>
        </p>
    </div>
</div>


            </div>
        </div>
    </div>
    <p><span>$\endgroup$</span>
</p></div>




            <p><span itemprop="commentCount">14</span></p>
    </div>

</div>



                <div id="answers">
                    


                                        


                                        
<div id="answer-207354" data-answerid="207354" data-parentid="207321" data-score="37" data-position-on-page="2" data-highest-scored="0" data-question-has-accepted-highest-score="1" itemprop="suggestedAnswer" itemscope="" itemtype="https://schema.org/Answer">
    <div>
        

        

<div>
    <p><span>$\begingroup$</span></p><div itemprop="text">
<p>Summarizing what Cole says for my own understanding: By methods which he doesn&#39;t make clear to me, Cole found solutions to $x^2 \equiv a \bmod N$ for many small values of $a$ and convinced himself (but not rigorously) that many other $a$ were not achievable. This gave many congruence conditions on possible divisors of $N$. In this manner, he was rapidly able to filter the integers up to $16$ million down to just a few trial divisors, none of which worked. (Note that it is okay if he winds up trying some non-prime divisors in the process.)</p>

<p>At this point, he used his data in a different way. Suppose that $N=pq$ and look at one of his small values of $a$, for example $a=-7$. Since he knew $-7$ was square modulo $N$, we deduce that $p$ and $q$ are each $ 1$ , $2$ or $4 \bmod 7$ and, since $2^{67}-1 \equiv 1 \bmod 7$, we get that $(p,q)$ is $(1,1)$, $(2,4)$ or $(4,2) \bmod 7$. This means that $(p+q)/2 \equiv 1$ or $3 \bmod 7$. In this way, he obtained many modular conditions on $(p+q)/2$, giving a few possibilities. For each possibility $x$, he checked whether $x^2-N$ was square. When he tried the right option, he had $x^2-N = ((p+q)/2)^2 - N = ((p-q)/2)^2$ and won.</p>
    </div>
    
    <p><span>$\endgroup$</span>
</p></div>




            <p><span itemprop="commentCount">3</span></p>
    </div>
</div>

                                        
<div id="answer-325119" data-answerid="325119" data-parentid="207321" data-score="22" data-position-on-page="3" data-highest-scored="0" data-question-has-accepted-highest-score="1" itemprop="suggestedAnswer" itemscope="" itemtype="https://schema.org/Answer">
    <div>
        

        

<div>
    <p><span>$\begingroup$</span></p><div itemprop="text">
<p>You assume that he did his computations by hand, but that&#39;s not a necessity. At the time, mechanical calculators (<a href="https://en.wikipedia.org/wiki/Arithmometer" rel="noreferrer">arithmometers</a>) were widely available. It&#39;s not at all unusual that the kind of person who devotes Sundays to factoring would own one.</p>

<p>These machines are orders of magnitude faster and more precise than doing computations by hand. This model from 1875 could handle 20-digit numbers, for instance. (<span>$2^{67}$</span> has 21 digits.)</p>

<p><a href="https://i.stack.imgur.com/7rHdf.png" rel="noreferrer"><img src="https://i.stack.imgur.com/7rHdf.png" alt="enter image description here"/></a></p>

<p>Multiplying two numbers on one of them takes a few seconds. To multiply 761838257287 by 193707721, for instance (assuming they fit on the machine, which isn&#39;t the case for the machine in the picture --- it can multiply two ten-digit numbers at most, natively), you&#39;d have to:</p>

<ul>
<li>reset the machine by turning a certain small reset crank or switch.</li>
<li>slide up and down the 10 linear switches in the lower-right part, one by one, to the positions corresponding to the digits of 761838257287.</li>
<li>turn the crank one time, then slide the upper slab to the right by one notch, then turn the crank again 2 times, then move the slab, then turn it 7 times, and so on for each digit of the second number, for a total of 1+9+3+7+0+7+7+2+1 = 37 turns. The number of turns made in each position is displayed on an indicator, to reduce mistakes. (those ten tiny circular holes on top of the linear switches, I think).</li>
<li>then you can read off the digits of the result in the upper row of 20 rotating indicators.</li>
</ul>

<p>Similarly, to divide (with remainder) a certain number <span>$A&lt;10^{20}$</span> by a <span>$B&lt;10^{10}$</span>, you can do the following, which directly mimics grade school division:</p>

<ul>
<li>set up the machine so that the top moving row shows the number <span>$A$</span></li>
<li>slide the upper slab to the right a certain number <span>$k$</span> of tims, so that the most significant digit of <span>$A$</span> is aligned with the most significant digit of <span>$B$</span>.</li>
<li>turn the crank in the reverse direction between 0 and 10 times; each turn subtracts <span>$10^k B$</span> from <span>$A$</span>. Stop when you&#39;d reach below zero. In practice, these machines work modulo <span>$10^{20}$</span>, and many models make a bell sound when you move below zero; so in practice you&#39;d turn the crank until you hear the bell, then make one turn back.</li>
<li>slide the upper slab one notch to the left, and continue by subtracting multiples of <span>$10^{k-1}B$</span> from the number in the top row. Continue until the upper slab is back to the original position (which means you&#39;re subtracting multiples of <span>$10^{0}B$</span> and can&#39;t slide it left anymore. Then you can read the remainder on the top row, and the quotient on a tiny (barely visible here) row of numbers below it, which kept track of how many turns were made in each position.</li>
</ul>

<p>I don&#39;t have much manual skill with these machines, but it looks like the method could be performed in a completely mindless way --- turn the crank until you hear the bell, turn it back one turn, slide left, repeat.</p>
    </div>
    <div>
        <div>
            
            


            <div>
                <div>
    <p>
        answered <span title="2019-03-10 23:14:41Z">Mar 10, 2019 at 23:14</span>
    </p>
    <div>
        <a href="https://mathoverflow.net/users/1898/federico-poloni"><p><img src="https://www.gravatar.com/avatar/9361a13cf042c0091a1f6164377cd67b?s=64&amp;d=identicon&amp;r=PG&amp;f=1" alt="Federico Poloni&#39;s user avatar" width="32" height="32"/></p></a>
    </div>
    <div itemprop="author" itemscope="" itemtype="http://schema.org/Person">
        <p><a href="https://mathoverflow.net/users/1898/federico-poloni">Federico Poloni</a><span itemprop="name">Federico Poloni</span></p><p><span title="reputation score 18,170" dir="ltr">18.2k</span><span title="2 gold badges" aria-hidden="true"><span></span><span>2</span></span><span>2 gold badges</span><span title="72 silver badges" aria-hidden="true"><span></span><span>72</span></span><span>72 silver badges</span><span title="113 bronze badges" aria-hidden="true"><span></span><span>113</span></span><span>113 bronze badges</span>
        </p>
    </div>
</div>


            </div>
        </div>
        
    
    </div>
    <p><span>$\endgroup$</span>
</p></div>




            <p><span itemprop="commentCount">2</span></p>
    </div>
</div>

                                        
<div id="answer-207406" data-answerid="207406" data-parentid="207321" data-score="14" data-position-on-page="4" data-highest-scored="0" data-question-has-accepted-highest-score="1" itemprop="suggestedAnswer" itemscope="" itemtype="https://schema.org/Answer">
    <div>
        

        

<div>
    <p><span>$\begingroup$</span></p><div itemprop="text">
<p>While the question how Cole factored $N := 2^{67}−1$ has already been answered by quid,
David Speyer&#39;s more general question is how someone could find the factors of that
number in $100000$ minutes of hand computation.</p>

<p>Assuming one would try <a href="http://en.wikipedia.org/wiki/Pollard%27s_rho_algorithm" rel="noreferrer">Pollard&#39;s rho algorithm</a> and compute the sequence
$x_1 := 1$, $x_{k+1} := (x_k^2+1) \!\! \mod n$, then one would find that
$\gcd(x_{8064} - x_{2536},n) = 193707721$. This requires $2 \cdot 8063 = 16126$
multiplications mod $n$ (in practice a bit more, since one doesn&#39;t take Gcd&#39;s
after every step), and taking a couple of Gcd&#39;s with $n$.
Now, doing a multiplication modulo a $21$-digit number in $6$ minutes by hand
is maybe tough, but plausibly possible.</p>

<p>Another option would be to try the <a href="http://en.wikipedia.org/wiki/Quadratic_sieve" rel="noreferrer">quadratic sieve</a>.
In this case, we try to see whether what <a href="http://www.gap-system.org/Packages/factint.html" rel="noreferrer">FactInt</a>&#39;s MPQS routine does
could be done by hand as well. --</p>

<p>FactInt chooses a factor base of size $92$, and takes $4096$ as length of the sieving
interval. With this, it takes $8$ polynomials until it finds enough
factorizations over the factor base (including relations with a large factor)
to obtain a factorization of $N$. Doing the sieving by hand on standard
A4 $5$mm-squared paper by marking squares would require $2$ sheets of paper
for each sieving interval of $4096$ numbers, as there are $41 \cdot 58 = 2378$
squares on each sheet, hence the sieving would take in total $8 \cdot 2 = 16$
sheets of paper.</p>

<p>Finally one would need to find the nullspace of a sparse $\mathbb{F}_2$ matrix
with $114$ columns and a few more rows, which one could write down on
$6$ of the said sheets of squared paper glued together if one uses one square
for each entry. Doing Gaussian elimination would now probably be a little
tedious by hand and would likely take up the rest of the writing pad,
but it would certainly not be infeasible with a supply of time as generous
as the assumed $100000$ minutes.</p>
    </div>
    <div>
        <div>
            


            <div>
                <div>
    <p>
        answered <span title="2015-05-23 14:08:07Z">May 23, 2015 at 14:08</span>
    </p>
    <div>
        <a href="https://mathoverflow.net/users/28104/stefan-kohl"><p><img src="https://i.stack.imgur.com/3k5W9.jpg?s=64&amp;g=1" alt="Stefan Kohl&#39;s user avatar" width="32" height="32"/></p></a>
    </div>
    <div itemprop="author" itemscope="" itemtype="http://schema.org/Person">
        <p><a href="https://mathoverflow.net/users/28104/stefan-kohl">Stefan Kohl</a><span title="Moderator">♦</span><span itemprop="name">Stefan Kohl</span></p><p><span title="reputation score 18,358" dir="ltr">18.4k</span><span title="21 gold badges" aria-hidden="true"><span></span><span>21</span></span><span>21 gold badges</span><span title="69 silver badges" aria-hidden="true"><span></span><span>69</span></span><span>69 silver badges</span><span title="127 bronze badges" aria-hidden="true"><span></span><span>127</span></span><span>127 bronze badges</span>
        </p>
    </div>
</div>


            </div>
        </div>
        
    
    </div>
    <p><span>$\endgroup$</span>
</p></div>




            
    </div>
</div>

                                        
<div id="answer-207322" data-answerid="207322" data-parentid="207321" data-score="7" data-position-on-page="5" data-highest-scored="0" data-question-has-accepted-highest-score="1" itemprop="suggestedAnswer" itemscope="" itemtype="https://schema.org/Answer">
    <div>
        

        

<div>
    <p><span>$\begingroup$</span></p><div itemprop="text">
<p>I imagine it took Cole longer than he said.  If I were to undertake the project, here is how I would proceed:</p>

<p>I would start sifting the set of numbers {134k + 1} for primes.  One can modify the Sieve of Eratosthenes to produce quite a few of the primes quickly, and then just do certain members of the arithmetic progression whether they are prime or not (say those coprime to 2310).</p>

<p>I might do trial division, but for the larger numbers, modular exponentiation/ multiplication is the way to go.  I make a table up to 2^33 of powers of two.  Given p, I multiply by the largest power of 2 less than p to get a product less than p and then double that carefully and subtract p, and then repeat until I get to 2^67 mod p.  The nice thing about this is that I can leverage earlier work: If I have 2^s = p + K for some small K, the next prime q = p +r will have 2^s = p + (K-r) + r, and so some work can be saved on some iterations.  I can see processing two or three primes in parallel this way by hand.</p>

<p>Gerhard &#34;Wonder Which TI Was Used&#34; Paseman, 2015.05.22</p>
    </div>
    <div>
        <div>
            


            <div>
                <div>
    <p>
        answered <span title="2015-05-22 15:57:06Z">May 22, 2015 at 15:57</span>
    </p>
    <div>
        <a href="https://mathoverflow.net/users/3206/gerhard-paseman"><p><img src="https://www.gravatar.com/avatar/bbf84efcc87c217f192a6aa4f3c12a66?s=64&amp;d=identicon&amp;r=PG" alt="Gerhard Paseman&#39;s user avatar" width="32" height="32"/></p></a>
    </div>
    <div itemprop="author" itemscope="" itemtype="http://schema.org/Person">
        <p><a href="https://mathoverflow.net/users/3206/gerhard-paseman">Gerhard Paseman</a><span itemprop="name">Gerhard Paseman</span></p><p><span title="reputation score " dir="ltr">3,171</span><span title="1 gold badge" aria-hidden="true"><span></span><span>1</span></span><span>1 gold badge</span><span title="16 silver badges" aria-hidden="true"><span></span><span>16</span></span><span>16 silver badges</span><span title="29 bronze badges" aria-hidden="true"><span></span><span>29</span></span><span>29 bronze badges</span>
        </p>
    </div>
</div>


            </div>
        </div>
        
    
    </div>
    <p><span>$\endgroup$</span>
</p></div>




            
    </div>
</div>


                        


                            <h2 data-loc="1">
                                
                            </h2>
                </div>
            </div>

                


    </div></div>
  </body>
</html>
