<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://castel.dev/post/research-workflow/">Original</a>
    <h1>My Mathematics PhD research workflow: LaTeX notes and instant pdf referencing</h1>
    
    <div id="readability-page-1" class="page"><div><div><p> Earlier this year I started a PhD in pure mathematics at KU Leuven in Belgium and in this blog post I discuss my research workflow. I talk about how I take daily notes, both handwritten ones and ones in LaTeX and how I handle references, featuring a way to instantly add clickable references to my notes.</p></div>

<p>Doing pure mathematics research is quite unlike other scientific research.
I don’t run experiments, nor do I have data to crunch through. A computer is surprisingly often of little to no help. It’s just you and pencil and paper.
Or in my case, me, my laptop and a Wacom tablet.</p>
<p>My research workflow is hybrid: it consists both of (digital) handwritten notes and typed LaTeX notes. I like having these two options. Handwritten notes allow me to think completely freely, while taking notes in LaTeX forces me more to write down things neatly, which sometimes results in finding mistakes in the handwritten notes.</p>
<h2 id="latex-notes">LaTeX Notes</h2>
<p>Doing a PhD in mathematics, it makes most sense to take notes in LaTeX, especially since I have a very efficient system set up already, as explained in my previous blog posts.
My LaTeX notes look as follows:</p>
<div>
<p><span>
      <a href="https://castel.dev/static/c1a4ab8ae67ee729902edc52dbc319d7/f2702/n1.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="Page 1" title="Page 1" src="https://castel.dev/static/c1a4ab8ae67ee729902edc52dbc319d7/a4de1/n1.png" srcset="/static/c1a4ab8ae67ee729902edc52dbc319d7/e3b59/n1.png 170w,
/static/c1a4ab8ae67ee729902edc52dbc319d7/d6fe0/n1.png 340w,
/static/c1a4ab8ae67ee729902edc52dbc319d7/a4de1/n1.png 680w,
/static/c1a4ab8ae67ee729902edc52dbc319d7/f2702/n1.png 725w" sizes="(max-width: 680px) 100vw, 680px" loading="lazy" decoding="async"/>
  </a>
    </span>
</p>
<p><span>
      <a href="https://castel.dev/static/c9653d35338b1678efb01f3c3b6cbb41/f2702/n2.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="Page 2" title="Page 2" src="https://castel.dev/static/c9653d35338b1678efb01f3c3b6cbb41/a4de1/n2.png" srcset="/static/c9653d35338b1678efb01f3c3b6cbb41/e3b59/n2.png 170w,
/static/c9653d35338b1678efb01f3c3b6cbb41/d6fe0/n2.png 340w,
/static/c9653d35338b1678efb01f3c3b6cbb41/a4de1/n2.png 680w,
/static/c9653d35338b1678efb01f3c3b6cbb41/f2702/n2.png 725w" sizes="(max-width: 680px) 100vw, 680px" loading="lazy" decoding="async"/>
  </a>
    </span>
</p>
<p><span>
      <a href="https://castel.dev/static/d953c520185b41669bb6ada5328a435d/f2702/n4.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="Page 3" title="Page 3" src="https://castel.dev/static/d953c520185b41669bb6ada5328a435d/a4de1/n4.png" srcset="/static/d953c520185b41669bb6ada5328a435d/e3b59/n4.png 170w,
/static/d953c520185b41669bb6ada5328a435d/d6fe0/n4.png 340w,
/static/d953c520185b41669bb6ada5328a435d/a4de1/n4.png 680w,
/static/d953c520185b41669bb6ada5328a435d/f2702/n4.png 725w" sizes="(max-width: 680px) 100vw, 680px" loading="lazy" decoding="async"/>
  </a>
    </span>
</p>
</div>
<div>
<ul>
<li><a href="#latex-notes">LaTeX Notes</a></li>
<li>
<p><a href="#reference-management">Reference management</a></p>
<ul>
<li><a href="#instantly-creating-clickable-references">Instantly creating clickable references</a></li>
<li><a href="#instantly-adding-new-papers">Instantly adding new papers</a></li>
</ul>
</li>
<li><a href="#handwritten-digital-notes">Handwritten digital notes</a></li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#short-update-on-unrelated-things">Short update on unrelated things</a></li>
</ul>
</div>
<p>This LaTeX document automatically concatenates the notes of the previous 14 days, adds the date of each note in the margin and adds a link to my handwritten notes of that day. The global directory structure looks as follows:</p>
<ul>
    <li>phd
        <ul>
        <li>scripts</li>
        <li>teaching</li>
        <li>papers
        <ul>
            <li>title - authors.pdf</li>
            <li>...</li>
        </ul>
        </li>
        <li>notes
            <ul>
                <li>master.tex</li>
                <li>preamble.tex</li>
                <li>references.tex</li>
                <li>theorems.tex</li>
                <li>symbols.tex</li>
                <li>2022-01-03
                    <ul>
                        <li>note.tex</li>
                        <li>note.xoj</li>
                    </ul>
                </li>
                <li>2022-01-04</li>
                <li>2022-01-05</li>
                <li>...</li>
            </ul>
        </li>
        </ul>
    </li>
</ul>
<p>Since I have a note for every day I never have to think about where to write something down. I just press <kbd>Alt</kbd> + <kbd>N</kbd> to open today’s <span>note.tex</span>, and I’m set.
To open the handwritten notes I can press <kbd>Alt</kbd> + <kbd>X</kbd>, which opens <a href="http://xournal.sourceforge.net/">Xournal</a> — more on that later.
You can find the source code on <a href="https://gist.github.com/gillescastel/7e8a0dc54f62182acde62503b2e8f1d7#file-master-tex" target="_blank" rel="nofollow noopener noreferrer">Github</a>.</p>
<h2 id="reference-management">Reference management</h2>
<p>Doing research means dealing with a lot of references to papers and books.
I wanted to have a minimalistic approach that is friction-free, having three goals in mind. First, when I am reading a pdf document, I want to be able to add a reference to the current page to my notes with a single keystroke. Secondly, when browsing the Arxiv, I’d like to add a paper to my library with a single click and lastly I want a way to instantly open papers I have in my library, which is really useful during meetings.</p>
<h3 id="instantly-creating-clickable-references">Instantly creating clickable references</h3>
<p>Have a look back at my notes and notice the parts that are in bold, such as <b>[definition, p. 29]</b> or <b>[Section 5. Infinitesimal deformations, p. 23]</b>.
These are links to papers, books, … and when I click them, my pdf viewer opens the file at the corresponding page.
This makes it easy to get back in the flow reading old notes: I don’t lose time searching for certain definitions of concepts, I can just click the link and get back on track immediately.</p>
<p>I made it extremely easy to create these kind of references. When I have any document open in my pdf viewer and I press <kbd>Alt</kbd>+<kbd>F</kbd>, it copies some LaTeX code referring to the current page of the currently opened pdf. I just press <kbd>p</kbd> to paste this in Vim, and the link is created. This also works in Firefox, creating a reference to the currently opened tab.</p>
<p>An example of a reference to a web pages:</p>
<p><img alt="Referring to a web page" src="https://castel.dev/f6922b9311fbb07740265093d23d61e6/url-reference.gif"/></p><p>A references to a local pdf document:</p>
<p><img alt="Referring to a pdf document" src="https://castel.dev/0c264d080d659b6442f3d15a1fe1ede5/pdf-reference.gif"/></p><p>In the video above, I generate a reference to page 61 of ‘Generalized Complex Geometry’, by Marco Gualtieri and I paste the generated code in Vim:</p>
<div data-language="tex"><pre><code><span>\pdfref</span><span>{</span>gcg<span>}</span><span>{</span>61<span>}</span><span>{</span>Gualtieri<span>}</span></code></pre></div>
<p>The first argument, <code>gcg</code>, is an identifier I’ve assigned to this document.
When referring to a document for the first time,
I get asked once to assign it an id, which is then used automatically thereafter.
The second argument <code>61</code> is of course the page number, and the third one, <code>Gualtieri</code>, is the title of the pdf file. This is what gets printed when I compile the document. It is easy enough to quickly change using <kbd>c</kbd><kbd>i</kbd><kbd>}</kbd>, or I can change the default by changing the title of the pdf.</p>
<p>As shown in the video, clicking on the link opens the document on the referenced page.
Having made referencing so low effort, I tend to do it way more often, which saves me much time later on.</p>
<p>If you’re interested in the technical side of things, click below to expand the section, otherwise skip to the next one. In any case you can find the code and setup instructions on <a href="https://github.com/gillescastel/instant-reference" target="_blank" rel="nofollow noopener noreferrer">Github</a>.</p>
<details>
<summary>Technical details: Custom protocol handlers and DBus/gvfs</summary>
<p>While seemingly simple, this was surprisingly difficult to pull off.
Creating a link in a pdf that opens a local file is not hard: instead of using the <code>http://path</code>, you can use <code>run:path</code> and this tries to open the file located at <code>path</code>. This is for example how the links to the handwritten notes work.</p>
<p>This works similarly for linking to pdf files, but there is not a standard way to open a file at a current page. Some pdf viewer support <code>path#page=1</code>, but not all of them, and mine doesn’t.
The solution? Defining a custom protocol! I named it <code>phd</code> for lack of better imagination.
Now I create a link to <code>phd://open-paper?id=gcg&amp;page=61</code>. I configured a custom protocol handler for handling these kinds of links, which then runs <code>pdf-viewer --page 1 path</code>, opening the file at the correct page. Here, <code>path</code> the path of the document that corresponds to <code>id</code>.</p>
<p>For actually getting the path and page number of the currently opened pdf file, I used <a href="https://en.wikipedia.org/wiki/D-Bus" target="_blank" rel="nofollow noopener noreferrer">DBus</a> for my preferred pdf viewer <a href="https://pwmt.org/projects/zathura/" target="_blank" rel="nofollow noopener noreferrer">Zathura</a>, and I managed to get it working via <a href="https://en.wikipedia.org/wiki/GVfs" target="_blank" rel="nofollow noopener noreferrer">gvfs</a> for <a href="https://wiki.gnome.org/Apps/Evince" target="_blank" rel="nofollow noopener noreferrer">Evince</a>, the default pdf viewer on Gnome.
Using gvfs for this is a bit of a hack, as this is a virtual file system for storing metadata on files, in this case for remembering the page you last looked at. But because Evince updates this whenever you scroll, this is actually the same as the current page. Why Evince does not support retrieving the current page through DBus is beyond me.</p>
</details>
<h3 id="instantly-adding-new-papers">Instantly adding new papers</h3>
<p>To add a new paper to my library, I added a userscript to my browser to add a button to the ArXiv labeled ‘Add to Library’. When I click on this, the pdf file gets downloaded to my <span>papers</span> directory and named <span>Title - Authors.pdf</span>. Also the metadata is set accordingly and the pdf opens in my pdf reader.</p>
<p><span>
      <a href="https://castel.dev/static/001c087f09b6ad862a0ca5368e3eafbc/bed0d/arxiv2.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="ArXiv add to library button" title="ArXiv add to library button" src="https://castel.dev/static/001c087f09b6ad862a0ca5368e3eafbc/a4de1/arxiv2.png" srcset="/static/001c087f09b6ad862a0ca5368e3eafbc/e3b59/arxiv2.png 170w,
/static/001c087f09b6ad862a0ca5368e3eafbc/d6fe0/arxiv2.png 340w,
/static/001c087f09b6ad862a0ca5368e3eafbc/a4de1/arxiv2.png 680w,
/static/001c087f09b6ad862a0ca5368e3eafbc/e9ece/arxiv2.png 1020w,
/static/001c087f09b6ad862a0ca5368e3eafbc/bed0d/arxiv2.png 1304w" sizes="(max-width: 680px) 100vw, 680px" loading="lazy" decoding="async"/>
  </a>
    </span></p><p>To open a paper in my library, I can press <kbd>Alt</kbd>+<kbd>P</kbd> and fuzzy search through the list:</p>
<p><img alt="Alt-P opens a fuzzy search" src="https://castel.dev/f24b81b4bfb5f82d341383d26016ba57/alt-p.gif"/></p><p>If the paper doesn’t exists, it searches for it on ArXiv.</p>
<h2 id="handwritten-digital-notes">Handwritten digital notes</h2>
<p>While the LaTeX notes are great for referencing later on, I also take handwritten notes using <a href="http://xournal.sourceforge.net/" target="_blank" rel="nofollow noopener noreferrer">Xournal</a>.
This is where I first go to if I have ideas, and only later I turn the (possibly) interesting ones into LaTeX.</p>
<p>I take my handwritten notes using a Wacom drawing tablet (One by Wacom Medium).
I thought about buying a tablet like Remarkable or an Android tablet, but this setup gives me most flexibility, and it is also extremely cheap compared to other approaches (especially when you use the drawing tablet of your girlfriend).</p>
<p>Xournal is a minimalist note taking app that works well with Wacom tablets. Below you see me using it.</p>
<p><img alt="A video showing how I use Xournal" src="https://castel.dev/16ede057a685e9fe44c31fc4c4767954/xournal2.gif"/></p><p>Digital notes have quite a few advantages.
The page size is practically infinite, which really helps when dealing with some nasty expressions. You can assign a button on the pen to delete entire strokes at once, which makes it very easy to quickly redraw a letter or change up some symbols. These settings are not default, you can find my configuration on <a href="https://gist.github.com/gillescastel/7e8a0dc54f62182acde62503b2e8f1d7#file-xournal-config" target="_blank" rel="nofollow noopener noreferrer">Github</a>. I also disable pressure sensitivity as I find it distracts more than it does good.</p>
<p>Copy and paste is also something you obviously don’t get with pencil and paper. Having this feature makes me do smaller steps and less in my head, which decreases the amount of errors I make. I simply copy the previous expression, make a few small alterations and repeat. Not having to rewrite it increases my patience and decreases transcription errors.</p>
<p>Another useful feature is increasing or decreasing vertical space.
I can simply drag and create more space to write something extra or remove space to condense everything a bit.</p>
<h2 id="conclusion">Conclusion</h2>
<p>I’ve been using this system for about half a year now and I’m very happy with how things are going. Having everything organized and being able to manage references this easy makes it much more enjoyable to do research. I especially love how I can look back at notes of months ago and get back in the flow immediately by clicking on the references.</p>
<h2 id="short-update-on-unrelated-things">Short update on unrelated things</h2>
<p>By request of many people, I published the <a href="https://github.com/gillescastel/lecture-notes/" target="_blank" rel="nofollow noopener noreferrer">source code of some of my lecture notes</a> on Github, as well as the LaTeX code for my <a href="https://github.com/gillescastel/masterthesis" target="_blank" rel="nofollow noopener noreferrer">Master’s thesis</a> containing a lot of nice pictures.</p>
<p>In the meanwhile, I’m working on a framework called <em>Immersion</em> for creating mathematical presentations.
You can see some of the presentations I’ve made with it on my <a href="https://castel.dev/talks/" target="_blank" rel="nofollow noopener noreferrer">talks page</a>.
It features LaTeX support, a visual editor for animating formulae, an easy way to animate SVG figures, presenter notes, references, and I’ve been using it for all my presentations for the last two years. My goal is to make it public in the near future, but it still requires quite a lot of work to make it user friendly.</p>
<p>Liked this blog post? Consider <a href="https://castel.dev/coffee">buying me a coffee</a>!</p></div></div>
  </body>
</html>
