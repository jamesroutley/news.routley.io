<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.lightbluetouchpaper.org/2022/01/20/arm-releases-experimental-cheri-enabled-morello-board-as-part-of-187m-ukri-digital-security-by-design-programme/">Original</a>
    <h1>Arm releases experimental CHERI-enabled Morello board</h1>
    
    <div id="readability-page-1" class="page"><div>
		
<p>Professor Robert N. M. Watson (Cambridge), Professor Simon W. Moore (Cambridge), Professor Peter Sewell (Cambridge), Dr Jonathan Woodruff (Cambridge), Brooks Davis (SRI), and Dr Peter G. Neumann (SRI)</p>



<p>After over a decade of research creating the <a href="https://www.cl.cam.ac.uk/research/security/ctsrd/cheri/">CHERI protection model, hardware, software, and formal models and proofs</a>, developed over three DARPA research programmes, we are at a truly exciting moment. Today, <a href="https://www.arm.com/company/news/2022/01/morello-research-program-hits-major-milestone-with-hardware-now-available-for-testing">Arm announced first availability of its experimental CHERI-enabled Morello processor, System-on-Chip, and development board</a> – an industrial quality and industrial scale demonstrator of CHERI merged into a high-performance processor design. Not only does Morello fully incorporate the features described in our <a href="https://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-951.pdf">CHERI ISAv8 specification</a> to provide fine-grained memory protection and scalable software compartmentalisation, but it also implements an Instruction-Set Architecture (ISA) with <a href="https://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-959.pdf">formally verified security properties</a>. The <a href="https://arm.com/morello" data-type="URL" data-id="https://arm.com/morello">Arm Morello Program</a> is supported by the <a href="https://www.dsbd.tech">£187M UKRI Digital Security by Design (DSbD) research programme</a>, a UK government and industry-funded effort to transition CHERI towards mainstream use.</p>



<h2>CHERI and Morello</h2>



<p>The University of Cambridge and <a href="http://www.csl.sri.com/">SRI International</a> began work on the CHERI architectural protection model in 2010 as part of <a href="https://www.darpa.mil/program/clean-slate-design-of-resilient-adaptive-secure-hosts">DARPA’s CRASH programme</a>, with support exceeding $30M from DARPA across two further research programmes, <a href="https://www.darpa.mil/program/mission-oriented-resilient-clouds">MRC</a> and <a href="https://www.darpa.mil/program/ssith">SSITH</a>, with additional support from EPSRC, ERC, Arm, Google, and HP. CHERI implements <em>architectural capabilities</em> that directly enable software security features such as fine-grained memory protection and scalable software compartmentalisation — both important software vulnerability mitigation techniques that are not well supported on current processor architectures. Hardware-supported capabilities are an old idea in computer science, and of particular historic interest at Cambridge where the <a href="https://en.wikipedia.org/wiki/CAP_computer">CAP Computer</a> was prototyped – but in 2010, their application to contemporary processor architectures and software stacks was open territory for new blue-sky research.</p>



<p>By the end of the CRASH programme in 2015, we had successfully developed an early FPGA-based prototype beginning to demonstrate the promise of such an idea, focused on providing a platform able to efficiently run memory-safe C/C++ and open the door to new, more secure software architectures based on high-performance compartmentalisation. However, many open questions remained – not least, whether there were potential successful integrations with industrial-scale processor designs, efficient microarchitectural implementations of capabilities and memory tagging, viable compiler and OS techniques that could use them, and clear and valuable applications large-scale software corpora.</p>



<p><a href="https://www.arm.com">Arm</a> joined the collaboration in 2014, and it has been an exciting and at times intense journey as we worked side-by-side to address many challenging obstacles. Until the start of the pandemic in March 2020, we had Arm engineers working side-by-side with us at the William Gates Building at the University of Cambridge, as well as industrial collaborators from companies such as Google and Microsoft working together to address a long series of hardware, software, and formal methodology challenges in adopting and using the technology – those collaborations now continue online. During our collaboration, we developed new architectural approaches (e.g., <a href="https://www.cl.cam.ac.uk/research/security/ctsrd/pdfs/2019tc-cheri-concentrate.pdf">compressed capabilities</a> and <a href="https://www.cl.cam.ac.uk/research/security/ctsrd/pdfs/2020oakland-cornucopia.pdf">CHERI temporal safety</a>), microarchitectural techniques (e.g., <a href="https://www.cl.cam.ac.uk/research/security/ctsrd/pdfs/201711-iccd2017-efficient-tags.pdf">tag controllers and caches</a>), new operating system approaches (e.g., <a href="https://www.cl.cam.ac.uk/research/security/ctsrd/pdfs/201904-asplos-cheriabi.pdf">memory-safe UNIX process environment</a>), new language and compiler techniques (e.g., <a href="https://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-947.pdf">memory-safe C compilation and linkage</a>), and formal approaches (<a href="https://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-940.pdf">including proofs about ISA-based malicious code containment</a>). Each one of these concepts has been utilised in creating the prototype architecture used in Morello, its hardware, and its software stack. You can learn more about these and other aspects of CHERI by reading our <a href="https://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-941.pdf">Introduction to CHERI</a> technical report.</p>



<p>A key tenet of our collaboration has been an open approach to prevent intellectual property impediments to use of the “capability essential IP” necessary to implement CHERI in other Instruction-Set Architectures. Further details can be found in our recent <a href="https://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-953.pdf">Capability Essential IP technical report</a> declaring those concepts.</p>



<div><figure><a href="https://www.lightbluetouchpaper.org/wp-content/uploads/2022/01/Morello-Chip-Photo.jpg"><img loading="lazy" width="512" height="246" src="https://www.lightbluetouchpaper.org/wp-content/uploads/2022/01/Morello-Chip-Photo.jpg" alt="" srcset="https://www.lightbluetouchpaper.org/wp-content/uploads/2022/01/Morello-Chip-Photo.jpg 512w, https://www.lightbluetouchpaper.org/wp-content/uploads/2022/01/Morello-Chip-Photo-300x144.jpg 300w" sizes="(max-width: 512px) 100vw, 512px"/></a></figure></div>



<p>Arm’s engineers took as their starting point the existing Arm Neoverse N1 design, which is used in Arm-based servers at major cloud providers. The result was a new, experimental chip and board, Morello, which will now become a development, evaluation, and demonstration platform for dozens of UK-based companies and universities participating in Digital Security by Design. Many further boards have been ordered by international research labs and governments eager to explore the technology. Collectively, we aim to develop new software models enabled by CHERI, and to evaluate its impacts on security, compatibility, and performance, building on already substantial work exploring these concerns across open-source operating systems and applications.</p>



<p>Rich research agendas (e.g., <a href="https://msrc-blog.microsoft.com/2022/01/20/an_armful_of_cheris/">as written about today by Microsoft</a>) and demonstrators (e.g., <a href="https://soteriaresearch.org">THG and Manchester University’s Soteria demonstrator</a>) will explore a huge range of application workloads and approaches to utilising CHERI’s protections across various operating systems, programming languages, and applications. What does all of that software have in common? A long history of security vulnerabilities that demand disruptive change able to dramatically reduce them, and that is able confine successful attacks. Recent studies at the Microsoft Security Response Center (MSRC), <a href="https://github.com/microsoft/MSRC-Security-Research/raw/master/papers/2020/Security%20analysis%20of%20CHERI%20ISA.pdf">exploring past Microsoft security vulnerabilities</a>, and Capabilities Limited, <a href="http://www.capabilitieslimited.co.uk/pdfs/20210917-capltd-cheri-desktop-report-version1-FINAL.pdf">looking at the open-source desktop software ecosystem</a>, have estimated that CHERI can deterministically mitigate, respectively, in excess of 67% and 74% of past vulnerabilities. However, these security claims, and implied requirements for low performance overheads, require experimental validation that now possible with Arm’s Morello prototype.</p>



<h2>What Morello has already demonstrated</h2>



<p>We are hitting the ground running: Within weeks of first preproduction chips arriving at Arm’s facilities in Cambridge, England, our full CHERI prototype software stack was running on early development boards. This includes Cambridge and SRI’s memory-safe <a href="https://www.cl.cam.ac.uk/research/security/ctsrd/cheri/cheribsd.html">CheriBSD UNIX kernel</a> (a CHERI-enabled version of the open-source <a href="https://www.freebsd.org/">FreeBSD</a> kernel), memory-safe CheriABI UNIX userspace including programs such as OpenSSH, and CHERI-adapted applications such as <a href="https://www.cl.cam.ac.uk/research/security/ctsrd/cheri/cheri-webkit.html">Apple’s WebKit</a> including its JavaScriptCore (JSC) just-in-time (JIT) compiler adapted to target Morello (developed in collaboration with Arm), as well Arm’s own work on the Android operating system. With multiple boards now at our own lab in Cambridge, we are starting on early performance evaluation of CHERI’s spatial and temporal memory-safety features, bringing up GPU device drivers required to support a rich user-facing application ecosystem, and preparing to support a growing research ecosystem as further Morello boards are received by research partners around the world.</p>



<p>It is worth reflecting on what has been achieved. We have now experimentally validated a number of key hypotheses developed during our early work in DARPA’s CRASH programme:</p>



<p><strong>Architecture</strong>: That an architectural capability-system model can be successfully atom smashed with a contemporary, MMU-enabled ISA such as Armv8-A.</p>



<p><strong>Formal methods</strong>: That it is possible to formally model and verify the security of that architecture specification, with machine-checked mathematical proof about its full 60,000 line definition, showing it ensures goals such as malicious code confinement, as well as to automatically generate hardware test suites from the same models.</p>



<p><strong>Microarchitecture</strong>: That an architectural capability-system model can be implemented in a high-performance, industrial quality multicore superscalar processor implementation, including microarchitecture such as CHERI’s compressed capabilities and a tag controller/cache model. Morello is based on Arm’s widely used Neoverse N1 microarchitecture – very much the “real thing” – and achieves 2.5Ghz, its target clock frequency.</p>



<p><strong>Memory-safe C/C++</strong>: That it is possible to support memory-safe variants of C and C++ (“CHERI C/C++”) using that architecture, through recompilation using industrial compiler toolchains such as LLVM, providing strong and deterministic spatial and referential memory safety for a large corpus of off-the-shelf C/C++ software with minimal modification.</p>



<p><strong>Memory-safe UNIX</strong>: That it is possible to compile and run a memory-safe version of a fully fledged UNIX operating system kernel and userspace with minor adaptions.</p>



<p>These results are, to say the least, surprising – none were foregone conclusions, and it’s only in the final stages of the Morello implementation process that we have confidence that they are indeed true.</p>



<h2>Our next directions at Cambridge and SRI</h2>



<p>We are now turning our attention to a series of escalating experiments over the coming months and years, as prototype silicon becomes more widely available:</p>



<p><strong>Software performance</strong>: That, across a rich variety of software components and workloads (SPEC, web browsers, language runtimes, OS kernels, …) we can achieve acceptable performance-security trade-offs for spatial and temporal safety.</p>



<p><strong>Microarchitectural choices</strong>: Exploring the cost and performance of various microarchitectural designs and parameter choices with respect to tagging, capability compression, branch prediction, and so on. Exploring how CHERI scales to exascale systems.  Ensuring that emerging threats like speculative execution attacks are mitigated</p>



<p><strong>Compartmentalisation</strong>: That CHERI compartmentalisation achieves the greater than an order-of-magnitude improvements compared to MMU separation seen in FPGA-based experiments, as well as compartment scalability, and that multiple viable software models can be implemented conveniently and efficiently over CHERI primitives.</p>



<p><strong>Source-level compatibility and quality</strong>: That the compatibility objectives permitting widespread deployment across current C and C++ software can be met across a large code corpus, and with sufficient quality of implementation to support Morello consumers.</p>



<p><strong>Security evaluation</strong>: That further evaluation including formal analysis, analytic studies, and practical penetration testing, show that CHERI fulfils the promises of fine-grained memory protection and scalable compartmentalisation.</p>



<p>All of this work is dependent on a heavy software-engineering agenda to explore these ideas through hands-on experimentation with real-world, large-scale software stacks. We look forward to the coming years as we get to work with collaborators on these and many other topics.</p>



<h2>Acknowledgements</h2>



<p>CHERI and Morello are the result of hundreds of staff years of effort across Cambridge, SRI, Arm, Microsoft, Google, and others. From the PhD students and postdocs exploring novel approaches to microarchitecture, compilers, and operating systems, to the research software engineers, consultants, and industrial collaborators who led research development efforts essential to the transition of this work, as well as the amazing team at Arm working on Morello architecture, hardware, and software, this truly has been a vast collective effort.</p>



<p>We are especially wish to thank our current and past collaborators at Cambridge and SRI, with whom it has been an honour to work for over a decade, including: Hesham Almatary, Jonathan Anderson, Alasdair Armstrong, Peter Blandford-Baker, John Baldwin, Hadrien Barrel, Thomas Bauereiss, Ruslan Bukin, Brian Campbell, David Chisnall, Jessica Clarke, Nirav Dave, Lawrence Esswood, Nathaniel W. Filardo, Franz Fuchs, Dapeng Gao, Khilan Gudka, Brett Gutstein, Alexandre Joannou, Mark Johnston, Robert Kovacsics, Ben Laurie, A. Theo Markettos, J. Edward Maste, Alfredo Mazzinghi, Alan Mujumdar, Prashanth Mundkur, Steven J. Murdoch, Edward Napierala, Kyndylan Nienhuis, George Neville-Neil, Robert Norton-Wright, Philip Paeps, Lucian Paul-Trifu, Allison Randal, Ivan Ribeiro, Alex Richardson, Michael Roe, Colin Rothwell, Peter Rugg, Hassen Saidi, Peter Sewell, Thomas Sewell, Stacey Son, Ian Stark, Domagoj Stolfa, Andrew Turner, Munraj Vadera, Konrad Witaszczyk, Hongyan Xia, and Bjoern A. Zeeb. We are very pleased that so many of the students and postdocs who have moved on from Cambridge to industry continue to actively collaborate with us on CHERI at companies such as Google and Microsoft.</p>



<p>Our eight-year collaboration with Arm has been incredibly rewarding, and we wish to thank Graeme Barnes, Richard Grisenthwaite, Lee Smith, Hugo Vincent, Lee Eisen, Kevin Brodsky, Ruben Ayrapetyan, Silviu Baranga, Karthik Muthusamy, Mark Nicholson, Mark Inskip, and countless others with whom it has been a great pleasure to work with, and to learn so much from. Our expanding collaboration with Microsoft has also been extremely productive, and we particularly wish to thank Manuel Costa, Saar Amar, and Nicolas Joly.</p>



<p>Finally, we are grateful to Howie Shrobe, MIT professor and past DARPA CRASH and MRC program manager, who offered both technical insight and support throughout this work.  We are also grateful to Robert Laddaga, Stu Wagner, and Jonathan Smith, who succeeded Howie in overseeing the CRASH program, John Launchbury (DARPA I2O office director), Dale Waters (DARPA AEO office director), Linton Salmon (DARPA SSITH program manager), Keith Rebello (DARPA SSITH program manager), Daniel Adams and Laurisa Goergen (DARPA I2O SETAs supporting the CRASH and MRC programs), Marnie Dunsmore and John Marsh (DARPA MTO SETAs supporting the SSITH program), John Goodacre (UKRI), and Georgios Papadakis (UKRI).</p>
	</div></div>
  </body>
</html>
