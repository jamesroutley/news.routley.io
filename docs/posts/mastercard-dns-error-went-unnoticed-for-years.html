<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://krebsonsecurity.com/2025/01/mastercard-dns-error-went-unnoticed-for-years/">Original</a>
    <h1>Mastercard DNS Error Went Unnoticed for Years</h1>
    
    <div id="readability-page-1" class="page"><div>
												<p>The payment card giant <strong>MasterCard</strong> just fixed a glaring error in its domain name server settings that could have allowed anyone to intercept or divert Internet traffic for the company by registering an unused domain name. The misconfiguration persisted for nearly five years until a security researcher spent $300 to register the domain and prevent it from being grabbed by cybercriminals.</p>
<div id="attachment_70128"><p><img aria-describedby="caption-attachment-70128" decoding="async" src="https://krebsonsecurity.com/wp-content/uploads/2025/01/akamne.png" alt="" width="667" height="478"/></p><p id="caption-attachment-70128">A DNS lookup on the domain az.mastercard.com on Jan. 14, 2025 shows the mistyped domain name a22-65.akam.ne.</p></div>
<p>From June 30, 2020 until January 14, 2025, one of the core Internet servers that MasterCard uses to direct traffic for portions of the mastercard.com network was misnamed. MasterCard.com relies on five shared Domain Name System (DNS) servers at the Internet infrastructure provider <strong>Akamai </strong>[DNS acts as a kind of Internet phone book, by translating website names to numeric Internet addresses that are easier for computers to manage].</p>
<p>All of the Akamai DNS server names that MasterCard uses are supposed to end in “akam.net” but one of them was misconfigured to rely on the domain “<strong>akam.ne</strong>.”</p>
<p>This tiny but potentially critical typo was discovered recently by <strong>Philippe Caturegli</strong>, founder of the security consultancy <a href="https://www.seralys.com/" target="_blank" rel="noopener">Seralys</a>. Caturegli said he guessed that nobody had yet registered the domain akam.ne, which is under the purview of the top-level domain authority for the West Africa nation of <a href="https://en.wikipedia.org/wiki/Niger" target="_blank" rel="noopener">Niger</a>.</p>
<p>Caturegli said it took $300 and nearly three months of waiting to secure the domain with the registry in Niger. After enabling a DNS server on akam.ne, he noticed hundreds of thousands of DNS requests hitting his server each day from locations around the globe. Apparently, MasterCard wasn’t the only organization that had fat-fingered a DNS entry to include “akam.ne,” but they were by far the largest.</p>
<p>Had he enabled an email server on his new domain akam.ne, Caturegli likely would have received wayward emails directed toward mastercard.com or other affected domains. If he’d abused his access, he probably could have <a href="https://krebsonsecurity.com/2024/08/local-networks-go-global-when-domain-names-collide/" target="_blank" rel="noopener">obtained website encryption certificates (SSL/TLS certs)</a> that were authorized to accept and relay web traffic for affected websites. He may even have been able to <a href="https://krebsonsecurity.com/2020/02/dangerous-domain-corp-com-goes-up-for-sale/" target="_blank" rel="noopener">passively receive Microsoft Windows authentication credentials</a> from employee computers at affected companies.</p>
<p>But the researcher said he didn’t attempt to do any of that. Instead, he alerted MasterCard that the domain was theirs if they wanted it, copying this author on his notifications. A few hours later, MasterCard acknowledged the mistake, but said there was never any real threat to the security of its operations.</p>
<p>“We have looked into the matter and there was not a risk to our systems,” a MasterCard spokesperson wrote. “This typo has now been corrected.”</p>
<p>Meanwhile, Caturegli received a request submitted through <strong>Bugcrowd</strong>, a program that offers financial rewards and recognition to security researchers who find flaws and work privately with the affected vendor to fix them. The message suggested his public disclosure of the MasterCard DNS error via <a href="https://www.linkedin.com/feed/update/urn:li:activity:7285038365236682753/" target="_blank" rel="noopener">a post on LinkedIn</a> (after he’d secured the akam.ne domain) was not aligned with ethical security practices, and passed on a request from MasterCard to have the post removed.</p>
<div id="attachment_70126"><p><img aria-describedby="caption-attachment-70126" decoding="async" loading="lazy" src="https://krebsonsecurity.com/wp-content/uploads/2025/01/mastercard-response.png" alt="" width="708" height="855"/></p><p id="caption-attachment-70126">MasterCard’s request to Caturegli, a.k.a. “Titon” on infosec.exchange.</p></div>
<p>Caturegli said while he does have an account on Bugcrowd, he has never submitted anything through the Bugcrowd program, and that he reported this issue directly to MasterCard.</p>
<p>“I did not disclose this issue through Bugcrowd,” Caturegli wrote in reply. “Before making any public disclosure, I ensured that the affected domain was registered to prevent exploitation, mitigating any risk to MasterCard or its customers. This action, which we took at our own expense, demonstrates our commitment to ethical security practices and responsible disclosure.” <span id="more-70117"></span></p>
<p>Most organizations have at least two authoritative domain name servers, but some handle so many DNS requests that they need to spread the load over additional DNS server domains. In MasterCard’s case, that number is five, so it stands to reason that if an attacker managed to seize control over just one of those domains they would only be able to see about one-fifth of the overall DNS requests coming in.</p>
<p>But Caturegli said the reality is that many Internet users are relying at least to some degree on public traffic forwarders or DNS resolvers like <strong>Cloudflare</strong> and <strong>Google</strong>.</p>
<p>“So all we need is for one of these resolvers to query our name server and cache the result,” Caturegli said. By setting their DNS server records with a long TTL or “Time To Live” — a setting that can adjust the lifespan of data packets on a network — an attacker’s poisoned instructions for the target domain can be propagated by large cloud providers.</p>
<p>“With a long TTL, we may reroute a LOT more than just 1/5 of the traffic,” he said.</p>
<p>The researcher said he’d hoped that the credit card giant might thank him, or at least offer to cover the cost of buying the domain.</p>
<p>“We obviously disagree with this assessment,” Caturegli wrote in <a href="https://www.linkedin.com/feed/update/urn:li:activity:7285038365236682753?commentUrn=urn%3Ali%3Acomment%3A%28activity%3A7285038365236682753%2C7285289297706909697%29&amp;dashCommentUrn=urn%3Ali%3Afsd_comment%3A%287285289297706909697%2Curn%3Ali%3Aactivity%3A7285038365236682753%29" target="_blank" rel="noopener">a follow-up post</a> on LinkedIn regarding MasterCard’s public statement. “But we’ll let you judge— here are some of the DNS lookups we recorded before reporting the issue.”</p>
<div id="attachment_70125"><p><img aria-describedby="caption-attachment-70125" decoding="async" loading="lazy" src="https://krebsonsecurity.com/wp-content/uploads/2025/01/mastercard-domains.png" alt="" width="790" height="561" srcset="https://krebsonsecurity.com/wp-content/uploads/2025/01/mastercard-domains.png 790w, https://krebsonsecurity.com/wp-content/uploads/2025/01/mastercard-domains-768x545.png 768w, https://krebsonsecurity.com/wp-content/uploads/2025/01/mastercard-domains-782x555.png 782w, https://krebsonsecurity.com/wp-content/uploads/2025/01/mastercard-domains-100x70.png 100w" sizes="(max-width: 790px) 100vw, 790px"/></p><p id="caption-attachment-70125">Caturegli posted this screenshot of MasterCard domains that were potentially at risk from the misconfigured domain.</p></div>
<p>As the screenshot above shows, the misconfigured DNS server Caturegli found involved the MasterCard subdomain <strong>az.mastercard.com</strong>. It is not clear exactly how this subdomain is used by MasterCard, however their naming conventions suggest the domains correspond to production servers at Microsoft’s <strong>Azure</strong> cloud service. Caturegli said the domains all resolve to Internet addresses at Microsoft.</p>
<p>“Don’t be like Mastercard,” Caturegli concluded in his LinkedIn post. “Don’t dismiss risk, and don’t let your marketing team handle security disclosures.”</p>
<p>One final note: The domain akam.ne has been registered previously — in December 2016 by someone using the email address um-i-delo@yandex.ru. The Russian search giant Yandex reports this user account belongs to an “Ivan I.” from Moscow. Passive DNS records from <a href="https://www.domaintools.com" target="_blank" rel="noopener">DomainTools.com</a> show that between 2016 and 2018 the domain was connected to an Internet server in Germany, and that the domain was left to expire in 2018.</p>
<p>This is interesting given <a href="https://www.linkedin.com/feed/update/urn:li:activity:7285038365236682753?commentUrn=urn%3Ali%3Acomment%3A%28activity%3A7285038365236682753%2C7285221445796835329%29&amp;replyUrn=urn%3Ali%3Acomment%3A%28activity%3A7285038365236682753%2C7285223757982363648%29&amp;dashCommentUrn=urn%3Ali%3Afsd_comment%3A%287285221445796835329%2Curn%3Ali%3Aactivity%3A7285038365236682753%29&amp;dashReplyUrn=urn%3Ali%3Afsd_comment%3A%287285223757982363648%2Curn%3Ali%3Aactivity%3A7285038365236682753%29" target="_blank" rel="noopener">a comment on Caturegli’s LinkedIn post from an ex-Cloudflare employee</a> who linked to a report he co-authored on a similar typo domain apparently registered in 2017 for organizations that may have mistyped their AWS DNS server as “<strong>awsdns-06.ne</strong>” instead of “<strong>awsdns-06.net</strong>.” DomainTools reports that this typo domain also was registered to a Yandex user (playlotto@yandex.ru), and was hosted at the same German ISP — Team Internet (AS61969).</p>
											</div></div>
  </body>
</html>
