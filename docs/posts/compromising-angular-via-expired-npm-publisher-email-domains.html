<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://thehackerblog.com/zero-days-without-incident-compromising-angular-via-expired-npm-publisher-email-domains-7kZplW4x/">Original</a>
    <h1>Compromising Angular via expired NPM publisher email domains</h1>
    
    <div id="readability-page-1" class="page"><div>

<p><strong>NOTE:</strong> <em>If you’re just looking for the high level points, see the
“<a href="#the-tldr-summary--high-level-points">The TL;DR Summary &amp; High-Level
Points</a>” section of this
post.</em></p>
<p>Recently I took an interest in the <a href="https://www.npmjs.com/">npm
registry</a> due to it’s critical role in
the security of managing packages for all of JavaScript and Node. After
registering an account and creating an example package, I began looking
through various web endpoints to understand what sort of system I was
dealing with.</p>

<p>While browsing various popular packages, I noticed one fairly unique
thing to the registry: email addresses for all users are public. For
example, requesting my own <a href="https://www.npmjs.com/~mandatory">profile
page</a> returned my email
address:</p>
<p><img src="https://docpusher.s3.amazonaws.com/images/fece4fff8be683f3787a6f14d791d467/image14.png" alt="alt text"/></p>
<p><em>HTTP response including my npm account email.</em></p>
<p>Spam concerns aside, this is an interesting choice for a registry as it
publicly discloses the email addresses for maintainers of all npm
packages. An attacker could use this to enumerate the emails of all
maintainers for an npm package and utilize them in a targeted spear
phishing campaign, for example. In any case, these sorts of phishing
attacks are well-known and not of particular interest for research.
However, there may be more novel ideas to consider…</p>
<h2 id="custom-email-domains--developer-culture">Custom Email Domains &amp; Developer Culture</h2>
<p>Upon viewing more packages and maintainers, another pattern began to
emerge: emails at developer-owned domains. As many developers will tell
you, having an email at your own domain is peak nerd street cred. I hate
to admit it, but when someone gives me their email and I notice it has a
custom domain, I subconsciously think “this person may know a thing or
two about computers”.</p>
<p><img src="https://docpusher.s3.amazonaws.com/images/fece4fff8be683f3787a6f14d791d467/image3.gif" alt="alt text"/></p>
<p><em>Average nerd reaction to receiving another nerd’s email with a custom
domain.</em></p>
<p>Of course, these custom emails are not just used for social
communication. They are used for all of the various accounts that
developers utilize. As you may have guessed, one of those online
accounts could very well be a developer’s account on the npm registry.</p>
<p>This raises a point that I don’t think many developers consider. By
registering and using a custom domain as their main email address, they
implicitly give that domain <a href="https://thehackerblog.com/the-io-error-taking-control-of-all-io-domains-with-a-targeted-registration/">and their
TLD</a>
complete control over most of their online accounts. While not
universally true, often if you have control of someone’s email account
you can get access to their online accounts by simply initiating and
completing the password reset process for each site. Again, the npm
registry is no exception to this. If you have control of someone’s email
you can reset the npm account’s password and take over the account.</p>
<h2 id="ticking-towards-vulnerable-domain-expiration">Ticking Towards Vulnerable, Domain Expiration</h2>
<p>Domains for the most part are not free, and require continually paying a
fee to keep them under your control. Over a long enough time period this
can prove problematic, because often these domains can end up expiring
and becoming available for registration by other people. I’ve written
about vulnerabilities caused by this <a href="https://bishopfox.com/blog/noscript-bypass-advisory">as far
back as
2015</a>, and
overtime I’ve only seen more and more potential for attacks utilizing
this issue.</p>
<p>I was curious if any of the maintainers of popular npm packages had
emails which were hosted on expired domain names. From past experience,
if you have a somewhat probable event and you cast a wide-enough net, it
reasons that you’re likely to get results. With this in mind, I wrote a
custom script to scrape the maintainers for the top 1,000 npm packages
and the dependencies they depend upon. For each package I pulled the
full list of developer emails, extracted the email base domains, and
checked if these domains returned a <a href="https://www.iana.org/assignments/dns-parameters/dns-parameters.xhtml#dns-parameters-6">status
(<code>RCODE</code>)</a>
other than <a href="https://www.iana.org/assignments/dns-parameters/dns-parameters.xhtml#dns-parameters-6"><code>NOERROR</code></a>.
The idea being that if the domains returned a non-standard error code
when queried, they might be expired or exploitably-misconfigured.</p>
<h2 id="results-registrations-and-resets">Results, Registrations, and Resets</h2>
<p>The results met expectations: lots of <a href="https://www.iana.org/assignments/dns-parameters/dns-parameters.xhtml#dns-parameters-6"><code>NXDOMAIN</code></a>
(domain not found) and other DNS errors in the domains extracted from
maintainer emails. Many of these domains were for smaller packages
without many weekly installs, but a few were from packages that were
quite popular.</p>
<p>For example, the package <a href="https://www.npmjs.com/package/ajv-formats"><code>ajv-formats</code></a>
has a maintainer <a href="https://www.npmjs.com/~additiveamateur"><code>additiveamateur</code></a>
with an email address of <code>carlo[@]machina[dot]bio</code>. The package is
quite popular, with ~5 million installs a week on npm at the time of
this writing:</p>
<p><img src="https://docpusher.s3.amazonaws.com/images/fece4fff8be683f3787a6f14d791d467/image12.png" alt="alt text"/></p>
<p><em>Weekly package downloads of <a href="https://www.npmjs.com/package/ajv-formats"><code>ajv-formats</code></a>
as of Feb 6, 2022.</em></p>
<p>This domain name returned an <code>NXDOMAIN</code> error and was available for
registration. In order to confirm that it was actually possible to take
over the <a href="https://www.npmjs.com/package/ajv-formats"><code>ajv-formats</code></a>
package with this expired domain, I proceeded to register it:</p>
<p><img src="https://docpusher.s3.amazonaws.com/images/fece4fff8be683f3787a6f14d791d467/image11.png" alt="alt text"/></p>
<p><em>Registration confirmation of <code>machina.bio</code></em></p>
<p>Once the domain was registered, I configured the domain’s DNS to route
email from <code>carlo[@]machina[dot]bio</code> to my personal email inbox.
With emails routing for this address, I then initiated the
password-reset process for the <a href="https://www.npmjs.com/~additiveamateur"><code>additiveamateur</code></a>
npm user:</p>
<p><img src="https://docpusher.s3.amazonaws.com/images/fece4fff8be683f3787a6f14d791d467/image8.png" alt="alt text"/></p>
<p><em>Recover password prompt on the npm registry website.</em></p>
<p>However, I encountered an unexpected error upon submitting the request:</p>
<p><img src="https://docpusher.s3.amazonaws.com/images/fece4fff8be683f3787a6f14d791d467/image17.png" alt="alt text"/></p>
<p><em>Error message upon submitting the password reset request.</em></p>
<p>Checking the raw HTTP response provided some clarity on the potential
problem:</p>
<p><img src="https://docpusher.s3.amazonaws.com/images/fece4fff8be683f3787a6f14d791d467/image6.png" alt="alt text"/></p>
<p><em>Raw HTTP response detailing error from password reset.</em></p>
<p>This type of thing is exactly why doing end-to-end confirmation for
theoretical vulnerabilities is so important. To quote Benjamin Brewster:
<a href="https://quoteinvestigator.com/2018/04/14/theory/"><em>“In theory there is no difference between
theory and practice. In practice there
is.”</em></a>.</p>
<p>What caused this account to be flagged in this way? Was there some npm
security check created to lock all accounts with emails at expired
domains? That would be an impressive level of defense-in-depth, but
perhaps there is a more simple explanation at play.</p>

<p>I wanted to see if contacting support was actually a real barrier to
exploitation of these accounts. In order to do this, I submitted a
support ticket intentionally written to be as basic as possible:</p>
<p><img src="https://docpusher.s3.amazonaws.com/images/fece4fff8be683f3787a6f14d791d467/image13.png" alt="alt text"/></p>
<p><em>Intentionally basic support ticket submission to test the “contact
support” roadblock.</em></p>
<p>I didn’t want to bias the test by using any persuasive language or
social engineering, so I kept the ticket message plain. I simply noted
that I’m getting an error when resetting the password for the account
and I’d like it to be unblocked. If support required further
verification to do this, or if there was some other hurdle, then the
plan was to conclude the research there.</p>
<p>However, after three days of waiting, I received the following response
from npm support:</p>
<p><img src="https://docpusher.s3.amazonaws.com/images/fece4fff8be683f3787a6f14d791d467/image10.png" alt="alt text"/></p>
<p><em>Response from support confirming that the ability to reset passwords
has been re-enabled.</em></p>
<p>Support confirmed that they had re-enabled the ability to reset
passwords for the account. Their response seemed to indicate that the
account was flagged due to previous issues sending emails, which would
be expected with the domain having expired.</p>
<p>Perhaps a much more simple explanation for the restriction was that they
had issues delivering to the email address on file previously, and as a
result email-sending features were disable for the account. This would
make sense, as <a href="https://docs.aws.amazon.com/ses/latest/dg/send-email-concepts-deliverability.html#send-email-concepts-deliverability-bounce">bouncing emails can hurt your
email sender
reputation</a>
and get your emails marked as spam.</p>
<p>In any case, the support roadblock was not an actual preventative
measure in this case.</p>
<h2 id="taking-over-the-additiveamateur-account">Taking Over the <code>additiveamateur</code> Account</h2>
<p>I then again attempted to reset the password for the <code>additiveamateur</code>
account. This time I was greeted with a confirmation that the reset had
succeeded and that a reset link was sent to the email address for the
account:</p>
<p><img src="https://docpusher.s3.amazonaws.com/images/fece4fff8be683f3787a6f14d791d467/image5.png" alt="alt text"/></p>
<p><em>Confirmation prompt that the password reset was successful.</em></p>
<p>Sure enough, I received an email with a link to reset the account
password for the account in my inbox:</p>
<p><img src="https://docpusher.s3.amazonaws.com/images/fece4fff8be683f3787a6f14d791d467/image7.png" alt="alt text"/></p>
<p><em>Password reset email received for the account.</em></p>
<p>The next steps were about what you’d expect, I set a new password and
was then able to successfully log in as the <code>additiveamateur</code> account:</p>
<p><img src="https://docpusher.s3.amazonaws.com/images/fece4fff8be683f3787a6f14d791d467/image1.png" alt="alt text"/></p>
<p><em>Screenshot of options once logged in to the <code>additiveamateur</code>
account.</em></p>
<p>As expected, the account had full access to the <a href="https://www.npmjs.com/package/ajv-formats"><code>ajv-formats</code></a>
package:</p>
<p><img src="https://docpusher.s3.amazonaws.com/images/fece4fff8be683f3787a6f14d791d467/image9.png" alt="alt text"/></p>
<p><em>Settings page for <a href="https://www.npmjs.com/package/ajv-formats"><code>ajv-formats</code></a>,
demonstrating admin access to the package. Screenshot dated January
15th, 2022.</em></p>
<p>At this point, I was satisfied that the impact was proven and I ceased
testing on the issue. I didn’t push any updates to the package because I
believed the risk of affecting developers far out-weighed the benefit of
proving the entire attack chain. Clearly this was possible, so I
believed that taking this extra step would be unnecessary (and
potentially reckless).</p>
<p>However, there was something that was still bothering me: <em>why was this
package being installed so frequently</em>? The package seemed useful of
course, but ~5 million installs a week (and rising) is a huge amount.
This was not adding up, so I did a bit more digging. I reported the
issue responsibly to the vendor but it was marked as Informative, see
the disclosure timeline for more details.</p>
<h2 id="through-the-fire--flames-of-dependency-hell">Through the Fire &amp; Flames of Dependency Hell</h2>
<p>The npm registry website has a nice feature which allows you to see the
packages that depend on a given npm package. Using this, I took a look
at <a href="https://www.npmjs.com/browse/depended/ajv-formats">the packages which would install
<code>ajv-formats</code> as a dependency when they
were
installed</a>:</p>
<p><img src="https://docpusher.s3.amazonaws.com/images/fece4fff8be683f3787a6f14d791d467/image15.png" alt="alt text"/></p>
<p><em>A few of the packages which install the package as a dependency.</em></p>
<p>The package was a dependency of both <a href="https://www.npmjs.com/package/@angular-devkit/core"><code>@angular-devkit/core</code></a>
and <a href="https://www.npmjs.com/package/schema-utils"><code>schema-utils</code></a>.
What happens when we go one level deeper and find the dependencies of
these packages?</p>
<p><img src="https://docpusher.s3.amazonaws.com/images/fece4fff8be683f3787a6f14d791d467/image2.png" alt="alt text"/></p>
<p><em>Packages with a dependency on <code>*@angular-devkit/core</code></em>.*</p>
<p><img src="https://docpusher.s3.amazonaws.com/images/fece4fff8be683f3787a6f14d791d467/image16.png" alt="alt text"/></p>
<p><em>Packages with a dependency on <a href="https://www.npmjs.com/browse/depended/schema-utils"><code>schema-utils</code></a>.</em></p>
<p>Shockingly, the <a href="https://www.npmjs.com/package/ajv-formats"><code>ajv-formats</code></a>
package was a transitive dependency for both the Angular CLI and for
<code>webpack</code>! A quick sanity check confirmed that when I installed the
Angular CLI, I was also installing the <a href="https://www.npmjs.com/package/ajv-formats"><code>ajv-formats</code></a>
package:</p>
<p><img src="https://docpusher.s3.amazonaws.com/images/fece4fff8be683f3787a6f14d791d467/image4.gif" alt="alt text"/></p>
<p><em>Installing the Angular CLI and confirming that the <a href="https://www.npmjs.com/package/ajv-formats"><code>ajv-formats</code></a>
package is also installed.</em></p>
<p>For those not as familiar with Angular, <a href="https://angular.io/guide/deployment">the
Angular CLI is essentially required for building and deploying Angular
apps</a> (unless you’re using a
third-party builder).</p>
<p>This result seemed to clearly confirm the real-world impact of this
vulnerability, had it been exploited by an actual malicious attacker.
Notably there were a few other popular packages which were exploitable
in this same fashion (registration of developer email domains), but in
the spirit of keeping this writeup succinct I’ve decided not to include
them in this post.</p>
<p><strong>NOTE:</strong> As of the time of this writing, the <a href="https://www.npmjs.com/package/webpack"><code>webpack</code></a>
package is pinned to <a href="https://www.npmjs.com/package/schema-utils"><code>schema-utils</code></a>
version <a href="https://www.npmjs.com/package/schema-utils/v/3.1.1">3.1.1</a>
which does <em>not</em> include <a href="https://www.npmjs.com/package/ajv-formats"><code>ajv-formats</code></a>.
As such, it would not be transitively installed until <a href="https://www.npmjs.com/package/webpack"><code>webpack</code></a>
updated the version of <a href="https://www.npmjs.com/package/schema-utils"><code>schema-utils</code></a>
that it depends upon. This would be a natural requirement in all cases
of backdoored npm packages, and a more nuanced perspective is included
below.</p>
<h2 id="is-there-any-backstop-the-nuance-of-exploiting-users-of-transitively-dependent-packages">Is There Any Backstop? The Nuance of Exploiting Users of Transitively-Dependent Packages</h2>
<p>This research raises a number of interesting questions around npm
dependencies, and just how serious the impact the compromise of a
transitive dependency is. For example, if you have a package which has a
dependency on another package and that sub-package is compromised, is
the main package compromised as well?</p>
<p>As with most things in software, the answer is nuanced.</p>
<h3 id="what-you-cannot-do-in-the-npm-registry">What You Cannot Do In the npm Registry</h3>
<p>To introduce the more interesting pieces of dependency security, a few
key points need to be mentioned about how packages work in npm.
Specifically it’s important to note that:</p>
<ul>
<li>
<p><a href="https://docs.npmjs.com/unpublishing-packages-from-the-registry#when-to-unpublish">You cannot “overwrite” an already-published version of a package</a>. If you’ve published a <code><a href="https://thehackerblog.com/cdn-cgi/l/email-protection" data-cfemail="5f2f3e3c343e383a1f6e716f716d">[email protected]</a></code> version, for example, you can’t suddenly push a backdoored package to that same exact version. Notably <a href="https://blog.npmjs.org/post/141577284765/kik-left-pad-and-npm.html">this was not always the case</a>.</p>
</li>
<li>
<p><a href="https://docs.npmjs.com/unpublishing-packages-from-the-registry">You can only unpublish a package version if it’s less than 72 hours old and no other packages depend on it.</a> (So no, you can’t get clever and delete a version only to republish a backdoored version.)</p>
</li>
</ul>
<p>This removes the most immediate path for compromising downstream
packages, leaving us with the obvious alternative of pushing a new and
backdoored version instead. Updating package dependencies is a regular
part of package maintenance after all, and it happens regularly across
the npm ecosystem.</p>
<h3 id="pinning-dependencies-with-package-lockjson--the-dependency-security-catch-22">Pinning Dependencies With <code>package-lock.json</code> &amp; the Dependency Security Catch-22</h3>
<p>Those familiar with the world of dependency security will also be
familiar with the catch-22 of “pinning your dependencies”. In the case
of npm, this usually means to have a <a href="https://docs.npmjs.com/cli/v8/configuring-npm/package-lock-json#description"><code>package-lock.json</code></a>
file which specifies the entire dependency tree for your project. With
this file sitting in your root project folder, <code>npm install</code> commands
will now always install all of your dependency versions as they were
when you ran <code>npm install</code> to generate the file. Rogue packages
updates are no longer your concern since you’re not updating! Problem
solved, <em>right</em>?</p>
<p>However, this leaves another potentially more serious problem:
vulnerable libraries are no longer being updated. If you’re pinning all
your dependencies (and their dependencies), then you’ll never receive
bug fixes and critical patches. In the <a href="https://www.lunasec.io/docs/blog/log4j-zero-day">wake of
the log4j
vulnerability</a>,
this is clearly not an ideal route to take. Like most things in
security, it’s a risk tradeoff decision. You weigh the pros and cons of
each and proceed accordingly.</p>
<h3 id="marking-a-package-as-vulnerable-to-push-downstream-packages-to-update-to-your-malicious-version">Marking a Package as “Vulnerable” to Push Downstream Packages to Update to Your Malicious Version</h3>
<p>What if an attacker were to intentionally flag their compromised package
as “vulnerable”? Where would that leave dependent packages? Authors of
packages which depend on the attacker’s package now have to make a
decision on the exact catch-22 we mentioned before. If they <em>don’t
update</em> their dependencies, they risk putting all those who utilize
their package at risk of being “vulnerable”. However, if they <em>do
update</em> their dependencies, they risk a whole slew of new code being
incorporated into their package.</p>
<h3 id="cant-we-just-review-everything-before-we-update">Can’t We Just Review <em>Everything</em> Before We Update?</h3>
<p>That raises another question, <em>can’t maintainers and developers just
review all of the new code in each dependency before including the
updated versions?</em></p>
<p>The most obvious rebuttal to this idea is probably self-evident: <em>it’s a
ton of work</em>. We’re talking about going over diffs for the dependencies
themselves, their dependencies, and so on. Doing so with any serious
level of rigor is a large time-consuming effort. A vast majority of full
time software developers aren’t reviewing every change in their
dependencies, let alone volunteers who maintain packages in their own
personal time. Asking these volunteers to do this daunting task seems
unrealistic, to say the very least.</p>
<p>The problem only becomes more murky when you factor in the ability to
specify <a href="https://docs.npmjs.com/cli/v8/configuring-npm/package-json#dependencies">version ranges in your
package.json</a>.
If you have a dependency that allows for flexibility in its dependencies
(e.g: <code>&gt;=package_name</code>) then a developer could later publish an
update to a new version, and they would be included in fresh installs.
This means that you could review all of your dependencies, find nothing
malicious, and then be seamlessly backdoored later.</p>
<h3 id="some-homework-and-some-thoughts">Some Homework and Some Thoughts</h3>
<p>For those interested in doing a bit of learning and research themselves,
take a stab at looking at the process for updating dependencies in
Angular. In my opinion Google actually does a fairly good job of it (all
things considered). Here’s an example pull request to get you started:
<a href="https://github.com/angular/angular/pull/45013">https://github.com/angular/angular/pull/45013</a></p>
<p>If not Angular, pick any popular package that you use in your JavaScript
development. When you research the process, ask yourself some of these
questions:</p>
<ul>
<li>
<p><em>“Would this process catch a rogue dependency update which is malicious?”</em></p>
</li>
<li>
<p><em>“Would it catch a malicious update to a dependency-of-a-depency?”</em></p>
</li>
<li>
<p><em>“Does it prevent dependencies that specify a version range instead of a specific singular version?”</em></p>
</li>
<li>
<p><em>“Are packages being regularly updated to ensure vulnerabilities are being regularly patched?”</em></p>
</li>
</ul>
<p>This is not a quiz and there are no gotchas or simple answers, this is
meant to have you seriously think about the problems being faced in
dependency security. The real world is filled with nuance and hard
problems and software development is no exception!</p>
<h2 id="wait-what-about-the-expired-email-domains-problem">Wait, What About the Expired Email Domains Problem?</h2>
<p>Clearly dependency security is a complex issue, so let’s focus on the
more simple issue here: expired domains in account emails. In this case,
there are a few important pieces to consider:</p>
<ul>
<li>
<p>Custom domains are a common part of developer culture, and they are unlikely to go away. They carry a real risk of being exploitable when these domains expire, and developers should give serious consideration of this problem when using them for their important accounts.</p>
</li>
<li>
<p>During this research the npm accounts weren’t the only accounts which were suddenly hijackable upon registering the expired domains. Accounts on all sorts of important websites such as Github, Slack, etc were also in jeopardy. Any website which uses emailed password resets as a single-factor for account access has this problem.</p>
</li>
<li>
<p>Sites may want to proactively disable accounts when their email domains expire or become non-routable. They will also likely need to have an alternative path to reset the account’s password that strongly verifies the person is the owner of the account when this happens and the original account owner needs to get access to their account again.</p>
</li>
</ul>
<p>In the npm case, I reported the problem to them (the Github security
team) via HackerOne which they require for vulnerability reports. They
closed the report as “Informative” and noted that “<em>This is something
we’ve been tracking internally and have mitigations in place for</em>”.
Whether or not they implemented any new changes is unclear. See the
disclosure timeline below, or <a href="https://imgur.com/a/7TQs3vx">this archive of
the HackerOne report for more info</a>.
I would probably advise npm users to proceed with the assumption that
this is still a problem that could be exploited.</p>
<h2 id="the-tldr-summary--high-level-points">The TL;DR Summary &amp; High-Level Points</h2>
<ul>
<li>
<p>Developers for highly-installed npm packages had their npm accounts registered to email addresses at expired domains.</p>
</li>
<li>
<p>Registering these expired domain names allowed for the takeover of important npm packages such as <a href="https://www.npmjs.com/package/ajv-formats"><code>ajv-formats</code></a> which currently has ~5 million installs a week.</p>
</li>
<li>
<p>The <a href="https://www.npmjs.com/package/ajv-formats"><code>ajv-formats</code></a> package is a dependency of <a href="https://www.npmjs.com/package/@angular-devkit/core"><code>@angular-devkit/core</code></a>, Angular’s core utility library. <a href="https://www.npmjs.com/package/@angular-devkit/core"><code>@angular-devkit/core</code></a> is a dependency of <a href="https://www.npmjs.com/package/@angular/cli"><code>@angular/cli</code></a>, which is the tooling <a href="https://angular.io/start/start-deployment#prerequisites">used to compile Angular apps</a>.</p>
</li>
<li>
<p>Dependency security is a complex problem with risk tradeoffs that should be weighed carefully.</p>
</li>
<li>
<p>Developers using custom domains for their email address should seriously consider the risks they are taking on by using the email for their online accounts. If this domain expires or is hijacked, where does that leave them?</p>
</li>
<li>
<p>It’s unclear if npm has changed anything as a result of my report to them and npm users should likely assume that this issue could still be exploited in the future.</p>
</li>
</ul>
<h2 id="disclosure-timeline">Disclosure Timeline</h2>
<h3 id="ajv-formatsmachinobio-domain-disclosure"><code>ajv-formats</code>/<code>machino.bio</code> Domain Disclosure</h3>
<ul>
<li>
<p><em>Jan 10, 2022</em>: Reached out to the owner of <code>machina.bio</code> domain via LinkedIn to disclose the issue.</p>
</li>
<li>
<p><em>Jan 15, 2022</em>: Realized I had missed a reply to the LinkedIn reachout with the developer’s email. Sent details of disclosure to the email address provided.</p>
</li>
<li>
<p><em>Jan 21, 2022</em>: Received a response to <code>machina.bio</code> domain disclosure email.</p>
</li>
<li>
<p><em>Jan 22, 2022</em>: Followed up with credentials for npm account and <code>machina.bio</code> domain transfer code to complete handover.</p>
</li>
</ul>
<h3 id="npm-registry-github-security-team-disclosure">npm Registry (Github Security Team) Disclosure</h3>
<ul>
<li>
<p><em>Jan 17, 2022</em>: Submitted HackerOne bug to Github’s bug bounty program, due to <a href="https://www.npmjs.com/support">npm’s site</a> requesting bugs be submitted via this avenue. <a href="https://hackerone.com/reports/1452186">Report ID #1452186</a>.</p>
</li>
<li>
<p><em>Jan 25, 2022</em>: Github security team closes the bug as invalid <em>“Because this attack vector included submitting a support request to re-enable password resets for a disabled account, this is considered social engineering and is therefore ineligible for a reward under the Bug Bounty program.”</em>. They also considered the issue mitigated <em>“​​This is something we’ve been tracking internally and have mitigations in place for.”</em></p>
</li>
<li>
<p><em>Jan 25, 2022</em>: Requested public disclosure due to the bug being apparently mitigated and because the report was closed as Informative.</p>
</li>
<li>
<p><em>Feb 2, 2022</em>: Github denies disclosure request due to bug being closed as Informational. However, they state that publishing a write up is completely fine. You can see the full HackerOne report as an image here: <a href="https://imgur.com/a/7TQs3vx">https://imgur.com/a/7TQs3vx</a></p>
</li>
</ul>
<p>—</p>
<p><em>Special thanks to <a href="https://twitter.com/michaelxproxy">Michael Xu
(@michaelxproxy)</a> for
consulting with me on this topic. His feedback was essential for the
sections on the nuances of package-pinning.</em></p>

</div></div>
  </body>
</html>
