<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://writings.stephenwolfram.com/2024/03/when-exactly-will-the-eclipse-happen-a-multimillennium-tale-of-computation/">Original</a>
    <h1>When will the eclipse happen? A multimillennium tale of computation</h1>
    
    <div id="readability-page-1" class="page"><div>
            
<div>


<p><a href="https://www.youtube.com/watch?v=7Eqhd34ytoc" target="_blank"><img title="When Exactly Will the Eclipse Happen? A Multimillennium Tale of Computation" src="https://content.wolfram.com/sites/43/2024/03/eclipse-livestream-stripe-v2.png" alt="When Exactly Will the Eclipse Happen? A Multimillennium Tale of Computation" width="624" height="45"/></a></p>
<p><em>Updated and expanded from <a href="https://writings.stephenwolfram.com/2017/08/when-exactly-will-the-eclipse-happen-a-multimillenium-tale-of-computation/">a post for the eclipse of August 21, 2017</a>.</em></p>
<p><img title="When Exactly Will the Eclipse Happen? A Multimillennium Tale of Computation" src="https://content.wolfram.com/sites/43/2024/03/eclipse-history-hero.png" alt="IWhen Exactly Will the Eclipse Happen? A Multimillennium Tale of Computation" width="700" height="401"/></p>
<h2 id="preparing-for-april-8-2024">Preparing for April 8, 2024</h2>
<p>On April 8, 2024, there’s going to be a total eclipse of the Sun visible on a line across the US. But when exactly will the eclipse occur at a given location? Being able to predict astronomical events has historically been one of the great triumphs of exact science. But how well can it actually be done now? </p>
<p>The answer is well enough that even though the edge of totality moves at just over 1000 miles per hour, it’s possible to predict when it will arrive at a given location to within perhaps a second. And as a demonstration of this, for the total eclipse back in 2017 we created <a href="http://www.precisioneclipse.com" target="_blank" rel="noopener">a website</a> to let anyone enter their geo location (or address) and then immediately compute when the eclipse would reach them—as well as generate many pages of other information.<span id="more-57966"></span></p>
<p><a alt="Precisioneclipse.com pages" title="Precisioneclipse.com pages" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg1.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg1-v4-min.png" alt="Click to enlarge" title="Click to enlarge" width="850" height="487"/><br/>
</a></p>
<h2 id="its-an-old-business">It’s an Old Business</h2>
<p>These days it’s easy to find out when the next solar eclipse will be; indeed built right into the <a href="https://wolfram.com/language/">Wolfram Language</a> there’s just a <a href="https://reference.wolfram.com/language/ref/SolarEclipse.html">function</a> that tells you (in this form the output is the “time of greatest eclipse”):</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg2.png" alt="" title="" width="227" height="55"/> </p>
</div>
<p>It’s also easy to find out, and plot, where the region of totality will be:</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg4A.png" alt="" title="" width="465" height="211"/> </p>
</div>
<p>Or to determine that the whole area of totality (including lots of ocean and some of Canada) will be about a third of the area of the US:</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg5.png" alt="" title="" width="519" height="55"/> </p>
</div>
<p>But computing eclipses is not exactly a new business. In fact, the <a href="https://en.wikipedia.org/wiki/Antikythera_mechanism" target="_blank" rel="noopener">Antikythera device</a> from 2000 years ago even tried to do it—using 37 metal gears to approximate the motion of the Sun and Moon (yes, with the Earth at the center). To me there’s something unsettling—and cautionary—about the fact that the Antikythera device stands as such a solitary piece of technology, forgotten but not surpassed for more than 1600 years.</p>
<p>But right there on the bottom of the device there’s an arm that moves around, and when it points to an Η or Σ marking, it indicates a possible Sun or Moon eclipse. The way of setting dates on the device is a bit funky (after all, the <a href="https://en.wikipedia.org/wiki/Gregorian_calendar" target="_blank" rel="noopener">modern calendar</a> wouldn’t be invented for another 1500 years), but if one takes the <a href="http://demonstrations.wolfram.com/AntikytheraMechanism/">simulation</a> on the <a href="http://demonstrations.wolfram.com/">Wolfram Demonstrations Project</a> (which was calibrated back in 2012 when the <a href="http://demonstrations.wolfram.com/AntikytheraMechanism/">Demonstration</a> was created), and turns the crank to set the device for April 8, 2024, here’s what one gets:</p>
<p><a alt="Antikythera device" title="Antikythera device" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg6.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg6.png" alt="Click to enlarge" title="Click to enlarge" width="217" height="219"/><br/>
</a></p>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/antikythera2024d.gif" alt="Antikythera device in action" title="Antikythera device in action" width="500" height="439"/></p>
<p>And, yes, all those gears move so as to line the Moon indicator up with the Sun—and to make the arm on the bottom point right at an H—just as it should for a solar eclipse. It’s amazing to see this computation successfully happen on a device designed 2000 years ago. </p>
<p>Of course the results are a lot more accurate today. Though, strangely, despite all the theoretical science that’s been done, the way we actually compute the position of the Sun and Moon is conceptually very much like the gears—and effectively epicycles—of the Antikythera device. It’s just that now we have the digital equivalent of hundreds of thousands of gears.</p>
<h2 id="why-do-eclipses-happen">Why Do Eclipses Happen?</h2>
<p>A total solar eclipse occurs when the Moon gets in front of the Sun from the point of view of a particular location on the Earth. And it so happens that at this point in the Earth’s history the Moon can just block the Sun because it has almost exactly the same angular diameter in the sky as the Sun (about <a href="https://www.wolframalpha.com/input/?i=angular+diameter+of+sun">0.5° or 30 arc-minutes</a>). </p>
<p>So when does the Moon get between the Sun and the Earth? Well, basically every time there’s a new moon (i.e. once every <a href="https://www.wolframalpha.com/input/?i=lunar+month">lunar month</a>). But we know there isn’t an eclipse every month. So how come?</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg8.png" alt="" title="" width="319" height="35"/> </p>
</div>
<p>Well, actually, in the analogous situation of <a href="https://www.wolframalpha.com/input/?i=ganymede">Ganymede</a> and <a href="https://www.wolframalpha.com/input/?i=jupiter">Jupiter</a>, there <em>is</em> an eclipse every time Ganymede goes around Jupiter (which happens to be about <a href="https://www.wolframalpha.com/input/?i=ganymede+orbital+period">once per week</a>). Like the Earth, Jupiter’s orbit around the Sun lies in a particular plane (the “<a href="https://en.wikipedia.org/wiki/Ecliptic" target="_blank" rel="noopener">plane of the ecliptic</a>”). And it turns out that Ganymede’s orbit around Jupiter also <a href="https://www.wolframalpha.com/input/?i=ganymede+inclination">lies in essentially the same plane</a>. So every time Ganymede reaches the “new moon” position (or, in official astronomy parlance, when it’s aligned “in <a href="https://www.wolframalpha.com/input/?i=syzygy">syzygy</a>”—pronounced sizz-ee-gee), it’s in the right place to cast its shadow onto Jupiter, and to eclipse the Sun wherever that shadow lands. (From Jupiter, Ganymede appears <a href="https://www.wolframalpha.com/input?i=%28ganymede+diameter%29+%2F+%28ganymede+orbital+distance%29+%2F+%28%28solar+diameter%29+%2F+%28jupiter+orbital+distance%29%29">about 3 times the size of the Sun</a>.)</p>
<p>But our Moon is different. Its orbit doesn’t lie in the plane of the ecliptic. Instead, it’s <a href="https://www.wolframalpha.com/input/?i=moon+inclination">inclined at about 5°</a>. (How it got that way is unknown, but it’s presumably related to how the Moon was formed.) But that 5° is what makes eclipses so comparatively rare: they can only happen when there’s a “new moon configuration” (syzygy) right at a time when the Moon’s orbit passes through the plane of the ecliptic. </p>
<p>To show what’s going on, let’s draw an exaggerated version of everything. Here’s the Moon going around the Earth, colored red whenever it’s close to the plane of the ecliptic:</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg9.png" alt="" title="" width="526" height="200"/> </p>
</div>
<p>Now let’s look at what happens over the course of about a year. We’re showing a dot for where the Moon is each day. And the dot is redder if the Moon is closer to the plane of the ecliptic that day. (Note that if this was drawn to scale, you’d barely be able to see the Moon’s orbit, and it wouldn’t ever seem to go backwards like it does here.)</p>
<div>
<p><img title="" src="https://content.wolfram.com/sites/43/2017/08/img_09-animation-v3.gif" alt="" width="500" height="500" srcset="https://content.wolfram.com/sites/43/2017/08/img_09-animation-v3.gif 500w, https://content.wolfram.com/sites/43/2017/08/img_09-animation-v3-150x150.gif 150w, https://content.wolfram.com/sites/43/2017/08/img_09-animation-v3-300x300.gif 300w" sizes="(max-width: 500px) 100vw, 500px"/></p>
</div>
</div>
<p>Now we can start to see how eclipses work. The basic point is that there’s a solar eclipse whenever the Moon is both positioned between the Earth and the Sun, and it’s in the plane of the ecliptic. In the picture, those two conditions correspond to the Moon being as far as possible towards the center, and as red as possible. So far we’re only showing the position of the (exaggerated) Moon once per day. But to make things clearer, let’s show it four times a day—and now prune out cases where the Moon isn’t at least roughly lined up with the Sun:</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg11.png" alt="" title="" width="465" height="415"/> </p>
</div>
<p>And now we can see that at least in this particular case, there are two points (indicated by arrows) where the Moon is lined up and in the plane of the ecliptic (so shown in red)—and these points will then correspond to solar eclipses.</p>
<p>In different years, the picture will look slightly different, essentially because the Moon is starting at a different place in its orbit at the beginning of the year. Here are schematic pictures for a few successive years:</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg12.png" alt="" title="" width="577" height="374"/> </p>
</div>
<p>It’s not so easy to see exactly when eclipses occur here—and it’s also not possible to tell which are total eclipses where the Moon is exactly lined up, and which are only partial eclipses. But there’s at least an indication, for example, that there are “<a href="https://en.wikipedia.org/wiki/Eclipse_season" target="_blank" rel="noopener">eclipse seasons</a>” in different parts of the year where eclipses happen.</p>
<p>OK, so what does the <a href="https://reference.wolfram.com/language/ref/SolarEclipse.html">real data</a> look like? Here’s a plot for 20 years in the past and 20 years in the future, showing the actual days in each year when total and partial solar eclipses occur (the small dots everywhere indicate <a href="https://reference.wolfram.com/language/ref/MoonPhase.html">new moons</a>):</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg13.png" alt="" title="" width="564" height="194"/> </p>
</div>
<p>The reason for the “drift” between successive years is just that the <a href="https://www.wolframalpha.com/input/?i=moon+orbital+period">lunar</a> month (29.53 days) doesn’t line up with the year, so the Moon doesn’t go through a whole number of orbits in the course of a year, with the result that at the beginning of a new year, the Moon is in a different phase. But as the picture makes clear, there’s quite a lot of regularity in the general times at which eclipses occur—and for example there are usually 2 eclipses in a given year—though there can be more (and in 0.2% of years there can be as many as 5, as there last were in 1935).</p>
<p>To see more detail about eclipses, let’s plot the time differences (in fractional years) between all successive solar eclipses for 100 years in the past and 100 years in the future:</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg14.png" alt="" title="" width="569" height="184"/> </p>
</div>
<p>And now let’s plot the same time differences, but just for total solar eclipses:</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg15.png" alt="" title="" width="570" height="184"/> </p>
</div>
<p>There’s obviously a fair amount of overall regularity here, but there are also lots of little fine structure and irregularities. And being able to correctly predict all these details has basically taken science the better part of a few thousand years. </p>
<h2 id="ancient-history">Ancient History</h2>
<p>It’s hard <a href="http://blog.stephenwolfram.com/2016/05/something-i-learned-in-kindergarten/">not to notice an eclipse</a>, and presumably even from the earliest times people did. But were eclipses just reflections—or omens—associated with random goings-on in the heavens, perhaps in some kind of soap opera among the gods? Or were they things that could somehow be predicted? </p>
<p>A few thousand years ago, it wouldn’t have been clear what people like astrologers could conceivably predict. When will the Moon be at a certain place in the sky? Will it rain tomorrow? What will the price of barley be? Who will win a battle? Even now, we’re not sure how predictable all of these are. But the one clear case where prediction and exact science have triumphed is astronomy. </p>
<p>At least as far as the Western tradition is concerned, it all seems to have started in ancient Babylon—where for many hundreds of years, careful observations were made, and, in keeping with the ways of that civilization, detailed records were kept. And even today we still have thousands of daily official diary <a href="http://repository.edition-topoi.org/collection/BDIA" target="_blank">entries</a> written in what look like tiny chicken scratches preserved on little clay tablets. “Night of the 14th: Cold north wind. Moon was in front of <a href="https://www.wolframalpha.com/input/?i=alpha+leonis">α Leonis</a>. From 15th to 20th river rose 1/2 cubit. Barley was 1 kur 5 siit. 25th, last part of night, moon was 1 cubit 8 fingers behind ε Leonis. 28th, 74° after sunrise, solar eclipse…”</p>
<p><a alt="Babylonian clay tablet" title="Babylonian clay tablet" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg16.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg16.png" alt="Click to enlarge" title="Click to enlarge" width="300" height="150"/><br/>
</a></p>
<p>If one looks at what happens on a particular day, one probably can’t tell much. But by putting observations together over years or even hundreds of years, it’s possible to see all sorts of repetitions and regularities. And back in Babylonian times the idea arose of using these to construct an <a href="https://en.wikipedia.org/wiki/Ephemeris" target="_blank" rel="noopener">ephemeris</a>—a systematic table that said where a particular heavenly body such as the Moon was expected to be at any particular time. </p>
<p>(Needless to say, reconstructing Babylonian astronomy is a complicated exercise in decoding what’s by now basically an alien culture. A key figure in this effort was a certain <a href="https://www.wolframalpha.com/input/?i=Otto+Neugebauer">Otto Neugebauer</a>, who happened to work down the hall from me at the <a href="https://www.ias.edu/" target="_blank" rel="noopener">Institute for Advanced Study</a> in Princeton in the early 1980s. I would see him almost every day—a quiet white-haired chap, with a twinkle in his eye—and just sometimes I’d glimpse his huge filing system of index cards which I now realize was at the center of understanding Babylonian astronomy.)</p>
<p>One thing the Babylonians did was to measure surprisingly accurately the repetition period for the phases of the Moon—the so-called <a href="https://www.wolframalpha.com/input/?i=1+synodic+month">synodic month</a> (or “lunation period”) of about 29.53 days. And they noticed that 235 synodic months was very close to 19 years—so that about every 19 years, dates and phases of the Moon repeat their alignment, forming a so-called <a href="https://en.wikipedia.org/wiki/Metonic_cycle" target="_blank" rel="noopener">Metonic cycle</a> (named after <a href="https://en.wikipedia.org/wiki/Meton_of_Athens" target="_blank" rel="noopener">Meton of Athens</a>, who described it in 432 BC). </p>
<p>It probably helps that the random constellations in the sky form a good pattern against which to measure the precise position of the Moon (it reminds me of the modern fashion of wearing fractals to make motion capture for movies easier). But the Babylonians noticed all sorts of details of the motion of the Moon. They knew about its “<a href="https://en.wikipedia.org/wiki/Apsis" target="_blank" rel="noopener">anomaly</a>”: its periodic speeding up and slowing down in the sky (now known to be a consequence of its slightly elliptical orbit). And they measured the average period of this—the so-called <a href="https://www.wolframalpha.com/input/?i=anomalistic+month">anomalistic month</a>—to be about 27.55 days. They also noticed that the Moon went above and below the plane of the ecliptic (now known to be because of the <a href="https://www.wolframalpha.com/input/?i=moon+inclination">inclination of its orbit</a>)—with an average period (the so-called <a href="https://www.wolframalpha.com/input/?i=draconic+month">draconic month</a>) that they measured as about 27.21 days.</p>
<p>And by 400 BC they’d noticed that every so-called <a href="https://www.wolframalpha.com/input/?i=saros">saros</a> of about 18 years 11 days all these different periods essentially line up (223 synodic months, 239 anomalistic months and 242 draconic months)—with the result that the Moon ends up at about the same position relative to the Sun. And this means that if there was an eclipse at one saros, then one can make the prediction that there’s going to be an eclipse at the next saros too.</p>
<p>When one’s absolutely precise about it, there are all sorts of effects that prevent precise repetition at each saros. But over timescales of more than 1300 years, there are in fact still strings of eclipses separated from each other by one saros. (Over the course of such a saros series, the locations of the eclipses effectively scan across the Earth; the upcoming eclipse is number 30 in a series of 71 that began in 1501 AD with an eclipse near the North Pole and will end in 2763 AD with an eclipse near the South Pole.)</p>
<p>Any given moment in time will be in the middle of quite a few saros series (right now it’s 40)—and successive eclipses will always come from different series. But knowing about the saros cycle is a great first step in predicting eclipses—and it’s for example what the Antikythera device uses. In a sense, it’s a quintessential piece of science: take many observations, then synthesize a theory from them, or at least a scheme for computation. </p>
<p>It’s not clear what the Babylonians thought about abstract, formal systems. But the Greeks were definitely into them. And by 300 BC <a href="https://www.wolframalpha.com/input/?i=euclid">Euclid</a> had defined his abstract system for geometry. So when someone like <a href="https://www.wolframalpha.com/input/?i=ptolemy">Ptolemy</a> did astronomy, they did it a bit like Euclid—effectively taking things like the saros cycle as axioms, and then proving from them often surprisingly elaborate geometrical theorems, such as that there must be at least two solar eclipses in a given year.</p>
<p>Ptolemy’s <em><a href="https://en.wikipedia.org/wiki/Almagest" target="_blank" rel="noopener">Almagest</a></em> from around 150 AD is an impressive piece of work, containing among many other things some quite elaborate procedures—and explicit tables—for predicting eclipses. (Yes, even in the later printed version, numbers are still <a href="https://www.wolframalpha.com/input/?i=75+in+greek+numerals">represented confusingly by letters</a>, as they always were in ancient Greek.)</p>
<p><a alt="Ptolemy’s Almagest" title="Ptolemy’s Almagest" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg17.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg17.png" alt="Click to enlarge" title="Click to enlarge" width="874" height="397"/><br/>
</a></p>
<p>In Ptolemy’s astronomy, Earth was assumed to be at the center of everything. But in modern terms that just meant he was choosing to use a different coordinate system—which didn’t affect most of the things he wanted to do, like working out the geometry of eclipses. And unlike the mainline Greek philosophers he wasn’t trying to make a fundamental theory of the world; he just wanted whatever epicycles and so on he needed to fit what he observed.</p>
<h2 id="the-dawn-of-modern-science">The Dawn of Modern Science</h2>
<p>For more than a thousand years Ptolemy’s theory of the Moon defined the state of the art. In the 1300s <a href="https://en.wikipedia.org/wiki/Ibn_al-Shatir" target="_blank" rel="noopener">Ibn al-Shatir</a> revised Ptolemy’s models, achieving somewhat better accuracy. In 1472 <a href="https://www.wolframalpha.com/input/?i=Regiomontanus">Regiomontanus (Johannes Müller)</a>, systematizer of trigonometry, published more complete tables as part of his launch of what was essentially the first-ever scientific publishing company. But even in 1543 when <a href="https://www.wolframalpha.com/input/?i=Nicolaus+Copernicus">Nicolaus Copernicus</a> introduced his Sun-centered model of the solar system, the results he got were basically the same as Ptolemy’s, even though his underlying description of what was going on was quite different.</p>
<p>It’s said that <a href="https://www.wolframalpha.com/input/?i=Tycho+Brahe">Tycho Brahe</a> got interested in astronomy in 1560 at age 13 when he saw a solar eclipse that had been predicted—and over the next several decades his careful observations uncovered several effects in the motion of the Moon (such as speeding up just before a full moon)—that eventually resulted in perhaps a factor 5 improvement in the prediction of its position. To Tycho eclipses were key tests, and he measured them carefully, and worked hard to be able to predict their timing more accurately than to within a few hours. (He himself never saw a total solar eclipse, only partial ones.)</p>
<p><a alt="Tycho&#39;s pages" title="Tycho&#39;s pages" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg18.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg18.png" alt="Click to enlarge" title="Click to enlarge" width="487" height="230"/><br/>
</a></p>
<p>Armed with Tycho’s observations, <a href="https://www.wolframalpha.com/input/?i=Johannes+Kepler">Johannes Kepler</a> developed his description of <a href="https://mathworld.wolfram.com/Ellipse.html">orbits as ellipses</a>—introducing concepts like <a href="https://en.wikipedia.org/wiki/Orbital_inclination" target="_blank" rel="noopener">inclination</a> and <a href="https://en.wikipedia.org/wiki/Eccentric_anomaly" target="_blank" rel="noopener">eccentric anomaly</a>—and in 1627 finally produced his <em><a href="https://en.wikipedia.org/wiki/Rudolphine_Tables" target="_blank" rel="noopener">Rudolphine Tables</a></em>, which got right a lot of things that had been got wrong before, and included all sorts of detailed tables of lunar positions, as well as vastly better predictions for eclipses.</p>
<p><a alt="Kepler’s Rudolphine Tables" title="Kepler’s Rudolphine Tables" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg19.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg19.png" alt="Click to enlarge" title="Click to enlarge" width="618" height="477"/><br/>
</a></p>
<p>Using Kepler’s <em>Rudolphine Tables</em> (and a couple of pages of calculations) the first known actual map of a solar eclipse was published in 1654. And while there are some charming inaccuracies in overall geography, the geometry of the eclipse isn’t too bad. </p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg20.png" alt="" title="" width="623" height="281"/> </p>
</div>
<p>Whether it was Ptolemy’s epicycles or Kepler’s ellipses, there were plenty of calculations to do in determining the motions of heavenly bodies (and indeed the first known mechanical calculator—excepting the Antikythera device—was developed by a <a href="https://en.wikipedia.org/wiki/Wilhelm_Schickard" target="_blank" rel="noopener">friend of Kepler’s</a>, presumably for the purpose). But there wasn’t really a coherent underlying theory; it was more a matter of describing effects in ways that could be used to make predictions.</p>
<p>So it was a big step forward in 1687 when <a href="https://www.wolframalpha.com/input/?i=Isaac+Newton">Isaac Newton</a> published his <em><a href="https://www.wolframalpha.com/input/?i=Philosophiæ+Naturalis+Principia+Mathematica">Principia</a></em>, and claimed that with his laws for motion and gravity it should be possible—essentially from first principles—to calculate everything about the motion of the Moon. (Charmingly, in his “Theory of the World” section he simply asserts as his Proposition XXII “That all the motions of the Moon… follow from the principles which we have laid down.”)</p>
<p>Newton was proud of the fact that he could explain all sorts of known effects on the basis of his new theory. But when it came to actually calculating the detailed motion of the Moon he had a frustrating time. And even after several years he still couldn’t get the right answer—in later editions of the <em>Principia</em> adding the admission that actually “The apse of the Moon is about twice as swift” (i.e. his answer was wrong by a factor of 2). </p>
<p>Still, in 1702 Newton was happy enough with his results that he allowed them to be published, in the form of a 20-page booklet on the “Theory of the Moon”, which proclaimed that “By this Theory, what by all Astronomers was thought most difficult and almost impossible to be done, the Excellent Mr. Newton hath now effected, viz. to determine the Moon’s Place even in her Quadratures, and all other Parts of her Orbit, besides the Syzygys, so accurately by Calculation, that the Difference between that and her true Place in the Heavens shall scarce be two Minutes…” </p>
<p><a alt="Newton&#39;s Theory of the Moon booklet" title="Newton&#39;s Theory of the Moon booklet" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg21.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg21.png" alt="Click to enlarge" title="Click to enlarge" width="1769" height="633"/><br/>
</a></p>
<p>Newton didn’t explain his methods (and actually it’s still not clear exactly what he did, or how mathematically rigorous it was or wasn’t). But his booklet effectively gave a step-by-step algorithm to compute the position of the Moon. He didn’t claim it worked “at the syzygys” (i.e. when the Sun, Moon and Earth are lined up for an eclipse)—though his advertised error of two arc-minutes was still much smaller than the angular size of the Moon in the sky.</p>
<p>But it wasn’t eclipses that were the focus then; it was a very practical problem of his day: knowing the location of a ship out in the open ocean. It’s possible to determine what latitude you’re at just by measuring how high the Sun gets in the sky. But to determine longitude you have to correct for the rotation of the Earth—and to do that you have to accurately keep track of time. But back in Newton’s day, the clocks that existed simply weren’t accurate enough, especially when they were being tossed around on a ship.</p>
<p>But particularly after various naval accidents, the problem of longitude was deemed important enough that the British government in 1714 established a “Board of Longitude” to offer prizes to help get it solved. One early suggestion was to use the regularity of the moons of Jupiter discovered by <a href="https://www.wolframalpha.com/input/?i=Galileo+Galilei">Galileo</a> as a way to tell time. But it seemed that a simpler solution (not requiring a powerful telescope) might just be to measure the position of our Moon, say relative to certain fixed stars—and then to back-compute the time from this.</p>
<p>But to do this one had to have an accurate way to predict the motion of the Moon—which is what Newton was trying to provide. In reality, though, it took until the 1760s before tables were produced that were accurate enough to be able to determine time to within a minute (and thus distance to within 15 miles or so). And it so happens that right around the same time a marine chronometer was invented that was directly able to keep good time.</p>
<h2 id="the-three-body-problem">The Three-Body Problem</h2>
<p>One of Newton’s great achievements in the <em>Principia</em> was to solve the so-called two-body problem, and to show that with an inverse square law of gravity the orbit of one body around another must always be what Kepler had said: an ellipse. </p>
<p>In a first approximation, one can think of the Moon as just orbiting the Earth in a simple elliptical orbit. But what makes everything difficult is that that’s just an approximation, because in reality there’s also a gravitational pull on the Moon from the Sun. And because of this, the Moon’s orbit is no longer a simple fixed ellipse—and in fact it ends up being much more complicated. There are a few definite effects one can describe and reason about. The ellipse gets stretched when the Earth is closer to the Sun in its own orbit. The orientation of the ellipse precesses like a top as a result of the influence of the Sun. But there’s no way in the end to work out the orbit by pure reasoning—so there’s no choice but to go into the mathematics and start solving the equations of the <a href="https://www.wolframscience.com/nks/notes-7-4--three-body-problem/">three-body problem</a>.</p>
<p>In many ways this represented a new situation for science. In the past, one hadn’t ever been able to go far without having to figure out new laws of nature. But here the underlying laws were supposedly known, courtesy of Newton. Yet even given these laws, there was difficult mathematics involved in working out the behavior they implied. </p>
<p>Over the course of the 1700s and 1800s the effort to try to solve the <a href="https://www.wolframscience.com/nks/notes-7-4--three-body-problem/">three-body problem</a> and determine the orbit of the Moon was at the center of mathematical physics—and attracted a veritable who’s who of mathematicians and physicists.</p>
<p>An early entrant was <a href="https://www.wolframalpha.com/input/?i=Leonhard+Euler">Leonhard Euler</a>, who developed methods based on trigonometric series (including much of our current notation for such things), and whose works contain many immediately recognizable formulas:</p>
<p><a alt="Euler&#39;s methods" title="Euler&#39;s methods" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg22.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg22.png" alt="Click to enlarge" title="Click to enlarge" width="604" height="384"/><br/>
</a></p>
<p>In the mid-1740s there was a brief flap—also involving Euler’s “competitors” <a href="https://www.wolframalpha.com/input/?i=Alexis+Claude+Clairaut">Clairaut</a> and <a href="https://www.wolframalpha.com/input/?i=Jean+Le+Rond+d&#39;Alembert">d’Alembert</a>—about the possibility that the inverse-square law for gravity might be wrong. But the problem turned out to be with the calculations, and by 1748 Euler was using sums of about 20 trigonometric terms and <a href="http://math.dartmouth.edu/~euler/docs/originals/E141.pdf" target="_blank" rel="noopener">proudly proclaiming</a> that the <a href="http://eulerarchive.maa.org/docs/originals/E087.pdf" target="_blank" rel="noopener">tables he’d produced</a> for the three-body problem had predicted the time of a total solar eclipse to within minutes. (Actually, he had said there’d be 5 minutes of totality, whereas in reality there was only 1—but he blamed this error on incorrect <a href="https://www.wolframalpha.com/input/?i=berlin+coordinates">coordinates he’d been given for Berlin</a>.) </p>
<p>Mathematical physics moved rapidly over the next few decades, with all sorts of now-famous methods being developed, notably by people like <a href="https://www.wolframalpha.com/input/?i=Joseph­Louis+Lagrange">Lagrange</a>. And by the 1770s, for example, Lagrange’s work was looking just like it could have come from a modern calculus book (or from a <a href="https://www.wolframalpha.com/pro/step-by-step-math-solver">Wolfram|Alpha step-by-step solution</a>):</p>
<p><a alt="Lagrange&#39;s methods" title="Lagrange&#39;s methods" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg23.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg23.png" alt="Click to enlarge" title="Click to enlarge" width="776" height="507"/><br/>
</a></p>
<p>Particularly in the hands of <a href="https://www.wolframalpha.com/input/?i=Pierre­Simon+Laplace">Laplace</a> there was increasingly obvious success in deriving the observed phenomena of what he called “<a href="https://en.wikipedia.org/wiki/Celestial_mechanics" target="_blank" rel="noopener">celestial mechanics</a>” from mathematics—and in establishing the idea that mathematics alone could indeed generate new results in science.</p>
<p>At a practical level, measurements of things like the position of the Moon had always been much more accurate than calculations. But now they were becoming more comparable—driving advances in both. Meanwhile, there was increasing systematization in the production of ephemeris tables. And in 1767 the annual publication began of what was for many years the standard: the British <em><a href="https://en.wikipedia.org/wiki/The_Nautical_Almanac" target="_blank" rel="noopener">Nautical Almanac</a></em>. </p>
<p>The almanac quoted the position of the Moon to the arc-second, and systematically achieved at least arc-minute accuracy. The primary use of the almanac was for navigation (and it was what started the convention of using Greenwich as the “<a href="https://en.wikipedia.org/wiki/Prime_meridian_(Greenwich)" target="_blank" rel="noopener">prime meridian</a>” for measuring time). But right at the front of each year’s edition were the predicted times of the eclipses for that year—in 1767 just two solar eclipses:</p>
<p><a alt="Nautical Almanac" title="Nautical Almanac" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg24.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg24.png" alt="Click to enlarge" title="Click to enlarge" width="619" height="281"/><br/>
</a></p>
<h2 id="the-math-gets-more-serious">The Math Gets More Serious</h2>
<p>At a mathematical level, the three-body problem is about solving a system of three ordinary <a href="https://reference.wolfram.com/language/guide/DifferentialEquations.html">differential equations</a> that give the positions of the three bodies as a function of time. If the positions are represented in standard 3D Cartesian coordinates <span><img src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg25.png" width="102" height="16"/></span>, the equations can be stated in the form:</p>
<p>  <img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg26.png" alt="3D Cartesian coordinates equations" title="3D Cartesian coordinates equations" width="424" height="138"/> </p>
<p>The {<em>x</em>, <em>y</em>, <em>z</em>} coordinates here aren’t, however, what traditionally show up in astronomy. For example, in describing the position of the Moon one might use longitude and latitude on a sphere around the Earth. Or, given that one knows the Moon has a roughly elliptical orbit, one might instead choose to describe its motions by variables that are based on deviations from such an orbit. In principle it’s just a matter of algebraic manipulation to restate the equations with any given choice of variables. But in practice what comes out is often long and complex—and can lead to formulas that fill many pages.</p>
<p>But, OK, so what are the best kinds of variables to use for the three-body problem? Maybe they should involve relative positions of pairs of bodies. Or relative angles. Or maybe positions in various kinds of rotating coordinate systems. Or maybe quantities that would be constant in a pure two-body problem. Over the course of the 1700s and 1800s many treatises were written exploring different possibilities. </p>
<p>But in essentially all cases the ultimate approach to the three-body problem was the same. Set up the problem with the chosen variables. Identify parameters that, if set to zero, would make the problem collapse to some easy-to-solve form. Then do a <a href="https://reference.wolfram.com/language/ref/Series.html">series expansion</a> in powers of these parameters, keeping just some number of terms.</p>
<p>The calculations were difficult, and people’s results often didn’t agree.  And for example in 1843 <a href="https://writings.stephenwolfram.com/2015/12/untangling-the-tale-of-ada-lovelace/#what-ada-actually-wrote">Ada Lovelace noted that</a> “In the solution of the famous problem of the Three Bodies, there are, out of about 295 coefficients of lunar perturbations [that had recently been computed]… only 101… agree precisely both in signs and in amount [with previous works]” (going on to say, rather farsightedly, that this was something the Analytical Engine would be able to solve).</p>
<p>By the 1860s <a href="https://www.wolframalpha.com/input/?i=Charles+Delaunay">Charles Delaunay</a> had, however, spent 20 years developing the most extensive theory of the Moon using series expansions. He’d identified five parameters with respect to which to do his expansions (eccentricities, inclinations, and ratios of orbit sizes)—and in the end he generated about 1800 pages like this (yes, he really needed <a href="https://www.wolfram.com/mathematica">Mathematica</a>!):</p>
<p><a alt="Delaunay&#39;s series expressions" title="Delaunay&#39;s series expressions" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg27.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg27.png" alt="Click to enlarge" title="Click to enlarge" width="958" height="616"/><br/>
</a></p>
<p>But the sad fact was that despite all this effort, he didn’t get terribly good answers. And eventually it became clear why. The basic problem was that Delaunay wanted to represent his results in terms of functions like <a href="https://reference.wolfram.com/language/ref/Sin.html">sin</a> and <a href="https://reference.wolfram.com/language/ref/Cos.html">cos</a>. But in his computations, he often wanted to do series expansions with respect to the frequencies of those functions. Here’s a minimal case:</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg28.png" alt="" title="" width="533" height="66"/> </p>
</div>
<p>And here’s the problem. Take a look even at the second term. Yes, the δ parameter may be small. But how about the <span><img src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg29.png" width="5" height="11"/></span> parameter, standing for time? If you don’t want to make predictions very far out, that’ll stay small. But what if you want to figure out what will happen further in the future?</p>
<p>Well, eventually that term will get big. And higher-order terms will get even bigger. But unless the Moon is going to escape its orbit or something, the final mathematical expressions that represent its position can’t have values that are too big. So in these expressions the so-called secular terms that increase with<em> </em><span><img src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg30.png" width="5" height="11"/></span> must somehow cancel out.</p>
<p>But the problem is that at any given order in the series expansion, there’s no guarantee that will happen in a numerically useful way. And in Delaunay’s case—even though with immense effort he often went to 7th order or beyond—it didn’t. </p>
<p>One nice feature of Delaunay’s computation was that it was in a sense entirely algebraic: everything was done symbolically, and only at the very end were actual numerical values of parameters substituted in.</p>
<p>But even before Delaunay, <a href="https://www.wolframalpha.com/input/?i=Peter+Hansen">Peter Hansen</a> had taken a different approach—substituting numbers as soon as he could, and dropping terms based on their numerical size rather than their symbolic form. His presentations look less pure (notice things like all those <span><img src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg31.png" width="58" height="12"/></span>, where <span><img src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg32.png" width="5" height="11"/></span> is the time in years), and it’s more difficult to tell what’s going on. But as a practical matter, his results were much better, and in fact were used for many national almanacs from about 1862 to 1922, achieving errors as small as 1 or 2 arc-seconds at least over periods of a decade or so. (Over longer periods, the errors could rapidly increase because of the lack of terms that had been dropped as a result of what amounted to numerical accidents.)</p>
<p><a alt="Hansen&#39;s methods" title="Hansen&#39;s methods" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg33.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg33.png" alt="Click to enlarge" title="Click to enlarge" width="810" height="572"/><br/>
</a></p>
<p>Both Delaunay and Hansen tried to represent orbits as series of powers and trigonometric functions (so-called Poisson series). But in the 1870s, <a href="https://www.wolframalpha.com/input/?i=George+William+Hill">George Hill</a> in the <a href="https://en.wikipedia.org/wiki/United_States_Naval_Observatory" target="_blank" rel="noopener">US Nautical Almanac Office</a> proposed instead using as a basis numerically computed functions that came from solving an equation for two-body motion with a periodic driving force of roughly the kind the Sun exerts on the Moon’s orbit. A large-scale effort was mounted, and starting in 1892 <a href="https://en.wikipedia.org/wiki/Ernest_William_Brown" target="_blank" rel="noopener">Ernest W. Brown</a> (who had moved to the US, but had been a student of <a href="https://www.wolframalpha.com/input/?i=george+darwin">George Darwin</a>, <a href="https://www.wolframalpha.com/input/?i=charles+darwin">Charles Darwin</a>’s physicist son) took charge of the project and in 1918 produced what would stand for many years as the definitive “<a href="https://archive.org/details/tablesofmotionof04browrich/tablesofmotionof04browrich/" target="_blank" rel="noopener">Tables of the Motion of the Moon</a>”.</p>
<p>Brown’s tables consist of hundreds of pages like this—ultimately representing the position of the Moon as a combination of about 1400 terms with very precise coefficients: </p>
<p><a alt="Brown&#39;s tables" title="Brown&#39;s tables" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg34.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg34.png" alt="Click to enlarge" title="Click to enlarge" width="889" height="609"/><br/>
</a></p>
<p>He says right at the beginning that the tables aren’t particularly intended for unique events like eclipses, but then goes ahead and does a “worked example” of computing an eclipse from 381 BC, reported by <a href="https://www.wolframalpha.com/input/?i=ptolemy">Ptolemy</a>: </p>
<p><a alt="Brown&#39;s tables 2" title="Brown&#39;s tables 2" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg35.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg35.png" alt="Click to enlarge" title="Click to enlarge" width="896" height="607"/><br/>
</a></p>
<p>It was an impressive indication of how far things had come. But ironically enough the final presentation of Brown’s tables had the same sum-of-trigonometric-functions form that one would get from having lots of epicycles. At some level it’s not surprising, because any function can ultimately be represented by epicycles, just as it can be represented by a Fourier or other series. But it’s a strange quirk of history that such similar forms were used.</p>
<h2 id="can-the-three-body-problem-be-solved">Can the Three-Body Problem Be Solved?</h2>
<p>It’s all well and good that one can find approximations to the three-body problem, but what about just finding an <a href="https://www.wolframscience.com/nks/notes-12-6--history-of-exact-solutions/">outright solution</a>—like as a mathematical formula? Even in the 1700s, there’d been some specific solutions found—like Euler’s collinear configuration, and <a href="https://en.wikipedia.org/wiki/Lagrangian_point" target="_blank" rel="noopener">Lagrange’s equilateral triangle</a>. But a century later, no further solutions had been found—and finding a complete solution to the three-body problem was beginning to seem as hopeless as trisecting an angle, solving the quintic, or making a perpetual motion machine. (That sentiment was reflected for example in a letter <a href="http://blog.stephenwolfram.com/2015/12/untangling-the-tale-of-ada-lovelace/">Charles Babbage wrote Ada Lovelace</a> in 1843 mentioning the “horrible problem [of] the three bodies”—even though this letter was later misinterpreted by Ada’s biographers to be about a romantic triangle, not the three-body problem of celestial mechanics.)</p>
<p>In contrast to the three-body problem, what seemed to make the two-body problem tractable was that its solutions could be completely characterized by “<a href="https://en.wikipedia.org/wiki/Constant_of_motion" target="_blank" rel="noopener">constants of the motion</a>”—quantities that stay constant with time (in this case notably the <a href="https://en.wikipedia.org/wiki/Laplace%E2%80%93Runge%E2%80%93Lenz_vector" target="_blank" rel="noopener">direction of the axis of the ellipse</a>). So for many years one of the big goals with the three-body problem was to find constants of the motion.</p>
<p>In 1887, though, <a href="https://en.wikipedia.org/wiki/Heinrich_Bruns" target="_blank" rel="noopener">Heinrich Bruns</a> showed that there couldn’t be any such constants of the motion, at least expressible as algebraic functions of the standard {<em>x</em>, <em>y</em>, <em>z</em>} position and velocity coordinates of the three bodies. Then in the mid-1890s <a href="https://www.wolframalpha.com/input/?i=Henri+Poincare">Henri Poincaré</a> showed that actually there couldn’t be any constants of the motion that were expressible as any <a href="https://en.wikipedia.org/wiki/Analytic_function" target="_blank" rel="noopener">analytic functions</a> of the positions, velocities and mass ratios.</p>
<p>One reason that was particularly disappointing at the time was that it had been hoped that somehow constants of the motion would be found in <em>n</em>-body problems that would lead to a mathematical proof of the long-term stability of the solar system. And as part of his work, Poincaré also saw something else: that at least in particular cases of the three-body problem, there was arbitrarily <a href="https://www.wolframscience.com/nks/p304--chaos-theory-and-randomness-from-initial-conditions/">sensitive dependence on initial conditions</a>—implying that even tiny errors in measurement could be amplified to arbitrarily large changes in predicted behavior (the classic “<a href="https://www.wolframscience.com/nks/notes-7-4--history-of-chaos-theory/">chaos theory</a>” phenomenon). </p>
<p>But having discovered that particular solutions to the three-body problem could have this kind of instability, Poincaré took a different approach that would actually be characteristic of much of pure mathematics going forward: he decided to look not at individual solutions, but at the space of all possible solutions. And needless to say, he found that for the three-body problem, this was very complicated—though in his efforts to analyze it he invented the field of <a href="http://mathworld.wolfram.com/Topology.html">topology</a>.</p>
<p>Poincaré’s work all but ended efforts to find complete solutions to the three-body problem. It also seemed to some to explain why the series expansions of Delaunay and others hadn’t worked out—though in 1912 <a href="https://en.wikipedia.org/wiki/Karl_F._Sundman" target="_blank" rel="noopener">Karl Sundman</a> did show that at least in principle the three-body problem could be solved in terms of an infinite series, albeit one that converges outrageously slowly.</p>
<p>But what does it mean to say that there can’t be a solution to the three-body problem? <a href="https://www.wolframalpha.com/input/?i=Évariste+Galois">Galois</a> had shown that there couldn’t be a solution to the generic <a href="https://www.wolframalpha.com/input/?i=quintic+equation">quintic equation</a>, at least in terms of radicals. But actually it’s still perfectly possible to express the solution in terms of elliptic or hypergeometric functions. So why can’t there be some more sophisticated class of functions that can be used to just “solve the three-body problem”?</p>
<p>Here are some pictures of what can actually happen in the three-body problem, with various initial conditions:</p>
<p><a alt="" title="" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg37.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg37.png" alt="Click to enlarge" title="Click to enlarge" width="658" height="530"/><br/>
</a></p>
<p>And looking at these immediately gives some indication of why it’s not easy to just “solve the three-body problem”. Yes, there are cases where what happens is fairly simple. But there are also cases where it’s not, and where the trajectories of the three bodies continue to be complicated and tangled for a long time.</p>
<p>So what’s fundamentally going on here? I don’t think traditional mathematics is the place to look. But I think what we’re seeing is actually an example of a general phenomenon I call <a href="https://www.wolframalpha.com/input/?i=computational+irreducibility">computational irreducibility</a> that I discovered in the 1980s in studying the computational universe of possible programs.</p>
<p>Many programs, like many instances of the three-body problem, behave in quite simple ways. But if you just start looking at all possible simple programs, it doesn’t take long before you start seeing behavior like this:</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg38A.png" alt="" title="" width="618" height="260"/> </p>
</div>
<p>How can one tell what’s going to happen? Well, one can just keep explicitly running each program and seeing what it does. But the question is: is there some systematic way to jump ahead, and to predict what will happen without tracing through all the steps?</p>
<p>The answer is that in general there isn’t. And what I call the <a href="https://www.wolframscience.com/nks/chap-12--the-principle-of-computational-equivalence/">Principle of Computational Equivalence</a> suggests that pretty much whenever one sees complex behavior, there won’t be. </p>
<p>Here’s the way to think about this. The system one’s studying is effectively doing a computation to work out what its behavior will be. So to jump ahead we’d in a sense have to do a more sophisticated computation. But what the Principle of Computational Equivalence says is that actually we can’t—and that whether we’re using our brains or our mathematics or a <a href="https://www.wolframscience.com/nks/p78--turing-machines/">Turing machine</a> or anything else, we’re always stuck with computations of the same sophistication. </p>
<p>So what about the three-body problem? Well, <a href="https://www.wolframscience.com/nks/notes-7-4--three-body-problem/">I strongly suspect</a> that it’s an example of computational irreducibility: that in effect the computations it’s doing are as sophisticated as any computations that we can do, so there’s no way we can ever expect to systematically jump ahead and solve the problem. (We also can’t expect to just define some new finite class of functions that can just be evaluated to give the solution.)</p>
<p>I’m <a href="https://www.wolframscience.com/prizes/tm23/">hoping that one day</a> someone will rigorously prove this. There’s some <a href="https://www.wolframscience.com/nks/notes-12-4--continuous-computation/">technical difficulty</a>, because the three-body problem is usually formulated in terms of <a href="https://www.wolframscience.com/nks/notes-12-4--continuous-computation/">real numbers</a> that immediately have an infinite number of digits—but to compare with ordinary computation one has to require finite processes to <a href="https://www.wolframscience.com/nks/notes-12-4--constructible-reals/">set up initial conditions</a>. (Ultimately one wants to show for example that there’s a “compiler” that can go from any program, say for a Turing machine, and can generate instructions to set up initial conditions for a three-body problem so that the evolution of the three-body problem will give the same results as running that program—implying that the three-body problem is capable of <a href="https://www.wolframscience.com/nks/p642--the-phenomenon-of-universality/">universal computation</a>.)</p>
<p>I have to say that I consider Newton in a sense very lucky. It could have been that it wouldn’t have been possible to work out anything interesting from his theory without encountering the kind of difficulties he had with the motion of the Moon—because one would always be running into computational irreducibility. But in fact, there was enough computational reducibility and enough that could be computed easily that one could see that the theory was useful in predicting features of the world (and not getting wrong answers, like with the apse of the Moon)—even if there were some parts that might take two centuries to work out, or never be possible at all.</p>
<p>Newton himself was certainly <a href="https://www.wolframscience.com/nks/notes-12-6--history-of-computational-irreducibility/">aware of the potential issue</a>, saying that at least if one was dealing with gravitational interactions between many planets then “to define these motions by exact laws admitting of easy calculation exceeds, if I am not mistaken, the force of any human mind”. </p>
<p>It’s not particularly that there’s sensitive dependence on initial conditions: we actually have measurements that should be precise enough to determine what will happen for a long time. The problem is that we just have to do the computation—a bit like computing the digits of π—to work out the behavior of the <span><img src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg39.png" width="8" height="9"/></span>-body problem that is our solar system. </p>
<p>Existing simulations show that for perhaps a few tens of millions of years, nothing too dramatic can happen. But after that we don’t know. Planets could change their order. Maybe they could even collide, or be ejected from the solar system. Computational irreducibility implies that at least after an infinite time it’s actually <a href="https://www.wolframscience.com/nks/p753--undecidability-and-intractability/">formally undecidable</a> (in the sense of Gödel’s theorem or the halting problem) what can happen.</p>
<p>One of my children, when they were very young, asked me whether when dinosaurs existed the Earth could have had two moons. For years when I ran into celestial mechanics experts I would ask them that question—and it was notable how difficult they found it. Most now say that at least at the time of the dinosaurs we couldn’t have had an extra moon—though a billion years earlier it’s not clear. </p>
<p>We used to only have one system of planets to study. And the fact that there were (then) 9 of them used to be a <a href="http://www.iep.utm.edu/lawofnat/" target="_blank" rel="noopener">classic philosopher’s example</a> of a truth about the world that just happens to be the way it is, and isn’t “necessarily true” (like 2 + 2 = 4). But now of course we know about lots of <a href="https://www.wolframalpha.com/input/?t=crmtb01&amp;f=ob&amp;i=exoplanets">exoplanets</a>. And it’s beginning to look as if there might be a theory for things like how many planets a solar system is likely to have.</p>
<p>At some level there’s presumably a process like natural selection: some configurations of planets aren’t <a href="https://www.wolframscience.com/nks/notes-7-4--randomness-in-the-solar-system/">“fit enough” to be stable</a>—and only those that are survive. In biology it’s traditionally been assumed that natural selection and adaptation is somehow what’s led to the complexity we see. But actually <a href="https://www.wolframscience.com/nks/p383--fundamental-issues-in-biology/">I suspect much of it</a> is instead just a reflection of what generally happens in the computational universe—both in biology and in celestial mechanics. Now in celestial mechanics, we haven’t yet seen in the wild any particularly complex forms (<a href="https://www.wolframscience.com/nks/notes-7-4--randomness-in-the-solar-system/">beyond a few</a> complicated gap structures in rings, and tumbling moons and asteroids). But perhaps elsewhere we’ll see things like those obviously tangled solutions to the three-body problem—that come closer to what we’re used to in biology.</p>
<p>It’s remarkable how similar the issues are across so many different fields. For example, the whole idea of using “<a href="https://en.wikipedia.org/wiki/Perturbation_theory" target="_blank" rel="noopener">perturbation theory</a>” and series expansions that has existed since the 1700s in celestial mechanics is now also core to quantum field theory. But just like in celestial mechanics there’s trouble with convergence (maybe one should try renormalization or resummation in celestial mechanics). And in the end one begins to realize that there are phenomena—no doubt like turbulence or the three-body problem—that inevitably involve more sophisticated computations, and that need to be studied not with traditional mathematics of the kind that was so successful for Newton and his followers but with the kind of science that comes from exploring the computational universe.</p>
<h2 id="approaching-modern-times">Approaching Modern Times</h2>
<p>But let’s get back to the story of the motion of the Moon. Between Brown’s tables, and Poincaré’s theoretical work, by the beginning of the 1900s the general impression was that whatever could reasonably be computed about the motion of the Moon had been computed.</p>
<p>Occasionally there were tests. Like for example in 1925, when there was a total solar eclipse visible in New York City, and the <em><a href="http://www.nyt.com" target="_blank" rel="noopener">New York Times</a></em> perhaps overdramatically said that “scientists [were] tense… [wondering] whether they or Moon is wrong as eclipse lags five seconds behind”. The fact is that a prediction accurate to 5 seconds was remarkably good, and we can’t do all that much better even today. (By the way, the actual article talks extensively about “Professor Brown”—as well as about how the eclipse might “disprove Einstein” and corroborate the existence of “<a href="https://en.wikipedia.org/wiki/Coronium" target="_blank" rel="noopener">coronium</a>”—but doesn’t elaborate on the supposed prediction error.)</p>
<p><a alt="Newspaper article" title="Newspaper article" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg40.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg40.png" alt="Click to enlarge" title="Click to enlarge" width="620" height="500"/><br/>
</a></p>
<p>As a practical matter, Brown’s tables were not exactly easy to use: to find the position of the Moon from them required lots of mechanical desk calculator work, as well as careful transcription of numbers. And this led <a href="https://www.wolframalpha.com/input/?i=Leslie+Comrie">Leslie Comrie</a> in 1932 to propose using a punch-card-based IBM Hollerith automatic tabulator—and with the help of <a href="https://www.wolframalpha.com/input/?i=Thomas+Watson">Thomas Watson</a>, CEO of <a href="http://www.ibm.com" target="_blank" rel="noopener">IBM</a>, what was probably the first “scientific computing laboratory” was established—to automate computations from Brown’s tables.</p>
<p><a alt="Automatic tabulation" title="Automatic tabulation" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg41.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg41.png" alt="Click to enlarge" title="Click to enlarge" width="709" height="189"/><br/>
</a></p>
<p>(When I was in elementary school in England in the late 1960s—before electronic calculators—I always carried around, along with my slide rule, a little book of “4-figure mathematical tables”. I think I found it odd that such a book would have an author—and perhaps for that reason I still remember the name: “L. J. Comrie”.) </p>
<p>By the 1950s, the calculations in Brown’s tables were slowly being rearranged and improved to make them more suitable for computers. But then with <a href="https://www.wolframalpha.com/input/?i=john+f+kennedy">John F. Kennedy</a>’s 1962 “We choose to go to the Moon”, there was suddenly urgent interest in getting the most accurate computations of the Moon’s position. As it turned out, though, it was basically just a tweaked version of Brown’s tables, running on a mainframe computer, that did the computations for the Apollo program.</p>
<p>At first, computers were used in celestial mechanics purely for numerical computation. But by the mid-1960s there were also experiments in using them for algebraic computation, and particularly to automate the generation of series expansions. <a href="https://www.wolframalpha.com/input/?i=Wallace+Eckert">Wallace Eckert</a> at IBM started using <a href="https://en.wikipedia.org/wiki/FORMAC" target="_blank" rel="noopener">FORMAC</a> to redo Brown’s tables, while in Cambridge David Barton and <a href="https://www.wolframalpha.com/input/?i=steve+bourne">Steve Bourne</a> (later the creator of the <a href="https://en.wikipedia.org/wiki/Bourne_shell" target="_blank" rel="noopener">“Bourne shell” (sh) in Unix</a>) built their own <a href="https://en.wikipedia.org/wiki/Cambridge_Algebra_System" target="_blank" rel="noopener">CAMAL</a> computer algebra system to try extending the kind of thing Delaunay had done. (And by 1970, Delaunay’s 7th-order calculations had been extended to 20th order.)</p>
<p>When I myself started to work on computer algebra in 1976 (primarily for computations in particle physics), I’d certainly heard about CAMAL, but I didn’t know what it had been used for (beyond vaguely “celestial mechanics”). And as a practicing theoretical physicist in the late 1970s, I have to say that the “problem of the Moon” that had been so prominent in the 1700s and 1800s had by then fallen into complete obscurity. </p>
<p>I remember for example in 1984 asking a certain <a href="https://en.wikipedia.org/wiki/Martin_Gutzwiller" target="_blank" rel="noopener">Martin Gutzwiller</a>, who was talking about quantum chaos, what his main interest actually was. And when he said “the problem of the Moon”, I was floored; I didn’t know there still was any problem with the Moon. As it turns out, in writing this post I found out that Gutzwiller was actually the person who took over from Eckert and spent nearly two decades working on trying to improve the computations of the position of the Moon.</p>
<h2 id="why-not-just-solve-it">Why Not Just Solve It?</h2>
<p>Traditional approaches to the three-body problem come very much from a mathematical way of thinking. But modern computational thinking immediately suggests a different approach. Given the differential equations for the three-body problem, why not just directly solve them? And indeed in the <a href="http://www.wolfram.com/language/">Wolfram Language</a> there’s a built-in function <tt><a href="http://reference.wolfram.com/language/ref/NDSolve.html">NDSolve</a></tt> for numerically solving systems of differential equations. </p>
<p>So what happens if one just feeds in equations for a three-body problem? Well, here are the equations:</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg42.png" alt="" title="" width="562" height="177"/> </p>
</div>
<p>Now as an example let’s set the masses to random values:</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg43.png" alt="" title="" width="333" height="45"/> </p>
</div>
<p>And let’s define the initial position and velocity for each body to be random as well:</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg44.png" alt="" title="" width="672" height="118"/> </p>
</div>
<p>Now we can just use <tt><a href="http://reference.wolfram.com/language/ref/NDSolve.html">NDSolve</a></tt> to get the solutions (it gives them as implicit approximate numerical functions of <span><img src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg45.png" width="5" height="11"/></span>):</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg46.png" alt="" title="" width="730" height="134"/> </p>
</div>
<p>And now we can plot them. And now we’ve got a solution to a three-body problem, just like that!</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg47.png" alt="" title="" width="626" height="208"/> </p>
</div>
<p>Well, obviously this is using the Wolfram Language and a huge tower of modern technology. But would it have been possible even right from the beginning for people to generate direct numerical solutions to the three-body problem, rather than doing all that algebra? Back in the 1700s, Euler already knew what’s now called <a href="https://www.wolframalpha.com/input/?i=Euler+backward+method">Euler’s method</a> for finding approximate numerical solutions to differential equations. So what if he’d just used that method to calculate the motion of the Moon?</p>
<p>The method relies on taking a sequence of discrete steps in time. And if he’d used, say, a step size of a minute, then he’d have had to take 40,000 steps to get results for a month, but he should have been able to successfully reproduce the position of the Moon to about a percent. If he’d tried to extend to 3 months, however, then he would already have had at least a 10% error. </p>
<p>Any numerical scheme for solving differential equations in practice eventually builds up some kind of error—but the more one knows about the equations one’s solving, and their expected solutions, the more one’s able to preprocess and adapt things to minimize the error. <tt><a href="http://reference.wolfram.com/language/ref/NDSolve.html">NDSolve</a></tt> has enough automatic adaptivity built into it that it’ll do pretty well for a surprisingly long time on a typical three-body problem. (It helps that the Wolfram Language and <tt><a href="http://reference.wolfram.com/language/ref/NDSolve.html">NDSolve</a></tt> can handle numbers with arbitrary precision, not just machine precision.) </p>
<p>But if one looks, say, at the total energy of the three-body system—which one can prove from the equations should stay constant—then one will typically see an error slowly build up in it. One can avoid this if one effectively does a change of variables in the equations to “factor out” energy. And one can imagine doing a whole hierarchy of algebraic transformations that in a sense give the numerical scheme as much help as possible. </p>
<p>And indeed since at least the 1980s that’s exactly what’s been done in practical work on the three-body problem, and the Earth-Moon-Sun system. So in effect it’s a mixture of the traditional algebraic approach from the 1700s and 1800s, together with modern numerical computation.</p>
<h2 id="the-real-earth-moon-sun-problem">The Real Earth-Moon-Sun Problem</h2>
<p>OK, so what’s involved in solving the real problem of the Earth-Moon-Sun system? The standard three-body problem gives a remarkably good approximation to the physics of what’s happening. But it’s obviously not the whole story. </p>
<p>For a start, the Earth isn’t the only planet in the solar system. And if one’s trying to get sufficiently accurate answers, one’s going to have to take into account the gravitational effect of other planets. The most important is Jupiter, and its typical effect on the orbit of the Moon is at about the <span><img src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg48.png" width="30" height="14"/></span> level—sufficiently large that for example Brown had to take it into account in his tables. </p>
<p>The next effect is that the Earth isn’t just a point mass, or even a precise sphere. Its rotation makes it bulge at the equator, and that affects the orbit of the Moon at the <span><img src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg49.png" width="31" height="16"/></span> level. </p>
<p>Orbits around the Earth ultimately depend on the full mass distribution and <a href="https://reference.wolfram.com/language/ref/GeogravityModelData.html">gravitational field</a> of the Earth (which is what <a href="https://www.wolframalpha.com/input/?i=Sputnik-1">Sputnik-1</a> was nominally launched to map)—and both this, and the reverse effect from the Moon, come in at the <span><img src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg50.png" width="31" height="16"/></span> level. At the <span><img src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg51.png" width="30" height="14"/></span> level there are then effects from tidal deformations (“<a href="https://en.wikipedia.org/wiki/Earth_tide" target="_blank" rel="noopener">solid tides</a>”) on the Earth and Moon, as well as from gravitational redshift and other general relativistic phenomena.</p>
<p>To predict the position of the Moon as accurately as possible one ultimately has to have at least some model for these various effects.</p>
<p>But there’s a much more immediate issue to deal with: one has to know the initial conditions for the Earth, Sun and Moon, or in other words, one has to know as accurately as possible what their positions and velocities were at some particular time.</p>
<p>And conveniently enough, there’s now a really good way to do that, because <a href="https://www.wolframalpha.com/input/?i=Apollo+11">Apollo 11</a>, <a href="https://www.wolframalpha.com/input/?i=Apollo+14">14</a> and <a href="https://www.wolframalpha.com/input/?i=Apollo+15">15</a> all left <a href="https://en.wikipedia.org/wiki/Lunar_Laser_Ranging_experiment" target="_blank" rel="noopener">laser retroreflectors</a> on the Moon. And by precisely timing how long it takes a laser pulse from the Earth to round-trip to these retroreflectors, it’s now possible in effect to measure the position of the Moon to millimeter accuracy.</p>
<p>OK, so how do modern analogs of the Babylonian ephemerides actually work? Internally they’re dealing with the equations for all the significant bodies in the solar system. They do symbolic preprocessing to make their numerical work as easy as possible. And then they directly solve the differential equations for the system, appropriately inserting models for things like the mass distribution in the Earth. </p>
<p>They start from particular measured initial conditions, but then they repeatedly insert new measurements, trying to correct the parameters of the model so as to optimally reproduce all the measurements they have. It’s very much like a typical <a href="https://reference.wolfram.com/language/guide/MachineLearning.html">machine learning</a> task—with the training data here being observations of the solar system (and typically fitting just being <a href="https://reference.wolfram.com/language/ref/Fit.html">least squares</a>).</p>
<p>But, OK, so there’s a model one can run to figure out something like the position of the Moon. But one doesn’t want to have to explicitly do that every time one needs to get a result; instead one wants in effect just to store a big table of pre-computed results, and then to do something like <a href="https://reference.wolfram.com/language/ref/Interpolation.html">interpolation</a> to get any particular result one needs. And indeed that’s how it’s done today.</p>
<h2 id="how-its-really-done">How It’s Really Done</h2>
<p>Back in the 1960s NASA started directly solving differential equations for the motion of planets. The Moon was more difficult to deal with, but by the 1980s that too was being handled in a similar way. Ongoing data from things like the lunar retroreflectors was added, and all available historical data was inserted as well. </p>
<p>The result of all this was the <a href="https://en.wikipedia.org/wiki/Jet_Propulsion_Laboratory_Development_Ephemeris" target="_blank" rel="noopener">JPL Development Ephemeris</a> (JPL DE). In addition to new observations being used, the underlying system gets updated every few years, for example to get what’s needed for some spacecraft going to some new place in the solar system. (The latest is DE441—that follows DE432, which was built for going to Pluto.)</p>
<p>But so how is the actual ephemeris delivered? Well, for every thousand years covered, the ephemeris has about 100 megabytes of results, given as coefficients for <a href="http://mathworld.wolfram.com/ChebyshevPolynomialoftheFirstKind.html">Chebyshev polynomials</a>, which are convenient for interpolation. And for any given quantity in any given coordinate system over a particular period of time, one accesses the appropriate parts of these results.</p>
<p>In Wolfram Language, it’s all packaged up into the function <tt><a href="http://reference.wolfram.com/language/ref/AstroPosition.html">AstroPosition</a></tt>—which here gives the position of the Moon in coordinates relative to the equator of the Earth right now:</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg52.png" alt="" title="" width="356" height="81"/> </p>
</div>
<p>OK, but so how does one find an eclipse? Well, it’s an iterative process. Start with an approximation, perhaps from the saros cycle. Then interpolate the ephemeris and look at the result. Then keep iterating until one finds out just when the Moon will be in the appropriate position.</p>
<p>But actually there’s some more to do. Because what’s originally computed are the positions of the barycenters (centers of mass) of the various bodies. But now one has to figure out how the bodies are oriented. </p>
<p>The Earth rotates, and we know its rate quite precisely. But the Moon is basically locked with the same face pointing to the Earth, except that in practice there are small “<a href="https://en.wikipedia.org/wiki/Libration" target="_blank" rel="noopener">librations</a>” where the Moon wobbles a little back and forth—and these turn out to be particularly troublesome to predict.</p>
<h2 id="where-will-the-eclipse-be">Where Will the Eclipse Be?</h2>
<p>OK, so let’s say one knows where the Earth, Moon and Sun are. How does one then figure out what type of eclipse will happen, and where on the Earth the eclipse will actually hit? Well, there’s some further geometry to do. And here’s the beginning of what’s involved:</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg53.png" alt="" title="" width="453" height="208"/> </p>
</div>
<p>Basically the Moon generates a cone of shadow, and then the question is how this cone intersects the Earth. If the tip of the cone is inside the Earth, that means there’ll be a region of total shadow (“umbra”) on the Earth—and a total eclipse. (If the tip is above the Earth, there’ll be an annular eclipse, in which there’s a “ring of sun” visible around the Moon.)</p>
<p>By the way, the more complete geometry is like this (again not to scale)</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg54.png" alt="" title="" width="462" height="215"/> </p>
</div>
<p>where now we’ve included the penumbra in which only part of the Sun is shadowed by the Moon. In the particular case shown, the umbra cone “misses the Earth”, so there’s no total eclipse, but there’s still a partial eclipse where part of the Sun is shadowed.</p>
<p>OK, but let’s say there’s going to be a total eclipse. To see where on the Earth the region of totality will be, we have to work out where the “cone of total shadow” (i.e. umbra) will intersect the surface of the Earth. It’s a somewhat complicated 3D geometry problem:</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg55.png" alt="" title="" width="301" height="249"/> </p>
</div>
<p>It’s easiest to understand what happens by looking at things from the position of the Sun. The light gray region is the penumbra, and the little black dot is the region of totality (i.e. the umbra):</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg56.png" alt="" title="" width="288" height="289"/> </p>
</div>
<p>As the Earth and Moon move in their orbits, the region of shadow will move relative to the Earth:</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg57A.png" alt="" title="" width="502" height="252"/> </p>
</div>
<p>But now there’s another part of the story, which is the rotation of the Earth. And if we include that, we’ll see that the region of totality (at least in this case) traces out a kind of <em>S</em>-shaped curve on the surface of the Earth:</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg58A.png" alt="" title="" width="504" height="263"/> </p>
</div>
<p>All this tricky geometry got figured out in 1824 by <a href="https://www.wolframalpha.com/input/?i=Friedrich+Bessel">Friedrich Bessel</a>, who introduced what are now called the <a href="https://writings.stephenwolfram.com/2024/03/when-exactly-will-the-eclipse-happen-a-multimillennium-tale-of-computation/%5B%5B%20linked%20to%20examples%20in%20SolarEclipse%20%5D%5D" target="_blank" rel="noopener">Besselian elements</a>—eight variables that specify the location, orientation and aperture of the umbra and penumbra cones, as well as the orientation of the Earth, as a function of time. And for any given eclipse, the whole story of its appearance and trajectory on the surface of the Earth is determined by its Besselian elements.</p>
<h2 id="when-will-the-eclipse-arrive">When Will the Eclipse Arrive?</h2>
<p>OK, so now we know what the trajectory of an eclipse will be. But how do we figure out at what time the eclipse will actually reach a given point on Earth? Well, first we have to be clear on our definition of time. And there’s an immediate issue with the speed of light and <a href="https://en.wikipedia.org/wiki/Special_relativity" target="_blank" rel="noopener">special relativity</a>. What does it mean to say that the positions of the Earth and Sun are such-and-such at such-and-such a time? Because it takes light about 8 minutes to get to the Earth from the Sun, we only get to see where the Sun was 8 minutes ago, not where it is now. </p>
<p>And what we need is really a classic <a href="https://en.wikipedia.org/wiki/Special_relativity" target="_blank" rel="noopener">special relativity</a> setup. We essentially imagine that the solar system is filled with a grid of clocks that have been synchronized by light pulses. And what a modern ephemeris does is to quote the results for positions of bodies in the solar system relative to the times on those clocks. (<a href="https://en.wikipedia.org/wiki/General_relativity" target="_blank" rel="noopener">General relativity</a> implies that in different gravitational fields the clocks will run at different rates, but for our purposes this is a tiny effect. But what isn’t a tiny effect is including retardation in the equations for the <span><img src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg59.png" width="8" height="9"/></span>-body problem—making them become <a href="https://reference.wolfram.com/language/tutorial/NDSolveDelayDifferentialEquations.html">delay differential equations</a>.)</p>
<p>But now there’s another issue. If one’s observing the eclipse, one’s going to be using some timepiece (phone?) to figure out what time it is. And if it’s working properly that timepiece should show official “civil time” that’s based on <a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time" target="_blank" rel="noopener">UTC</a>—which is what <a href="https://en.wikipedia.org/wiki/Network_Time_Protocol" target="_blank" rel="noopener">NTP</a> internet time is synchronized to. But the issue is that UTC has a complicated relationship to the time used in the astronomical ephemeris.</p>
<p>The starting point is what’s called <a href="https://en.wikipedia.org/wiki/Universal_Time#Versions" target="_blank" rel="noopener">UT1</a>: a definition of time in which one day is the average time it takes the Earth to rotate once relative to the Sun. But the point is that this average time isn’t constant, because the rotation of the Earth is gradually slowing down, primarily as a result of interactions with the Moon. But meanwhile, UTC is defined by an atomic clock whose timekeeping is independent of any issues about the rotation of the Earth. </p>
<p>There’s a convention for keeping UT1 aligned with UTC: if UT1 is going to get more than 0.9 seconds away from UTC, then a <a href="https://en.wikipedia.org/wiki/Leap_second" target="_blank" rel="noopener">leap second</a> is added to UTC. One might think this would be a tiny effect, but actually, since 1972, a total of 27 leap seconds have been added (as specified in the Wolfram Language by <tt><a href="http://reference.wolfram.com/language/ref/GeoOrientationData.html">GeoOrientationData</a></tt>):</p>
<div>
<p><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg60.png" alt="" title="" width="598" height="36"/> </p>
</div>
<p>Exactly when a new leap second will be needed is unpredictable; it depends on things like what earthquakes have occurred. But we need to account for leap seconds if we’re going to get the time of the eclipse correct to the second relative to UTC or internet time.</p>
<p>There are a few other effects that are also important in the precise observed timing of the eclipse. The most obvious is <a href="https://reference.wolfram.com/language/ref/GeoElevationData.html">geo elevation</a>. In doing astronomical computations, the Earth is assumed to be an ellipsoid. (There are many different definitions, corresponding to different <a href="https://reference.wolfram.com/language/ref/GeodesyData.html">geodetic “datums”</a>—and that’s an issue in defining things like “sea level”, but it’s not relevant here.) But if you’re at a different height above the ellipsoid, the cone of shadow from the eclipse will reach you at a different time. And the size of this effect can be as much as 0.3 seconds for every 1000 feet of height.</p>
<p>All of the effects we’ve talked about we’re readily able to account for. But there is one remaining effect that’s a bit more difficult. Right at the beginning or end of totality one typically sees points of light on the rim of the Moon. Known as <a href="https://en.wikipedia.org/wiki/Baily%27s_beads" target="_blank" rel="noopener">Baily’s beads</a>, these are the result of rays of light that make it to us between mountains on the Moon. Figuring out exactly when all these rays are extinguished requires taking <a href="https://reference.wolfram.com/language/ref/GeoElevationData.html">geo elevation data for the Moon</a>, and effectively doing full 3D ray tracing. And in doing this, one ends with the rather bizarre conclusion that the region of shadow on the earth isn’t a perfect circle; instead <a href="https://community.wolfram.com/groups/-/m/t/3139774">it’s roughly a polygon</a>, each of whose edges is associated with a particular Baily’s bead. The effect of this can last as long as a second, and can cause the precise edge of totality to move by as much as a mile. (One can also imagine effects having to do with the corona of the Sun, which is <a href="https://www.wolframalpha.com/input/?i=space+weather">constantly changing</a>.)</p>
<p>But in the end, even though the shadow of the Moon on the Earth moves at more than 1000 mph, modern science successfully makes it possible to compute when the shadow will reach a particular point on Earth to an accuracy of perhaps a second. And that’s what our <a href="http://precisioneclipse.com" target="_blank" rel="noopener">precisioneclipse.com</a> website is set up to do. </p>
<h2 id="eclipse-experiences">Eclipse Experiences</h2>
<h3 id="written-august-15-2017">Written August 15, 2017</h3>
<p>I <a href="http://blog.stephenwolfram.com/2016/05/something-i-learned-in-kindergarten/">saw my first partial solar eclipse</a> more than 50 years ago. And I’ve seen <a href="https://www.wolframalpha.com/input/?i=total+eclipse+1991">one total solar eclipse</a> before in my life—in 1991. It was the longest eclipse (6 minutes 53 seconds) that’ll happen for more than a century.</p>
<p>There was a certain irony to my experience, though, especially in view of our efforts now to predict the exact arrival time of next week’s eclipse. I’d chartered a plane and flown to a small airport in Mexico (yes, that’s me on the left with the silly hat)—and my friends and I had walked to a beautiful deserted beach, and were waiting under a cloudless sky for the total eclipse to begin. </p>
<p><a alt="1991 eclipse trip photos" title="1991 eclipse trip photos" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg61.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg61.png" alt="Click to enlarge" title="Click to enlarge" width="697" height="311"/><br/>
</a></p>
<p>I felt proud of how prepared I was—with maps marking to the minute when the eclipse should arrive. But then I realized: there we were, out on a beach with no obvious signs of modern civilization—and nobody had brought any properly set timekeeping device (and in those days my cellphone was just a phone, and didn’t even have signal there).</p>
<p>And so it was that I missed seeing a demonstration of an impressive achievement of science. And instead I got to experience the eclipse pretty much the way people throughout history have experienced eclipses—even if I did know that the Moon would continue gradually eating into the Sun and eventually cover it, and that it wouldn’t make the world end.</p>
<p>There’s always something sobering about astronomical events, and about realizing just how tiny human scales are compared to them. Billions of eclipses have happened over the course of the Earth’s history. Recorded history has covered only a few thousand of them. On average, there’s an eclipse at any given place on Earth roughly every 400 years; in Jackson, WY, where I’m planning to see next week’s eclipse, it turns out the <a href="https://www.wolframalpha.com/input/?i=eclipse+in+july+2744">next total eclipse</a> will be 727 years from now—in 2744.</p>
<p>In earlier times, civilizations built giant monuments to celebrate the motions of the Sun and Moon. Today, for the eclipse next week, what we’re making is a <a href="http://www.precisioneclipse.com" target="_blank" rel="noopener">website</a>. But that website builds on one of the great epics of human intellectual history—stretching back to the earliest times of systematic science, and encompassing contributions from a remarkable cross-section of the most celebrated scientists and mathematicians from past centuries.</p>
<p>It’ll be about 9538 days since the eclipse I saw in 1991. The Moon will have traveled some 500 million miles around the Earth, and the Earth some 15 billion miles around the Sun. But now—in a remarkable triumph of science—we’re computing to the second when they’ll be lined up again.</p>
<h3 id="written-in-anticipation-of-april-8-2024">Written in Anticipation of April 8, 2024</h3>
<p>In the days leading up to August 21, 2017, millions of people accessed our <a href="https://www.precisioneclipse.com/en/" target="_blank">precisioneclipse.com</a> website—with their geoIPs increasingly concentrating near the path of totality. I had traveled to Wyoming and—with a couple of hours to spare—found a place with a clear view across a valley. And this now being 2017, I tweeted:</p>
<p><a alt="2017 eclipse tweet" title="2017 eclipse tweet" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg62.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg62.png" alt="Click to enlarge" title="Click to enlarge" width="488" height="406"/><br/>
</a></p>
<p>But would our carefully done computations actually be accurate? The eclipse was going to make landfall on the Oregon coast, and, conveniently, we had a spotter right there. From where I was, the partial eclipse was well underway. And then I got a text: yes, totality in Oregon had come at the predicted second. It would take the shadow of the Moon a little under 20 minutes to reach me.</p>
<p>Unlike in 1991, I and everyone else had a cellphone with a precise clock—and was able to access our <a href="https://www.precisioneclipse.com/en/" target="_blank">precisioneclipse.com</a> site: </p>
<p><a alt="2017 Precisioneclipse.com info for Jackson, WY" title="2017 Precisioneclipse.com info for Jackson, WY" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg63.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg63.png" alt="Click to enlarge" title="Click to enlarge" width="235" height="388"/><br/>
</a></p>
<p>While I was waiting I was making little images of the crescent Sun with my fingers—repeating something I’d <a href="https://writings.stephenwolfram.com/2016/05/something-i-learned-in-kindergarten/">first noticed more than 50 years earlier</a> when I saw my first partial eclipse at the age of 6:</p>
<p><a alt="2017 eclipse shadows" title="2017 eclipse shadows" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg64.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg64.png" alt="Click to enlarge" title="Click to enlarge" width="529" height="195"/><br/>
</a></p>
<p>A few minutes before the eclipse, I started to see a strange shimmering (invisible on any video I took): shadow bands, a strange and poorly understood eclipse phenomenon. And then, there it came, sweeping across the valley: totality. Arriving right at the predicted second:</p>
<p><a alt="2017 eclipse arrives" title="2017 eclipse arrives" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg65.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg65.png" alt="Click to enlarge" title="Click to enlarge" width="712" height="267"/><br/>
</a></p>
<div>
<p><iframe src="https://player.vimeo.com/video/926415848?h=7213e53fa2" width="620" height="348" frameborder="0" allow="autoplay; fullscreen" allowfullscreen=""></iframe></p>
</div>

<p>I had set up a camera to capture a video of the eclipse, and a little later that day I did an analysis of it—and, since earlier in 2017 I’d started routinely doing livestreams, I livestreamed it: </p>
<p><a alt="2017 eclipse analysis" title="2017 eclipse analysis" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg66.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg66.png" alt="Click to enlarge" title="Click to enlarge" width="453" height="347"/><br/>
</a></p>
<p> At the end, I published my notebook to the Wolfram Cloud, and <a href="https://www.wolframcloud.com/objects/outreach/Eclipse-Analysis">it’s still there</a>:</p>
<p><a alt="Wolfram Cloud eclipse notebook" title="Wolfram Cloud eclipse notebook" href="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg67.png"><img loading="lazy" src="https://content.wolfram.com/sites/43/2024/03/sw032124eclipseHimg67.png" alt="Click to enlarge" title="Click to enlarge" width="540" height="371"/><br/>
</a></p>
<p>And now six years have passed. Much has happened in our human world. But the Moon has just inexorably continued in its orbit. And 2422 days later, it will once again line up to create a total eclipse…</p>
        </div></div>
  </body>
</html>
