<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://pilcrowonpaper.com/blog/dear-oauth-providers/">Original</a>
    <h1>Dear OAuth Providers</h1>
    
    <div id="readability-page-1" class="page"><div id="md" data-astro-cid-s45qjres=""> <p>A short letter to some of the OAuth providers I’ve worked with.</p>
<h2 id="dear-github">Dear GitHub</h2>
<p>Your token endpoint returns a 200 status code even for errors. Error responses must use a 400 or 401 status code. Please fix it.</p>
<h2 id="dear-facebook">Dear Facebook</h2>
<p>Your token endpoint returns a custom error response.</p>
<pre tabindex="0" data-language="json"><code><span><span>{</span></span>
<span><span>	&#34;error&#34;</span><span>: {</span></span>
<span><span>		&#34;message&#34;</span><span>: </span><span>&#34;Error validating access token: Session has expired on Wednesday, 14-Feb-18 18:00:00 PST. The current time is Thursday, 15-Feb-18 13:46:35 PST.&#34;</span><span>,</span></span>
<span><span>		&#34;type&#34;</span><span>: </span><span>&#34;OAuthException&#34;</span><span>,</span></span>
<span><span>		&#34;code&#34;</span><span>: </span><span>190</span><span>,</span></span>
<span><span>		&#34;error_subcode&#34;</span><span>: </span><span>463</span><span>,</span></span>
<span><span>		&#34;fbtrace_id&#34;</span><span>: </span><span>&#34;H2il2t5bn4e&#34;</span></span>
<span><span>	}</span></span>
<span><span>}</span></span>
<span></span></code></pre>
<p>It must be a JSON object with an <code>error</code> field. Please fix it.</p>
<pre tabindex="0" data-language="json"><code><span><span>{</span></span>
<span><span>	&#34;error&#34;</span><span>: </span><span>&#34;invalid_request&#34;</span></span>
<span><span>}</span></span>
<span></span></code></pre>
<h2 id="dear-tiktok">Dear TikTok</h2>
<p>Your server uses the <code>client_key</code> parameter instead of <code>client_id</code>. There’s no reason why you had to deviate from the spec like this. Please fix it.</p>
<h2 id="dear-strava">Dear Strava</h2>
<p>Your server uses a comma-delimitated list for the <code>scope</code> parameter.</p>
<pre tabindex="0" data-language="plaintext"><code><span><span>scope=a,b,c</span></span>
<span><span></span></span></code></pre>
<p>It should be a space-delimitated list. Please fix it.</p>
<pre tabindex="0" data-language="plaintext"><code><span><span>scope=a%20b%20c</span></span>
<span><span></span></span></code></pre>
<h2 id="dear-naver">Dear Naver</h2>
<p>Your server, for whatever fucking reason, returns a string for the token expiration.</p>
<pre tabindex="0" data-language="json"><code><span><span>{</span></span>
<span><span>	&#34;access_token&#34;</span><span>: </span><span>&#34;TOKEN&#34;</span><span>,</span></span>
<span><span>	&#34;expires_in&#34;</span><span>: </span><span>&#34;3600&#34;</span></span>
<span><span>}</span></span>
<span></span></code></pre>
<p>This isn’t about being spec-compliant anymore. I <em>need</em> to know the thought process behind this decision. And also please fix it.</p>
<h2 id="dear-aws-cognito">Dear AWS Cognito</h2>
<p>Despite what’s written in your <a href="https://docs.aws.amazon.com/cognito/latest/developerguide/token-endpoint.html#post-token-positive-exchanging-authorization-code-grant-with-pkce-for-tokens">documentation</a>, HTTP basic auth isn’t supported when PKCE is used. Interestingly, it works fine without PKCE. Please fix it.</p>
<p><em>I’ve also heard that HTTP basic auth doesn’t work with <code>grant_type=refresh_token</code> but I haven’t tested that myself.</em></p>
<h2 id="dear-42-atlassian-box-coinbase-dribble-facebook-kakao-line-linear-linkedin-naver-osu-patreon-shikimori-startgg-strava-tiltify-twitch-vk-workos">Dear 42, Atlassian, Box, Coinbase, Dribble, Facebook, Kakao, Line, Linear, LinkedIn, Naver, osu!, Patreon, Shikimori, Start.gg, Strava, Tiltify, Twitch, VK, WorkOS</h2>
<p>Please support HTTP basic auth for client authentication instead of the just the <code>client_secret</code> parameter:</p>
<blockquote>
<p>The authorization server MUST support the HTTP Basic authentication scheme for authenticating clients that were issued a client password.</p>
</blockquote>
<p><em>Edit: I’ve been informed that HTTP basic auth is just optional in the upcoming OAuth 2.1 standard. However, since PKCE is required even for confidential clients in 2.1 and most of these providers don’t even use PKCE, these providers aren’t compliant to either specs.</em></p> </div></div>
  </body>
</html>
