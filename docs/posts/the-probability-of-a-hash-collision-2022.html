<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://kevingal.com/blog/collisions.html">Original</a>
    <h1>The probability of a hash collision (2022)</h1>
    
    <div id="readability-page-1" class="page">
    <header>
        
    </header>

<h2>The probability of a hash collision</h2>
<h3>2022-01-15</h3>
<h3>Exploring the math behind hash collisions.</h3>
<p>Tags: <a href="https://karthikbalakrishnan.com/blog/tag/probability.html">probability</a> </p>
<a href="https://karthikbalakrishnan.com/blog/twos.html">&lt;&lt; previous</a><a href="https://karthikbalakrishnan.com/blog/wordle.html">next &gt;&gt;</a>
<hr/>
<p>A <a href="https://en.wikipedia.org/wiki/Hash_function">hash function</a> takes arbitrarily complex input - a word, a website, an image, a human being - and maps it to a single number. This is useful for various computer science stuffs, such as data storage and cryptography.</p>
<p>For example, let&#39;s say you want to store a book in one of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span></span></span></span> boxes. If you put the book in a random box, it&#39;s quite likely that you&#39;ll forget which box you picked, especially as <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span></span></span></span> gets bigger. What you can do instead is apply a hash function to the title of the book (probably <em>The Notebook</em>, knowing you), which will spit out a number, <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>i</span></span></span></span>. You then put your book in the <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>i</span></span></span></span>-th box<sup id="fnref:modulo"><a href="#fn:modulo">1</a></sup>. When you want to retrieve <em>The Notebook</em> again, you recompute the hash function and it tells you to look in the <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>i</span></span></span></span>-th box, without you needing to remember where you stored anything! You won&#39;t lose a book from your Nicholas Sparks collection ever again.</p>
<p>We won&#39;t get into the specifics of what a hash function looks like. This post is instead concerned with <a href="https://en.wikipedia.org/wiki/Hash_collision">hash collisions</a>, which happen when your hash function assigns the same value to two different items. This might be a Bad Thing. Our hash function wouldn&#39;t be very useful, for instance, if it told us to put all our books in the 1st box, because we&#39;d have to spend a lot of time rooting around in that box to find a specific book<sup id="fnref:unique"><a href="#fn:unique">2</a></sup>. For this reason, a good hash function should have evenly distributed outputs. But even then, it&#39;s only a matter of time before a hash collision occurs as we add more and more books to our collection. By the time we reach <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">N+1</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span><span></span><span>+</span><span></span></span><span><span></span><span>1</span></span></span></span> books, there won&#39;t enough boxes to store the books individually and there will definitely be at least 1 hash collision.</p>
<p>Given <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span></span></span></span> boxes and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> books, how do you figure out the <em>probability</em> of a hash collision? Hash collisions can be a Bad Thing, but rather than trying to eliminate them entirely (an impossible task), you might instead buy enough boxes that the probability of a hash collision is relatively low.</p>
<p>Jeff Preshing wrote a <a href="https://preshing.com/20110504/hash-collision-probabilities/">neat article</a> on how to calculate hash collision probabilities, but there are some gaps in his explanation. This is my attempt to fill those gaps. To follow along you&#39;ll need a basic understanding of probability and an iron will.</p>
<h3 id="the-birthday-problem">The Birthday Problem</h3>
<p>Consider the following problem statements.</p>
<ol>
<li>
<p>When you compute the hash values of 500 different book titles from your magnificent book collection, and put each book into the corresponding box in a row of 100,000 boxes (yes, it&#39;s a lot of boxes), what&#39;s the probability that at least 2 books will be in the same box? (~71.3%).</p>
</li>
<li>
<p>When you put 50 balls into 100 buckets at random, what&#39;s the probability that at least 2 balls will end up in the same bucket? (~99.99997%).</p>
</li>
<li>
<p>When there are 30 people in a room, what&#39;s the probability that at least 2 of them will share a birthday? (~70.6%).</p>
</li>
</ol>
<p>These are all versions of the notorious <a href="http://en.wikipedia.org/wiki/Birthday_problem">birthday problem</a>. It&#39;s notorious because it&#39;s not immediately intuitive why the probabilities are so high. The key is that even though there are only 50 balls in problem #2, there are 1225 <em>pairs</em> of balls, and only one of those pairs needs to be in the same bucket. Problems #1 and #3 have the exact same structure. In problem #1, you can think of the books as balls and the boxes as buckets, and in problem #3, the people are balls and the days of the year are buckets.</p>
<p>The problem of calculating hash collision probabilities IS the birthday problem. Let&#39;s look at how to solve the birthday problem.</p>
<h3 id="exact-calculation-of-birthday-probability">Exact calculation of birthday probability</h3>
<p>To calculate the exact probability of two or more people sharing a birthday in a room of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> people, it&#39;s easiest to first figure out the probability of <em>none of them</em> sharing a birthday. In this case, <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>365</mn></mrow><annotation encoding="application/x-tex">N=365</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span><span></span><span>=</span><span></span></span><span><span></span><span>365</span></span></span></span>, since instead of boxes there are 365 possible birthdays.</p>
<p>The first person to enter the room has probability</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mi>N</mi><mi>N</mi></mfrac><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">
\frac{N}{N} = 1
</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>N</span></span></span><span><span></span><span></span></span><span><span></span><span><span>N</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>1</span></span></span></span></span></p>
<p>of not sharing a birthday with anyone, because duh, there&#39;s nobody else in the room!</p>
<p>The probability that the first and second person to enter the room don&#39;t share a birthday is</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mi>N</mi><mi>N</mi></mfrac><mo>×</mo><mfrac><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><mi>N</mi></mfrac><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">
\frac{N}{N} \times \frac{N-1}{N},
</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>N</span></span></span><span><span></span><span></span></span><span><span></span><span><span>N</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>×</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>N</span></span></span><span><span></span><span></span></span><span><span></span><span><span>N</span><span></span><span>−</span><span></span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>,</span></span></span></span></span></p>
<p>because there are <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">N-1</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span><span></span><span>−</span><span></span></span><span><span></span><span>1</span></span></span></span> out of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span></span></span></span> days free for the second person.</p>
<p>The probability that the first, second and third person don&#39;t share a birthday is</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mi>N</mi><mi>N</mi></mfrac><mo>×</mo><mfrac><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><mi>N</mi></mfrac><mo>×</mo><mfrac><mrow><mi>N</mi><mo>−</mo><mn>2</mn></mrow><mi>N</mi></mfrac><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">
\frac{N}{N} \times \frac{N-1}{N} \times \frac{N-2}{N},
</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>N</span></span></span><span><span></span><span></span></span><span><span></span><span><span>N</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>×</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>N</span></span></span><span><span></span><span></span></span><span><span></span><span><span>N</span><span></span><span>−</span><span></span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>×</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>N</span></span></span><span><span></span><span></span></span><span><span></span><span><span>N</span><span></span><span>−</span><span></span><span>2</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>,</span></span></span></span></span></p>
<p>This continues until everyone is in the room and we get that the probability of no shared birthday is</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mi>N</mi><mi>N</mi></mfrac><mo>×</mo><mfrac><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><mi>N</mi></mfrac><mo>×</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>×</mo><mfrac><mrow><mi>N</mi><mo>−</mo><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mi>N</mi></mfrac><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
\frac{N}{N} \times \frac{N-1}{N} \times ... \times \frac{N-(k-1)}{N}.
</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>N</span></span></span><span><span></span><span></span></span><span><span></span><span><span>N</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>×</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>N</span></span></span><span><span></span><span></span></span><span><span></span><span><span>N</span><span></span><span>−</span><span></span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>×</span><span></span></span><span><span></span><span>...</span><span></span><span>×</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>N</span></span></span><span><span></span><span></span></span><span><span></span><span><span>N</span><span></span><span>−</span><span></span><span>(</span><span>k</span><span></span><span>−</span><span></span><span>1</span><span>)</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>.</span></span></span></span></span></p>
<p>The probability of at least 1 shared birthday, i.e. of a hash collision, is then the complement of there being no shared birthdays:</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mn>1</mn><mo>−</mo><mfrac><mi>N</mi><mi>N</mi></mfrac><mo>×</mo><mfrac><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><mi>N</mi></mfrac><mo>×</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>×</mo><mfrac><mrow><mi>N</mi><mo>−</mo><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mi>N</mi></mfrac><mi mathvariant="normal">.</mi></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(1)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
1 - \frac{N}{N} \times \frac{N-1}{N} \times ... \times \frac{N-(k-1)}{N}.\tag{1}
</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>N</span></span></span><span><span></span><span></span></span><span><span></span><span><span>N</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>×</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>N</span></span></span><span><span></span><span></span></span><span><span></span><span><span>N</span><span></span><span>−</span><span></span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>×</span><span></span></span><span><span></span><span>...</span><span></span><span>×</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>N</span></span></span><span><span></span><span></span></span><span><span></span><span><span>N</span><span></span><span>−</span><span></span><span>(</span><span>k</span><span></span><span>−</span><span></span><span>1</span><span>)</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>.</span></span><span><span></span><span><span>(</span><span><span>1</span></span><span>)</span></span></span></span></span></span></p>
<p>And... that&#39;s it. That&#39;s the EXACT probability of a hash collision for <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> items and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span></span></span></span> possible hash function outputs! All right, pack your bags and go home. Nothing more to see here.</p>
<p>But actually, this formula gets clunky as <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> get big. Imagine you have 1 billion books. Do you really want to multiply 1 billion numbers together? I bet not. Even a computer will take a long time to multiply 1 billion numbers. For this reason, approximations of the formula are often used, as we will see next.</p>
<h3 id="e-asy-approximation">e-asy approximation</h3>
<p>A first approximation of the hash collision probability can be derived by rewriting equation (1) so that the terms in the product are written as complements:</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>1</mn><mo>−</mo><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><mn>0</mn><mo fence="true">)</mo></mrow><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mo fence="true">)</mo></mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><mfrac><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><mi>N</mi></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">
1 - \left(1 - 0\right)\left(1 - \frac{1}{N}\right)...\left(1-\frac{k-1}{N}\right)
</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span><span>(</span><span>1</span><span></span><span>−</span><span></span><span>0</span><span>)</span></span><span></span><span><span><span>(</span></span><span>1</span><span></span><span>−</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>N</span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>)</span></span></span><span></span><span>...</span><span></span><span><span><span>(</span></span><span>1</span><span></span><span>−</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>N</span></span></span><span><span></span><span></span></span><span><span></span><span><span>k</span><span></span><span>−</span><span></span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>)</span></span></span></span></span></span></span></p>
<p>Now, here comes a trick. It&#39;s a fact that <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>x</mi><mo>≈</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup></mrow><annotation encoding="application/x-tex">1-x \approx e^{-x}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span>x</span><span></span><span>≈</span><span></span></span><span><span></span><span><span>e</span><span><span><span><span><span><span></span><span><span><span>−</span><span>x</span></span></span></span></span></span></span></span></span></span></span></span> as <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span></span></span></span> gets small (see Appendix A for a proof, which was omitted from Preshing&#39;s article). You might notice that we rewrote the terms in the product to match the form <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">1-x</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span>x</span></span></span></span>, where <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>i</mi><mi mathvariant="normal">/</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">x=i/N</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span><span></span><span>=</span><span></span></span><span><span></span><span>i</span><span>/</span><span>N</span></span></span></span> for varying <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>i</span></span></span></span>. Since <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span></span></span></span> is presumably much larger than <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>i</span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span></span></span></span> is therefore small, we can use our cute little approximation to get</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>1</mn><mo>−</mo><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><mn>0</mn><mo fence="true">)</mo></mrow><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mo fence="true">)</mo></mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><mfrac><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><mi>N</mi></mfrac><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mn>0</mn></msup><mo>×</mo><msup><mi>e</mi><mrow><mo>−</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>N</mi></mrow></msup><mo>×</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>×</mo><msup><mi>e</mi><mrow><mo>−</mo><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>N</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><mfrac><mrow><mn>1</mn><mo>+</mo><mn>2</mn><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mi>N</mi></mfrac></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><mfrac><mrow><mi>k</mi><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mrow><mn>2</mn><mi>N</mi></mrow></mfrac></mrow></msup><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable></mtd><mtd width="50%"></mtd><mtd><mtext>(2)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
&amp;1 - \left(1 - 0\right)\left(1 - \frac{1}{N}\right)...\left(1-\frac{k-1}{N}\right) \\
&amp;=1-e^0 \times e^{-1/N}\times ... \times e^{-(k-1)/N} \\
&amp;= 1 - e^{-\frac{1+2+...+(k-1)}{N}} \\
&amp;= 1 - e^{-\frac{k(k-1)}{2N}}. \tag{2}
\end{aligned}
</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span><span><span></span><span></span></span><span><span></span><span></span></span><span><span></span><span></span></span><span><span></span><span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span><span><span><span><span><span></span><span><span></span><span>1</span><span></span><span>−</span><span></span><span><span>(</span><span>1</span><span></span><span>−</span><span></span><span>0</span><span>)</span></span><span></span><span><span><span>(</span></span><span>1</span><span></span><span>−</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>N</span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>)</span></span></span><span></span><span>...</span><span></span><span><span><span>(</span></span><span>1</span><span></span><span>−</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>N</span></span></span><span><span></span><span></span></span><span><span></span><span><span>k</span><span></span><span>−</span><span></span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>)</span></span></span></span></span><span><span></span><span><span></span><span></span><span>=</span><span></span><span>1</span><span></span><span>−</span><span></span><span><span>e</span><span><span><span><span><span><span></span><span><span>0</span></span></span></span></span></span></span></span><span></span><span>×</span><span></span><span><span>e</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1/</span><span>N</span></span></span></span></span></span></span></span></span><span></span><span>×</span><span></span><span>...</span><span></span><span>×</span><span></span><span><span>e</span><span><span><span><span><span><span></span><span><span><span>−</span><span>(</span><span>k</span><span>−</span><span>1</span><span>)</span><span>/</span><span>N</span></span></span></span></span></span></span></span></span></span></span><span><span></span><span><span></span><span></span><span>=</span><span></span><span>1</span><span></span><span>−</span><span></span><span><span>e</span><span><span><span><span><span><span></span><span><span><span>−</span><span><span></span><span><span><span><span><span><span></span><span><span><span>N</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span><span>+</span><span>2</span><span>+</span><span>...</span><span>+</span><span>(</span><span>k</span><span>−</span><span>1</span><span>)</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span></span></span></span></span></span></span><span><span></span><span><span></span><span></span><span>=</span><span></span><span>1</span><span></span><span>−</span><span></span><span><span>e</span><span><span><span><span><span><span></span><span><span><span>−</span><span><span></span><span><span><span><span><span><span></span><span><span><span>2</span><span>N</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>k</span><span>(</span><span>k</span><span>−</span><span>1</span><span>)</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span></span></span></span></span><span>.</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span><span><span></span><span><span>(</span><span><span>2</span></span><span>)</span></span></span></span></span></span></p>
<p>The last equality comes from the fact that <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>+</mo><mn>2</mn><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><mi>n</mi><mo>=</mo><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">1+2+...+n=n(n+1)/2</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>1</span><span></span><span>+</span><span></span></span><span><span></span><span>2</span><span></span><span>+</span><span></span></span><span><span></span><span>...</span><span></span><span>+</span><span></span></span><span><span></span><span>n</span><span></span><span>=</span><span></span></span><span><span></span><span>n</span><span>(</span><span>n</span><span></span><span>+</span><span></span></span><span><span></span><span>1</span><span>)</span><span>/2</span></span></span></span>.</p>
<p>This approximation reduces the complexity of computing the probability, from <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(k)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>O</span><span>(</span><span>k</span><span>)</span></span></span></span> to <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(1)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>O</span><span>(</span><span>1</span><span>)</span></span></span></span>. Or, phrased in non-computer-science terms: instead of doing around <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> math operations, we only have to do a small fixed number of them! What&#39;s more, the approximation becomes more and more accurate as we increase <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span></span></span></span>.</p>
<h3 id="approximations-all-the-way-down">Approximations all the way down</h3>
<p>It&#39;s possible to simplify this equation even further, using the exact same trick as before! Note that the final line of equation (2) is in the form <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>y</mi></mrow></msup></mrow><annotation encoding="application/x-tex">1-e^{-y}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span><span>e</span><span><span><span><span><span><span></span><span><span><span>−</span><span>y</span></span></span></span></span></span></span></span></span></span></span></span>, where <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mfrac><mrow><mi>k</mi><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mrow><mn>2</mn><mi>N</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">y=\frac{k(k-1)}{2N}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>y</span><span></span><span>=</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>2</span><span>N</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>k</span><span>(</span><span>k</span><span>−</span><span>1</span><span>)</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span>. We&#39;ve already seen that <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>y</mi></mrow></msup><mo>≈</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">1-e^{-y} \approx y</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span><span>e</span><span><span><span><span><span><span></span><span><span><span>−</span><span>y</span></span></span></span></span></span></span></span></span><span></span><span>≈</span><span></span></span><span><span></span><span>y</span></span></span></span> when <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>y</span></span></span></span> is small, and so the hash collision probability can be further approximated by:</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mfrac><mrow><mi>k</mi><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mrow><mn>2</mn><mi>N</mi></mrow></mfrac><mi mathvariant="normal">.</mi></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(3)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\frac{k(k-1)}{2N}. \tag{3}
</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>2</span><span>N</span></span></span><span><span></span><span></span></span><span><span></span><span><span>k</span><span>(</span><span>k</span><span></span><span>−</span><span></span><span>1</span><span>)</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>.</span></span><span><span></span><span><span>(</span><span><span>3</span></span><span>)</span></span></span></span></span></span></p>
<p>...which is funny, because <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>k</mi><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{k(k-1)}{2}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>2</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>k</span><span>(</span><span>k</span><span>−</span><span>1</span><span>)</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span> is the number of pairs of items, which I brought up earlier to provide an intuition for the birthday problem!</p>
<p>The final approximation suggested by Preshing is that <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k(k-1)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span><span>(</span><span>k</span><span></span><span>−</span><span></span></span><span><span></span><span>1</span><span>)</span></span></span></span> starts to look an awful lot like <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>k</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">k^2</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>k</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span></span></span></span></span></span></span></span> as <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> gets bigger (see Appendix A), so the formula can be written simply as</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mfrac><msup><mi>k</mi><mn>2</mn></msup><mrow><mn>2</mn><mi>N</mi></mrow></mfrac><mi mathvariant="normal">.</mi></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(4)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
\frac{k^2}{2N}. \tag{4}
</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>2</span><span>N</span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>k</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>.</span></span><span><span></span><span><span>(</span><span><span>4</span></span><span>)</span></span></span></span></span></span></p>
<p>And there you have it. 4 different methods of calculating the hash collision probability, with varying levels of accuracy.</p>
<h3 id="comparisons">Comparisons</h3>
<p>How do the approximations fare? Here&#39;s a plot of their relative error compared to the exact birthday calculation, for <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>10000</mn></mrow><annotation encoding="application/x-tex">N=10000</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span><span></span><span>=</span><span></span></span><span><span></span><span>10000</span></span></span></span>.</p>
<figure>
<img src="https://karthikbalakrishnan.com/static/img/collisions/error.png" alt="Relative error of the approximations. k goes from 2 to 10000 (ish)."/>
<figcaption>Relative errors of the three approximation methods: the exponential approximation (exp), the simplified version (simple), and the even more simplified version (simple-square).</figcaption>
</figure>

<p>The relative error between two quantities <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>y</span></span></span></span> is <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>r</mi><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mo stretchy="false">∣</mo><mi>x</mi><mo>−</mo><mi>y</mi><mo stretchy="false">∣</mo></mrow><mi>x</mi></mfrac></mrow><annotation encoding="application/x-tex">err(x,y)=\frac{\lvert x - y \rvert}{x}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>err</span><span>(</span><span>x</span><span>,</span><span></span><span>y</span><span>)</span><span></span><span>=</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>x</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>∣</span><span>x</span><span>−</span><span>y</span><span>∣</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span>, and the smaller it is, the better. If <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>r</mi><mi>r</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">err(x,y)&lt;1</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>err</span><span>(</span><span>x</span><span>,</span><span></span><span>y</span><span>)</span><span></span><span>&lt;</span><span></span></span><span><span></span><span>1</span></span></span></span>, the approximation is within an order of magnitude of the true value. We see that the exponential approximation gradually gets better as <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span></span></span></span> gets smaller. But also, once <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&gt;</mo><mn>300</mn></mrow><annotation encoding="application/x-tex">k&gt;300</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>&gt;</span><span></span></span><span><span></span><span>300</span></span></span></span> or thereabouts, the relative error drops like a stone. The simpler approximations are kinda reasonable for <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&lt;</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">k&lt;100</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>&lt;</span><span></span></span><span><span></span><span>100</span></span></span></span>, but after that point they go bonkers.</p>
<p>HERE&#39;S A SAMPLE DATAPOINT. At <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">k=10</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>=</span><span></span></span><span><span></span><span>10</span></span></span></span>, the real collision probability is about <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.0044913</mn></mrow><annotation encoding="application/x-tex">0.0044913</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>0.0044913</span></span></span></span>. The exponential approximation is about <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.0044899</mn></mrow><annotation encoding="application/x-tex">0.0044899</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>0.0044899</span></span></span></span>, and if you squint a little, you could mistake them for the same answer. The simplified approximation is about <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.0045</mn></mrow><annotation encoding="application/x-tex">0.0045</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>0.0045</span></span></span></span>, which is, you know, still quite good. And the simplest approximation is <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.005</mn></mrow><annotation encoding="application/x-tex">0.005</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>0.005</span></span></span></span>, which is less quite good. </p>
<p>I was going to dig into the error behaviour of the approximations, but I think I&#39;ll get a sandwich instead. Something something exercise for the reader.</p>
<h3 id="conclusions">Conclusions</h3>
<p>We have seen how to calculate the probability of a hash collision, as well as 3 different ways to approximate this probability. The exponential approximation appears to be robust. The other two are convenient for back of the envelope calculations, but may lose their nerve as you add more books to your collection. Finally, if you want to play around with the birthday problem parameters, I&#39;ve posted a <a href="https://karthikbalakrishnan.com/apps/collision.html">hash collision calculator</a> on the site.</p>
<h3 id="appendix-a-supporting-proofs-for-approximations">Appendix A: Supporting proofs for approximations</h3>
<p>How do we prove that the approximations we&#39;ve used are &#34;good&#34; in some sense? Or more specifically, that:</p>
<ol>
<li><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>∼</mo><msup><mi>k</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">k(k-1) \sim k^2</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span><span>(</span><span>k</span><span></span><span>−</span><span></span></span><span><span></span><span>1</span><span>)</span><span></span><span>∼</span><span></span></span><span><span></span><span><span>k</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span></span></span></span></span></span></span></span> as <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">k \to \infty</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>k</span><span></span><span>→</span><span></span></span><span><span></span><span>∞</span></span></span></span>.</li>
<li><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>x</mi><mo>∼</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup></mrow><annotation encoding="application/x-tex">1-x \sim e^{-x}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span>x</span><span></span><span>∼</span><span></span></span><span><span></span><span><span>e</span><span><span><span><span><span><span></span><span><span><span>−</span><span>x</span></span></span></span></span></span></span></span></span></span></span></span> as <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x \to 0</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span><span></span><span>→</span><span></span></span><span><span></span><span>0</span></span></span></span>.</li>
</ol>
<p>This might seem obvious (in the case of #2, just set x=0 and they&#39;re the same!), but I was wondering how you would go about it with slightly more rigour.</p>
<p>One approach is based on ratios. Use <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>f</span><span>(</span><span>x</span><span>)</span></span></span></span> to denote the function being approximated, and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g(x)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>g</span><span>(</span><span>x</span><span>)</span></span></span></span> to denote the approximation, and show that <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>lim</mi><mo>⁡</mo></mrow><mrow><mi>x</mi><mo>→</mo><mi>a</mi></mrow></msub><mfrac><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lim_{x \to a} \frac{f(x)}{g(x)}=1</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>lim</span><span><span><span><span><span><span></span><span><span><span>x</span><span>→</span><span>a</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>g</span><span>(</span><span>x</span><span>)</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>f</span><span>(</span><span>x</span><span>)</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>1</span></span></span></span>. Since <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>u</mi><mi>v</mi></mfrac><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\frac{u}{v}=1</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>v</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>u</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>1</span></span></span></span> implies <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>=</mo><mi>v</mi></mrow><annotation encoding="application/x-tex">u=v</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>u</span><span></span><span>=</span><span></span></span><span><span></span><span>v</span></span></span></span>, this means that <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>f</span><span>(</span><span>x</span><span>)</span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g(x)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>g</span><span>(</span><span>x</span><span>)</span></span></span></span> converge in some sense.</p>
<p>I&#39;ve had a shot at the proofs, below. I&#39;m not a mathematician, so don&#39;t take them seriously, although the sages of r/learnmath did <a href="https://www.reddit.com/r/learnmath/comments/s3cf8s/analysis_proving_that_these_are_good/">review them for me</a>.</p>
<p>For #1, the proof is:</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><msup><mi>k</mi><mn>2</mn></msup><mrow><mi>k</mi><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mfrac><msup><mi>k</mi><mn>2</mn></msup><mrow><msup><mi>k</mi><mn>2</mn></msup><mo>−</mo><mi>k</mi></mrow></mfrac><mo>=</mo><mfrac><msup><mi>k</mi><mn>2</mn></msup><msup><mi>k</mi><mn>2</mn></msup></mfrac><mo>×</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>k</mi></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>k</mi></mrow></mfrac><mo><mo><munder><mo><mo>=</mo></mo><mrow><mi>k</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow></munder></mo></mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>−</mo><mn>0</mn></mrow></mfrac><mo>=</mo><mn>1.</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\frac{k^2}{k(k-1)} = \frac{k^2}{k^2-k} = \frac{k^2}{k^2} \times \frac{1}{1-1/k} = \frac{1}{1-1/k} \mathrel{\underset{k \to \infty}{=}} \frac{1}{1-0} = 1.
\end{aligned}
</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span><span><span></span><span><span><span></span><span><span><span><span><span><span></span><span><span>k</span><span>(</span><span>k</span><span></span><span>−</span><span></span><span>1</span><span>)</span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>k</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>k</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span></span></span></span></span><span></span><span>−</span><span></span><span>k</span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>k</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>k</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span></span></span></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>k</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>×</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>1</span><span></span><span>−</span><span></span><span>1/</span><span>k</span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>1</span><span></span><span>−</span><span></span><span>1/</span><span>k</span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span><span><span><span><span><span><span><span></span><span><span><span>k</span><span>→</span><span>∞</span></span></span></span><span><span></span><span><span>=</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>1</span><span></span><span>−</span><span></span><span>0</span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span><span>1.</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>For #2, we use the Taylor series expansion of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup></mrow><annotation encoding="application/x-tex">e^{-x}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>e</span><span><span><span><span><span><span></span><span><span><span>−</span><span>x</span></span></span></span></span></span></span></span></span></span></span></span>,</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mi>x</mi><mrow><mn>1</mn><mo stretchy="false">!</mo></mrow></mfrac><mo>+</mo><mfrac><msup><mi>x</mi><mn>2</mn></msup><mrow><mn>2</mn><mo stretchy="false">!</mo></mrow></mfrac><mo>−</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
e^{-x} = 1 - \frac{x}{1!} + \frac{x^2}{2!} - ...
</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>e</span><span><span><span><span><span><span></span><span><span><span>−</span><span>x</span></span></span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>1</span><span>!</span></span></span><span><span></span><span></span></span><span><span></span><span><span>x</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>+</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>2</span><span>!</span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>x</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>−</span><span></span></span><span><span></span><span>...</span></span></span></span></span></p>
<p>Applying this expansion to the ratio, we get</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mfrac><mrow><mn>1</mn><mo>−</mo><mi>x</mi></mrow><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mn>1</mn><mo>−</mo><mi>x</mi></mrow><mrow><mn>1</mn><mo>−</mo><mfrac><mi>x</mi><mrow><mn>1</mn><mo stretchy="false">!</mo></mrow></mfrac><mo>+</mo><mfrac><msup><mi>x</mi><mn>2</mn></msup><mrow><mn>2</mn><mo stretchy="false">!</mo></mrow></mfrac><mo>−</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mfrac><mo><mo><munder><mo><mo>=</mo></mo><mrow><mi>x</mi><mo>→</mo><mn>0</mn></mrow></munder></mo></mo><mfrac><mrow><mn>1</mn><mo>−</mo><mn>0</mn></mrow><mrow><mn>1</mn><mo>−</mo><mn>0</mn><mo>+</mo><mn>0</mn><mo>−</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mfrac><mo>=</mo><mn>1.</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\frac{1-x}{e^{-x}} &amp;= \frac{1-x}{1-\frac{x}{1!}+\frac{x^2}{2!} - ...} \mathrel{\underset{x \to 0}{=}} \frac{1 - 0}{1 - 0 + 0 - ...} = 1.
\end{aligned}
</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span><span><span></span><span><span><span></span><span><span><span><span><span><span></span><span><span><span>e</span><span><span><span><span><span><span></span><span><span><span>−</span><span>x</span></span></span></span></span></span></span></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span><span></span><span>−</span><span></span><span>x</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span><span><span><span><span><span></span><span><span></span><span></span><span>=</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>1</span><span></span><span>−</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>1</span><span>!</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>x</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>+</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>2</span><span>!</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span><span>x</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>−</span><span></span><span>...</span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span><span></span><span>−</span><span></span><span>x</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span><span><span><span><span><span><span><span></span><span><span><span>x</span><span>→</span><span>0</span></span></span></span><span><span></span><span><span>=</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>1</span><span></span><span>−</span><span></span><span>0</span><span></span><span>+</span><span></span><span>0</span><span></span><span>−</span><span></span><span>...</span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span><span></span><span>−</span><span></span><span>0</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span><span>1.</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span></span></span></p>

<hr/>
<a href="https://karthikbalakrishnan.com/blog/twos.html">&lt;&lt; previous</a><a href="https://karthikbalakrishnan.com/blog/wordle.html">next &gt;&gt;</a>
<ul>
<li><a href="https://karthikbalakrishnan.com/blog.html">Back to blog</a></li>
<li><a href="https://karthikbalakrishnan.com/feed.xml">RSS feed</a></li>
</ul>
<p>I&#39;d be happy to hear from you at <i>galligankevinp@gmail.com</i>.</p>


</div>
  </body>
</html>
