<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/peer-calls/peer-calls">Original</a>
    <h1>Peer Calls: WebRTC peer to peer calls for everyone</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/peer-calls/peer-calls/workflows/Peer%20Calls%20CI/badge.svg"><img src="https://github.com/peer-calls/peer-calls/workflows/Peer%20Calls%20CI/badge.svg" alt="Peer Calls CI"/></a>
<a href="https://goreportcard.com/report/github.com/peer-calls/peer-calls" rel="nofollow"><img src="https://camo.githubusercontent.com/da9c9c0b746385f2020b3c1ee4e9ca79abcde95495bb88addb5a5419fdf124e3/68747470733a2f2f676f7265706f7274636172642e636f6d2f62616467652f6769746875622e636f6d2f706565722d63616c6c732f706565722d63616c6c73" alt="Go Report Card" data-canonical-src="https://goreportcard.com/badge/github.com/peer-calls/peer-calls"/></a></p>
<p dir="auto">WebRTC peer to peer calls for everyone. See it live in action at
<a href="https://peercalls.com" rel="nofollow">peercalls.com</a>.</p>
<p dir="auto">The server has been completely rewriten in Go and all the original
functionality works. An optional implementation of a Selective Forwarding Unit
(SFU) is available to make Peer Calls consume less bandwith for user video
uploads. This wouldn&#39;t haven been possible without the awesome
<a href="https://github.com/pion/webrtc">pion/webrtc</a> library.</p>
<p dir="auto">The config file format is still YAML, but is different than what was in v3. The
v3 source code is available in <code>version-3</code> branch.  Version 4 will no longer be
published on NPM since the server is no longer written in NodeJS.</p>

<ul>
<li> Core rewritten in Golang.</li>
<li> Selective Forwarding Unit. Can be enabled using <code>NETWORK_TYPE=sfu</code> environment variable. The <a href="https://peercalls.com" rel="nofollow">peercalls.com</a> instance has this enabled.</li>
<li> Ability to change video and audio devices without reconnecting.</li>
<li> Improved toolbar layout. Can be toggled by clicking or tapping.</li>
<li> Multiple videos are now shown in a full-size grid and each can be minimized.</li>
<li> Video cropping can be turned off.</li>
<li> Improved file sending. Users are now able to send files larger than 64 or 256 KB (depends on the browser).</li>
<li> Device names are correctly populated in the dropdown list.</li>
<li> Improved desktop sharing.</li>
<li> Copy invite link to clipboard. Will show as share icon on devices that support it.</li>
<li> Fix: Toolbar icons render correctly on iOS 12 devices.</li>
<li> Fix: Video autoplays.</li>
<li> Fix: Toolbar is no longer visible until call is joined</li>
<li> Fix: Add warning when using an unsupported browser</li>
<li> Fix: Add warning when JavaScript is disabled</li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">TODO for Selective Forwarding Unit</h2><a id="user-content-todo-for-selective-forwarding-unit" aria-label="Permalink: TODO for Selective Forwarding Unit" href="#todo-for-selective-forwarding-unit"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul>
<li> Support dynamic adding and removing of streams</li>
<li> Support RTCP packet Picture Loss Indicator (PLI)</li>
<li> Support RTCP packet Receiver Estimated Maximum Bitrate (REMB)</li>
<li> Add handling of other RTCP packets besides NACK, PLI and REMB</li>
<li> Add JitterBuffer (experimental, currently without congestion control)</li>
<li> Support multiple Peer Calls nodes when using SFU</li>
<li> Add support for passive ICE TCP candidates</li>
<li> End-to-End Encryption (E2EE) using Insertable Streams. See <a href="https://github.com/peer-calls/peer-calls/pull/142" data-hovercard-type="pull_request" data-hovercard-url="/peer-calls/peer-calls/pull/142/hovercard">#142</a>.</li>
</ul>

<ul dir="auto">
<li><a href="https://nodejs.org" rel="nofollow">Node.js 18.13</a></li>
<li><a href="https://golang.org/" rel="nofollow">Go 1.19.5</a></li>
</ul>
<p dir="auto">Alternatively, Docker  can be used to run Peer Calls.</p>


<ul dir="auto">
<li><a href="https://golang.org/" rel="nofollow">Golang</a></li>
<li><a href="https://github.com/pion/webrtc">pion/webrtc</a></li>
<li>github.com/go-chi/chi</li>
<li>nhooyr.io/websocket</li>
</ul>
<p dir="auto">See <a href="https://github.com/peer-calls/peer-calls/blob/master/go.mod">go.mod</a> for more information</p>

<ul dir="auto">
<li>React</li>
<li>Redux</li>
<li>TypeScript (since peer-calls <code>v2.1.0</code>)</li>
</ul>
<p dir="auto">See <a href="https://github.com/peer-calls/peer-calls/blob/master/package.json">package.json</a> for more information.</p>


<p dir="auto">Head to <a href="https://github.com/peer-calls/peer-calls/releases">Releases</a> and
download a precompiled version. Currently the binaries for the following
systems are built automatically:</p>
<ul dir="auto">
<li>linux amd64</li>
<li>linux arm</li>
<li>darwin (macOS) amd64</li>
<li>windows amd64</li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">Deploying onto Kubernetes</h2><a id="user-content-deploying-onto-kubernetes" aria-label="Permalink: Deploying onto Kubernetes" href="#deploying-onto-kubernetes"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The root of this repository contains a <code>kustomization.yaml</code>, allowing anyone to
patch the manifests found within the <code>deploy/</code> directory. To deploy the manifests
without applying any patches, pass the URL to <code>kubectl</code>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="kubectl apply -k github.com/peer-calls/peer-calls"><pre>kubectl apply -k github.com/peer-calls/peer-calls</pre></div>

<p dir="auto">The automated builds on Docker Hub now require a subscription, and approval is
required even for open source projects. We recently switched to using GitHub
Container Registry instead:</p>
<p dir="auto">Use the <a href="https://ghcr.io/peer-calls/peer-calls" rel="nofollow"><code>ghcr.io/peer-calls/peer-calls</code></a> image:</p>
<div dir="auto" data-snippet-clipboard-copy-content="docker run --rm -it -p 3000:3000 ghcr.io/peer-calls/peer-calls:latest"><pre>docker run --rm -it -p 3000:3000 ghcr.io/peer-calls/peer-calls:latest</pre></div>

<div dir="auto" data-snippet-clipboard-copy-content="git clone https://github.com/peer-calls/peer-calls.git
cd peer-calls
npm install

# for production
npm run build
npm run build:go:linux

# for development
npm run start"><pre>git clone https://github.com/peer-calls/peer-calls.git
<span>cd</span> peer-calls
npm install

<span><span>#</span> for production</span>
npm run build
npm run build:go:linux

<span><span>#</span> for development</span>
npm run start</pre></div>

<div dir="auto" data-snippet-clipboard-copy-content="git clone https://github.com/peer-calls/peer-calls
cd peer-calls
docker build -t peer-calls .
docker run --rm -it -p 3000:3000 peer-calls"><pre>git clone https://github.com/peer-calls/peer-calls
<span>cd</span> peer-calls
docker build -t peer-calls <span>.</span>
docker run --rm -it -p 3000:3000 peer-calls</pre></div>


<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Variable</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>PEERCALLS_LOG</code></td>
<td>csv</td>
<td>Enables or disables logging for certain modules</td>
<td><code>-sdp,-ws,-nack,-rtp,-rtcp,-pion:*:trace,-pion:*:debug,-pion:*:info,*</code></td>
</tr>
<tr>
<td><code>PEERCALLS_FS</code></td>
<td>string</td>
<td>When set to a non-empty value, use the path to find resource files</td>
<td></td>
</tr>
<tr>
<td><code>PEERCALLS_BASE_URL</code></td>
<td>string</td>
<td>Base URL of the application</td>
<td></td>
</tr>
<tr>
<td><code>PEERCALLS_BIND_HOST</code></td>
<td>string</td>
<td>IP to listen to</td>
<td><code>0.0.0.0</code></td>
</tr>
<tr>
<td><code>PEERCALLS_BIND_PORT</code></td>
<td>int</td>
<td>Port to listen to</td>
<td><code>3000</code></td>
</tr>
<tr>
<td><code>PEERCALLS_TLS_CERT</code></td>
<td>string</td>
<td>Path to TLS PEM certificate. If set will enable TLS</td>
<td></td>
</tr>
<tr>
<td><code>PEERCALLS_TLS_KEY</code></td>
<td>string</td>
<td>Path to TLS PEM cert key. If set will enable TLS</td>
<td></td>
</tr>
<tr>
<td><code>PEERCALLS_STORE_TYPE</code></td>
<td>string</td>
<td>Can be <code>memory</code> or <code>redis</code></td>
<td><code>memory</code></td>
</tr>
<tr>
<td><code>PEERCALLS_STORE_REDIS_HOST</code></td>
<td>string</td>
<td>Hostname of Redis server</td>
<td></td>
</tr>
<tr>
<td><code>PEERCALLS_STORE_REDIS_PORT</code></td>
<td>int</td>
<td>Port of Redis server</td>
<td></td>
</tr>
<tr>
<td><code>PEERCALLS_STORE_REDIS_PREFIX</code></td>
<td>string</td>
<td>Prefix for Redis keys. Suggestion: <code>peercalls</code></td>
<td></td>
</tr>
<tr>
<td><code>PEERCALLS_NETWORK_TYPE</code></td>
<td>string</td>
<td>Can be <code>mesh</code> or <code>sfu</code>. Setting to SFU will make the server the main peer</td>
<td><code>mesh</code></td>
</tr>
<tr>
<td><code>PEERCALLS_NETWORK_SFU_INTERFACES</code></td>
<td>csv</td>
<td>List of interfaces to use for ICE candidates, uses all available when empty</td>
<td></td>
</tr>
<tr>
<td><code>PEERCALLS_NETWORK_SFU_JITTER_BUFFER</code></td>
<td>bool</td>
<td>Set to <code>true</code> to enable the use of Jitter Buffer</td>
<td><code>false</code></td>
</tr>
<tr>
<td><code>PEERCALLS_NETWORK_SFU_PROTOCOLS</code></td>
<td>csv</td>
<td>Can be <code>udp4</code>, <code>udp6</code>, <code>tcp4</code> or <code>tcp6</code></td>
<td><code>udp4,udp6</code></td>
</tr>
<tr>
<td><code>PEERCALLS_NETWORK_SFU_TCP_BIND_ADDR</code></td>
<td>string</td>
<td>ICE TCP bind address. By default listens on all interfaces.</td>
<td></td>
</tr>
<tr>
<td><code>PEERCALLS_NETWORK_SFU_TCP_LISTEN_PORT</code></td>
<td>int</td>
<td>ICE TCP listen port. By default uses a random port.</td>
<td><code>0</code></td>
</tr>
<tr>
<td><code>PEERCALLS_NETWORK_SFU_TRANSPORT_LISTEN_ADDR</code></td>
<td>string</td>
<td>When set, will listen for external RTP, Data and Metadata UDP streams</td>
<td></td>
</tr>
<tr>
<td><code>PEERCALLS_NETWORK_SFU_TRANSPORT_NODES</code></td>
<td>csv</td>
<td>When set, will transmit media and data to designated <code>host:port</code>(s).</td>
<td></td>
</tr>
<tr>
<td><code>PEERCALLS_NETWORK_SFU_UDP_PORT_MIN</code></td>
<td>int</td>
<td>Defines ICE UDP range start to use for UDP host candidates.</td>
<td><code>0</code></td>
</tr>
<tr>
<td><code>PEERCALLS_NETWORK_SFU_UDP_PORT_MAX</code></td>
<td>int</td>
<td>Defines ICE UDP range end to use for UDP host candidates.</td>
<td><code>0</code></td>
</tr>
<tr>
<td><code>PEERCALLS_ICE_SERVER_URLS</code></td>
<td>csv</td>
<td>List of ICE Server URLs</td>
<td></td>
</tr>
<tr>
<td><code>PEERCALLS_ICE_SERVER_AUTH_TYPE</code></td>
<td>string</td>
<td>Can be empty or <code>secret</code> for coturn <code>static-auth-secret</code> config option.</td>
<td></td>
</tr>
<tr>
<td><code>PEERCALLS_ICE_SERVER_SECRET</code></td>
<td>string</td>
<td>Secret for coturn</td>
<td></td>
</tr>
<tr>
<td><code>PEERCALLS_ICE_SERVER_USERNAME</code></td>
<td>string</td>
<td>Username for coturn</td>
<td></td>
</tr>
<tr>
<td><code>PEERCALLS_PROMETHEUS_ACCESS_TOKEN</code></td>
<td>string</td>
<td>Access token for prometheus <code>/metrics</code> URL</td>
<td></td>
</tr>
<tr>
<td><code>PEERCALLS_FRONTEND_ENCODED_INSERTABLE_STREAMS</code></td>
<td>bool</td>
<td>Enable insertable streams</td>
<td><code>false</code></td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto">The default ICE servers in use are:</p>
<ul dir="auto">
<li><code>stun:stun.l.google.com:19302</code></li>
<li><code>stun:global.stun.twilio.com:3478?transport=udp</code></li>
</ul>
<p dir="auto">Only a single ICE server can be defined via environment variables. To define
more use a YAML config file. To load a config file, use the <code>-c /path/to/config.yml</code> command line argument.</p>
<p dir="auto">See <a href="https://github.com/peer-calls/peer-calls/blob/master/src/server/config/types.go">config/types.go</a> for configuration types.</p>
<p dir="auto">Example:</p>
<div dir="auto" data-snippet-clipboard-copy-content="base_url: &#39;&#39;
bind_host: &#39;0.0.0.0&#39;
bind_port: 3005
ice_servers:
 - urls:
   - &#39;stun:stun.l.google.com:19302&#39;
- urls:
  - &#39;stun:global.stun.twilio.com:3478?transport=udp&#39;
#- urls:
#  - &#39;turn:coturn.mydomain.com&#39;
#  auth_type: secret
#  auth_secret:
#    username: &#34;peercalls&#34;
#    secret: &#34;some-static-secret&#34;
# tls:
#   cert: test.pem
#   key: test.key
store:
  type: memory
  # type: redis
  # redis:
  #   host: localhost
  #   port: 6379
  #   prefix: peercalls
network:
  type: mesh
  # type: sfu
  # sfu:
  #   interfaces:
  #   - eth0
prometheus:
  access_token: &#34;mytoken&#34;
frontend:
  encodedInsertableStreams: false"><pre><span>base_url</span>: <span><span>&#39;</span><span>&#39;</span></span>
<span>bind_host</span>: <span><span>&#39;</span>0.0.0.0<span>&#39;</span></span>
<span>bind_port</span>: <span>3005</span>
<span>ice_servers</span>:
 - <span>urls</span>:
   - <span><span>&#39;</span>stun:stun.l.google.com:19302<span>&#39;</span></span>
- <span>urls</span>:
  - <span><span>&#39;</span>stun:global.stun.twilio.com:3478?transport=udp<span>&#39;</span></span>
<span><span>#</span>- urls:</span>
<span><span>#</span>  - &#39;turn:coturn.mydomain.com&#39;</span>
<span><span>#</span>  auth_type: secret</span>
<span><span>#</span>  auth_secret:</span>
<span><span>#</span>    username: &#34;peercalls&#34;</span>
<span><span>#</span>    secret: &#34;some-static-secret&#34;</span>
<span><span>#</span> tls:</span>
<span><span>#</span>   cert: test.pem</span>
<span><span>#</span>   key: test.key</span>
<span>store</span>:
  <span>type</span>: <span>memory</span>
  <span><span>#</span> type: redis</span>
  <span><span>#</span> redis:</span>
  <span><span>#</span>   host: localhost</span>
  <span><span>#</span>   port: 6379</span>
  <span><span>#</span>   prefix: peercalls</span>
<span>network</span>:
  <span>type</span>: <span>mesh</span>
  <span><span>#</span> type: sfu</span>
  <span><span>#</span> sfu:</span>
  <span><span>#</span>   interfaces:</span>
  <span><span>#</span>   - eth0</span>
<span>prometheus</span>:
  <span>access_token</span>: <span><span>&#34;</span>mytoken<span>&#34;</span></span>
<span>frontend</span>:
  <span>encodedInsertableStreams</span>: <span>false</span></pre></div>
<p dir="auto">Prometheus <code>/metrics</code> URL will not be accessible without an access token set.
The access token can be provided by either:</p>
<ul dir="auto">
<li>Setting <code>Authorization</code> header to <code>Bearer mytoken</code>, or</li>
<li>Providing the access token as a query string: <code>/metrics?access_token=mytoken</code></li>
</ul>
<p dir="auto">To access the server, go to <a href="http://localhost:3000" rel="nofollow">http://localhost:3000</a>.</p>

<p dir="auto">Most browsers will prevent access to user media devices if the application is
accessed from the network (not via 127.0.0.1). If you wish to test your mobile
devices, you&#39;ll have to enable TLS by setting the <code>PEERCALLS_TLS_CERT</code> and
<code>PEERCALLS_TLS_KEY</code> environment variables. To generate a self-signed certificate
you can use:</p>
<div data-snippet-clipboard-copy-content="openssl req -nodes -x509 -newkey rsa:4096 -keyout key.pem -subj &#34;/C=US/ST=Oregon/L=Portland/O=Company Name/OU=Org/CN=example.com&#34; -out cert.pem -days 365"><pre><code>openssl req -nodes -x509 -newkey rsa:4096 -keyout key.pem -subj &#34;/C=US/ST=Oregon/L=Portland/O=Company Name/OU=Org/CN=example.com&#34; -out cert.pem -days 365
</code></pre></div>
<p dir="auto">Replace <code>example.com</code> with your server&#39;s hostname.</p>

<p dir="auto">Redis can be used to allow users connected to different instances to connect.
The following needs to be added to <code>config.yaml</code> to enable Redis:</p>
<div dir="auto" data-snippet-clipboard-copy-content="store:
  type: redis
  redis:
    host: redis-host  # redis host
    port: 6379        # redis port
    prefix: peercalls # all instances must use the same prefix"><pre><span>store</span>:
  <span>type</span>: <span>redis</span>
  <span>redis</span>:
    <span>host</span>: <span>redis-host  </span><span><span>#</span> redis host</span>
    <span>port</span>: <span>6379</span>        <span><span>#</span> redis port</span>
    <span>prefix</span>: <span>peercalls </span><span><span>#</span> all instances must use the same prefix</span></pre></div>

<p dir="auto">By default, Peer Calls server will log only basic information. Client-side
logging is disabled by default.</p>
<p dir="auto">Server-side logs can be configured via the <code>PEERCALLS_LOG</code> environment variable. Setting
it to <code>*</code> will enable all server-side logging:</p>
<ul dir="auto">
<li><code>PEERCALLS_LOG=*</code></li>
</ul>
<p dir="auto">Client-side logs can be configured via <code>localStorage.DEBUG</code> and
<code>localStorage.LOG</code> variables:</p>
<ul dir="auto">
<li>Setting <code>localStorage.log=1</code> enables logging of Redux actions and state
changes</li>
<li>Setting <code>localStorage.debug=peercalls,peercalls:*</code> enables all other
client-side logging</li>
</ul>

<p dir="auto">Below are some common scripts used for development:</p>
<div data-snippet-clipboard-copy-content="npm start              build all resources and start the server.
npm run build          build all client-side resources.
npm run start:server   start the server
npm run js:watch       build and watch resources
npm test               run all client-side tests.
go test ./...          run all server tests
npm run ci             run all linting, tests and build the client-side"><pre><code>npm start              build all resources and start the server.
npm run build          build all client-side resources.
npm run start:server   start the server
npm run js:watch       build and watch resources
npm test               run all client-side tests.
go test ./...          run all server tests
npm run ci             run all linting, tests and build the client-side
</code></pre></div>

<p dir="auto">Tested on Firefox and Chrome, including mobile versions. Also works on Safari
and iOS since version 11. Does not work on Microsoft Edge because they do not
support DataChannels yet.</p>
<p dir="auto">For more details, see here:</p>
<ul dir="auto">
<li><a href="http://caniuse.com/#feat=rtcpeerconnection" rel="nofollow">http://caniuse.com/#feat=rtcpeerconnection</a></li>
<li><a href="http://caniuse.com/#search=getUserMedia" rel="nofollow">http://caniuse.com/#search=getUserMedia</a></li>
</ul>
<p dir="auto">In Firefox, it might be useful to use <code>about:webrtc</code> to debug connection
issues. In Chrome, use <code>about:webrtc-internals</code>.</p>
<p dir="auto">When experiencing connection issues, the first thing to try is to have all
peers to use the same browser.</p>

<p dir="auto">The UDP port range can be defined for opening epheremal ports. These ports will
be used for generating UDP host ICE candidates. It is recommended to enable
these UDP ports when ICE TCP is enabled, because the priority of TCP host
candidates will be higher than srflx/prflx candidates, as such TCP will be used
even though UDP connectivity might be possible.</p>

<p dir="auto">Peer Calls supports ICE over TCP as described in RFC6544. Currently only
passive ICE candidates are supported. This means that users whose ISPs or
corporate firewalls block UDP packets can use TCP to connect to the SFU. In
most scenarios, this removes the need to use a TURN server, but this
functionality is currently experimental and is not enabled by default.</p>
<p dir="auto">Add the <code>tcp4</code> and <code>tcp6</code> to your <code>PEERCALLS_NETWORK_SFU_PROTOCOLS</code> to enable
support for ICE TCP:</p>
<div data-snippet-clipboard-copy-content="PEERCALLS_NETWORK_TYPE=sfu PEERCALLS_NETWORK_SFU_PROTOCOLS=`udp4,udp6,tcp4,tcp6` peer-calls"><pre><code>PEERCALLS_NETWORK_TYPE=sfu PEERCALLS_NETWORK_SFU_PROTOCOLS=`udp4,udp6,tcp4,tcp6` peer-calls
</code></pre></div>
<p dir="auto">To test this functionality, <code>udp4</code> and <code>udp6</code> network types should be omitted:</p>
<div data-snippet-clipboard-copy-content="PEERCALLS_NETWORK_TYPE=sfu PEERCALLS_NETWORK_SFU_PROTOCOLS=`tcp4,tcp6` peer-calls"><pre><code>PEERCALLS_NETWORK_TYPE=sfu PEERCALLS_NETWORK_SFU_PROTOCOLS=`tcp4,tcp6` peer-calls
</code></pre></div>
<p dir="auto">Please note that in production the <code>PEERCALLS_NETWORK_SFU_TCP_LISTEN_PORT</code> should
be specified and external TCP access allowed through the server firewall.</p>

<p dir="auto">When a direct connection cannot be established, it might be help to use a TURN
server. The peercalls.com instance is configured to use a TURN server and it
can be used for testing. However, the server bandwidth there is not unlimited.</p>
<p dir="auto">Here are the steps to install a TURN server on Ubuntu/Debian Linux:</p>

<p dir="auto">Use the following configuration as a template for <code>/etc/turnserver.conf</code>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="lt-cred-mech
use-auth-secret
static-auth-secret=p4ssw0rd
realm=example.com
total-quota=300
cert=/etc/letsencrypt/live/rtc.example.com/fullchain.pem
pkey=/etc/letsencrypt/live/rtc.example.com/privkey.pem
log-file=/dev/stdout
no-multicast-peers
proc-user=turnserver
proc-group=turnserver"><pre>lt-cred-mech
use-auth-secret
static-auth-secret=p4ssw0rd
realm=example.com
total-quota=300
cert=/etc/letsencrypt/live/rtc.example.com/fullchain.pem
pkey=/etc/letsencrypt/live/rtc.example.com/privkey.pem
log-file=/dev/stdout
no-multicast-peers
proc-user=turnserver
proc-group=turnserver</pre></div>
<p dir="auto">Change the <code>p4ssw0rd</code>, <code>realm</code>  and paths to server certificates.</p>
<p dir="auto">Use the following configuration for Peer Calls:</p>
<div dir="auto" data-snippet-clipboard-copy-content="iceServers:
- urls:
  - &#39;turn:rtc.example.com&#39;
  auth_type: secret
  auth_secret:
    username: &#39;example&#39;
    secret: &#39;p4ssw0rd&#39;"><pre><span>iceServers</span>:
- <span>urls</span>:
  - <span><span>&#39;</span>turn:rtc.example.com<span>&#39;</span></span>
  <span>auth_type</span>: <span>secret</span>
  <span>auth_secret</span>:
    <span>username</span>: <span><span>&#39;</span>example<span>&#39;</span></span>
    <span>secret</span>: <span><span>&#39;</span>p4ssw0rd<span>&#39;</span></span></pre></div>
<p dir="auto">Finally, enable and start the <code>coturn</code> service:</p>
<div dir="auto" data-snippet-clipboard-copy-content="sudo systemctl enable coturn
sudo systemctl start coturn"><pre>sudo systemctl <span>enable</span> coturn
sudo systemctl start coturn</pre></div>

<p dir="auto">See <a href="https://github.com/peer-calls/peer-calls/blob/master/CONTRIBUTING.md">Contributing</a> section.</p>
<p dir="auto">If you encounter a bug, please open a new issue!</p>

<p dir="auto">The development of Peer Calls is sponsored by <a href="https://rondomoon.com" rel="nofollow">rondomoon</a>. If you&#39;d
like enterprise on-site support or become a sponsor, please contact
<a href="mailto:hello@rondomoon.com">hello@rondomoon.com</a>.</p>

<p dir="auto"><a href="https://github.com/peer-calls/peer-calls/blob/master/LICENSE">Apache 2.0</a></p>
</article></div></div>
  </body>
</html>
