<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://codeberg.org/amano.kenji/j3blocks">Original</a>
    <h1>J3blocks is a Janet scripting system for i3bar and swaybar</h1>
    
    <div id="readability-page-1" class="page"><div>
	
	<div>
		
		<div>
			
				
<p dir="auto">It is a janet scripting system for i3bar and swaybar. It is distributed as a jpm library. You have to write a janet
script to use this library.</p>
<p dir="auto"><a href="https://janet-lang.org/" rel="nofollow">Janet</a> is a system scripting language.</p>
<h2 id="user-content-built-in-j3blocks-module-screenshots" dir="auto">Built-in j3blocks module screenshots</h2>
<p dir="auto">bandwidth</p>
<p dir="auto"><a href="https://codeberg.org/amano.kenji/j3blocks/media/branch/master/screenshots/bandwidth.png" target="_blank" rel="nofollow noopener"><img src="https://codeberg.org/amano.kenji/j3blocks/media/branch/master/screenshots/bandwidth.png" alt="bandwidth"/></a></p>
<p dir="auto">cpu</p>
<p dir="auto"><a href="https://codeberg.org/amano.kenji/j3blocks/media/branch/master/screenshots/cpu.png" target="_blank" rel="nofollow noopener"><img src="https://codeberg.org/amano.kenji/j3blocks/media/branch/master/screenshots/cpu.png" alt="cpu"/></a></p>
<p dir="auto">memory usage</p>
<p dir="auto"><a href="https://codeberg.org/amano.kenji/j3blocks/media/branch/master/screenshots/mem.png" target="_blank" rel="nofollow noopener"><img src="https://codeberg.org/amano.kenji/j3blocks/media/branch/master/screenshots/mem.png" alt="mem"/></a></p>
<p dir="auto">swap usage</p>
<p dir="auto"><a href="https://codeberg.org/amano.kenji/j3blocks/media/branch/master/screenshots/swap.png" target="_blank" rel="nofollow noopener"><img src="https://codeberg.org/amano.kenji/j3blocks/media/branch/master/screenshots/swap.png" alt="swap"/></a></p>
<p dir="auto">time</p>
<p dir="auto"><a href="https://codeberg.org/amano.kenji/j3blocks/media/branch/master/screenshots/time.png" target="_blank" rel="nofollow noopener"><img src="https://codeberg.org/amano.kenji/j3blocks/media/branch/master/screenshots/time.png" alt="time"/></a></p>

<p dir="auto">j3blocks tries not to have a lot of built-in modules.</p>
<p dir="auto">Extra community modules can be found on <a href="https://codeberg.org/amano.kenji/j3blocks-extra" rel="nofollow">j3blocks-extra</a>.</p>
<p dir="auto">You can contribute j3blocks modules to j3blocks-extra.</p>
<h2 id="user-content-basic-usage" dir="auto">Basic usage</h2>
<p dir="auto">Built-in j3blocks modules are available in <code>j3blocks/modules</code>.</p>
<p dir="auto">For example, if you want to use the built-in cpu module, run this janet script.</p>
<pre><code>(import j3blocks)
(import j3blocks/modules/cpu)
(import j3blocks/loglevel)

(j3blocks/run
  :unix-socket-name &#34;test&#34;
  :loglevel loglevel/info
  :blocks
  [{:id &#34;cpu&#34;
    :module (cpu/usage &#34;CPU &#34; 1)
    :click-event
    (fn
      [input output log]
      (case (get (ev/take input) &#34;button&#34;)
        # left click
        1
        (ev/give output &#34;update&#34;)
        # right click
        3
        (ev/spawn (os/execute [&#34;do&#34; &#34;something&#34;] :p))))
    :modify-block
    (fn
      [input output log]
      (forever
        (def block (ev/take input))
        (put block &#34;separator&#34; false)
        (put block &#34;markup&#34; &#34;pango&#34;)
        (ev/give output block)))}])
</code></pre><p dir="auto">The above example disables separator and sets markup to pango in cpu module. Log level is set to <code>info</code>. It also
processes click events.</p>
<p dir="auto">It creates a unix domain socket at <code>$XDG_RUNTIME_DIR/j3blocks/test</code> or <code>/tmp/j3blocks/$UID/test</code>. The unix domain
socket messages become block events.</p>
<p dir="auto">For details, read <code>(doc j3blocks/run)</code>.</p>
<h2 id="user-content-unix-domain-socket" dir="auto">Unix domain socket</h2>
<p dir="auto">If you want to pass messages to j3blocks unix domain socket, then you should use <code>j3blocks/msg</code> as below.</p>
<pre><code>(import j3blocks/msg)

(msg/send &#34;test&#34; [&#34;static-block1&#34; &#34;instance1&#34;] {&#34;message&#34; &#34;ok&#34;})
</code></pre><p dir="auto">In the above example, <code>msg/send</code> sends <code>{&#34;message&#34; &#34;ok&#34;}</code> to a block identified by <code>[&#34;static-block1&#34; &#34;instance1&#34;]</code>.
The block is running on a j3blocks instance listening on the unix domain socket, <code>test</code>. Any message sent to a j3blocks
block must be valid JSON which can be a string, a number, an object, and so on.</p>
<p dir="auto">Refer to <code>(doc msg/send)</code> for details.</p>
<p dir="auto">Every j3blocks block can receive click events and unix domain socket events.</p>
<h2 id="user-content-useful-janet-modules-for-j3blocks" dir="auto">Useful janet modules for j3blocks</h2>
<ul dir="auto">
<li>If you want to produce pango markup text, <code>j3blocks/pango</code> module will be useful.</li>
<li>If your j3blocks module needs to parse <code>/proc/meminfo</code>, <code>j3blocks/procmeminfo</code> module will be useful.</li>
<li>If your j3blocks module needs to parse <code>/proc/net/dev</code>, <code>j3blocks/procnetdev</code> module will be useful.</li>
<li><code>spork/sh</code> is useful for launching programs in response to click events.</li>
</ul>
<h2 id="user-content-contribution" dir="auto">Contribution</h2>
<p dir="auto">This library tries not to exceed 120 characters per line.</p>

			
		</div>
	</div>
</div></div>
  </body>
</html>
