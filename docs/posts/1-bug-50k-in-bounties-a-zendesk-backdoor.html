<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://gist.github.com/hackermondev/68ec8ed145fcee49d2f5e2b9d2cf2e52">Original</a>
    <h1>1 bug, $50k in bounties, a Zendesk backdoor</h1>
    
    <div id="readability-page-1" class="page"><p>
    1 bug, $50,000+ in bounties, how Zendesk intentionally left a backdoor in hundreds of Fortune 500 companies
  </p><div>
  <div id="file-zendesk-md">
      
      <div id="file-zendesk-md-readme">
    <article itemprop="text"><p dir="auto">hi, i&#39;m daniel. i&#39;m a 15-year-old with some programming experience and i do a little bug hunting in my free time. here&#39;s the insane story of how I found a single bug that affected over half of all Fortune 500 companies:</p>

<p dir="auto">If you&#39;ve spent some time online, you’ve probably come across Zendesk.</p>
<p dir="auto">Zendesk is a customer service tool used by some of the world’s top companies. It’s easy to set up: you link it to your company’s support email (like <a href="mailto:support@company.com">support@company.com</a>), and Zendesk starts managing incoming emails and creating tickets. You can handle these tickets yourself or have a support team do it for you. Zendesk is a billion-dollar company, trusted by big names like Cloudflare.</p>
<p dir="auto">Personally, I’ve always found it surprising that these massive companies, worth billions, rely on third-party tools like Zendesk instead of building their own in-house ticketing systems.</p>

<p dir="auto">As the saying goes, “You’re only as strong as your weakest link.” Since Zendesk is just seen as a basic ticketing tool, companies often set it up without much thought. The most common setup I&#39;ve seen is is forwarding all emails from <code>support@company.com</code> to Zendesk.</p>
<p dir="auto">Why is that dangerous? Many companies use their @company.com domain for Single Sign-On (SSO), which lets employees quickly log in to internal tools. By connecting Zendesk to the same domain, companies unknowingly create a potential security gap. Zendesk handles all emails for the domain it’s configured for, which means if your SSO system doesn’t properly validate email addresses, anyone who gains access to your Zendesk could potentially exploit this and access your internal systems. (I’ll explain more on this later.)</p>

<p dir="auto">At the beginning of the year, I discovered a serious vulnerability in Zendesk that allowed attackers to read customer support tickets from any company using Zendesk. All they had to do was sent a crafted email to a Support email handled by Zendesk. The shocking part? Zendesk didn’t seem to care.</p>
<p dir="auto">The bug itself was surprisingly simple. Zendesk had no effective protection against email spoofing, and this oversight made it possible to exploit their email collaboration feature to gain access to others’ tickets.</p>
<p dir="auto">Here’s how it worked: When you send an email to a company’s Zendesk support portal (e.g., <code>support@company.com</code>), Zendesk creates a new support ticket. To keep track of the email thread, Zendesk automatically generates a reply-to address, which looks like this: <code>support+id{id}@company.com</code>, where <code>{id}</code> is the unique ticket number. This address ensures that any future replies you send go directly to the same ticket.</p>
<p dir="auto">Zendesk also has a feature for ticket collaboration. If you CC someone on one of your email replies, Zendesk automatically adds them to the ticket, allowing them to see the full ticket history in the support portal.</p>
<p dir="auto">The exploit was simple: if an attacker knew the support email address and the ticket ID (which are usually easy to guess since ticket IDs are incremental), they could use email spoofing to impersonate the original sender. By sending a fake email to <code>support+id{id}@company.com</code> from the requestor’s email address and CCing their own email, Zendesk would think the email was legitimate. It would then add the attacker’s email to the ticket, giving them full access to the entire ticket history.</p>
<p dir="auto">This meant an attacker could effectively join any ongoing support conversation, and read sensitive information—all because Zendesk didn’t have proper safeguards against email spoofing.</p>
<p dir="auto">Bug Prerequisites:</p>
<ul dir="auto">
<li>Requestor&#39;s email</li>
<li>The ticket ID (since Zendesk ticket IDs are incremental, an attacker could brute-force or estimate it)</li>
<li>Access to a public support portal</li>
</ul>
<div dir="auto"><h2 dir="auto">&#34;out of scope,&#34; said no attacker ever</h2><a id="user-content-out-of-scope-said-no-attacker-ever" aria-label="Permalink: &#34;out of scope,&#34; said no attacker ever" href="#out-of-scope-said-no-attacker-ever"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">As soon as I discovered this vulnerability, I reported it through Zendesk’s bug bounty program, fully expecting it to be taken seriously and fixed quickly. A week later, I was hit with a disappointing response:
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/60828015/375600604-ac8f16ef-97a5-4519-a6fd-d49c0ac0c7fe.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjg3ODgyODAsIm5iZiI6MTcyODc4Nzk4MCwicGF0aCI6Ii82MDgyODAxNS8zNzU2MDA2MDQtYWM4ZjE2ZWYtOTdhNS00NTE5LWE2ZmQtZDQ5YzBhYzBjN2ZlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDEwMTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQxMDEzVDAyNTMwMFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWNmZDAwMDE0M2RkNTI3ODQxODliOWRlMjM3Zjg1MDU0NjhhZTdmNWU1ZDczNmM2OGFhZGU0OTdlMWY5YTA3MzcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.hKOrY4XxqXoIGDm4rqjdwUKpv4j7RUn32OM7nxNNCZI"><img width="782" alt="image" src="https://private-user-images.githubusercontent.com/60828015/375600604-ac8f16ef-97a5-4519-a6fd-d49c0ac0c7fe.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjg3ODgyODAsIm5iZiI6MTcyODc4Nzk4MCwicGF0aCI6Ii82MDgyODAxNS8zNzU2MDA2MDQtYWM4ZjE2ZWYtOTdhNS00NTE5LWE2ZmQtZDQ5YzBhYzBjN2ZlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDEwMTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQxMDEzVDAyNTMwMFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWNmZDAwMDE0M2RkNTI3ODQxODliOWRlMjM3Zjg1MDU0NjhhZTdmNWU1ZDczNmM2OGFhZGU0OTdlMWY5YTA3MzcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.hKOrY4XxqXoIGDm4rqjdwUKpv4j7RUn32OM7nxNNCZI"/></a></p>
<p dir="auto">Because my bug relied on email spoofing, which was considered &#34;out of scope&#34; for their HackerOne program, they rejected my report. It was unbelievable.</p>
<p dir="auto">This response wasn’t even from an actual Zendesk team member. Many companies, like Zendesk, use a HackerOne service to triage reports so their own team can focus on fixing bugs instead of verifying submissions. Realizing this, I asked for the report to be forwarded to an actual Zendesk staff member for review. A few days later, I got another frustrating reply:</p>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/60828015/375601586-ffd6f4e7-d772-4f53-b4f3-4e32a43d3905.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjg3ODgyODAsIm5iZiI6MTcyODc4Nzk4MCwicGF0aCI6Ii82MDgyODAxNS8zNzU2MDE1ODYtZmZkNmY0ZTctZDc3Mi00ZjUzLWI0ZjMtNGUzMmE0M2QzOTA1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDEwMTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQxMDEzVDAyNTMwMFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWZhOGRmOWM3ZWYyYmY4ZmVhNzVmYWFhYmViZDgwMzYwOTAxZWU0MGU3YmY0MDVlMTRmNGE5ZGQ1OGYyM2JlOWYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.ffM_i6llwGDX7hu1uHZb17bNh_OvhZzn4AMCELelgfY"><img width="949" alt="image" src="https://private-user-images.githubusercontent.com/60828015/375601586-ffd6f4e7-d772-4f53-b4f3-4e32a43d3905.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjg3ODgyODAsIm5iZiI6MTcyODc4Nzk4MCwicGF0aCI6Ii82MDgyODAxNS8zNzU2MDE1ODYtZmZkNmY0ZTctZDc3Mi00ZjUzLWI0ZjMtNGUzMmE0M2QzOTA1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDEwMTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQxMDEzVDAyNTMwMFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWZhOGRmOWM3ZWYyYmY4ZmVhNzVmYWFhYmViZDgwMzYwOTAxZWU0MGU3YmY0MDVlMTRmNGE5ZGQ1OGYyM2JlOWYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.ffM_i6llwGDX7hu1uHZb17bNh_OvhZzn4AMCELelgfY"/></a>
<p dir="auto">Zendesk refused to reconsider. Despite the security risk, they wouldn’t act on the report because it fell outside their program’s scope. Of course, they’d change their minds in a few weeks—but more on that later.</p>
<div dir="auto"><h2 dir="auto">escalating this to a full Slack takeover</h2><a id="user-content-escalating-this-to-a-full-slack-takeover" aria-label="Permalink: escalating this to a full Slack takeover" href="#escalating-this-to-a-full-slack-takeover"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">I could have reported the email spoofing bug to individual companies that were affected by it, as it was possible to patch individual instances by disabling email collaboration, prevent attackers from adding themselves to tickets. But I wanted to make a bigger impact.</p>
<p dir="auto">That&#39;s when I came across <a href="https://medium.com/intigriti/how-i-hacked-hundreds-of-companies-through-their-helpdesk-b7680ddc2d4c" rel="nofollow">TICKETTRICK</a>, a blog post from 2017. In it, security researcher Inti De Ceukelaire detailed how he exploited Zendesk to infiltrate the private Slack workspaces of hundreds of companies. Since many companies use Slack SSO on the same domain as Zendesk, the researcher figured out he could complete email verifications through a <code>support@company.com</code> email, and gain access to private Slack channels. Back then, Zendesk wasn&#39;t as big and there were some bugs that allowed anyone to view your tickets if they had your email.</p>
<p dir="auto">I realized that I could replicate his exploit using my bug, but with a few challenges to overcome.</p>

<p dir="auto">After his disclosure (this was years ago!), Slack changed their email verification system to include a random token in email addresses.</p>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/60828015/375606032-eb140eaa-541e-4546-bd8e-fd675b6ab43e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjg3ODgyODAsIm5iZiI6MTcyODc4Nzk4MCwicGF0aCI6Ii82MDgyODAxNS8zNzU2MDYwMzItZWIxNDBlYWEtNTQxZS00NTQ2LWJkOGUtZmQ2NzViNmFiNDNlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDEwMTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQxMDEzVDAyNTMwMFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWEzZWY4ZDY2NzM5ZjkyNDY5ZWZlMDA0Mzk4OTI5MTZmNWViMWVkOTY2NGJkYWMyOWQwNGI4YmRlNjVkZTk2NjMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.5yuIRnacpz5yiqsWS-32mWELoRXGeMkzQsBwTxaU7OM"><img width="327" alt="image" src="https://private-user-images.githubusercontent.com/60828015/375606032-eb140eaa-541e-4546-bd8e-fd675b6ab43e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjg3ODgyODAsIm5iZiI6MTcyODc4Nzk4MCwicGF0aCI6Ii82MDgyODAxNS8zNzU2MDYwMzItZWIxNDBlYWEtNTQxZS00NTQ2LWJkOGUtZmQ2NzViNmFiNDNlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDEwMTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQxMDEzVDAyNTMwMFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWEzZWY4ZDY2NzM5ZjkyNDY5ZWZlMDA0Mzk4OTI5MTZmNWViMWVkOTY2NGJkYWMyOWQwNGI4YmRlNjVkZTk2NjMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.5yuIRnacpz5yiqsWS-32mWELoRXGeMkzQsBwTxaU7OM"/></a>
<p dir="auto">Inti&#39;s exploit (like mine) required the attacker to know the sending email address of the verification code. Slack added random tokens to their email addresses to combat similar attacks in the future. It was impossible to know what email they would send the verification email from (which is one of the prerequisites required for my exploit) as they generated a random token everytime. Unless...</p>
<p dir="auto">While Slack used a random email token when sending email verification, neither Google or Apple did. Slack supported both methods for OAuth login.</p>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/60828015/375606552-fa1760ab-8ae0-4b1b-a172-6d4ba2463b95.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjg3ODgyODAsIm5iZiI6MTcyODc4Nzk4MCwicGF0aCI6Ii82MDgyODAxNS8zNzU2MDY1NTItZmExNzYwYWItOGFlMC00YjFiLWExNzItNmQ0YmEyNDYzYjk1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDEwMTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQxMDEzVDAyNTMwMFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWI5MTg4NWI1NzM0Y2RlOGU4ODQxNGQwYmMwNWEyYjQ2ZTg4NzFkZTI4ZTVmNzk1MmExMTUxOWQzNTkxNGFkNTcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.agUY__FhyhkTsE3wQMb8ka9sPMUZqUusYilEgtBiQm0"><img width="477" alt="image" src="https://private-user-images.githubusercontent.com/60828015/375606552-fa1760ab-8ae0-4b1b-a172-6d4ba2463b95.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjg3ODgyODAsIm5iZiI6MTcyODc4Nzk4MCwicGF0aCI6Ii82MDgyODAxNS8zNzU2MDY1NTItZmExNzYwYWItOGFlMC00YjFiLWExNzItNmQ0YmEyNDYzYjk1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDEwMTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQxMDEzVDAyNTMwMFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWI5MTg4NWI1NzM0Y2RlOGU4ODQxNGQwYmMwNWEyYjQ2ZTg4NzFkZTI4ZTVmNzk1MmExMTUxOWQzNTkxNGFkNTcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.agUY__FhyhkTsE3wQMb8ka9sPMUZqUusYilEgtBiQm0"/></a>
<p dir="auto">It was the most simple bypass. Slack intoduced OAuth login just a few years ago and must have completely forgotten about their protections against this type of attacks.</p>
<p dir="auto">So now the exploit was simple, create a Google account with a <code>support@company.com</code> email, request verification code, use my bug to access the ticket Zendesk automatically creates when it arrives, verify Google account, login with Google to Slack.</p>
<p dir="auto">This was perfect...except it wouldn&#39;t work with Google. Google sent verification email from <code>noreply@google.com</code> and Zendesk had started blocking emails from <code>noreply@</code> addresses from being automatically created as tickets (probably after the TICKETTRICK disclosure too) which meant we wouldn&#39;t be able to recieve it.</p>
<p dir="auto">Apple didn&#39;t do this though, Apple sent verification emails from <code>appleid@</code> address, jackpot.
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/60828015/375607789-92f473e1-4aef-4e50-a92c-d486480b842d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjg3ODgyODAsIm5iZiI6MTcyODc4Nzk4MCwicGF0aCI6Ii82MDgyODAxNS8zNzU2MDc3ODktOTJmNDczZTEtNGFlZi00ZTUwLWE5MmMtZDQ4NjQ4MGI4NDJkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDEwMTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQxMDEzVDAyNTMwMFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWY2NWQ1OGRiMDM3ZDZmZmUwMTEwZWU2MTgwMTkyNzFkZmFhOTU2NWNlZDk1ZDQ4MGNkYjZmNjViNWY5ZDE5NTcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.0Qp7jDjlMutbKWMecR_FFsLCDru-f5U3toX7_8m53XU"><img width="336" alt="image" src="https://private-user-images.githubusercontent.com/60828015/375607789-92f473e1-4aef-4e50-a92c-d486480b842d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjg3ODgyODAsIm5iZiI6MTcyODc4Nzk4MCwicGF0aCI6Ii82MDgyODAxNS8zNzU2MDc3ODktOTJmNDczZTEtNGFlZi00ZTUwLWE5MmMtZDQ4NjQ4MGI4NDJkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDEwMTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQxMDEzVDAyNTMwMFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWY2NWQ1OGRiMDM3ZDZmZmUwMTEwZWU2MTgwMTkyNzFkZmFhOTU2NWNlZDk1ZDQ4MGNkYjZmNjViNWY5ZDE5NTcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.0Qp7jDjlMutbKWMecR_FFsLCDru-f5U3toX7_8m53XU"/></a></p>
<div dir="auto"><h2 dir="auto">reproduction steps, apple -&gt; zendesk -&gt; slack</h2><a id="user-content-reproduction-steps-apple---zendesk---slack" aria-label="Permalink: reproduction steps, apple -&gt; zendesk -&gt; slack" href="#reproduction-steps-apple---zendesk---slack"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The steps to execute the attack now were simple:</p>
<ol dir="auto">
<li>Create an Apple account with <code>support@company.com</code> email and request a verification code, Apple sends verification code from <code>appleid@id.apple.com</code> to <code>support@company.com</code> and Zendesk automatically creates a ticket</li>
<li>At the same time, create a ticket on <code>company.com</code> support portal from my own email address, this allows me to keep track of a ID range</li>
<li>Use the email spoofing bug I mentioned earlier to attempt to add yourself to every ticket within the range from earlier</li>
</ol>
<div dir="auto"><pre><span>const</span> <span>sendmail</span> <span>=</span> <span>require</span><span>(</span><span>&#39;sendmail&#39;</span><span>)</span><span>(</span><span>)</span><span>;</span>

<span>// Assuming the ticket you created in step #2 was assigned a ticket ID of #453 </span>
<span>// verification email landed somewhere near there</span>
<span>const</span> <span>range</span> <span>=</span> <span>[</span><span>448</span><span>,</span> <span>457</span><span>]</span><span>;</span>
<span>for</span> <span>(</span><span>let</span> <span>i</span> <span>=</span> <span>range</span><span>[</span><span>0</span><span>]</span><span>;</span> <span>i</span> <span>&lt;</span> <span>range</span><span>[</span><span>1</span><span>]</span><span>;</span> <span>i</span><span>++</span><span>)</span> <span>{</span>
    <span>// Send spoofed emails from Apple to Zendesk</span>
    <span>sendmail</span><span>(</span><span>{</span>
        <span>from</span>: <span>&#39;appleid@id.apple.com&#39;</span><span>,</span>
        <span>to</span>: <span>`support+id<span><span>${</span><span>i</span><span>}</span></span>@company.com`</span><span>,</span>
        <span>cc</span>: <span>&#39;daniel@wearehackerone.com&#39;</span><span>,</span>
        <span>subject</span>: <span>&#39;&#39;</span><span>,</span>
        <span>html</span>: <span>&#39;comment body&#39;</span><span>,</span>
    <span>}</span><span>,</span> <span>function</span> <span>(</span><span>err</span><span>,</span> <span>reply</span><span>)</span> <span>{</span>
        <span>console</span><span>.</span><span>log</span><span>(</span><span>err</span> <span>&amp;&amp;</span> <span>err</span><span>.</span><span>stack</span><span>)</span>
        <span>console</span><span>.</span><span>dir</span><span>(</span><span>reply</span><span>)</span>
    <span>}</span><span>)</span><span>;</span>
<span>}</span><span>;</span></pre></div>
<ol start="4" dir="auto">
<li>Login to a company.com support portal (usually at support.company.com) from your account (<code>daniel@wearehackerone.com</code>) and view your CCed tickets.</li>
<li></li>
</ol>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/60828015/375897466-267284d0-af09-456a-90f1-fa89d93588ab.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjg3ODgyODAsIm5iZiI6MTcyODc4Nzk4MCwicGF0aCI6Ii82MDgyODAxNS8zNzU4OTc0NjYtMjY3Mjg0ZDAtYWYwOS00NTZhLTkwZjEtZmE4OWQ5MzU4OGFiLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDEwMTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQxMDEzVDAyNTMwMFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTA4ZTdlMzVkMWU0NTA5M2IwNGVhMzljNmY3NTE4ZDZhZTEzOWMwNjk5YmY3NGMzMzlmOTYxYjQ4ZmMzODZiODImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.2l-p8DYYbyQC4BToh6x-wzLjmzkMR8IABrYgPPoLZxU"><img width="307" alt="image" src="https://private-user-images.githubusercontent.com/60828015/375897466-267284d0-af09-456a-90f1-fa89d93588ab.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjg3ODgyODAsIm5iZiI6MTcyODc4Nzk4MCwicGF0aCI6Ii82MDgyODAxNS8zNzU4OTc0NjYtMjY3Mjg0ZDAtYWYwOS00NTZhLTkwZjEtZmE4OWQ5MzU4OGFiLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDEwMTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQxMDEzVDAyNTMwMFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTA4ZTdlMzVkMWU0NTA5M2IwNGVhMzljNmY3NTE4ZDZhZTEzOWMwNjk5YmY3NGMzMzlmOTYxYjQ4ZmMzODZiODImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.2l-p8DYYbyQC4BToh6x-wzLjmzkMR8IABrYgPPoLZxU"/></a>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/60828015/375620769-aee5ce24-d805-4f43-bbc3-c57a0454a2c5.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjg3ODgyODAsIm5iZiI6MTcyODc4Nzk4MCwicGF0aCI6Ii82MDgyODAxNS8zNzU2MjA3NjktYWVlNWNlMjQtZDgwNS00ZjQzLWJiYzMtYzU3YTA0NTRhMmM1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDEwMTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQxMDEzVDAyNTMwMFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWQxOGMzNTUxMDQzMTVkNTE3ZDdlOGY0YzZlMDIxNDY3ZmVlM2I0MjVjNzUzNzAxZmMyMDdmYTBjNDI4ZmM1ZTImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.DDI1MHBiK6CNGGI1BEsloyJUPiXwANWmjO1YnZdY20Q"><img src="https://private-user-images.githubusercontent.com/60828015/375620769-aee5ce24-d805-4f43-bbc3-c57a0454a2c5.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjg3ODgyODAsIm5iZiI6MTcyODc4Nzk4MCwicGF0aCI6Ii82MDgyODAxNS8zNzU2MjA3NjktYWVlNWNlMjQtZDgwNS00ZjQzLWJiYzMtYzU3YTA0NTRhMmM1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDEwMTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQxMDEzVDAyNTMwMFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWQxOGMzNTUxMDQzMTVkNTE3ZDdlOGY0YzZlMDIxNDY3ZmVlM2I0MjVjNzUzNzAxZmMyMDdmYTBjNDI4ZmM1ZTImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.DDI1MHBiK6CNGGI1BEsloyJUPiXwANWmjO1YnZdY20Q" alt="image"/></a></p>
<ol start="5" dir="auto">
<li>Enter the verification code in Apple</li>
<li>Use Slack&#39;s &#34;Login with Apple&#34; feature and log in with the Apple account connected to company.com&#39;s email</li>
</ol>
<p dir="auto">I replicated this 6-step reproduction steps across hundreds of vulnerable Zendesk and Slack instances. After getting everything ready, I started individually reporting the bug to companies using Zendesk.</p>

<p dir="auto">I spent about a week reporting the vulnerability to individual companies, some of them took immediate action and patched their instances, while others argued that it was a Zendesk issue. Then, something interesting happened—a comment appeared on my original HackerOne report:</p>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/60828015/375613130-2a887c2c-4d8d-4dc7-b0fe-fb44922a629e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjg3ODgyODAsIm5iZiI6MTcyODc4Nzk4MCwicGF0aCI6Ii82MDgyODAxNS8zNzU2MTMxMzAtMmE4ODdjMmMtNGQ4ZC00ZGM3LWIwZmUtZmI0NDkyMmE2MjllLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDEwMTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQxMDEzVDAyNTMwMFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTEwZGVkMGNiYWEyYzA5YWZmM2U1MzRkZDU0YTRiZmYxNDAyNDdiMTIwOGJlMTg5YWY0MWRhNDQ1MWRiZjQ1YTkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.USxlLQX8Ed-O61rqmjdfw2JgSrKWTisQugVka2OVOqo"><img width="786" alt="image" src="https://private-user-images.githubusercontent.com/60828015/375613130-2a887c2c-4d8d-4dc7-b0fe-fb44922a629e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjg3ODgyODAsIm5iZiI6MTcyODc4Nzk4MCwicGF0aCI6Ii82MDgyODAxNS8zNzU2MTMxMzAtMmE4ODdjMmMtNGQ4ZC00ZGM3LWIwZmUtZmI0NDkyMmE2MjllLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDEwMTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQxMDEzVDAyNTMwMFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTEwZGVkMGNiYWEyYzA5YWZmM2U1MzRkZDU0YTRiZmYxNDAyNDdiMTIwOGJlMTg5YWY0MWRhNDQ1MWRiZjQ1YTkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.USxlLQX8Ed-O61rqmjdfw2JgSrKWTisQugVka2OVOqo"/></a>
<p dir="auto">I couldn’t help but find it amusing—they were now asking me to keep the report confidential, despite having initially dismissed it as out of scope.</p>
<p dir="auto">Some companies must have contacted Zendesk after recieving my report and the pressure from this issue had essentially forced Zendesk’s hand. I hadn’t mentioned the Slack exploit in my original report to them because I hadn’t discovered it at that point, now they wanted full detailed reproduction steps for the Slack takeover.</p>
<p dir="auto">I provided the proof of concept for the Slack vulnerability, and they confirmed the issue. Though they claimed they had &#34;started working&#34; on a fix, it would actually take them over two months to resolve it.</p>

<p dir="auto">Once companies vulnerable to this were alerted to the issue, many of them quickly disabled Zendesk’s email collaboration feature to protect their instances. Over the course of my reporting, I earned more than $50,000 in bounties from individual companies on HackerOne and other platforms.</p>
<p dir="auto">Unsurprisingly, Zendesk didn’t come out of this looking good. At least one or two companies reportedly cut ties with Zendesk after my disclosure, canceling their agreements altogether.</p>
<div dir="auto"><h2 dir="auto">zendesk&#39;s fix (and my $0 bounty)</h2><a id="user-content-zendesks-fix-and-my-0-bounty" aria-label="Permalink: zendesk&#39;s fix (and my $0 bounty)" href="#zendesks-fix-and-my-0-bounty"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">On July 2, 2024—two months after I submitted the report—Zendesk finally confirmed that they had fixed the issue. Here’s a statement from their Offensive Security Leader:</p>
<blockquote>
<p dir="auto">In most cases, when an end user submits a support request by email, the email becomes a new ticket or adds a comment to an existing ticket. However, in certain cases, the email may be suspended. Suspending an email means putting it aside for further review. It&#39;s not necessarily spam. It&#39;s just not a ticket in Zendesk Support yet. It remains in limbo until somebody reviews it and decides whether to accept or reject it.
We use two spam filters, Cloudmark and Rspamd EAP to help determine suspicious characteristics in messages. Depending on the score received by these tools, messages may be suspended. If you are curious, we publish a full list of causes for ticket suspension.
In the attack scenario explained here, Cloudmark had very low spam scores of while RSpamD had very high spam scores; unfortunately we weren’t using the RSpamD score in this case, otherwise many of the emails would have been suspended and limited the ability to add CCs at all. The first fix we implemented was to Automatically switch to RSPAMD spam analysis when:</p>
<ol dir="auto">
<li>Our automatic ticket threading is triggered to thread an new email into a existing ticket and;</li>
<li>We haven’t previously suspended the message due to the Cloudmark score.
In addition to this, we also implemented filters to automatically suspend the following classes of emails:
User verification emails sent by Apple based on the Reply-To and Message-Id header values
Non-transactional emails from from <a href="mailto:googleworkspace-noreply@google.com">googleworkspace-noreply@google.com</a>
Over the coming months, we will continue to look into opportunities to strengthen our Sender Authentication functionality and provide customers with more gradual and advanced security controls over the types of emails that get suspended or rejected.</li>
</ol>
</blockquote>
<p dir="auto">Despite fixing the issue, Zendesk ultimately chose not to award a bounty for my report. Their reasoning? I had broken HackerOne&#39;s disclosure guidelines by sharing the vulnerability with affected companies. I didn’t bother to argue :)</p>

<p dir="auto">What started as a small email bug turned into an exploit that allowed me to infiltrate the internal systems of some of the world’s largest companies. While Zendesk eventually fixed the vulnerability, the journey to get there was a frustrating mix of rejections, slow responses, and ultimately no recognition for the report. But that’s the reality of bug hunting—sometimes you win, sometimes you don’t.</p>
<p dir="auto">If you enjoyed this write-up and want to stay updated on more of my bug hunting adventures, follow me on Twitter/X <a href="https://x.com/hackermondev" rel="nofollow">@hackermondev</a> for future blog posts and insights.</p>
<p dir="auto">read next? <a href="https://x.com/hackermondev/status/1816625357052588539" rel="nofollow">how I stumbled upon a Discord server and left with a $4000 bounty</a></p>
</article>
  </div>

  </div>
</div></div>
  </body>
</html>
