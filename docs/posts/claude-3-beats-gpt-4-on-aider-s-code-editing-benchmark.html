<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://aider.chat/2024/03/08/claude-3.html">Original</a>
    <h1>Claude 3 beats GPT-4 on Aider&#39;s code editing benchmark</h1>
    
    <div id="readability-page-1" class="page"><div id="content" role="main">
      

<p><a href="https://aider.chat/assets/2024-03-07-claude-3.svg"><img src="https://aider.chat/assets/2024-03-07-claude-3.svg" alt="benchmark results"/></a></p>

<p><a href="https://www.anthropic.com/news/claude-3-family">Anthropic just released their new Claude 3 models</a>
with evals showing better performance on coding tasks.
With that in mind, I’ve been benchmarking the new models
using Aider’s code editing benchmark suite.</p>

<p>Claude 3 Opus outperforms all of OpenAI’s models,
making it the best available model for pair programming with AI.</p>

<p>Aider currently supports Claude 3 Opus via
<a href="https://aider.chat/docs/faq.html#accessing-other-llms-with-openrouter">OpenRouter</a>:</p>

<div><div><pre><code># Install aider
pip install aider-chat

# Setup OpenRouter access
export OPENAI_API_KEY=&lt;your-openrouter-key&gt;
export OPENAI_API_BASE=https://openrouter.ai/api/v1

# Run aider with Claude 3 Opus using the diff editing format
aider --model anthropic/claude-3-opus --edit-format diff
</code></pre></div></div>

<h2 id="aiders-code-editing-benchmark">Aider’s code editing benchmark</h2>

<p><a href="https://github.com/paul-gauthier/aider">Aider</a>
is an open source command line chat tool that lets you
pair program with AI on code in your local git repo.</p>

<p>Aider relies on a
<a href="https://aider.chat/docs/benchmarks.html">code editing benchmark</a>
to quantitatively evaluate how well
an LLM can make changes to existing code.
The benchmark uses aider to try and complete
<a href="https://github.com/exercism/python">133 Exercism Python coding exercises</a>.
For each exercise,
Exercism provides a starting python file with stubs for the needed functions,
a natural language description of the problem to solve
and a test suite to evaluate whether the coder has correctly solved the problem.</p>

<p>The LLM gets two tries to solve each problem:</p>

<ol>
  <li>On the first try, it gets the initial stub code and the English description of the coding task. If the tests all pass, we are done.</li>
  <li>If any tests failed, aider sends the LLM the failing test output and gives it a second try to complete the task.</li>
</ol>

<h2 id="benchmark-results">Benchmark results</h2>

<h3 id="claude-3-opus">Claude 3 Opus</h3>

<ul>
  <li>The new <code>claude-3-opus-20240229</code> model got the highest score ever on this benchmark, completing 68.4% of the tasks with two tries.</li>
  <li>Its single-try performance was comparable to the latest GPT-4 Turbo model <code>gpt-4-0125-preview</code>, at 54.1%.</li>
  <li>While Opus got the highest score, it was only a few points higher than the GPT-4 Turbo results. Given the extra costs of Opus and the slower response times, it remains to be seen which is the most practical model for daily coding use.</li>
</ul>

<h3 id="claude-3-sonnet">Claude 3 Sonnet</h3>

<ul>
  <li>The new <code>claude-3-sonnet-20240229</code> model performed similarly to OpenAI’s GPT-3.5 Turbo models with an overall score of 54.9% and a first-try score of 43.6%.</li>
</ul>

<h2 id="code-editing">Code editing</h2>

<p>It’s highly desirable to have the LLM send back code edits as
some form of diffs, rather than having it send back an updated copy of the
entire source code.</p>

<p>Weaker models like GPT-3.5 are unable to use diffs, and are stuck sending back
updated copies of entire source files.
Aider uses more efficient
<a href="https://aider.chat/2023/07/02/benchmarks.html#diff">search/replace blocks</a>
with the original GPT-4
and
<a href="https://aider.chat/2023/12/21/unified-diffs.html#unified-diff-editing-format">unified diffs</a>
with the newer GPT-4 Turbo models.</p>

<p>Claude 3 Opus works best with the search/replace blocks, allowing it to send back
code changes efficiently.
Unfortunately, the Sonnet model was only able to work reliably with whole files,
which limits it to editing smaller source files and uses more tokens, money and time.</p>

<h2 id="other-observations">Other observations</h2>

<p>There are a few other things worth noting:</p>

<ul>
  <li>Claude 3 Opus and Sonnet are both slower and more expensive than OpenAI’s models. You can get almost the same coding skill faster and cheaper with OpenAI’s models.</li>
  <li>Claude 3 has a 2X larger context window than the latest GPT-4 Turbo, which may be an advantage when working with larger code bases.</li>
  <li>The Claude models refused to perform a number of coding tasks and returned the error “Output blocked by content filtering policy”. They refused to code up the <a href="https://exercism.org/tracks/python/exercises/beer-song">beer song</a> program, which makes some sort of superficial sense. But they also refused to work in some larger open source code bases, for unclear reasons.</li>
  <li>The Claude APIs seem somewhat unstable, returning HTTP 5xx errors of various sorts. Aider automatically recovers from these errors with exponential backoff retries, but it’s a sign that Anthropic made be struggling under surging demand.</li>
</ul>



      
    </div></div>
  </body>
</html>
