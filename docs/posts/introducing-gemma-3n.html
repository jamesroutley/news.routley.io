<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://developers.googleblog.com/en/introducing-gemma-3n-developer-guide/">Original</a>
    <h1>Introducing Gemma 3n</h1>
    
    <div id="readability-page-1" class="page"><div>

    
      <section>
        
      </section>
    

    <section>
      
    </section>

    <section>
      
    </section>

    <section>

      <section>
      
        
          
        
          
        

      
      </section>
      
    </section>

    
    <section>
      <div>
          

<div>
    <p data-block-key="0lwbc">The <a href="https://blog.google/technology/developers/gemma-open-models/">first Gemma model</a> launched early last year and has since grown into a thriving <a href="https://deepmind.google/models/gemma/gemmaverse/">Gemmaverse</a> of over 160 million collective downloads. This ecosystem includes our family of over a dozen specialized models for everything from safeguarding to medical applications and, most inspiringly, the countless innovations from the community. From innovators like <a href="https://deepmind.google/models/gemma/gemmaverse/roboflow/">Roboflow</a> building enterprise computer vision to the <a href="https://deepmind.google/models/gemma/gemmaverse/gemma-2-llama-swallow/">Institute of Science Tokyo</a> creating highly-capable Japanese Gemma variants, your work has shown us the path forward.</p><p data-block-key="8lqqe">Building on this incredible momentum, we&#39;re excited to announce the full release of Gemma 3n. While <a href="https://developers.googleblog.com/en/introducing-gemma-3n/">last month&#39;s preview</a> offered a glimpse, today unlocks the full power of this mobile-first architecture. Gemma 3n is designed for the developer community that helped shape Gemma. Itâ€™s supported by your favorite tools including Hugging Face Transformers, llama.cpp, Google AI Edge, Ollama, MLX, and many others, enabling you to fine-tune and deploy for your specific on-device applications with ease. This post is the developer deep dive: we&#39;ll explore some of the innovations behind Gemma 3n, share new benchmark results, and show you how to start building today.</p><h2 data-block-key="5yqtw" id="what&#39;s-new-in-gemma-3n"><b><br/></b>Whatâ€™s new in Gemma 3n?</h2><p data-block-key="10f0e">Gemma 3n represents a major advancement for on-device AI, bringing powerful multimodal capabilities to edge devices with performance previously only seen in last year&#39;s cloud-based frontier models.</p>
</div>    <div>
    <ul><li data-block-key="b4rlm"><b>Multimodal by design:</b> Gemma 3n natively supports image, audio, video, and text inputs and text outputs.</li></ul><ul><li data-block-key="belt8"><b>Optimized for on-device:</b> Engineered with a focus on efficiency, Gemma 3n models are available in two sizes based on <a href="https://developers.googleblog.com/en/introducing-gemma-3n-developer-guide/#per-layer-embeddings-(ple):-unlocking-more-memory-efficiency"><b>effective</b></a> parameters: E2B and E4B. While their raw parameter count is 5B and 8B respectively, architectural innovations allow them to run with a memory footprint comparable to traditional 2B and 4B models, operating with as little as 2GB (E2B) and 3GB (E4B) of memory.</li></ul><ul><li data-block-key="19kb"><b>Groundbreaking architecture:</b> At its core, Gemma 3n features novel components like the MatFormer architecture for compute flexibility, Per Layer Embeddings (PLE) for memory efficiency, and new audio and MobileNet-v5 based vision encoders optimized for on-device use cases.</li></ul><ul><li data-block-key="83m4e"><b>Enhanced quality:</b> Gemma 3n delivers quality improvements across multilinguality (supporting 140 languages for text and multimodal understanding of 35 languages), math, coding, and reasoning. The E4B version achieves an LMArena score over 1300, making it the first model under 10 billion parameters to reach this benchmark.</li></ul>
</div>   


    
    <div>
        <p><img src="https://storage.googleapis.com/gweb-developer-goog-blog-assets/images/Gemma_3n_Chart_1_RD1-V01_1.original.png" alt="LMArena Text Arena Elo Score rankings for Gemini 1.5 Pro, Gemma 3n E4B llama 4 Maverick 17B 128E GPT 4.1-nano and Phi-4"/>
            
            
        </p>
    </div>
  <div>
    <p data-block-key="0lwbc">Achieving this leap in on-device performance required rethinking the model from the ground up. The foundation is Gemma 3nâ€™s unique mobile-first architecture, and it all starts with MatFormer.</p><h2 data-block-key="s4iod" id="matformer:-one-model-many-sizes"></h2><p data-block-key="26ehe">At the core of Gemma 3n is the <a href="https://arxiv.org/abs/2310.07707"><b>MatFormer</b></a><b> (ðŸª†Matryoshka Transformer)</b> <b>architecture</b>, a novel nested transformer built for elastic inference. Think of it like Matryoshka dolls: a larger model contains smaller, fully functional versions of itself. This approach extends the concept of <a href="https://huggingface.co/papers/2205.13147">Matryoshka Representation Learning</a> from just embeddings to all transformer components.</p>
</div>   


    
    <div>
        <p><img src="https://storage.googleapis.com/gweb-developer-goog-blog-assets/images/image1_3h2xBRA.original.jpg" alt="MatFormer in Nano V3"/>
            
            
        </p>
    </div>
  <div>
    <p data-block-key="0lwbc">During the MatFormer training of the 4B effective parameter (E4B) model, a 2B effective parameter (E2B) sub-model is simultaneously optimized within it, as shown in the figure above. This provides developers two powerful capabilities and use cases today:</p><p data-block-key="2r57">1:<b> Pre-extracted models:</b> You can directly download and use either the main E4B model for the highest capabilities, or the standalone E2B sub-model which we have already extracted for you, offering up to 2x faster inference.</p><p data-block-key="dsd6a">2:<b> Custom sizes with Mix-n-Match:</b> For more granular control tailored to specific hardware constraints, you can create a spectrum of custom-sized models between E2B and E4B using a method we call Mix-n-Match. This technique allows you to precisely slice the E4B model&#39;s parameters, primarily by adjusting the feed forward network hidden dimension per layer (from 8192 to 16384) and selectively skipping some layers. We are releasing the <a href="https://goo.gle/gemma3n-matformer-lab">MatFormer Lab</a>, a tool that shows how to retrieve these optimal models, which were identified by evaluating various settings on benchmarks like MMLU.</p>
</div>   


    
    <div>
        <div>
            
                <p><img src="https://storage.googleapis.com/gweb-developer-goog-blog-assets/images/image4_5lfhlBO.original.png" alt="Custom Sizes with Mix-n-Match"/></p><p>
                        MMLU scores for the pre-trained Gemma 3n checkpoints at different model sizes (using Mix-n-Match)
                    </p>
                
            
        </div>
    </div>
  <div>
    <p data-block-key="0lwbc">Looking ahead, the MatFormer architecture also paves the way for<b> elastic execution</b>. While not part of todayâ€™s launched implementations, this capability allows a single deployed E4B model to dynamically switch between E4B and E2B inference paths on the fly, enabling real-time optimization of performance and memory usage based on the current task and device load.</p><h2 data-block-key="9idvm" id="per-layer-embeddings-(ple):-unlocking-more-memory-efficiency"></h2><p data-block-key="2ilaf">Gemma 3n models incorporate <b>Per-Layer Embeddings (PLE)</b>. This innovation is tailored for on-device deployment as it dramatically improves model quality without increasing the high-speed memory footprint required on your device&#39;s accelerator (GPU/TPU).</p><p data-block-key="i1dh">While the Gemma 3n E2B and E4B models have a total parameter count of 5B and 8B respectively, PLE allows a significant portion of these parameters (the embeddings associated with each layer) to be loaded and computed efficiently on the CPU. This means only the core transformer weights (approximately 2B for E2B and 4B for E4B) need to sit in the typically more constrained accelerator memory (VRAM).</p>
</div>   


    
    <div>
        <div>
            
                <p><img src="https://storage.googleapis.com/gweb-developer-goog-blog-assets/images/image6_BdtLmLG.original.jpg" alt="Per-Layer Embeddings"/></p><p>
                        With Per-Layer Embeddings, you can use Gemma 3n E2B while only having ~2B parameters loaded in your accelerator.
                    </p>
                
            
        </div>
    </div>
  <div>
    <h2 data-block-key="atvio" id="kv-cache-sharing:-faster-long-context-processing">KV Cache sharing: Faster long-context processing</h2><p data-block-key="6472b">Processing long inputs, such as the sequences derived from audio and video streams, is essential for many advanced on-device multimodal applications. Gemma 3n introduces KV Cache Sharing, a feature designed to significantly accelerate time-to-first-token for streaming response applications.</p><p data-block-key="1tdep">KV Cache Sharing optimizes how the model handles the initial input processing stage (often called the &#34;prefill&#34; phase). The keys and values of the middle layer from local and global attention are directly shared with all the top layers, delivering a notable 2x improvement on prefill performance compared to Gemma 3 4B. This means the model can ingest and understand lengthy prompt sequences much faster than before.</p><h2 data-block-key="2fwfa" id="audio-understanding:-introducing-speech-to-text-and-translation"></h2><p data-block-key="uijl">Gemma 3n uses an advanced audio encoder based on the <a href="https://arxiv.org/abs/2303.01037">Universal Speech Model (USM)</a>. The encoder generates a token for every 160ms of audio (about 6 tokens per second), which are then integrated as input to the language model, providing a granular representation of the sound context.</p><p data-block-key="dlc74">This integrated audio capability unlocks key features for on-device development, including:</p><ul><li data-block-key="6mapr"><b>Automatic Speech Recognition (ASR):</b> Enable high-quality speech-to-text transcription directly on the device.</li></ul><ul><li data-block-key="caq44"><b>Automatic Speech Translation (AST):</b> Translate spoken language into text in another language.</li></ul><p data-block-key="doduj">We&#39;ve observed particularly strong AST results for translation between English and Spanish, French, Italian, and Portuguese, offering great potential for developers targeting applications in these languages. For tasks like speech translation, leveraging Chain-of-Thought prompting can significantly enhance results. Hereâ€™s an example:</p>
</div>  <div>
    <pre><code>&lt;bos&gt;&lt;start_of_turn&gt;user
Transcribe the following speech segment in Spanish, then translate it into English: 
&lt;start_of_audio&gt;&lt;end_of_turn&gt;
&lt;start_of_turn&gt;model</code></pre>
    <p>
        Plain text
    </p>
    <p><span>Copied</span>
        
    </p>
    
    
</div>  <div>
    <p data-block-key="7ree3">At launch time, the Gemma 3n encoder is implemented to process audio clips up to 30 seconds. However, this is not a fundamental limitation. The underlying audio encoder is a streaming encoder, capable of processing arbitrarily long audios with additional long form audio training. Follow-up implementations will unlock low-latency, long streaming applications.</p><h2 data-block-key="6a3jo" id="mobilenet-v5:-new-state-of-the-art-vision-encoder"><b><br/></b>MobileNet-V5: New state-of-the-art vision encoder</h2><p data-block-key="3r73m">Alongside its integrated audio capabilities, Gemma 3n features a new, highly efficient vision encoder, <b>MobileNet-V5-300M</b>, delivering state-of-the-art performance for multimodal tasks on edge devices.</p><p data-block-key="1qj1b">Designed for flexibility and power on constrained hardware, MobileNet-V5 gives developers:</p><ul><li data-block-key="c1qs0"><b>Multiple input resolutions</b>: Natively supports resolutions of 256x256, 512x512, and 768x768 pixels, allowing you to balance performance and detail for your specific applications.</li></ul><ul><li data-block-key="648dt"><b>Broad visual understanding</b>: Co-trained on extensive multimodal datasets, it excels at a wide range of image and video comprehension tasks.</li></ul><ul><li data-block-key="k1qf"><b>High throughput</b>: Processes up to 60 frames per second on a Google Pixel, enabling real-time, on-device video analysis and interactive experiences.</li></ul><p data-block-key="1a8ge">This level of performance is achieved with multiple architectural innovations, including:</p><ul><li data-block-key="48us4">An advanced foundation of MobileNet-V4 blocks (including Universal Inverted Bottlenecks and Mobile MQA).</li></ul><ul><li data-block-key="12p8">A significantly scaled up architecture, featuring a hybrid, deep pyramid model that is 10x larger than the biggest MobileNet-V4 variant.</li></ul><ul><li data-block-key="73gq1">A novel Multi-Scale Fusion VLM adapter that enhances the quality of tokens for better accuracy and efficiency.</li></ul><p data-block-key="e7u3j">Weâ€™re excited to share more about the work behind this model. Look out for our upcoming MobileNet-V5 technical report, which will deep dive into the model architecture, data scaling strategies, and advanced distillation techniques.</p><p data-block-key="emlv5">Making Gemma 3n accessible from day one has been a priority. We&#39;re proud to partner with many incredible open source developers to ensure broad support across popular tools and platforms, including contributions from teams behind AMD, Axolotl, Docker, Hugging Face, llama.cpp, LMStudio, MLX, <a href="https://developer.nvidia.com/blog/run-google-deepminds-gemma-3n-on-nvidia-jetson-and-rtx/">NVIDIA</a>, Ollama, RedHat, SGLang, Unsloth, and vLLM.</p><p data-block-key="354di">But this ecosystem is just the beginning. The true power of this technology is in what you will build with it. Thatâ€™s why weâ€™re launching the <a href="https://www.kaggle.com/competitions/google-gemma-3n-hackathon">Gemma 3n Impact Challenge.</a> Your mission: use Gemma 3n&#39;s unique on-device, offline, and multimodal capabilities to build a product for a better world. With $150,000 in prizes, we&#39;re looking for a compelling video story and a &#34;wow&#34; factor demo that shows real-world impact. <a href="https://www.kaggle.com/competitions/google-gemma-3n-hackathon">Join the challenge</a> and help build a better future.</p><h2 data-block-key="9i1x0" id="get-started-with-gemma-3n-today"></h2><p data-block-key="9t8b1">Ready to explore the potential of Gemma 3n today? Here&#39;s how:</p><ul><li data-block-key="cvr4m"><b>Experiment directly:</b> Use <a href="https://aistudio.google.com/prompts/new_chat?model=gemma-3n-e4b-it">Google AI Studio</a> to try Gemma 3n in just a couple of clicks. Gemma models can also be deployed directly to Cloud Run from AI Studio.</li></ul><ul><li data-block-key="p04i"><b>Download the models</b>: Find the model weights on<a href="https://huggingface.co/collections/google/gemma-3n-685065323f5984ef315c93f4"> Hugging Face</a> and <a href="https://www.kaggle.com/models/google/gemma-3n">Kaggle</a>.</li></ul><ul><li data-block-key="1va1s"><b>Learn &amp; integrate:</b> Dive into our <a href="https://ai.google.dev/gemma/docs/gemma-3n">comprehensive documentation</a> to quickly integrate Gemma into your projects or start with our inference and fine-tuning guides.</li></ul><ul><li data-block-key="74h3a"><b>Build with your favorite on-device AI tools</b>: <a href="https://github.com/google-ai-edge/gallery">Google AI Edge Gallery/LiteRT-LLM</a>, <a href="https://ollama.com/library/gemma3n">Ollama</a>, <a href="https://huggingface.co/collections/mlx-community/gemma-3n-685d6c8d02d7486c7e77a7dc">MLX</a>, <a href="https://huggingface.co/collections/ggml-org/gemma-3n-685d6fc0843071be9e77b6f7">llama.cpp</a>, Docker, <a href="https://huggingface.co/onnx-community/gemma-3n-E2B-it-ONNX">transformers.js</a> and more.</li></ul><ul><li data-block-key="ebs9n"><b>Use your favorite development tools:</b> Leverage your preferred tools and frameworks, including <a href="https://huggingface.co/blog/gemma3n">Hugging Face Transformers and TRL</a>, <a href="https://github.com/NVIDIA-NeMo">NVIDIA NeMo Framework</a>, <a href="https://unsloth.ai/blog/gemma-3n">Unsloth</a>, and <a href="https://lmstudio.ai/models/google/gemma-3n-e4b">LMStudio</a>.</li></ul><ul><li data-block-key="a9d96"><b>Deploy your way</b>: Gemma 3n offers multiple deployment options, including <a href="https://ai.google.dev/gemma/docs/core/gemma_on_gemini_api">Google GenAI API</a>, <a href="https://console.cloud.google.com/vertex-ai/publishers/google/model-garden/gemma3n">Vertex AI</a>, SGLang, vLLM, and <a href="https://build.nvidia.com/google/gemma-3n-e4b-it">NVIDIA API Catalog</a>.</li></ul>
</div> 
      </div>
    </section>
    

    <section>
      
      
    </section>

    
    
    
  </div></div>
  </body>
</html>
