<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.nature.com/articles/s41598-022-11234-4">Original</a>
    <h1>CandyCodes: Simple unique edible identifiers for authenticating pharmaceuticals</h1>
    
    <div id="readability-page-1" class="page"><div>
            <section aria-labelledby="Abs1" data-title="Abstract" lang="en"><div id="Abs1-section"><h2 id="Abs1">Abstract</h2><p>Counterfeit or substandard medicines adversely affect the health of millions of people and cost an estimated $200 billion USD annually. Their burden is greatest in developing countries, where the World Health Organization estimates that one in ten medical products are fake. In this work, I describe a simple addition to the existing drug manufacturing process that imparts an edible universally unique physical identifier to each pill, tablet, capsule, caplet, etc. This technique uses nonpareils (also called sprinkles and “hundreds and thousands”), tiny inexpensive multicolor candy spheres that are normally added to other candies or desserts as decorations. If nonpareils are applied at random to a pill immediately after manufacture, the specific pattern they form is unlikely to ever be repeated by random chance; this means that the pattern (or “CandyCode”) can be used to uniquely identify the pill and distinguish it from all other pills. By taking a photograph of each CandyCoded pill after manufacture and recording the location and color of each nonpareil, a manufacturer can construct a database containing the CandyCodes of all known-authentic pills they produce. A consumer can then simply use a cellphone to photograph a pill and transfer its image to the manufacturer’s server, which determines whether the pill’s CandyCode matches a known-good CandyCode in their database (meaning that the pill is authentic) or does not have a match in the database (in which case the consumer is warned that the pill may be counterfeit and should not be consumed). To demonstrate the feasibility of using random particles as universal identifiers, I performed a series of experiments using both real CandyCodes (on commercially produced chocolate candies) and simulated CandyCodes (generated by software). I also developed a simple method for converting a CandyCode photo to a set of strings for convenient storage and retrieval in a database. Even after subjecting CandyCodes to rough handling to simulate shipping conditions, the CandyCodes were still easily verifiable using a cellphone camera. A manufacturer could produce at least <span>\(10^{17}\)</span> CandyCoded pills—41 million for each person on Earth—and still be able to uniquely identify each CandyCode. By providing universally-unique IDs that are easy to manufacture but hard to counterfeit, require no alteration of the existing drug formulation and minimal alteration of the manufacturing process, and need only a cameraphone for verification, CandyCodes could play an important role in the fight against fraud in pharmaceuticals and many other products.</p></div></section>
            

                
            
                <section data-title="Introduction"><div id="Sec1-section"><h2 id="Sec1">Introduction</h2><div id="Sec1-content"><p>Every year, an estimated $200 billion USD is wasted on medicines that are counterfeit or substandard. These fake medicines often appear authentic, but they may not contain the specified amounts of active ingredients, or may contain inert (or dangerous) additional ingredients. The problem of adulterated medicines is most acute in the developing world, where the World Health Organization estimates that one in ten medical products are counterfeit or adulterated<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 1" title="World Health Organization. WHO Global Surveillance and Monitoring System for Substandard and Falsified Medical Products (WHO, Geneva, 2017)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR1" id="ref-link-section-d91769923e334">1</a></sup>. When criminals copy or reuse the packaging of authentic brands, fake medicines devalue and erode public trust in those brands. Consequently, legitimate drug makers are keenly interested in defending their brands and protecting the drug distribution chain connecting their factories to consumers.</p><p>Unique identifiers can play an important role in defending the pharmaceutical distribution chain and fighting counterfeit medications. For example, legitimate manufacturers already print unique lot numbers on medication bottles; concerned consumers could contact the manufacturer and confirm that a given bottle’s number corresponds to a known-good lot. However, criminals could thwart this defense by reusing authentic packaging or printing known-good lot numbers on their own fake packaging. Additionally, somewhere along the distribution chain, a criminal could obtain an authentic bottle of medicine, replace the contents with a cheaper substitute, and re-seal the bottle. Finally, since pharmacies commonly dispense medicines in generic containers, an unscrupulous pharmacy could dispense fraudulent medication in bottles with no traceable lot numbers. In each of these scenarios, a unique lot number on drug packaging cannot combat counterfeiting.</p><p>The ideal identifier for combatting drug fraud would be part of the drug product itself, permanently linked to the medicine at every step from manufacturing all the way to the consumer. A consumer could use this on-drug identifier to confirm the authenticity of a drug immediately before taking it. Various versions of on-drug identifiers have been proposed, but each version has shortcomings that have limited its widespread adoption. For example, one technique uses indentations on a drug capsule’s surface to encode an ID, but decoding the ID requires the use of a specialized reader<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 2" title="SofMat Anti-Counterfeiting Solutions. 
                  https://sofmat.com/sequential-marking/
                  
                , (2021)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR2" id="ref-link-section-d91769923e344">2</a></sup>. Another technique prints a unique QR code on each pill, but a microscope is required to read the code<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 3" title="Han, S. et al. Lithographically encoded polymer microtaggant using high-capacity and error-correctable QR code for anti-counterfeiting of drugs. Adv. Mater. 24(44), 5924–5929 (2012)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR3" id="ref-link-section-d91769923e348">3</a></sup>. Other techniques use fluorescent ink<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 4" title="You, M. et al. Three-dimensional quick response code based on inkjet printing of upconversion fluorescent nanoparticles for drug anti-counterfeiting. Nanoscale 8(19), 10096–10104 (2016)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR4" id="ref-link-section-d91769923e352">4</a></sup> or molding<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 5" title="Fei, J. &amp; Liu, R. Drug-laden 3d biodegradable label using qr code for anti-counterfeiting of drugs. Mater. Sci. Eng. C Mater. Biol. Appl. 63, 657–662 (2016)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR5" id="ref-link-section-d91769923e356">5</a></sup> to create on-pill QR codes that can be read using standard smartphone cameras, but integrating these codes into drug products would require a significant modification of the drug manufacturing process. Still other approaches propose printing IDs onto film-based formulations of a drug<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 6" title="Preis, M., Breitkreutz, J. &amp; Sandler, N. Perspective: concepts of printing technologies for oral film formulations. Int. J. Pharm. 494(2), 578–584 (2015)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR6" id="ref-link-section-d91769923e360">6</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 7" title="Edinger, M., Bar-Shalom, D., Sandler, N., Rantanen, J. &amp; Genina, N. QR encoded smart oral dosage forms by inkjet printing. Int. J. Pharm. 536(1), 138–145 (2018)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR7" id="ref-link-section-d91769923e363">7</a></sup>, but this requires a significant reformulation of the drug product. In summary, on-drug identifiers could play a role in combatting fraudulent pharmaceuticals, but problems with existing approaches to on-drug IDs have precluded their widespread adoption.</p><p>Researchers have also shown that random physical patterns can serve as unique IDs. For example, the “physical one-way functions” developed by Ravikanth Pappu et al.<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 8" title="Pappu, R., Recht, B., Taylor, J. &amp; Gershenfeld, N. Physical one-way functions. Science 297(5589), 2026–2030 (2002)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR8" id="ref-link-section-d91769923e370">8</a></sup> consist of small glass particles randomly distributed in a transparent matrix; when laser light shines through the matrix, the optical speckle fluctuations in the transmitted light are unique to that particle pattern and are unlikely to ever be duplicated by chance. Since these “physical one-way functions” are easy to make but very difficult to duplicate, Pappu et al. recognized that they could be used as authentication tokens in cryptographic applications. Later examples of these “physical unclonable functions” or PUFs have used random patterns of molecules, nanotubes, nanoparticles, and other objects to uniquely identify objects<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 9" title="Arppe, R. &amp; Just Sørensen, T. Physical unclonable functions generated through chemical methods for anti-counterfeiting. Nature Rev. Chem. 1(4), 1–13 (2017)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR9" id="ref-link-section-d91769923e374">9</a></sup>. Most recently, Jung Woo Leem et al.<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 10" title="Leem, J. W. et al. Edible unclonable functions. Nat. Commun. 11(1), 328 (2020)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR10" id="ref-link-section-d91769923e378">10</a></sup> demonstrated that fluorescent silk microparticles from genetically engineered silkworms can be distributed randomly in a silk film, then a piece of this silk can be attached to a pill. By imaging the silk-tagged pill using a fluorescence microscope, the microparticle pattern can be read and used to uniquely ID the pill. While these demonstrations confirm that random patterns can be used to uniquely identify a pill, they also require specialized equipment for reading the pill’s ID, equipment like lasers and fluorescence microscopes which are obviously not available to most consumers. This makes existing methods unsuitable for at-home use by an individual wishing to verify the authenticity of a pill before consuming it.</p><p>In this work, I describe a simple addition to the standard pharmaceutical manufacturing process that imparts to each pill a universally unique identifier that can be read using an ordinary cameraphone. This method was inspired by the chocolate candies coated in tiny multicolored candy “nonpareils” shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig1">1</a>. If enough multicolored nonpareils are applied at random to the chocolate, the pattern the nonpareils make can be considered universally unique and unlikely to ever be replicated by chance on another chocolate. Moreover, these patterns are simple to create (simply apply nonpareils at random), but it would be very difficult and time-consuming to duplicate an existing pattern by hand. These properties make multicolored nonpareil coatings (or “CandyCodes”) highly suitable for use as on-drug identifiers for combatting fraudulent pharmaceuticals. As a proof-of-concept, I created both real and simulated CandyCodes and tested their suitability as universally-unique identifiers. My findings suggest that CandyCodes could be a useful tool in the fight against fraudulent medicines.</p><div data-test="figure" data-container-section="figure" id="figure-1" data-title="Figure 1"><figure><figcaption><b id="Fig1" data-test="figure-caption-text">Figure 1</b></figcaption><div><div><a data-test="img-link" data-track="click" data-track-label="image" data-track-action="view figure" href="https://www.nature.com/articles/s41598-022-11234-4/figures/1" rel="nofollow"><picture><source type="image/webp" srcset="//media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Fig1_HTML.png?as=webp"/><img aria-describedby="Fig1" src="https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Fig1_HTML.png" alt="figure 1" loading="lazy" width="685" height="512"/></picture></a></div><p>If enough multicolored particles (like these candy “nonpareils,” top) are randomly attached to objects, the odds of two objects having the same pattern of particles are essentially zero. This means that every candy-coated chocolate (left) is likely unique and one-of-a-kind in the entire world. By attaching the same multicolored candies to pharmaceutical products (like the acetaminophen/paracetamol caplets at right), each pill receives an edible universally unique identifier—a “CandyCode”—that a consumer can use to confirm the authenticity of the product.</p></div></figure></div></div></div></section><section data-title="Results"><div id="Sec2-section"><h2 id="Sec2">Results</h2><div id="Sec2-content"><p>The overall process of using CandyCodes to guarantee the authenticity of a pharmaceutical product is summarized in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig2">2</a>. Each pill is coated in random multicolored candy nonpareils and photographed before leaving the manufacturer. These photographs can be stored in a database as is, or they can be converted to a more-easily-searchable format (a method for converting a CandyCode photo to a set of text-based strings is described later in this work). Either way, a database is created containing CandyCode patterns belonging to known-good pills. When a consumer receives a pharmaceutical product and wishes to check the authenticity of a pill, they merely snap a photograph of the pill using a cellphone and upload it to the manufacturer’s server. The suspect pill’s CandyCode is then compared to the database of known-good CandyCodes. If a close match is found, the consumer is informed that the pill is authentic, but if no matching pattern is found, the consumer is warned that the drug product is not authentic and should be discarded. CandyCodes can be added to existing drug products without having to reformulate the product or significantly alter the manufacturing process, they need no specialized equipment to read, and they would be extremely difficult and time-consuming to duplicate in an attempt to circumvent the security they provide.</p><div data-test="figure" data-container-section="figure" id="figure-2" data-title="Figure 2"><figure><figcaption><b id="Fig2" data-test="figure-caption-text">Figure 2</b></figcaption><div><div><a data-test="img-link" data-track="click" data-track-label="image" data-track-action="view figure" href="https://www.nature.com/articles/s41598-022-11234-4/figures/2" rel="nofollow"><picture><source type="image/webp" srcset="//media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Fig2_HTML.png?as=webp"/><img aria-describedby="Fig2" src="https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Fig2_HTML.png" alt="figure 2" loading="lazy" width="685" height="672"/></picture></a></div><p>Using CandyCodes to authenticate pharmaceuticals. By randomly affixing a number of distinguishable edible particles (in this case, multicolored nonpareil candies) to each pill after manufacturing, a pharmaceutical company gives each pill a universally-unique “CandyCode.” Each CandyCoded pill is photographed before packaging and distribution, and the pattern of particles in each photo is recorded (in this example, the manufacturer converts each photo into a set of text strings using a process detailed later in this work) and stored in a database of known-good CandyCodes. When a consumer receives the drug and wishes to verify its authenticity, the consumer uses their cameraphone to take a photo of a CandyCoded pill and uploads this photo to the manufacturer’s server, which performs the same pattern conversion and searches for a CandyCode with a matching or similar pattern in the database. In this example, Consumer 1’s CandyCoded pill has 27 strings (shown in green) that match the strings of a known-good CandyCoded pill in the manufacturer’s database, so the server informs Consumer 1 that their medication is authentic. However, Consumer 2’s CandyCode strings have no matches in the database of known-good CandyCodes, so Consumer 2’s drug must not have originated in the manufacturer’s facility and is not authentic, and the server warns Consumer 2 not to consume the medication.</p></div></figure></div><h3 id="Sec3">Materials for CandyCodes</h3><p>Some existing drug products take the form of several small drug-containing spheres enclosed in a transparent capsule. Often these drug-containing spheres are a mixture of two or more colors and are clearly visible from the outside of the capsule. For these particular products, if the drug-containing spheres do not move or shift positions inside the capsule, it is possible that the existing visible pattern made by the multicolor drug-containing spheres could already function as an intrinsic CandyCode, and manufacturers could use them as such with no alterations whatsoever to their manufacturing process. However, for drug formulations (like the caplets shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig1">1</a>) that do not contain intrinsic CandyCodes, we can add a CandyCode to the drug using particles.</p><p>In principle, any small edible particles with a variety of discernible appearances (different colors, sizes, shapes, etc.) could be used to create a CandyCode on a pill. In this work, I used commercially produced multicolor nonpareils (also known as “sprinkles” and “hundreds and thousands”<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 11" title="Richardson, T. Sweets: A History of Candy (Bloomsbury, New York, 2002)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR11" id="ref-link-section-d91769923e447">11</a></sup>). Nonpareils come from the manufacturer as a mixture of millimeter-sized candy spheres of different colors. One common variety which was used in this study has eight different sphere colors (each of which is referred to in this work by a single-letter abbreviation as shown): dark blue (D), green (G), light blue (L), orange (O), pink (P), red (R), white (W), and yellow (Y). These nonpareils are available in bulk for around $15 USD per kilogram. At 2.3 milligrams per nonpareil, they cost $0.000 034 5 USD per nonpareil (or 29 000 nonpareils per USD). Additionally, since each nonpareil can have eight different colors, each nonpareil can theoretically encode three binary bits of information (<span>\(2^3 = 8\)</span>), so as a data storage medium, a kilogram of nonpareils could store a theoretical maximum of 1.3 million bits of information.</p><h3 id="Sec4">Adding CandyCodes to drug products</h3><p>To add CandyCodes to a drug product, a manufacturer needs a method for adhering an adequate number of nonpareils to each pill, tablet, capsule, etc. The method needs to maintain the visibility of nonpareils on the surface of the drug (for photography), be safe for human consumption, and survive mechanical agitation during shipping. As a small-scale pilot test, I used a variety of edible adhesives to affix nonpareils to a typical commercial drug product, 500 mg caplets of acetaminophen/paracetamol (brand name Tylenol). These adhesives included commercial “edible adhesives” (often used to attach edible decorations to cakes), melted edible waxes, and melted sugar. The best results (shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig1">1</a> at right) were obtained using two edible adhesives (details in Materials and Methods below). Anecdotally, I found that these “homemade” CandyCoded caplets retained their nonpareil coatings during handling and were actually more pleasant to swallow than plain caplets (confirming Mary Poppins’ classic observation about the relationship between sugar and medicine).</p><p>For actual testing, I wanted to use CandyCodes that were more representative of those that would be produced commercially, not my “homemade” versions. I found that commercially produced nonpareil-coated chocolate candies (shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig1">1</a> at left) provide an excellent substitute for actual CandyCoded drug products. These chocolate candies are inexpensive (roughly $0.007 USD per candy when purchased in bulk), already mass-produced by several manufacturers, and roughly the same size as pills and capsules, so they made reasonable and convenient substitutes for actual mass-produced CandyCoded drugs in this study.</p><h3 id="Sec5">Photographing CandyCodes</h3><p>Once a drug product has received a random coating of nonpareils, the manufacturer must next photograph each CandyCoded pill before packaging. Since many manufacturers already use photographic machine vision systems for quality control purposes, obtaining photographs of CandyCoded drugs should require minimal (if any) alteration to current drug production methods.</p><p>To generate a library of CandyCode photos for testing, I randomly selected 120 nonpareil-coated chocolate candies from a one-pound bag and photographed them. I intentionally photographed the candies in groups (12 candies at a time) using a conventional smartphone camera; this resulted in relatively low-resolution images of each CandyCode (shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig3">3</a>) as might be obtained in a manufacturing facility or by an at-home consumer. I also intentionally used ambient room lighting and made no special effort to create consistent lighting conditions between photographs, although a smartphone’s built-in flash could be used to create consistent lighting for at-home use if necessary<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" title="Oncescu, V., O’Dell, D. &amp; Erickson, D. Smartphone based health accessory for colorimetric detection of biomarkers in sweat and saliva. Lab Chip 13, 3232–3238 (2013)." href="#ref-CR12" id="ref-link-section-d91769923e511">12</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" title="Oncescu, V., Mancuso, M. &amp; Erickson, D. Cholesterol testing on a smartphone. Lab Chip 14, 759–763 (2014)." href="#ref-CR13" id="ref-link-section-d91769923e511_1">13</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" title="Petryayeva, E. &amp; Russ Algar, W. A job for quantum dots: use of a smartphone and 3d-printed accessory for all-in-one excitation and imaging of photoluminescence. Anal. Bioanal. Chem. 408(11), 2913–2925 (2016)." href="#ref-CR14" id="ref-link-section-d91769923e511_2">14</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" title="Wang, Y. et al. Smartphone spectrometer for colorimetric biosensing. Analyst 141, 3233–3238 (2016)." href="#ref-CR15" id="ref-link-section-d91769923e511_3">15</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" title="Özdemir, G. K., Bayram, A., Kılıç, V., Horzum, N. &amp; Solmaz, M. E. Smartphone-based detection of dyes in water for environmental sustainability. Anal. Methods 9, 579–585 (2017)." href="#ref-CR16" id="ref-link-section-d91769923e511_4">16</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" title="Paterson, A. S. et al. A low-cost smartphone-based platform for highly sensitive point-of-care testing with persistent luminescent phosphors. Lab Chip 17, 1051–1059 (2017)." href="#ref-CR17" id="ref-link-section-d91769923e511_5">17</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 18" title="Woodburn, E. V., Long, K. D. &amp; Cunningham, B. T. Analysis of paper-based colorimetric assays with a smartphone spectrometer. IEEE Sens. J. 19(2), 508–514 (2019)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR18" id="ref-link-section-d91769923e514">18</a></sup>.</p><p>The 120 CandyCodes in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig3">3</a> have between 72 and 108 nonpareils per CandyCode, with an average number of 92.6 nonpareils per CandyCode and a median number of 94 nonpareils per CandyCode.</p><div data-test="figure" data-container-section="figure" id="figure-3" data-title="Figure 3"><figure><figcaption><b id="Fig3" data-test="figure-caption-text">Figure 3</b></figcaption><div><div><a data-test="img-link" data-track="click" data-track-label="image" data-track-action="view figure" href="https://www.nature.com/articles/s41598-022-11234-4/figures/3" rel="nofollow"><picture><source type="image/webp" srcset="//media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Fig3_HTML.png?as=webp"/><img aria-describedby="Fig3" src="https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Fig3_HTML.png" alt="figure 3" loading="lazy" width="685" height="1299"/></picture></a></div><p>Photographs of 120 candies used to create a test library of CandyCodes. These commercially produced candies were used as proxies for actual CandyCoded medications. Each chocolate candy is coated by the manufacturer with an eight-color mixture of nonpareil spheres; the candies shown here received between 72 and 108 nonpareils each, with an average of 92.6 nonpareils per candy. Each CandyCode photo was converted to a set of strings using the process described in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig4">4</a> and analyzed to determine its uniqueness. Additionally, three of these CandyCodes (numbers 103, 104, and 109) were selected at random and subjected to one week of physical abuse to determine if mechanical wear sustained during shipping could affect the information content of CandyCodes.</p></div></figure></div><h3 id="Sec6">Creating a database of known-good CandyCodes</h3><p>In the next step, the CandyCodes need to be stored in a database for later querying by consumers wishing to verify the authenticity of their CandyCoded medicines. There are many different ways in which this database of known-good CandyCodes could be constructed. Perhaps the most obvious approach would be simply saving the raw CandyCode photos taken by the manufacturer on the production line. When a consumer uploads a photo of a suspect CandyCoded medicine, image similarity algorithms could be used to determine whether there is a match in the database of known-good CandyCode photos. This approach would require a manufacturer to digitally store large numbers of CandyCode photos, but based on the file sizes of the photos used in this study (about 2.7 MB for each photo of 12 CandyCodes, or about 200 kB per CandyCode), a single TB-size hard drive could store millions of CandyCode photos. As image similarity algorithms grow more sophisticated, this raw-image-based approach could be a powerful way to build and query a CandyCode database.</p><p>Another approach to building a database of known-good CandyCodes would rely upon converting the CandyCode image into standard binary data. This is how one-dimensional barcodes (like EAN/UPC codes<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 19" title="ISO. 15420:2009 Information technology: automatic identification and data capture techniques: EAN/UPC bar code symbology specification. Technical report, (2009)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR19" id="ref-link-section-d91769923e557">19</a></sup>) and two-dimensional barcodes (like QR codes<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 20" title="ISO. 18004:2015 Information technology: automatic identification and data capture techniques: QR Code bar code symbology specification. Technical report, (2015)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR20" id="ref-link-section-d91769923e561">20</a></sup>) work: a pattern of lines or pixels is decoded to binary data, often interpreted as alphanumeric text. With an average of around 93 nonpareils per CandyCode and 8 different colors per nonpareil, a CandyCode could theoretically encode <span>\(\log _2 8^{93} = 279\)</span> bits of information. How likely is it that a random 279-bit code could ever be repeated by chance? For comparison, digital “version 4” universally-unique identifiers (UUIDs) commonly used in computing have just 122 random bits<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 21" title="Leach, P. J., Salz, R. &amp; Mealling, M. H. A Universally Unique Identifier (UUID) URN Namespace (RFC 4122, 2005)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR21" id="ref-link-section-d91769923e601">21</a></sup>, and programmers take it for granted that these digital UUIDs will never repeat in normal applications. Thus, a 93-nonpareil CandyCode encoding 279 random bits—more than double the bits of a digital UUID—should easily serve as a physical UUID that will never be duplicated by random chance.</p><p>However, this analysis ignores a crucial difference between barcodes and CandyCodes: barcodes have well-defined structures, like regularly spaced lines or regular grids of pixels, and these structures greatly facilitate their decoding. In other words, each line or pixel in a barcode has a well-defined location, and by reading the lines or pixels at each location, barcodes can easily be decoded and converted into binary information. In contrast, CandyCodes cannot be decoded using a simple barcode-like method because, unlike the lines or pixels in a barcode, the nonpareils in a CandyCode are placed in random locations. This random placement is useful—it makes CandyCodes easy to produce and difficult to counterfeit—but it also complicates the process of converting CandyCodes into a binary representation.</p><p>That being said, close inspection of CandyCodes like those in Figs. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig1">1</a> and <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig3">3</a> reveals patterns that can be used for imparting some local structure to the nonpareil locations, structure that can be useful for decoding CandyCodes. In particular, spherical nonpareils tend to pack onto the flat surface of a pill in a hexagonal pattern, at least in some local areas. This hexagonal pattern lets us identify the nonpareil “neighbors” (usually six of them) that are closest to a given nonpareil. And over larger areas, where the curvature of the pill surface influences the packing of the nonpareils, the patterns start resembling those encountered by mathematicians studying spherical codes and the so-called “Tammes problem”<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 22" title="Delsarte, P., Goethals, J. M. &amp; Seidel, J. J. Spherical Codes and Designs. In Geometry and Combinatorics (eds Corneil, D. G. &amp; Mathon, R.) 68–93 (Academic Press, 1991)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR22" id="ref-link-section-d91769923e617">22</a></sup>. Local structures like these make it possible to create reasonably robust algorithms for reproducibly identifying “neighborhoods” of nonpareils on the CandyCode. If each neighborhood could be converted to a binary representation, then a CandyCode could be decoded even if it has no overall regular structure.</p><p>To test this idea, I wrote a Python program (available in this project’s GitHub repository<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 23" title="Grover, W.H. Candycodes: simple universally unique edible identifiers for confirming the authenticity of pharmaceuticals. 
                  https://github.com/groverlab/candycodes
                  
                , (2022)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR23" id="ref-link-section-d91769923e625">23</a></sup>) that converts a CandyCode photograph into a set of binary text strings. Figure <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig4">4</a> illustrates the individual steps required to convert a specific randomly chosen CandyCode (number 44 from Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig3">3</a>) into a set of strings. In Step 1 of Figure <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig4">4</a>, the program records the location (in Cartesian coordinates) and color (using the single-letter abbreviations from &#34;<a data-track="click" data-track-label="link" data-track-action="section anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Sec3">Materials for CandyCodes</a>&#34; Section) of each of the 94 nonpareils visible in the CandyCode photo. These nonpareil coordinates are treated like vertices in a graph. Two vertices in this graph are considered connected by an edge if the corresponding two nonpareils are physically located close enough to be considered “neighbors.” To identify these neighbors, the code calculates the Delaunay triangulation<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 24" title="Delaunay, B. N. Sur la sphère vide. Bull. Acad. Sci. URSS 1934(6), 793–800 (1934)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR24" id="ref-link-section-d91769923e642">24</a></sup> of the nonpareil vertices using an implementation of the Quickhull algorithm<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 25" title="BradfordBarber, C., Dobkin, D. P. &amp; Huhdanpaa, H. The Quickhull algorithm for convex hulls. ACM Trans. Math. Softw. (TOMS) 22(4), 469–483 (1996)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR25" id="ref-link-section-d91769923e646">25</a></sup> in SciPy<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 26" title="Virtanen, P. et al. SciPy 10: fundamental algorithms for scientific computing in Python. Nature Meth. 17, 261–272 (2020)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR26" id="ref-link-section-d91769923e650">26</a></sup>. In the resulting graph (shown in Step 2 of Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig4">4</a>), two vertices connected by an edge are considered neighboring nonpareils.
</p><div data-test="figure" data-container-section="figure" id="figure-4" data-title="Figure 4"><figure><figcaption><b id="Fig4" data-test="figure-caption-text">Figure 4</b></figcaption><div><div><a data-test="img-link" data-track="click" data-track-label="image" data-track-action="view figure" href="https://www.nature.com/articles/s41598-022-11234-4/figures/4" rel="nofollow"><picture><source type="image/webp" srcset="//media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Fig4_HTML.png?as=webp"/><img aria-describedby="Fig4" src="https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Fig4_HTML.png" alt="figure 4" loading="lazy" width="685" height="711"/></picture></a></div><p>Converting a photograph of a CandyCode (number 44 from Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig3">3</a>) into a set of strings suitable for storage and querying in a database. In Step 1, the locations and colors of all visible nonpareils are recorded. In Step 2, the nonpareil locations and colors are interpreted as vertices on a graph, and the Delaunay triangulation<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" title="Delaunay, B. N. Sur la sphère vide. Bull. Acad. Sci. URSS 1934(6), 793–800 (1934)." href="#ref-CR24" id="ref-link-section-d91769923e670">24</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" title="BradfordBarber, C., Dobkin, D. P. &amp; Huhdanpaa, H. The Quickhull algorithm for convex hulls. ACM Trans. Math. Softw. (TOMS) 22(4), 469–483 (1996)." href="#ref-CR25" id="ref-link-section-d91769923e670_1">25</a>,<a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 26" title="Virtanen, P. et al. SciPy 10: fundamental algorithms for scientific computing in Python. Nature Meth. 17, 261–272 (2020)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR26" id="ref-link-section-d91769923e673">26</a></sup> of these vertices connects neighboring nonpareils via the edges on the graph. Next, for each nonpareil and its immediate neighbors, the colors of each nonpareil and their arrangement around the central nonpareil are used to create a text string. Step 3 shows three example string conversions, for the nonpareil neighborhoods marked with “<span>\(\star \)</span>,” “<img src="https://media.springernature.com/lw8/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Figa_HTML.gif" alt=""/>&#39;&#39; and “<img src="https://media.springernature.com/lw5/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Figb_HTML.gif" alt=""/>” in each step (details in main text). In Step 4, any low-quality strings (<i>e.g.,</i> those containing too-few different colors or located on the edge of the graph) are discarded. The remaining set of 53 strings represents this CandyCode, and this set is saved to the database of known-good CandyCodes. This process is repeated for every CandyCoded pill before leaving the manufacturer. When a consumer photographs a CandyCoded product and submits the photo for analysis, this process is repeated using the consumer’s photo, and the resulting set of strings is compared with the database of known-good string sets. If a known-good CandyCode is found that contains many of the same strings as the user’s CandyCode, then the user likely has an authentic product.</p></div></figure></div><p>Next, each nonpareil and its immediate neighbors are converted to a text string. For a specific example of this process, find the pink nonpareil marked with “<span>\(\star\)</span>” in the left-of-center region of CandyCode 44 in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig4">4</a> Step 1. This pink nonpareil has six neighboring nonpareils: two white nonpareils to the left, one dark blue nonpareil above, a green and red nonpareil to the right, and another pink nonpareil below. Now examine the Delaunay triangulation of this CandyCode in Step 2 of Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig4">4</a>. The original pink nonpareil’s vertex (again marked “<span>\(\star\)</span>” in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig4">4</a> Step 2) is connected to six other vertices; these correspond to the pink nonpareil’s six neighboring nonpareils. A closeup showing just the pink nonpareil’s vertex and its six neighboring vertices is shown in Step 3 of Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig4">4</a>. To convert this neighborhood of nonpareils to a text string, we start with the single-letter abbreviation of the central nonpareil’s color: P for pink. Next, we sort the single-letter abbreviations of the six connected nonpareils by alphabetical order. The D (dark blue) nonpareil at the top comes first in alphabetical order, so D is added to the string. The remaining neighboring nonpareils are added to the string by moving clockwise around the neighborhood, first to G, then R, then P, then W, and finally the second W. There are no more neighboring nonpareils to add, so the string is complete: PDGRPWW is the string representation of the neighborhood centered on the nonpareil marked “<span>\(\star\)</span>.”</p><p>For neighborhoods in which there are two or more surrounding nonpareils of the same color coming first in alphabetical order, the code sorts the two or more following vertices by alphabetical order and uses this order to select the next letter for the string. For example, consider the neighborhood centered on the white nonpareil (W) marked with &#39;&#39;<img src="https://media.springernature.com/lw8/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Figc_HTML.gif" alt=""/>&#39;&#39;  in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig4">4</a> Step 3. The string representation of this neighborhood starts with W. Sorting the surrounding nonpareils by alphabetical order reveals that the next letter will be a G, but it is unclear whether this corresponds to the green nonpareil at the top or the second green nonpareil on the bottom. To determine which green nonpareil should come next in the string, the code examines the nonpareils following each green nonpareil moving clockwise. The letter following the top green nonpareil, W, comes earlier in alphabetical order than the letter following the bottom nonpareil, Y. Thus, the top G is chosen as the next letter in the string, the remaining letters are added in the usual clockwise order, and the final string representation for the neighborhood marked “<img src="https://media.springernature.com/lw8/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Figd_HTML.gif" alt=""/>” is WGWWGY.</p><p>The number of letters in each string is determined by the number of nonpareils in each neighborhood. Many neighborhoods (like the one centered on the nonpareil marked “<span>\(\star\)</span>” in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig4">4</a>) yield seven-letter strings; this is the number predicted by hexagonal packing of spheres as described earlier. However, other string sizes are possible, including smaller strings (like the six-letter string resulting from the neighborhood centered on the nonpareil marked <img src="https://media.springernature.com/lw8/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Fige_HTML.gif" alt=""/> in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig4">4</a>) and larger strings (like the eight-letter string resulting from the neighborhood centered on the nonpareil marked “<img src="https://media.springernature.com/lw5/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Figf_HTML.gif" alt=""/>” in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig4">4</a>).</p><p>After using this process to convert each nonpareil and its neighbors to a text string as shown in Step 4 of Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig4">4</a>, the code discards certain low-quality strings. For example, vertices at the edge of the Delaunay triangulation graph naturally have fewer neighbors, which gives these vertices shorter strings that are more likely to be found repeated in other CandyCodes; discarding these short strings reduces the frequency of “false positives” when searching the database of known-good CandyCodes. Another discard criterion was created in response to an unexpected oddity of the chocolate candies used as substitutes for CandyCoded drugs in this study: I found that white nonpareils appear on these candies almost five times more often than any other color. In fact, 41.5% of the nonpareils are white, with the remaining seven colors present at only 7.3% to 8.1% each (details in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig7">7</a>). These excess white nonpareils were undoubtedly added intentionally by the manufacturer, but they also have the unfortunate effect of reducing the diversity of letters in the CandyCode strings (nearly half of the letters are W) and again increasing the likelihood of “false positive” strings that appear in multiple CandyCodes. So to eliminate strings with excessive Ws, the code discards strings with fewer than four different colors (like the one marked “<img src="https://media.springernature.com/lw8/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Figg_HTML.gif" alt=""/>” in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig4">4</a>). In this example, the 94 nonpareils in CandyCode 44 were converted into 94 strings, 41 of which were discarded as low-quality, leaving 53 good strings (shown in the list in Step 4 of Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig4">4</a>) that represent this CandyCode in the database of known-good CandyCodes.</p><p>This process was repeated for each of the 120 CandyCode images in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig3">3</a>. My proof-of-concept analysis code converted all 120 CandyCodes into string lists in 1.5 seconds on a conventional desktop computer, or about 12.5 milliseconds per CandyCode. On average, there were 52.8 good strings per CandyCode. The CandyCode with the smallest number of strings was CandyCode 30, which had just 19 good strings. This is significantly fewer strings than the other CandyCodes, so I examined CandyCode 30 to determine why it stored considerably less information than the other CandyCodes in the test library. I found that CandyCode 30 had an even higher excess of white nonpareils than the other CandyCodes: 55.6% of CandyCode 30’s nonpareils were white, compared to an average of 41.5% white across all 120 CandyCodes. With over half of CandyCode 30’s nonpareils the same color, my algorithm unsurprisingly discarded 44 of the CandyCode’s strings for having fewer than four different colors. Additionally, CandyCode 30 had only 81 total nonpareils, compared to an average of 92.6 nonpareils across all 120 CandyCodes; this gave CandyCode 30 fewer potential strings to begin with. The combination of these two deficiencies—low color diversity and a small nonpareil count—meant that CandyCode 30 had only a third as many strings as the average CandyCode. Both of these deficiencies could easily be eliminated by using equal amounts of each nonpareil color (as discussed later) and ensuring that all CandyCodes receive at least a minimum number of nonpareils.</p><p>In contrast, the CandyCode with the largest number of strings was CandyCode 70, which had 73 good strings. This CandyCode had a more diverse selection of colors, with only 36.6% of its nonpareils being white (this is still an excess of white nonpareils, but a smaller excess than the average of 41.5% white). Additionally, CandyCode 70 has a larger-than-average number of nonpareils (101, compared to the average of 92.6). These advantages combine to make CandyCode 70 the most information-rich of all 120 CandyCodes in the test library.</p><h3 id="Sec7">Assessing the uniqueness of CandyCode strings</h3><p>Normally, once a manufacturer converts a CandyCode photo to a set of strings and adds the set to their database of known-good CandyCodes, a consumer would then take their own photo of the CandyCode and upload it to the manufacturer’s server for analysis and comparison with the database. But before testing a consumer-like interaction with the database, I wanted to determine how different the database’s CandyCodes were when compared with each other. Specifically, I examined all pairwise combinations of the 120 CandyCodes to determine how many strings the CandyCodes had in common.</p><p>Out of the 7140 possible pairwise comparisons among the 120 CandyCodes in the test library:</p><ul>
                  <li>
                    <p>6811 CandyCode pairs (95.4%) had 0 strings in common</p>
                  </li>
                  <li>
                    <p>326 CandyCode pairs (4.56%) had 1 string in common</p>
                  </li>
                  <li>
                    <p>3 CandyCode pairs (0.04%) had 2 strings in common</p>
                  </li>
                </ul><p>and no CandyCode pairs had more than 2 strings in common. Stated differently, these results mean that if you choose two CandyCodes at random from the library, over 95% of the time the two codes will have no strings in common. Of the small fraction of CandyCode pairs that do have strings in common, the vast majority have only a single string shared between the CandyCodes. Note that this is a single shared string among the over 100 combined strings (on average) from both CandyCodes. Finally, an extremely small number of CandyCode pairs (less than one in 2000) have two shared strings. These results show that while repeated strings sometimes appear between two CandyCodes, they are vastly outnumbered by strings that are unique to a single CandyCode, at least for this small-scale test library. Finally, my proof-of-concept analysis code completed all 7140 pairwise comparisons of the 120 CandyCodes in about 2.6 seconds on a conventional desktop computer, or about 360 microseconds per comparison.</p><h3 id="Sec8">Searching for suspect CandyCodes in the known-good database</h3><p>Next, to test the experience of consumers using CandyCodes to confirm the authenticity of their medicines, I selected three of the 120 CandyCoded chocolates at random (numbers 103, 104, and 109) and photographed them again (Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig5">5</a>A). I made no special effort to reproduce the lighting, orientation, or other aspects of the original photos. I then converted these new “suspect” CandyCode photos to string sets as described above, and searched for matching strings in the database of known-good CandyCodes. The results are as follows:</p><ul>
                  <li>
                    <p><b>Suspect CandyCode 103</b> had:</p><ul>
                      <li>
                        <p>32 strings in common with known-good CandyCode 103</p>
                      </li>
                      <li>
                        <p>1 string in common with 9 other CandyCodes</p>
                      </li>
                      <li>
                        <p>0 strings in common with the remaining 110 CandyCodes</p>
                      </li>
                    </ul>
                  </li>
                  <li>
                    <p><b>Suspect CandyCode 104</b> had:</p><ul>
                      <li>
                        <p>30 strings in common with known-good CandyCode 104</p>
                      </li>
                      <li>
                        <p>1 string in common with 7 other CandyCodes</p>
                      </li>
                      <li>
                        <p>0 strings in common with the remaining 112 CandyCodes</p>
                      </li>
                    </ul>
                  </li>
                  <li>
                    <p><b>Suspect CandyCode 109</b> had:</p><ul>
                      <li>
                        <p>23 strings in common with known-good CandyCode 109</p>
                      </li>
                      <li>
                        <p>2 strings in common with 1 other CandyCode</p>
                      </li>
                      <li>
                        <p>1 string in common with 3 other CandyCodes</p>
                      </li>
                      <li>
                        <p>0 strings in common with the remaining 115 CandyCodes.</p>
                      </li>
                    </ul>
                  </li>
                </ul><p>In other words, the suspect CandyCode photos had an average of 28 strings in common with their corresponding photos in the known-good database; this proves that the suspect CandyCodes have matches in the known-good database and are therefore authentic. In addition, the suspect CandyCodes had zero strings in common with most of the non-matching CandyCodes in the database, and never had more than 2 strings in common with non-matching CandyCodes.</p><div data-test="figure" data-container-section="figure" id="figure-5" data-title="Figure 5"><figure><figcaption><b id="Fig5" data-test="figure-caption-text">Figure 5</b></figcaption><div><div><a data-test="img-link" data-track="click" data-track-label="image" data-track-action="view figure" href="https://www.nature.com/articles/s41598-022-11234-4/figures/5" rel="nofollow"><picture><source type="image/webp" srcset="//media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Fig5_HTML.png?as=webp"/><img aria-describedby="Fig5" src="https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Fig5_HTML.png" alt="figure 5" loading="lazy" width="685" height="188"/></picture></a></div><p>To replicate the experience of a consumer interacting with CandyCoded medications, three CandyCodes from the test library of 120 chocolate-based CandyCodes shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig3">3</a> were selected at random and photographed again <b>(A)</b>. These “suspect” CandyCode photos were converted to sets of strings using the process described in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig4">4</a> and compared with the library of known-good CandyCodes. The matching CandyCodes were found in the library, proving that these “suspect” CandyCodes are indeed authentic (details in the text in &#34;<a data-track="click" data-track-label="link" data-track-action="section anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Sec8">Searching for suspect CandyCodes in the known-good database</a>&#34; Section). To test whether shipping-induced damage might adversely affect CandyCoded medicines, the same three CandyCodes were added to medicine bottles containing commercial pharmaceutical tablets and capsules <b>(B)</b>, and the CandyCodes were then subjected to extreme physical abuse by tumbling the bottles in a modified rock tumbler nonstop for one week. The CandyCodes were then removed from the bottles and photographed again <b>(C)</b>, and the photographs were again converted to sets of strings. Even after undergoing physical abuse far greater than that experienced by pharmaceuticals during conventional shipping, the CandyCodes could still be matched with their entries in the library of known-good CandyCodes to confirm their authenticity (details in the text in &#34;<a data-track="click" data-track-label="link" data-track-action="section anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Sec9">Verifying CandyCodes after physical abuse</a>&#34; Section).</p></div></figure></div><p>While there are many strings in common between the “suspect” photo and the “known-good” photo of the same CandyCode, the string sets are not identical between the pairs of photos. Specifically, CandyCode 103’s photos had 32 matching strings out of 53 (or 60% of the strings matching), CandyCode 104 had 30 matching strings out of 49 (61% matching), and CandyCode 109 had 23 matching strings out of 57 (40% matching). Stated differently, two photos of the same CandyCode do not always result in the exact same set of strings. This can be attributed to the process used to convert CandyCode photos to string sets. In particular, the Delaunay triangulation (which is used to identify neighboring nonpareils) is very sensitive to the angles formed between nearby nonpareils, angles that could vary in different photographs taken from slightly different vantage points. But even though different photos of the same CandyCode have only about half of their strings in common, this is still more than enough shared strings to determine that the CandyCodes are the same.</p><h3 id="Sec9">Verifying CandyCodes after physical abuse</h3><p>CandyCodes use nonpareils attached to a pill to impart a unique identifier to the pill. These attached nonpareils make CandyCoded medicines easier to produce compared to anti-counterfeiting measures that require reformulation of a drug product. But if the nonpareils are not firmly affixed to the medication, they could become detached during the mechanical agitation that might accompany shipping and distributing the product. If enough nonpareils are lost, a consumer’s CandyCoded medication might no longer match the manufacturer’s record of that CandyCode, and the consumer would be told that the product is fraudulent when in fact it is authentic.</p><p>To examine the likelihood of CandyCoded medications sustaining damage during shipping, I took the same three chocolate-based CandyCodes examined in the previous section (numbers 103, 104, and 109) and subjected them to physical abuse far in excess of that which pharmaceuticals would normally receive. Each CandyCode was placed in its own standard pill bottle accompanied by assorted commercial medications (tablets and capsules) as shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig5">5</a>B. To intentionally maximize the mechanical stresses on the CandyCodes, the bottles were not fully filled and the CandyCodes were free to rattle and collide with the pills. The pill bottles were then placed into a modified rock tumbler and subjected to constant tumbling for one full week. The tumbler inverted the pill bottles once every two seconds, or over 300 000 inversions over the course of the experiment; this is far greater physical abuse than pharmaceuticals normally experience in <i>e.g.</i> a bottle (which usually contains cotton batting to fill empty space and keep pills from bumping against each other) or a blister pack (which physically separates pills from each other). After a week of tumbling, the CandyCodes were removed from the bottles and photographed again (Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig5">5</a>C), and each CandyCode photo was converted to a set of strings as described above. Finally, I compared these post-tumbling CandyCode strings to the original library of 120 CandyCodes to determine if the CandyCodes that underwent extreme physical abuse could still be identified in the library.</p><p>The results show that physical abuse had little effect on the appearance or function of the CandyCodes. Close comparison of the before and after photos in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig5">5</a> show that a couple of CandyCode 109’s nonpareils were chipped during a week of constant agitation, but the colors of these nonpareils were still recognizable. Converting the photos of the physically abused CandyCodes to string sets and comparing them with the original 120-CandyCode library had these results:</p><ul>
                  <li>
                    <p><b>Physically abused CandyCode 103</b> had:</p><ul>
                      <li>
                        <p>27 strings in common with known-good CandyCode 103</p>
                      </li>
                      <li>
                        <p>1 string in common with 9 other CandyCodes</p>
                      </li>
                      <li>
                        <p>0 strings in common with the remaining 110 CandyCodes</p>
                      </li>
                    </ul>
                  </li>
                  <li>
                    <p><b>Physically abused CandyCode 104</b> had:</p><ul>
                      <li>
                        <p>21 strings in common with known-good CandyCode 104</p>
                      </li>
                      <li>
                        <p>1 string in common with 8 other CandyCodes</p>
                      </li>
                      <li>
                        <p>0 strings in common with the remaining 111 CandyCodes</p>
                      </li>
                    </ul>
                  </li>
                  <li>
                    <p><b>Physically abused CandyCode 109</b> had:</p><ul>
                      <li>
                        <p>27 strings in common with known-good CandyCode 109</p>
                      </li>
                      <li>
                        <p>1 string in common with 2 other CandyCodes</p>
                      </li>
                      <li>
                        <p>0 strings in common with the remaining 117 CandyCodes.</p>
                      </li>
                    </ul>
                  </li>
                </ul><p>Comparing these results to the pre-abuse results for the same CandyCodes in the previous section, we see that after significant physical abuse, two CandyCodes had small decreases in the number of strings shared with the same CandyCode in the known-good database (CandyCode 103’s string matches dropped from 32 to 27, and CandyCode 104’s string matches dropped from 30 to 21), and one CandyCode actually had a small increase in the number of matching strings (CandyCode 109’s matches rose from 23 to 27). In light of these seemingly random changes, I attributed the changes to variations in the Delaunay triangulation from different photos of the same CandyCode as described earlier, not effects of physical abuse. Since these CandyCodes were virtually unchanged and still functional after this significant physical abuse, it is highly likely that commercially-produced CandyCodes would survive the much-less-severe stresses that accompany conventional shipping.</p><h3 id="Sec10">Simulating CandyCode libraries</h3><p>The experiments described above used a test library of just 120 CandyCodes. In real-world applications involving a commercial pharmaceutical, the library of CandyCodes would be far larger. To explore larger CandyCode libraries without using enormous numbers of chocolate candies, I created a Python-based simulator (available on this project’s GitHub repository<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 23" title="Grover, W.H. Candycodes: simple universally unique edible identifiers for confirming the authenticity of pharmaceuticals. 
                  https://github.com/groverlab/candycodes
                  
                , (2022)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR23" id="ref-link-section-d91769923e1169">23</a></sup>) that generates CandyCodes on a computer. The simulator replicates real CandyCode production by randomly placing small non-overlapping circles of different colors (the nonpareils) onto a larger circular area (the pill). The user can also specify the number of nonpareils per CandyCode, the number and probability of nonpareil colors, and the total number of CandyCodes to generate. The simulated CandyCodes are then subjected to the same analysis as the test library above, including conversion to string sets and analysis for matching strings between pairs of CandyCodes. Finally, this entire process was repeated 100 times for each set of simulation parameters, and the results were collected for statistical analysis.</p><p>To test the CandyCode simulator, I first used it to replicate the results of the experimental 120-CandyCode test library described above. Each of the 120 simulated CandyCodes had 94 nonpareils (the median number of nonpareils per CandyCode in the test library). The simulated nonpareil color frequency also matched the test library, with white nonpareils appearing five times more frequently than the other individual colors. After simulating and analyzing the 120-CandyCode library 100 separate times, I found that the largest number of strings shared between any two different CandyCodes in a library was 2.26 on average. This result is consistent with the experiments in &#34;<a data-track="click" data-track-label="link" data-track-action="section anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Sec7">Assessing the uniqueness of CandyCode strings</a>&#34; Section above, which found no more than 2 shared strings among the 120 real (chocolate-based) CandyCodes.</p><div data-test="figure" data-container-section="figure" id="figure-6" data-title="Figure 6"><figure><figcaption><b id="Fig6" data-test="figure-caption-text">Figure 6</b></figcaption><div><div><a data-test="img-link" data-track="click" data-track-label="image" data-track-action="view figure" href="https://www.nature.com/articles/s41598-022-11234-4/figures/6" rel="nofollow"><picture><source type="image/webp" srcset="//media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Fig6_HTML.png?as=webp"/><img aria-describedby="Fig6" src="https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Fig6_HTML.png" alt="figure 6" loading="lazy" width="685" height="335"/></picture></a></div><p>Results from analyzing simulated CandyCode libraries of different designs and sizes. Each point represents the average of 100 separate simulations of the CandyCode library, with error bars <span>\(\pm 1\)</span> standard deviation. <b>(A)</b> A simulation of Figure <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig3">3</a>’s 120-CandyCode test library with eight colors and a 5<span>\(\times\)</span> excess of white nonpareils <b>(black point)</b> predicts an maximum of 2.26 strings shared between any two different CandyCodes; this is in good agreement with the experimentally observed value of 2 maximum shared strings for this library. Simulating larger libraries of eight-color CandyCodes with excess white nonpareils <b>(red points)</b> reveals a logarithmic relationship with library size <b>(red line)</b>; increasing the library size by a factor of 10 increases the largest number of shared strings by a factor 1.2. Using CandyCodes with eight equal-probability colors <b>(green points and line)</b> reduces the number of strings shared between any two different Codes, so that the same 10<span>\(\times\)</span> increase in library size only increases the largest number of shared strings by 0.9. Finally, using CandyCodes with 15 equal-probability colors <b>(blue points and line)</b> further reduces the number of shared strings, so that the same 10<span>\(\times\)</span> increase in library size only increases the largest number of shared strings by 0.6. <b>(B)</b> By extrapolating these results to a CandyCode library size of <span>\(10^{17}\)</span> (the number of “version 4” digital UUIDs<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 21" title="Leach, P. J., Salz, R. &amp; Mealling, M. H. A Universally Unique Identifier (UUID) URN Namespace (RFC 4122, 2005)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR21" id="ref-link-section-d91769923e1310">21</a></sup> that must be generated before the odds of having a repeated UUID reach 1%<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 27" title="Mathis, F. H. A generalized birthday problem. SIAM Rev. 33(2), 265–270 (1991)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR27" id="ref-link-section-d91769923e1314">27</a></sup>), we can predict that a CandyCode library of that size using eight colors and a 5<span>\(\times\)</span> excess of white nonpareils would have up to 21 strings shared between any two CandyCodes; this equals the smallest number of strings shared between two photos of the same CandyCode in my experiments, so CandyCodes from this library would probably not be suitable for use as universally unique identifiers. However, a similarly-sized library using eight equal-probability colors is predicted to have only up to 15 strings shared, and a library using 15 equal-probability colors should have only up to 10 strings shared. These projections suggest that CandyCodes from these libraries could be used as universally-unique identifiers, and each CandyCode in the library could be distinguished from the <span>\(10^{17}\)</span> other CandyCodes in the library.</p></div></figure></div><p>Having replicated the experimental results using the simulator, I then simulated CandyCode libraries with sizes ranging from 1 to 100 000 CandyCodes per library (and still simulating each library size 100 times for statistical analysis). The results are shown in red in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig6">6</a>A, which plots the largest number of strings shared between any two different CandyCodes (on a linear scale) versus the total number of CandyCodes in the library (on a logarithmic scale). Not surprisingly, as the size of the CandyCode library increases, shared strings between the CandyCodes become more common. But the increase in shared strings follows a logarithmic function of library size, and least-squares fitting shows that increasing the library size by a factor of 10 only increases the largest number of shared strings by 1.2. So the largest library I simulated, 100 000 CandyCodes, would only be expected to have about 5.5 strings shared between any two different CandyCodes in the library. Since the smallest number of strings shared between two photos of the same CandyCode was 21 (determined in &#34;<a data-track="click" data-track-label="link" data-track-action="section anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Sec9">Verifying CandyCodes after physical abuse</a>&#34; Section above), it would be trivial to distinguish a correct CandyCode with 21 or more matching strings from incorrect CandyCodes with only 5 or 6 matching strings. So even with an excess of white nonpareils, these simulations suggest that the eight-color CandyCodes could support at least 100 000 different and distinguishable CandyCodes.</p><p>Libraries with more than 100 000 CandyCodes were too large to generate and analyze in a reasonable amount of computing time, but by extrapolating the simulation results, we can try to predict the feasibility of much larger CandyCode libraries. The red line in the zoomed-out plot in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig6">6</a>B shows that for eight-color nonpareils with a <span>\(5\times\)</span> excess of whites, the predicted largest number of strings shared between any two different CandyCodes in the library will exceed 21 after about <span>\(10^{17}\)</span> CandyCodes are generated. I chose <span>\(10^{17}\)</span> as a target number of CandyCodes because it is roughly equal to the number of “version 4” digital UUIDs<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 21" title="Leach, P. J., Salz, R. &amp; Mealling, M. H. A Universally Unique Identifier (UUID) URN Namespace (RFC 4122, 2005)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR21" id="ref-link-section-d91769923e1446">21</a></sup> that can be generated on a computer before the probability of a duplicated UUID reaches 1%<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 27" title="Mathis, F. H. A generalized birthday problem. SIAM Rev. 33(2), 265–270 (1991)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR27" id="ref-link-section-d91769923e1451">27</a></sup>. These digital UUIDs are routinely treated as universally unique in computing, so if <span>\(10^{17}\)</span> CandyCodes can be distinguished from each other, we can assume that the CandyCodes are also universally unique and could be used to uniquely identify one pill out of <span>\(10^{17}\)</span> pills (this enormous number equals 41 million pills for every person on Earth).</p><p>In the case of CandyCodes with eight-color nonpareils and a <span>\(5\times\)</span> excess of white nonpareils, the prediction in red in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig6">6</a>B suggests that a library of <span>\(10^{17}\)</span> CandyCodes is likely not suitable for use as a unique identifiers. Some mismatched CandyCodes in this library will still have up to 21 strings in common, and it would be impossible to distinguish these mismatched codes from correctly-matched CandyCodes that may have as few as 21 strings in common. So while the commercially produced candies used in this study could probably be uniquely identified in libraries of <span>\(\sim\)</span> <span>\(10^{10}\)</span> CandyCodes (which may be more than large enough for many pharmaceutical applications), they probably cannot be considered universally unique at the same level as digital UUIDs.</p><h3 id="Sec11">Simulating CandyCode libraries with unbiased nonpareil colors</h3><p>While the commercially-produced candies we used as test CandyCodes had a <span>\(5\times\)</span> excess of white nonpareils, it would be trivial for a manufacturer to use equal amounts of each color of nonpareil. I hypothesized that by using equal amounts of each nonpareil color, fewer strings would be discarded for having too-few unique colors, and the resulting CandyCodes could still be distinguishable even in larger libraries.</p><p>To test this hypothesis, I repeated the eight-color CandyCode simulations described in the previous section, but with each color having the same (12.5%) probability as shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig7">7</a>B. The simulation results shown in green in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig6">6</a> confirm that using equal amounts of each nonpareil color does reduce the number of strings shared between different CandyCodes. In this model, increasing the size of an equal-colored CandyCode library by a factor of 10 only increases the largest number of strings shared between any two different CandyCodes by 0.9 (compared to 1.2 for CandyCodes with <span>\(5\times\)</span> excess whites). This means that larger CandyCode libraries are feasible using equal amounts of nonpareil colors: the extrapolation in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig6">6</a>B predicts that up to 15 strings would be shared between different CandyCodes in a universally-unique library of <span>\(10^{17}\)</span> CandyCodes. This number is lower than 21, the smallest number of strings shared between photos of the same CandyCode observed in my experiments, so this projection suggests that an eight-color CandyCode with equal color probabilities could serve as a universally unique identifier, with CandyCodes still distinguishable from each other even after <span>\(10^{17}\)</span> of them have been made.</p><div data-test="figure" data-container-section="figure" id="figure-7" data-title="Figure 7"><figure><figcaption><b id="Fig7" data-test="figure-caption-text">Figure 7</b></figcaption><div><div><a data-test="img-link" data-track="click" data-track-label="image" data-track-action="view figure" href="https://www.nature.com/articles/s41598-022-11234-4/figures/7" rel="nofollow"><picture><source type="image/webp" srcset="//media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Fig7_HTML.png?as=webp"/><img aria-describedby="Fig7" src="https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Fig7_HTML.png" alt="figure 7" loading="lazy" width="685" height="170"/></picture></a></div><div data-test="bottom-caption" id="figure-7-desc"><p>Probabilities of nonpareil colors in the three CandyCode systems analyzed in this work: <b>(A)</b> the commercial eight-color chocolate candies with excess white nonpareils, used in the 120-CandyCode test library in &#34;<a data-track="click" data-track-label="link" data-track-action="section anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Sec3">Materials for CandyCodes</a>, <a data-track="click" data-track-label="link" data-track-action="section anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Sec4">Adding CandyCodes to drug products</a>, <a data-track="click" data-track-label="link" data-track-action="section anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Sec5">Photographing CandyCodes</a>, <a data-track="click" data-track-label="link" data-track-action="section anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Sec6">Creating a database of known-good CandyCodes</a>, <a data-track="click" data-track-label="link" data-track-action="section anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Sec7">Assessing the uniqueness of CandyCode strings</a>, <a data-track="click" data-track-label="link" data-track-action="section anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Sec8">Searching for suspect CandyCodes in the known-good database</a> and <a data-track="click" data-track-label="link" data-track-action="section anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Sec9">Verifying CandyCodes after physical abuse</a>&#34; Sections and simulated in Section <a data-track="click" data-track-label="link" data-track-action="section anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Sec10">Simulating CandyCode libraries</a>; <b>(B)</b> the proposed eight-color CandyCode with equal probabilities for each color, simulated in &#34;<a data-track="click" data-track-label="link" data-track-action="section anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Sec11">Simulating CandyCode libraries with unbiased nonpareil colors</a>&#34; Section ; and <b>(C)</b> the proposed fifteen-color CandyCode system with equal probabilities for each color, simulated in &#34; <a data-track="click" data-track-label="link" data-track-action="section anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Sec12">Simulating CandyCode libraries with additional colors</a>&#34; Section.</p></div></div></figure></div><h3 id="Sec12">Simulating CandyCode libraries with additional colors</h3><p>The experiments and simulations described above all use eight colors of nonpareils because many commercial products with nonpareils have eight colors. However, nothing fundamentally limits CandyCodes to using just eight colors. In principle, one could use as many different nonpareil colors as can be reliably discriminated using a camera. While modern smartphone cameras can distinguish a massive number of different colors, CandyCodes should probably limited to a subset of colors that can be reliably distinguished even under sub-optimal lighting and other adverse conditions.</p><p>I theorized that I could add seven additional colors to the original eight colors to create a set of 15 nonpareil colors that could still be reliably distinguished in a photograph. The seven new colors—black, dark gray, light gray, dark green, magenta, purple, and brown—are shown along with the original eight colors in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig7">7</a>C. With so many colors of nonpareils, the odds of discarding a text string due to too-few colors become very small, and even-larger libraries of CandyCodes should be feasible.</p><p>The 15-color CandyCode model was then subjected to the same simulation and analysis as the previous models. The results, shown in blue in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig6">6</a>, confirm that adding additional colors of nonpareils further reduces the number of strings shared between different CandyCodes. In a 15-color CandyCode library, increasing the number of CandyCodes by a factor of 10 only increases the largest number of strings shared between any two different CandyCodes by 0.6; this means that a 15-color CandyCode library should have roughly half as many strings shared between different CandyCodes as an equivalently sized library containing 8-color CandyCodes with <span>\(5\times\)</span> excess whites. Consequently, even larger libraries are feasible using 15 nonpareil colors, and Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig6">6</a>B predicts that a library containing <span>\(10^{17}\)</span> 15-color CandyCodes should have a maximum of only about 10 strings shared between different CandyCodes. This number is well below the minimum observed number of strings shared between photos of the same CandyCode in my experiments, so determining whether a given 15-color CandyCode exists in a library of <span>\(10^{17}\)</span> CandyCodes should be quite feasible (though further experimental testing would be necessary to confirm that common cellphone cameras can indeed reliably distinguish 15 different colors of nonpareils).</p></div></div></section><section data-title="Discussion"><div id="Sec13-section"><h2 id="Sec13">Discussion</h2><div id="Sec13-content"><p>This work demonstrates the feasibility of using random patterns of multicolored particles as universal identifiers. The specific implementation of CandyCodes described here is functional, but there is definitely room for improvement. In this section, I conclude by commenting on possible enhancements and applications for this technique in the future.</p><p>Perhaps most significantly, the process I developed for storing known-good CandyCodes in a searchable database could be dramatically improved. Converting each CandyCode photograph into a set of strings, as was done here, makes for a compact and easily searchable database, and my projections suggest that this string-based approach can scale to UUID-sized libraries (<span>\(\sim\)</span> <span>\(10^{17}\)</span> CandyCodes), but text conversion also discards a great deal of useful information contained in the CandyCode photographs. Storing known-good CandyCodes as raw photos instead of strings, and then using existing image search/comparison algorithms to quantify CandyCode similarity and find matches, could unlock much more of the information content of CandyCodes and further reduce the risk of erroneously classifying a fraudulent product as authentic (or vice versa). Recent breakthroughs in the fields of machine learning and computer vision could prove especially useful in CandyCode analysis.</p><p>Additionally, modifications to the CandyCode design shown here could impart additional robustness or error-resistance to CandyCodes. For example, I used identically-sized and -shaped spherical nonpareils in this work because they are readily available, but CandyCodes are not limited to using these exact nonpareils. Using two or three different sizes of nonpareils would double or triple the number of distinguishable particles used to create the CandyCode. Similarly, using different shapes of nonpareils (like triangles, rods, squares, and so on) would add additional uniqueness to the CandyCodes. For CandyCodes applied to noncircular forms of medications (like the oblong caplets shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig1">1</a>), the shape of the medication could be used to impose an overall orientation or alignment on the CandyCode, simplifying its analysis and comparison with other CandyCodes.</p><p>Finally, while this work focused on using CandyCodes to combat fraudulent pharmaceuticals, many other products are routinely counterfeited and passed as authentic. In 2019, the US Customs and Border Protection agency seized over $1.5 billion USD worth of counterfeit goods<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 28" title="US Customs and Border Protection. Intellectual property rights: Fiscal year 2019 seizure statistics. 
                  https://www.cbp.gov/document/report/fy-2019-ipr-seizure-statistics
                  
                , (2019)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR28" id="ref-link-section-d91769923e1907">28</a></sup>. Cosmetics, perfumes, wine, spirits, apparel, and accessories are some of the most-frequently counterfeited types of goods. To defend their genuine products, a manufacturer could simply apply a drop of glue to the cap of a perfume or beverage bottle, then randomly apply colored particles on the glue during the manufacturing process, forming a universally-unique CandyCode on the product (as shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig8">8</a>). Similarly, the tag on a dress, handbag, or wallet could receive a sticker that has been dusted with multicolored glitter. In each of these cases, a consumer would be encouraged to use their smartphone to snap a photo of the CandyCode and submit it to the manufacturer for confirmation before purchasing the product. Since CandyCodes are simple to make but difficult to duplicate, they can add value and defend against fraud in a wide variety of different products.</p><div data-test="figure" data-container-section="figure" id="figure-8" data-title="Figure 8"><figure><figcaption><b id="Fig8" data-test="figure-caption-text">Figure 8</b></figcaption><div><div><a data-test="img-link" data-track="click" data-track-label="image" data-track-action="view figure" href="https://www.nature.com/articles/s41598-022-11234-4/figures/8" rel="nofollow"><picture><source type="image/webp" srcset="//media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Fig8_HTML.png?as=webp"/><img aria-describedby="Fig8" src="https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41598-022-11234-4/MediaObjects/41598_2022_11234_Fig8_HTML.png" alt="figure 8" loading="lazy" width="685" height="437"/></picture></a></div><p>By applying adhesive to the cap of a small bottle and then pressing the cap into a bed of multicolored plastic spheres, the bottle receives a universally unique CandyCode that can subsequently be photographed and used to verify the authenticity of the bottle’s contents (assuming that the seal is intact). This CandyCode is only about a centimeter in size but contains nearly 300 easily-distinguishable microbeads; this is almost three times the number of nonpareils per CandyCode used in this work, meaning that this bottle’s CandyCode is universally unique and will never be duplicated by random chance.</p></div></figure></div></div></div></section><section data-title="Materials and methods"><div id="Sec14-section"><h2 id="Sec14">Materials and methods</h2><div id="Sec14-content"><p>In principle, any suitably sized and distinguishable particles could be used to make CandyCodes. The materials used in this demonstration were chosen for their commercial availability and low cost. The bulk nonpareils shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig1">1</a> were “Over the Top” brand (manufactured by Topco Associates, Elk Grove Village, IL, USA). These nonpareils contain five different standard food colorants: Allura Red AC (FD&amp;C Red 40; E129), tartrazine (FD&amp;C Yellow 5; E102), brilliant blue FCF (FD&amp;C Blue 1; E133), sunset yellow FCF (FD&amp;C Yellow 6; E110), and erythrosine (FD&amp;C Red 3; E127). These compounds have a long history of use in many food, pharmaceutical, and cosmetic products. In fact, many pharmaceuticals already contain these and other colorants for drug recognition and branding purposes<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 29" title="U.S. Food and Drug Administration. Summary of color additives for use in the united states in foods, drugs, cosmetics, and medical devices. 
                  https://www.fda.gov/industry/color-additive-inventories/summary-color-additives-use-united-states-foods-drugs-cosmetics-and-medical-devices
                  
                , (2015)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR29" id="ref-link-section-d91769923e1942">29</a></sup>, so their suitability for use in pharmaceuticals is already well validated. Additionally, the stability of these colorants is well established if they are protected from exposure to ultraviolet light; since many drug packages are already designed to block UV to protect the drug’s active ingredients from damage<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 30" title="The United States Pharmacopeia and National Formulary (USP 43 - NF 38), volume 4, chapter 671: Containers - Performance Testing. The United States Pharmacopeial Convention, Rockville, MD, 
                  https://subjectguides.uwaterloo.ca/AMA/uspnf
                  
                 (2020)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR30" id="ref-link-section-d91769923e1946">30</a></sup>, this same packaging would also protect CandyCode colors from fading.</p><p>These nonpareils were affixed to caplets of a commercial drug (500 mg caplets of acetaminophen or paracetamol, brand name Tylenol; manufactured by McNeil Consumer Healthcare, Fort Washington, PA, USA) using edible adhesive. After testing several different types of edible adhesive, I found two brands that gave the best results: “Sugarcraft Essentials” edible glue (containing water, preservative, acetic acid, and carboxymethyl cellulose; manufactured by Rainbow Dust Colors, Cuerden Green Mill, UK), and “Dab-N-Hold” edible adhesive (containing water, tapioca dextrin, dextrose, citric acid, xanthan gum, propylene glycol, sodium benzoate, and artificial flavors; manufactured by Wilton Industries, Naperville, IL, USA). The bulk nonpareil-coated chocolate candies shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig1">1</a> and used in Figs. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig3">3</a>, <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig4">4</a> and <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig5">5</a> were purchased from “Nuts.com” (Cranford, NJ, USA). The <span>\(\sim\)</span>850 <span>\(\mu\)</span>m diameter multicolored plastic spheres shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig8">8</a> were “Slime Metallic Microbeads,” produced for arts and crafts applications by Maddie Rae’s (Trumbull, CT, USA); they were adhered to the cap of a small perfume bottle using silicone adhesive (GE brand; Momentive Performance Materials, Huntersville, NC, USA). All CandyCodes were photographed using a conventional smartphone camera (iPhone 11 Pro; Apple, Cupertino, CA, USA) under ordinary room lighting conditions. A set of custom Python programs (available at this project’s GitHub repository<sup><a data-track="click" data-track-action="reference anchor" data-track-label="link" data-test="citation-ref" aria-label="Reference 23" title="Grover, W.H. Candycodes: simple universally unique edible identifiers for confirming the authenticity of pharmaceuticals. 
                  https://github.com/groverlab/candycodes
                  
                , (2022)." href="https://www.nature.com/articles/s41598-022-11234-4#ref-CR23" id="ref-link-section-d91769923e2003">23</a></sup>) was used to analyze the library of 120 chocolate-candy-based CandyCodes shown in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig3">3</a> and simulate the CandyCode libraries in Fig. <a data-track="click" data-track-label="link" data-track-action="figure anchor" href="https://www.nature.com/articles/s41598-022-11234-4#Fig6">6</a>.</p></div></div></section>
            

            <section data-title="Data availability"><div id="data-availability-section"><h2 id="data-availability">Data availability</h2><div id="data-availability-content">
              
              <p>All datasets and analysis code used in this study are available in the associated GitHub repository at <a href="https://github.com/groverlab/candycodes">https://github.com/groverlab/candycodes</a>.</p>
            </div></div></section><div id="MagazineFulltextArticleBodySuffix"><section aria-labelledby="Bib1" data-title="References"><div id="Bib1-section"><h2 id="Bib1">References</h2><div id="Bib1-content"><div data-container-section="references"><ol><li data-counter="1."><p id="ref-CR1">World Health Organization. <i>WHO Global Surveillance and Monitoring System for Substandard and Falsified Medical Products</i> (WHO, Geneva, 2017).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 1" href="http://scholar.google.com/scholar_lookup?&amp;title=WHO%20Global%20Surveillance%20and%20Monitoring%20System%20for%20Substandard%20and%20Falsified%20Medical%20Products&amp;publication_year=2017">
                    Google Scholar</a> 
                </p></li><li data-counter="2."><p id="ref-CR2">SofMat Anti-Counterfeiting Solutions. <a href="https://sofmat.com/sequential-marking/">https://sofmat.com/sequential-marking/</a>, (2021).</p></li><li data-counter="3."><p id="ref-CR3">Han, S. <i>et al.</i> Lithographically encoded polymer microtaggant using high-capacity and error-correctable QR code for anti-counterfeiting of drugs. <i>Adv. Mater.</i> <b>24</b>(44), 5924–5929 (2012).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://www.nature.com/articles/cas-redirect/1:CAS:528:DC%2BC38Xht1Kitb%2FK" aria-label="CAS reference 3">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://doi.org/10.1002%2Fadma.201201486" aria-label="Article reference 3">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 3" href="http://scholar.google.com/scholar_lookup?&amp;title=Lithographically%20encoded%20polymer%20microtaggant%20using%20high-capacity%20and%20error-correctable%20QR%20code%20for%20anti-counterfeiting%20of%20drugs&amp;journal=Adv.%20Mater.&amp;volume=24&amp;issue=44&amp;pages=5924-5929&amp;publication_year=2012&amp;author=Han%2CS&amp;author=Bae%2CHJ&amp;author=Kim%2CJ&amp;author=Shin%2CS&amp;author=Choi%2CSE&amp;author=Lee%2CSH&amp;author=Kwon%2CS&amp;author=Park%2CW">
                    Google Scholar</a> 
                </p></li><li data-counter="4."><p id="ref-CR4">You, M. <i>et al.</i> Three-dimensional quick response code based on inkjet printing of upconversion fluorescent nanoparticles for drug anti-counterfeiting. <i>Nanoscale</i> <b>8</b>(19), 10096–10104 (2016).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2016Nanos...810096Y" aria-label="ADS reference 4">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://www.nature.com/articles/cas-redirect/1:CAS:528:DC%2BC28Xms1Wgsbo%3D" aria-label="CAS reference 4">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://doi.org/10.1039%2FC6NR01353H" aria-label="Article reference 4">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 4" href="http://scholar.google.com/scholar_lookup?&amp;title=Three-dimensional%20quick%20response%20code%20based%20on%20inkjet%20printing%20of%20upconversion%20fluorescent%20nanoparticles%20for%20drug%20anti-counterfeiting&amp;journal=Nanoscale&amp;volume=8&amp;issue=19&amp;pages=10096-10104&amp;publication_year=2016&amp;author=You%2CM&amp;author=Lin%2CM&amp;author=Wang%2CS&amp;author=Wang%2CX&amp;author=Zhang%2CG&amp;author=Hong%2CY&amp;author=Dong%2CY&amp;author=Jin%2CG&amp;author=Feng%2CX">
                    Google Scholar</a> 
                </p></li><li data-counter="5."><p id="ref-CR5">Fei, J. &amp; Liu, R. Drug-laden 3d biodegradable label using qr code for anti-counterfeiting of drugs. <i>Mater. Sci. Eng. C Mater. Biol. Appl.</i> <b>63</b>, 657–662 (2016).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://www.nature.com/articles/cas-redirect/1:CAS:528:DC%2BC28XkvVCjt7c%3D" aria-label="CAS reference 5">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://doi.org/10.1016%2Fj.msec.2016.03.004" aria-label="Article reference 5">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 5" href="http://scholar.google.com/scholar_lookup?&amp;title=Drug-laden%203d%20biodegradable%20label%20using%20qr%20code%20for%20anti-counterfeiting%20of%20drugs&amp;journal=Mater.%20Sci.%20Eng.%20C%20Mater.%20Biol.%20Appl.&amp;volume=63&amp;pages=657-662&amp;publication_year=2016&amp;author=Fei%2CJ&amp;author=Liu%2CR">
                    Google Scholar</a> 
                </p></li><li data-counter="6."><p id="ref-CR6">Preis, M., Breitkreutz, J. &amp; Sandler, N. Perspective: concepts of printing technologies for oral film formulations. <i>Int. J. Pharm.</i> <b>494</b>(2), 578–584 (2015).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://www.nature.com/articles/cas-redirect/1:CAS:528:DC%2BC2MXislSktr4%3D" aria-label="CAS reference 6">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://doi.org/10.1016%2Fj.ijpharm.2015.02.032" aria-label="Article reference 6">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 6" href="http://scholar.google.com/scholar_lookup?&amp;title=Perspective%3A%20concepts%20of%20printing%20technologies%20for%20oral%20film%20formulations&amp;journal=Int.%20J.%20Pharm.&amp;volume=494&amp;issue=2&amp;pages=578-584&amp;publication_year=2015&amp;author=Preis%2CM&amp;author=Breitkreutz%2CJ&amp;author=Sandler%2CN">
                    Google Scholar</a> 
                </p></li><li data-counter="7."><p id="ref-CR7">Edinger, M., Bar-Shalom, D., Sandler, N., Rantanen, J. &amp; Genina, N. QR encoded smart oral dosage forms by inkjet printing. <i>Int. J. Pharm.</i> <b>536</b>(1), 138–145 (2018).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://www.nature.com/articles/cas-redirect/1:CAS:528:DC%2BC2sXhvV2ksL3K" aria-label="CAS reference 7">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://doi.org/10.1016%2Fj.ijpharm.2017.11.052" aria-label="Article reference 7">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 7" href="http://scholar.google.com/scholar_lookup?&amp;title=QR%20encoded%20smart%20oral%20dosage%20forms%20by%20inkjet%20printing&amp;journal=Int.%20J.%20Pharm.&amp;volume=536&amp;issue=1&amp;pages=138-145&amp;publication_year=2018&amp;author=Edinger%2CM&amp;author=Bar-Shalom%2CD&amp;author=Sandler%2CN&amp;author=Rantanen%2CJ&amp;author=Genina%2CN">
                    Google Scholar</a> 
                </p></li><li data-counter="8."><p id="ref-CR8">Pappu, R., Recht, B., Taylor, J. &amp; Gershenfeld, N. Physical one-way functions. <i>Science</i> <b>297</b>(5589), 2026–2030 (2002).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2002Sci...297.2026P" aria-label="ADS reference 8">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://www.nature.com/articles/cas-redirect/1:CAS:528:DC%2BD38Xnt1ans7s%3D" aria-label="CAS reference 8">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://doi.org/10.1126%2Fscience.1074376" aria-label="Article reference 8">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 8" href="http://scholar.google.com/scholar_lookup?&amp;title=Physical%20one-way%20functions&amp;journal=Science&amp;volume=297&amp;issue=5589&amp;pages=2026-2030&amp;publication_year=2002&amp;author=Pappu%2CR&amp;author=Recht%2CB&amp;author=Taylor%2CJ&amp;author=Gershenfeld%2CN">
                    Google Scholar</a> 
                </p></li><li data-counter="9."><p id="ref-CR9">Arppe, R. &amp; Just Sørensen, T. Physical unclonable functions generated through chemical methods for anti-counterfeiting. <i>Nature Rev. Chem.</i> <b>1</b>(4), 1–13 (2017).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://doi.org/10.1038%2Fs41570-017-0031" aria-label="Article reference 9">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 9" href="http://scholar.google.com/scholar_lookup?&amp;title=Physical%20unclonable%20functions%20generated%20through%20chemical%20methods%20for%20anti-counterfeiting&amp;journal=Nature%20Rev.%20Chem.&amp;volume=1&amp;issue=4&amp;pages=1-13&amp;publication_year=2017&amp;author=Arppe%2CR&amp;author=Just%20S%C3%B8rensen%2CT">
                    Google Scholar</a> 
                </p></li><li data-counter="10."><p id="ref-CR10">Leem, J. W. <i>et al.</i> Edible unclonable functions. <i>Nat. Commun.</i> <b>11</b>(1), 328 (2020).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2020NatCo..11..328L" aria-label="ADS reference 10">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://www.nature.com/articles/cas-redirect/1:CAS:528:DC%2BB3cXivFOgtL8%3D" aria-label="CAS reference 10">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://doi.org/10.1038%2Fs41467-019-14066-5" aria-label="Article reference 10">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 10" href="http://scholar.google.com/scholar_lookup?&amp;title=Edible%20unclonable%20functions&amp;journal=Nat.%20Commun.&amp;volume=11&amp;issue=1&amp;publication_year=2020&amp;author=Leem%2CJW&amp;author=Kim%2CMS&amp;author=Choi%2CSH&amp;author=Kim%2CS-R&amp;author=Kim%2CS-W&amp;author=Song%2CY&amp;author=Young%2CRJ&amp;author=Kim%2CYL">
                    Google Scholar</a> 
                </p></li><li data-counter="11."><p id="ref-CR11">Richardson, T. <i>Sweets: A History of Candy</i> (Bloomsbury, New York, 2002).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 11" href="http://scholar.google.com/scholar_lookup?&amp;title=Sweets%3A%20A%20History%20of%20Candy&amp;publication_year=2002&amp;author=Richardson%2CT">
                    Google Scholar</a> 
                </p></li><li data-counter="12."><p id="ref-CR12">Oncescu, V., O’Dell, D. &amp; Erickson, D. Smartphone based health accessory for colorimetric detection of biomarkers in sweat and saliva. <i>Lab Chip</i> <b>13</b>, 3232–3238 (2013).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://www.nature.com/articles/cas-redirect/1:CAS:528:DC%2BC3sXhtFSrtb7E" aria-label="CAS reference 12">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://doi.org/10.1039%2Fc3lc50431j" aria-label="Article reference 12">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 12" href="http://scholar.google.com/scholar_lookup?&amp;title=Smartphone%20based%20health%20accessory%20for%20colorimetric%20detection%20of%20biomarkers%20in%20sweat%20and%20saliva&amp;journal=Lab%20Chip&amp;volume=13&amp;pages=3232-3238&amp;publication_year=2013&amp;author=Oncescu%2CV&amp;author=O%E2%80%99Dell%2CD&amp;author=Erickson%2CD">
                    Google Scholar</a> 
                </p></li><li data-counter="13."><p id="ref-CR13">Oncescu, V., Mancuso, M. &amp; Erickson, D. Cholesterol testing on a smartphone. <i>Lab Chip</i> <b>14</b>, 759–763 (2014).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://www.nature.com/articles/cas-redirect/1:CAS:528:DC%2BC2cXpsFGjtg%3D%3D" aria-label="CAS reference 13">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://doi.org/10.1039%2FC3LC51194D" aria-label="Article reference 13">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 13" href="http://scholar.google.com/scholar_lookup?&amp;title=Cholesterol%20testing%20on%20a%20smartphone&amp;journal=Lab%20Chip&amp;volume=14&amp;pages=759-763&amp;publication_year=2014&amp;author=Oncescu%2CV&amp;author=Mancuso%2CM&amp;author=Erickson%2CD">
                    Google Scholar</a> 
                </p></li><li data-counter="14."><p id="ref-CR14">Petryayeva, E. &amp; Russ Algar, W. A job for quantum dots: use of a smartphone and 3d-printed accessory for all-in-one excitation and imaging of photoluminescence. <i>Anal. Bioanal. Chem.</i> <b>408</b>(11), 2913–2925 (2016).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://www.nature.com/articles/cas-redirect/1:CAS:528:DC%2BC28XhtFOkt70%3D" aria-label="CAS reference 14">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://doi.org/10.1007%2Fs00216-015-9300-3" aria-label="Article reference 14">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 14" href="http://scholar.google.com/scholar_lookup?&amp;title=A%20job%20for%20quantum%20dots%3A%20use%20of%20a%20smartphone%20and%203d-printed%20accessory%20for%20all-in-one%20excitation%20and%20imaging%20of%20photoluminescence&amp;journal=Anal.%20Bioanal.%20Chem.&amp;volume=408&amp;issue=11&amp;pages=2913-2925&amp;publication_year=2016&amp;author=Petryayeva%2CE&amp;author=Russ%20Algar%2CW">
                    Google Scholar</a> 
                </p></li><li data-counter="15."><p id="ref-CR15">Wang, Y. <i>et al.</i> Smartphone spectrometer for colorimetric biosensing. <i>Analyst</i> <b>141</b>, 3233–3238 (2016).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2016Ana...141.3233W" aria-label="ADS reference 15">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://www.nature.com/articles/cas-redirect/1:CAS:528:DC%2BC28XmvFegurk%3D" aria-label="CAS reference 15">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://doi.org/10.1039%2FC5AN02508G" aria-label="Article reference 15">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 15" href="http://scholar.google.com/scholar_lookup?&amp;title=Smartphone%20spectrometer%20for%20colorimetric%20biosensing&amp;journal=Analyst&amp;volume=141&amp;pages=3233-3238&amp;publication_year=2016&amp;author=Wang%2CY&amp;author=Liu%2CX&amp;author=Chen%2CP&amp;author=Thi%20Tran%2CN&amp;author=Zhang%2CJ&amp;author=Sheng%20Chia%2CW&amp;author=Boujday%2CS&amp;author=Liedberg%2CB">
                    Google Scholar</a> 
                </p></li><li data-counter="16."><p id="ref-CR16">Özdemir, G. K., Bayram, A., Kılıç, V., Horzum, N. &amp; Solmaz, M. E. Smartphone-based detection of dyes in water for environmental sustainability. <i>Anal. Methods</i> <b>9</b>, 579–585 (2017).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://doi.org/10.1039%2FC6AY03073D" aria-label="Article reference 16">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 16" href="http://scholar.google.com/scholar_lookup?&amp;title=Smartphone-based%20detection%20of%20dyes%20in%20water%20for%20environmental%20sustainability&amp;journal=Anal.%20Methods&amp;volume=9&amp;pages=579-585&amp;publication_year=2017&amp;author=%C3%96zdemir%2CGK&amp;author=Bayram%2CA&amp;author=K%C4%B1l%C4%B1%C3%A7%2CV&amp;author=Horzum%2CN&amp;author=Solmaz%2CME">
                    Google Scholar</a> 
                </p></li><li data-counter="17."><p id="ref-CR17">Paterson, A. S. <i>et al.</i> A low-cost smartphone-based platform for highly sensitive point-of-care testing with persistent luminescent phosphors. <i>Lab Chip</i> <b>17</b>, 1051–1059 (2017).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://www.nature.com/articles/cas-redirect/1:CAS:528:DC%2BC2sXitVKrt7Y%3D" aria-label="CAS reference 17">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://doi.org/10.1039%2FC6LC01167E" aria-label="Article reference 17">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 17" href="http://scholar.google.com/scholar_lookup?&amp;title=A%20low-cost%20smartphone-based%20platform%20for%20highly%20sensitive%20point-of-care%20testing%20with%20persistent%20luminescent%20phosphors&amp;journal=Lab%20Chip&amp;volume=17&amp;pages=1051-1059&amp;publication_year=2017&amp;author=Paterson%2CAS&amp;author=Raja%2CB&amp;author=Mandadi%2CV&amp;author=Townsend%2CB&amp;author=Lee%2CM&amp;author=Buell%2CA&amp;author=Binh%2CV&amp;author=Brgoch%2CJ&amp;author=Willson%2CRC">
                    Google Scholar</a> 
                </p></li><li data-counter="18."><p id="ref-CR18">Woodburn, E. V., Long, K. D. &amp; Cunningham, B. T. Analysis of paper-based colorimetric assays with a smartphone spectrometer. <i>IEEE Sens. J.</i> <b>19</b>(2), 508–514 (2019).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="http://adsabs.harvard.edu/cgi-bin/nph-data_query?link_type=ABSTRACT&amp;bibcode=2019ISenJ..19..508W" aria-label="ADS reference 18">ADS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://www.nature.com/articles/cas-redirect/1:CAS:528:DC%2BC1MXhsFyns7zI" aria-label="CAS reference 18">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://doi.org/10.1109%2FJSEN.2018.2876631" aria-label="Article reference 18">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 18" href="http://scholar.google.com/scholar_lookup?&amp;title=Analysis%20of%20paper-based%20colorimetric%20assays%20with%20a%20smartphone%20spectrometer&amp;journal=IEEE%20Sens.%20J.&amp;volume=19&amp;issue=2&amp;pages=508-514&amp;publication_year=2019&amp;author=Woodburn%2CEV&amp;author=Long%2CKD&amp;author=Cunningham%2CBT">
                    Google Scholar</a> 
                </p></li><li data-counter="19."><p id="ref-CR19">ISO. 15420:2009 Information technology: automatic identification and data capture techniques: EAN/UPC bar code symbology specification. Technical report, (2009).</p></li><li data-counter="20."><p id="ref-CR20">ISO. 18004:2015 Information technology: automatic identification and data capture techniques: QR Code bar code symbology specification. Technical report, (2015).</p></li><li data-counter="21."><p id="ref-CR21">Leach, P. J., Salz, R. &amp; Mealling, M. H. <i>A Universally Unique Identifier (UUID) URN Namespace</i> (RFC 4122, 2005).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://doi.org/10.17487%2Frfc4122" aria-label="Book reference 21">Book</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 21" href="http://scholar.google.com/scholar_lookup?&amp;title=A%20Universally%20Unique%20Identifier%20%28UUID%29%20URN%20Namespace&amp;publication_year=2005&amp;author=Leach%2CPJ&amp;author=Salz%2CR&amp;author=Mealling%2CMH">
                    Google Scholar</a> 
                </p></li><li data-counter="22."><p id="ref-CR22">Delsarte, P., Goethals, J. M. &amp; Seidel, J. J. Spherical Codes and Designs. In <i>Geometry and Combinatorics</i> (eds Corneil, D. G. &amp; Mathon, R.) 68–93 (Academic Press, 1991).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://doi.org/10.1016%2FB978-0-12-189420-7.50013-X" aria-label="Chapter reference 22">Chapter</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 22" href="http://scholar.google.com/scholar_lookup?&amp;title=Spherical%20Codes%20and%20Designs&amp;pages=68-93&amp;publication_year=1991&amp;author=Delsarte%2CP&amp;author=Goethals%2CJM&amp;author=Seidel%2CJJ">
                    Google Scholar</a> 
                </p></li><li data-counter="23."><p id="ref-CR23">Grover, W.H. Candycodes: simple universally unique edible identifiers for confirming the authenticity of pharmaceuticals. <a href="https://github.com/groverlab/candycodes">https://github.com/groverlab/candycodes</a>, (2022).</p></li><li data-counter="24."><p id="ref-CR24">Delaunay, B. N. Sur la sphère vide. <i>Bull. Acad. Sci. URSS</i> <b>1934</b>(6), 793–800 (1934).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="http://www.emis.de/MATH-item?60.0946.06" aria-label="MATH reference 24">MATH</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 24" href="http://scholar.google.com/scholar_lookup?&amp;title=Sur%20la%20sph%C3%A8re%20vide&amp;journal=Bull.%20Acad.%20Sci.%20URSS&amp;volume=1934&amp;issue=6&amp;pages=793-800&amp;publication_year=1934&amp;author=Delaunay%2CBN">
                    Google Scholar</a> 
                </p></li><li data-counter="25."><p id="ref-CR25">BradfordBarber, C., Dobkin, D. P. &amp; Huhdanpaa, H. The Quickhull algorithm for convex hulls. <i>ACM Trans. Math. Softw. (TOMS)</i> <b>22</b>(4), 469–483 (1996).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="http://www.ams.org/mathscinet-getitem?mr=1428265" aria-label="MathSciNet reference 25">MathSciNet</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://doi.org/10.1145%2F235815.235821" aria-label="Article reference 25">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 25" href="http://scholar.google.com/scholar_lookup?&amp;title=The%20Quickhull%20algorithm%20for%20convex%20hulls&amp;journal=ACM%20Trans.%20Math.%20Softw.%20%28TOMS%29&amp;volume=22&amp;issue=4&amp;pages=469-483&amp;publication_year=1996&amp;author=BradfordBarber%2CC&amp;author=Dobkin%2CDP&amp;author=Huhdanpaa%2CH">
                    Google Scholar</a> 
                </p></li><li data-counter="26."><p id="ref-CR26">Virtanen, P. <i>et al.</i> SciPy 10: fundamental algorithms for scientific computing in Python. <i>Nature Meth.</i> <b>17</b>, 261–272 (2020).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://www.nature.com/articles/cas-redirect/1:CAS:528:DC%2BB3cXislCjuro%3D" aria-label="CAS reference 26">CAS</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://doi.org/10.1038%2Fs41592-019-0686-2" aria-label="Article reference 26">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 26" href="http://scholar.google.com/scholar_lookup?&amp;title=SciPy%2010%3A%20fundamental%20algorithms%20for%20scientific%20computing%20in%20Python&amp;journal=Nature%20Meth.&amp;volume=17&amp;pages=261-272&amp;publication_year=2020&amp;author=Virtanen%2CP&amp;author=Gommers%2CR&amp;author=Oliphant%2CTE&amp;author=Haberland%2CM&amp;author=Reddy%2CT&amp;author=Cournapeau%2CD&amp;author=Burovski%2CE&amp;author=Peterson%2CP&amp;author=Weckesser%2CW&amp;author=Bright%2CJ&amp;author=Walt%2CSJ&amp;author=Brett%2CM&amp;author=Wilson%2CJ&amp;author=Millman%2CKJ&amp;author=Mayorov%2CN&amp;author=Nelson%2CARJ&amp;author=Jones%2CE&amp;author=Kern%2CR&amp;author=Larson%2CE&amp;author=Carey%2CCJ&amp;author=Polat%2CI&amp;author=Feng%2CY&amp;author=Moore%2CEW&amp;author=VanderPlas%2CJ&amp;author=Laxalde%2CD&amp;author=Perktold%2CJ&amp;author=Cimrman%2CR&amp;author=Henriksen%2CI&amp;author=Quintero%2CEA&amp;author=Harris%2CCR&amp;author=Archibald%2CAM&amp;author=Ribeiro%2CAH&amp;author=Pedregosa%2CF&amp;author=Mulbregt%2CP">
                    Google Scholar</a> 
                </p></li><li data-counter="27."><p id="ref-CR27">Mathis, F. H. A generalized birthday problem. <i>SIAM Rev.</i> <b>33</b>(2), 265–270 (1991).</p><p><a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="http://www.ams.org/mathscinet-getitem?mr=1108591" aria-label="MathSciNet reference 27">MathSciNet</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" href="https://doi.org/10.1137%2F1033051" aria-label="Article reference 27">Article</a> 
    <a data-track="click" data-track-action="outbound reference" data-track-label="link" rel="nofollow noopener" aria-label="Google Scholar reference 27" href="http://scholar.google.com/scholar_lookup?&amp;title=A%20generalized%20birthday%20problem&amp;journal=SIAM%20Rev.&amp;volume=33&amp;issue=2&amp;pages=265-270&amp;publication_year=1991&amp;author=Mathis%2CFH">
                    Google Scholar</a> 
                </p></li><li data-counter="28."><p id="ref-CR28">US Customs and Border Protection. Intellectual property rights: Fiscal year 2019 seizure statistics. <a href="https://www.cbp.gov/document/report/fy-2019-ipr-seizure-statistics">https://www.cbp.gov/document/report/fy-2019-ipr-seizure-statistics</a>, (2019).</p></li><li data-counter="29."><p id="ref-CR29">U.S. Food and Drug Administration. Summary of color additives for use in the united states in foods, drugs, cosmetics, and medical devices. <a href="https://www.fda.gov/industry/color-additive-inventories/summary-color-additives-use-united-states-foods-drugs-cosmetics-and-medical-devices">https://www.fda.gov/industry/color-additive-inventories/summary-color-additives-use-united-states-foods-drugs-cosmetics-and-medical-devices</a>, (2015).</p></li><li data-counter="30."><p id="ref-CR30">The United States Pharmacopeia and National Formulary (USP 43 - NF 38), volume 4, chapter 671: Containers - Performance Testing. The United States Pharmacopeial Convention, Rockville, MD, <a href="https://subjectguides.uwaterloo.ca/AMA/uspnf">https://subjectguides.uwaterloo.ca/AMA/uspnf</a> (2020).</p></li></ol><p><a data-track="click" data-track-action="download citation references" data-track-label="link" href="https://citation-needed.springer.com/v2/references/10.1038/s41598-022-11234-4?format=refman&amp;flavour=references">Download references<svg width="16" height="16" focusable="false" role="img" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#global-icon-download"></use></svg></a></p></div></div></div></section></div><section data-title="Acknowledgements"><div id="Ack1-section"><h2 id="Ack1">Acknowledgements</h2><p>This work was supported by a grant from the Bill and Melinda Gates Foundation (OPP1191214).</p></div></section><section aria-labelledby="author-information" data-title="Author information"><div id="author-information-section"><h2 id="author-information">Author information</h2><div id="author-information-content"><h3 id="affiliations">Authors and Affiliations</h3><ol><li id="Aff1"><p>Department of Bioengineering, University of California, Riverside, USA</p><p>William H. Grover</p></li></ol><h3 id="contributions">Contributions</h3><p>W.H.G. conducted this study and wrote the manuscript.</p><h3 id="corresponding-author">Corresponding author</h3><p id="corresponding-author-list">Correspondence to
                <a id="corresp-c1" href="mailto:wgrover@engr.ucr.edu">William H. Grover</a>.</p></div></div></section><section data-title="Ethics declarations"><div id="ethics-section"><h2 id="ethics">Ethics declarations</h2><div id="ethics-content">
              
                <h3>Competing interests</h3>
                <p>The authors declare no competing interests.</p>
              
            </div></div></section><section data-title="Additional information"><div id="additional-information-section"><h2 id="additional-information">Additional information</h2><div id="additional-information-content"><h3>Publisher&#39;s note</h3><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></div></div></section><section data-title="Rights and permissions"><div id="rightslink-section"><h2 id="rightslink">Rights and permissions</h2><div id="rightslink-content">
                <p><b>Open Access</b> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article&#39;s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article&#39;s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <a href="http://creativecommons.org/licenses/by/4.0/" rel="license">http://creativecommons.org/licenses/by/4.0/</a>.</p>
              <p><a data-track="click" data-track-action="view rights and permissions" data-track-label="link" href="https://s100.copyright.com/AppDispatchServlet?title=CandyCodes%3A%20simple%20universally%20unique%20edible%20identifiers%20for%20confirming%20the%20authenticity%20of%20pharmaceuticals&amp;author=William%20H.%20Grover&amp;contentID=10.1038%2Fs41598-022-11234-4&amp;copyright=The%20Author%28s%29&amp;publication=2045-2322&amp;publicationDate=2022-05-06&amp;publisherName=SpringerNature&amp;orderBeanReset=true&amp;oa=CC%20BY">Reprints and Permissions</a></p></div></div></section><section aria-labelledby="article-info" data-title="About this article"><div id="article-info-section"><h2 id="article-info">About this article</h2><div id="article-info-content"><div><p><a data-crossmark="10.1038/s41598-022-11234-4" target="_blank" rel="noopener" href="https://crossmark.crossref.org/dialog/?doi=10.1038/s41598-022-11234-4" data-track="click" data-track-action="Click Crossmark" data-track-label="link" data-test="crossmark"><img width="57" height="81" alt="Verify currency and authenticity via CrossMark" src="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjgxIiB3aWR0aD0iNTciIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBkPSJtMTcuMzUgMzUuNDUgMjEuMy0xNC4ydi0xNy4wM2gtMjEuMyIgZmlsbD0iIzk4OTg5OCIvPjxwYXRoIGQ9Im0zOC42NSAzNS40NS0yMS4zLTE0LjJ2LTE3LjAzaDIxLjMiIGZpbGw9IiM3NDc0NzQiLz48cGF0aCBkPSJtMjggLjVjLTEyLjk4IDAtMjMuNSAxMC41Mi0yMy41IDIzLjVzMTAuNTIgMjMuNSAyMy41IDIzLjUgMjMuNS0xMC41MiAyMy41LTIzLjVjMC02LjIzLTIuNDgtMTIuMjEtNi44OC0xNi42Mi00LjQxLTQuNC0xMC4zOS02Ljg4LTE2LjYyLTYuODh6bTAgNDEuMjVjLTkuOCAwLTE3Ljc1LTcuOTUtMTcuNzUtMTcuNzVzNy45NS0xNy43NSAxNy43NS0xNy43NSAxNy43NSA3Ljk1IDE3Ljc1IDE3Ljc1YzAgNC43MS0xLjg3IDkuMjItNS4yIDEyLjU1cy03Ljg0IDUuMi0xMi41NSA1LjJ6IiBmaWxsPSIjNTM1MzUzIi8+PHBhdGggZD0ibTQxIDM2Yy01LjgxIDYuMjMtMTUuMjMgNy40NS0yMi40MyAyLjktNy4yMS00LjU1LTEwLjE2LTEzLjU3LTcuMDMtMjEuNWwtNC45Mi0zLjExYy00Ljk1IDEwLjctMS4xOSAyMy40MiA4Ljc4IDI5LjcxIDkuOTcgNi4zIDIzLjA3IDQuMjIgMzAuNi00Ljg2eiIgZmlsbD0iIzljOWM5YyIvPjxwYXRoIGQ9Im0uMiA1OC40NWMwLS43NS4xMS0xLjQyLjMzLTIuMDFzLjUyLTEuMDkuOTEtMS41Yy4zOC0uNDEuODMtLjczIDEuMzQtLjk0LjUxLS4yMiAxLjA2LS4zMiAxLjY1LS4zMi41NiAwIDEuMDYuMTEgMS41MS4zNS40NC4yMy44MS41IDEuMS44MWwtLjkxIDEuMDFjLS4yNC0uMjQtLjQ5LS40Mi0uNzUtLjU2LS4yNy0uMTMtLjU4LS4yLS45My0uMi0uMzkgMC0uNzMuMDgtMS4wNS4yMy0uMzEuMTYtLjU4LjM3LS44MS42Ni0uMjMuMjgtLjQxLjYzLS41MyAxLjA0LS4xMy40MS0uMTkuODgtLjE5IDEuMzkgMCAxLjA0LjIzIDEuODYuNjggMi40Ni40NS41OSAxLjA2Ljg4IDEuODQuODguNDEgMCAuNzctLjA3IDEuMDctLjIzcy41OS0uMzkuODUtLjY4bC45MSAxYy0uMzguNDMtLjguNzYtMS4yOC45OS0uNDcuMjItMSAuMzQtMS41OC4zNC0uNTkgMC0xLjEzLS4xLTEuNjQtLjMxLS41LS4yLS45NC0uNTEtMS4zMS0uOTEtLjM4LS40LS42Ny0uOS0uODgtMS40OC0uMjItLjU5LS4zMy0xLjI2LS4zMy0yLjAyem04LjQtNS4zM2gxLjYxdjIuNTRsLS4wNSAxLjMzYy4yOS0uMjcuNjEtLjUxLjk2LS43MnMuNzYtLjMxIDEuMjQtLjMxYy43MyAwIDEuMjcuMjMgMS42MS43MS4zMy40Ny41IDEuMTQuNSAyLjAydjQuMzFoLTEuNjF2LTQuMWMwLS41Ny0uMDgtLjk3LS4yNS0xLjIxLS4xNy0uMjMtLjQ1LS4zNS0uODMtLjM1LS4zIDAtLjU2LjA4LS43OS4yMi0uMjMuMTUtLjQ5LjM2LS43OC42NHY0LjhoLTEuNjF6bTcuMzcgNi40NWMwLS41Ni4wOS0xLjA2LjI2LTEuNTEuMTgtLjQ1LjQyLS44My43MS0xLjE0LjI5LS4zLjYzLS41NCAxLjAxLS43MS4zOS0uMTcuNzgtLjI1IDEuMTgtLjI1LjQ3IDAgLjg4LjA4IDEuMjMuMjQuMzYuMTYuNjUuMzguODkuNjdzLjQyLjYzLjU0IDEuMDNjLjEyLjQxLjE4Ljg0LjE4IDEuMzIgMCAuMzItLjAyLjU3LS4wNy43NmgtNC4zNmMuMDcuNjIuMjkgMS4xLjY1IDEuNDQuMzYuMzMuODIuNSAxLjM4LjUuMjkgMCAuNTctLjA0LjgzLS4xM3MuNTEtLjIxLjc2LS4zN2wuNTUgMS4wMWMtLjMzLjIxLS42OS4zOS0xLjA5LjUzLS40MS4xNC0uODMuMjEtMS4yNi4yMS0uNDggMC0uOTItLjA4LTEuMzQtLjI1LS40MS0uMTYtLjc2LS40LTEuMDctLjctLjMxLS4zMS0uNTUtLjY5LS43Mi0xLjEzLS4xOC0uNDQtLjI2LS45NS0uMjYtMS41MnptNC42LS42MmMwLS41NS0uMTEtLjk4LS4zNC0xLjI4LS4yMy0uMzEtLjU4LS40Ny0xLjA2LS40Ny0uNDEgMC0uNzcuMTUtMS4wNy40NS0uMzEuMjktLjUuNzMtLjU4IDEuM3ptMi41LjYyYzAtLjU3LjA5LTEuMDguMjgtMS41My4xOC0uNDQuNDMtLjgyLjc1LTEuMTNzLjY5LS41NCAxLjEtLjcxYy40Mi0uMTYuODUtLjI0IDEuMzEtLjI0LjQ1IDAgLjg0LjA4IDEuMTcuMjNzLjYxLjM0Ljg1LjU3bC0uNzcgMS4wMmMtLjE5LS4xNi0uMzgtLjI4LS41Ni0uMzctLjE5LS4wOS0uMzktLjE0LS42MS0uMTQtLjU2IDAtMS4wMS4yMS0xLjM1LjYzLS4zNS40MS0uNTIuOTctLjUyIDEuNjcgMCAuNjkuMTcgMS4yNC41MSAxLjY2LjM0LjQxLjc4LjYyIDEuMzIuNjIuMjggMCAuNTQtLjA2Ljc4LS4xNy4yNC0uMTIuNDUtLjI2LjY0LS40MmwuNjcgMS4wM2MtLjMzLjI5LS42OS41MS0xLjA4LjY1LS4zOS4xNS0uNzguMjMtMS4xOC4yMy0uNDYgMC0uOS0uMDgtMS4zMS0uMjQtLjQtLjE2LS43NS0uMzktMS4wNS0uN3MtLjUzLS42OS0uNy0xLjEzYy0uMTctLjQ1LS4yNS0uOTYtLjI1LTEuNTN6bTYuOTEtNi40NWgxLjU4djYuMTdoLjA1bDIuNTQtMy4xNmgxLjc3bC0yLjM1IDIuOCAyLjU5IDQuMDdoLTEuNzVsLTEuNzctMi45OC0xLjA4IDEuMjN2MS43NWgtMS41OHptMTMuNjkgMS4yN2MtLjI1LS4xMS0uNS0uMTctLjc1LS4xNy0uNTggMC0uODcuMzktLjg3IDEuMTZ2Ljc1aDEuMzR2MS4yN2gtMS4zNHY1LjZoLTEuNjF2LTUuNmgtLjkydi0xLjJsLjkyLS4wN3YtLjcyYzAtLjM1LjA0LS42OC4xMy0uOTguMDgtLjMxLjIxLS41Ny40LS43OXMuNDItLjM5LjcxLS41MWMuMjgtLjEyLjYzLS4xOCAxLjA0LS4xOC4yNCAwIC40OC4wMi42OS4wNy4yMi4wNS40MS4xLjU3LjE3em0uNDggNS4xOGMwLS41Ny4wOS0xLjA4LjI3LTEuNTMuMTctLjQ0LjQxLS44Mi43Mi0xLjEzLjMtLjMxLjY1LS41NCAxLjA0LS43MS4zOS0uMTYuOC0uMjQgMS4yMy0uMjRzLjg0LjA4IDEuMjQuMjRjLjQuMTcuNzQuNCAxLjA0Ljcxcy41NC42OS43MiAxLjEzYy4xOS40NS4yOC45Ni4yOCAxLjUzcy0uMDkgMS4wOC0uMjggMS41M2MtLjE4LjQ0LS40Mi44Mi0uNzIgMS4xM3MtLjY0LjU0LTEuMDQuNy0uODEuMjQtMS4yNC4yNC0uODQtLjA4LTEuMjMtLjI0LS43NC0uMzktMS4wNC0uN2MtLjMxLS4zMS0uNTUtLjY5LS43Mi0xLjEzLS4xOC0uNDUtLjI3LS45Ni0uMjctMS41M3ptMS42NSAwYzAgLjY5LjE0IDEuMjQuNDMgMS42Ni4yOC40MS42OC42MiAxLjE4LjYyLjUxIDAgLjktLjIxIDEuMTktLjYyLjI5LS40Mi40NC0uOTcuNDQtMS42NiAwLS43LS4xNS0xLjI2LS40NC0xLjY3LS4yOS0uNDItLjY4LS42My0xLjE5LS42My0uNSAwLS45LjIxLTEuMTguNjMtLjI5LjQxLS40My45Ny0uNDMgMS42N3ptNi40OC0zLjQ0aDEuMzNsLjEyIDEuMjFoLjA1Yy4yNC0uNDQuNTQtLjc5Ljg4LTEuMDIuMzUtLjI0LjctLjM2IDEuMDctLjM2LjMyIDAgLjU5LjA1Ljc4LjE0bC0uMjggMS40LS4zMy0uMDljLS4xMS0uMDEtLjIzLS4wMi0uMzgtLjAyLS4yNyAwLS41Ni4xLS44Ni4zMXMtLjU1LjU4LS43NyAxLjF2NC4yaC0xLjYxem0tNDcuODcgMTVoMS42MXY0LjFjMCAuNTcuMDguOTcuMjUgMS4yLjE3LjI0LjQ0LjM1LjgxLjM1LjMgMCAuNTctLjA3LjgtLjIyLjIyLS4xNS40Ny0uMzkuNzMtLjczdi00LjdoMS42MXY2Ljg3aC0xLjMybC0uMTItMS4wMWgtLjA0Yy0uMy4zNi0uNjMuNjQtLjk4Ljg2LS4zNS4yMS0uNzYuMzItMS4yNC4zMi0uNzMgMC0xLjI3LS4yNC0xLjYxLS43MS0uMzMtLjQ3LS41LTEuMTQtLjUtMi4wMnptOS40NiA3LjQzdjIuMTZoLTEuNjF2LTkuNTloMS4zM2wuMTIuNzJoLjA1Yy4yOS0uMjQuNjEtLjQ1Ljk3LS42My4zNS0uMTcuNzItLjI2IDEuMS0uMjYuNDMgMCAuODEuMDggMS4xNS4yNC4zMy4xNy42MS40Ljg0LjcxLjI0LjMxLjQxLjY4LjUzIDEuMTEuMTMuNDIuMTkuOTEuMTkgMS40NCAwIC41OS0uMDkgMS4xMS0uMjUgMS41Ny0uMTYuNDctLjM4Ljg1LS42NSAxLjE2LS4yNy4zMi0uNTguNTYtLjk0LjczLS4zNS4xNi0uNzIuMjUtMS4xLjI1LS4zIDAtLjYtLjA3LS45LS4ycy0uNTktLjMxLS44Ny0uNTZ6bTAtMi4zYy4yNi4yMi41LjM3LjczLjQ1LjI0LjA5LjQ2LjEzLjY2LjEzLjQ2IDAgLjg0LS4yIDEuMTUtLjYuMzEtLjM5LjQ2LS45OC40Ni0xLjc3IDAtLjY5LS4xMi0xLjIyLS4zNS0xLjYxLS4yMy0uMzgtLjYxLS41Ny0xLjEzLS41Ny0uNDkgMC0uOTkuMjYtMS41Mi43N3ptNS44Ny0xLjY5YzAtLjU2LjA4LTEuMDYuMjUtMS41MS4xNi0uNDUuMzctLjgzLjY1LTEuMTQuMjctLjMuNTgtLjU0LjkzLS43MXMuNzEtLjI1IDEuMDgtLjI1Yy4zOSAwIC43My4wNyAxIC4yLjI3LjE0LjU0LjMyLjgxLjU1bC0uMDYtMS4xdi0yLjQ5aDEuNjF2OS44OGgtMS4zM2wtLjExLS43NGgtLjA2Yy0uMjUuMjUtLjU0LjQ2LS44OC42NC0uMzMuMTgtLjY5LjI3LTEuMDYuMjctLjg3IDAtMS41Ni0uMzItMi4wNy0uOTVzLS43Ni0xLjUxLS43Ni0yLjY1em0xLjY3LS4wMWMwIC43NC4xMyAxLjMxLjQgMS43LjI2LjM4LjY1LjU4IDEuMTUuNTguNTEgMCAuOTktLjI2IDEuNDQtLjc3di0zLjIxYy0uMjQtLjIxLS40OC0uMzYtLjctLjQ1LS4yMy0uMDgtLjQ2LS4xMi0uNy0uMTItLjQ1IDAtLjgyLjE5LTEuMTMuNTktLjMxLjM5LS40Ni45NS0uNDYgMS42OHptNi4zNSAxLjU5YzAtLjczLjMyLTEuMy45Ny0xLjcxLjY0LS40IDEuNjctLjY4IDMuMDgtLjg0IDAtLjE3LS4wMi0uMzQtLjA3LS41MS0uMDUtLjE2LS4xMi0uMy0uMjItLjQzcy0uMjItLjIyLS4zOC0uM2MtLjE1LS4wNi0uMzQtLjEtLjU4LS4xLS4zNCAwLS42OC4wNy0xIC4ycy0uNjMuMjktLjkzLjQ3bC0uNTktMS4wOGMuMzktLjI0LjgxLS40NSAxLjI4LS42My40Ny0uMTcuOTktLjI2IDEuNTQtLjI2Ljg2IDAgMS41MS4yNSAxLjkzLjc2cy42MyAxLjI1LjYzIDIuMjF2NC4wN2gtMS4zMmwtLjEyLS43NmgtLjA1Yy0uMy4yNy0uNjMuNDgtLjk4LjY2cy0uNzMuMjctMS4xNC4yN2MtLjYxIDAtMS4xLS4xOS0xLjQ4LS41Ni0uMzgtLjM2LS41Ny0uODUtLjU3LTEuNDZ6bTEuNTctLjEyYzAgLjMuMDkuNTMuMjcuNjcuMTkuMTQuNDIuMjEuNzEuMjEuMjggMCAuNTQtLjA3Ljc3LS4ycy40OC0uMzEuNzMtLjU2di0xLjU0Yy0uNDcuMDYtLjg2LjEzLTEuMTguMjMtLjMxLjA5LS41Ny4xOS0uNzYuMzFzLS4zMy4yNS0uNDEuNGMtLjA5LjE1LS4xMy4zMS0uMTMuNDh6bTYuMjktMy42M2gtLjk4di0xLjJsMS4wNi0uMDcuMi0xLjg4aDEuMzR2MS44OGgxLjc1djEuMjdoLTEuNzV2My4yOGMwIC44LjMyIDEuMi45NyAxLjIuMTIgMCAuMjQtLjAxLjM3LS4wNC4xMi0uMDMuMjQtLjA3LjM0LS4xMWwuMjggMS4xOWMtLjE5LjA2LS40LjEyLS42NC4xNy0uMjMuMDUtLjQ5LjA4LS43Ni4wOC0uNCAwLS43NC0uMDYtMS4wMi0uMTgtLjI3LS4xMy0uNDktLjMtLjY3LS41Mi0uMTctLjIxLS4zLS40OC0uMzctLjc4LS4wOC0uMy0uMTItLjY0LS4xMi0xLjAxem00LjM2IDIuMTdjMC0uNTYuMDktMS4wNi4yNy0xLjUxcy40MS0uODMuNzEtMS4xNGMuMjktLjMuNjMtLjU0IDEuMDEtLjcxLjM5LS4xNy43OC0uMjUgMS4xOC0uMjUuNDcgMCAuODguMDggMS4yMy4yNC4zNi4xNi42NS4zOC44OS42N3MuNDIuNjMuNTQgMS4wM2MuMTIuNDEuMTguODQuMTggMS4zMiAwIC4zMi0uMDIuNTctLjA3Ljc2aC00LjM3Yy4wOC42Mi4yOSAxLjEuNjUgMS40NC4zNi4zMy44Mi41IDEuMzguNS4zIDAgLjU4LS4wNC44NC0uMTMuMjUtLjA5LjUxLS4yMS43Ni0uMzdsLjU0IDEuMDFjLS4zMi4yMS0uNjkuMzktMS4wOS41M3MtLjgyLjIxLTEuMjYuMjFjLS40NyAwLS45Mi0uMDgtMS4zMy0uMjUtLjQxLS4xNi0uNzctLjQtMS4wOC0uNy0uMy0uMzEtLjU0LS42OS0uNzItMS4xMy0uMTctLjQ0LS4yNi0uOTUtLjI2LTEuNTJ6bTQuNjEtLjYyYzAtLjU1LS4xMS0uOTgtLjM0LTEuMjgtLjIzLS4zMS0uNTgtLjQ3LTEuMDYtLjQ3LS40MSAwLS43Ny4xNS0xLjA4LjQ1LS4zMS4yOS0uNS43My0uNTcgMS4zem0zLjAxIDIuMjNjLjMxLjI0LjYxLjQzLjkyLjU3LjMuMTMuNjMuMi45OC4yLjM4IDAgLjY1LS4wOC44My0uMjNzLjI3LS4zNS4yNy0uNmMwLS4xNC0uMDUtLjI2LS4xMy0uMzctLjA4LS4xLS4yLS4yLS4zNC0uMjgtLjE0LS4wOS0uMjktLjE2LS40Ny0uMjNsLS41My0uMjJjLS4yMy0uMDktLjQ2LS4xOC0uNjktLjMtLjIzLS4xMS0uNDQtLjI0LS42Mi0uNHMtLjMzLS4zNS0uNDUtLjU1Yy0uMTItLjIxLS4xOC0uNDYtLjE4LS43NSAwLS42MS4yMy0xLjEuNjgtMS40OS40NC0uMzggMS4wNi0uNTcgMS44My0uNTcuNDggMCAuOTEuMDggMS4yOS4yNXMuNzEuMzYuOTkuNTdsLS43NC45OGMtLjI0LS4xNy0uNDktLjMyLS43My0uNDItLjI1LS4xMS0uNTEtLjE2LS43OC0uMTYtLjM1IDAtLjYuMDctLjc2LjIxLS4xNy4xNS0uMjUuMzMtLjI1LjU0IDAgLjE0LjA0LjI2LjEyLjM2cy4xOC4xOC4zMS4yNmMuMTQuMDcuMjkuMTQuNDYuMjFsLjU0LjE5Yy4yMy4wOS40Ny4xOC43LjI5cy40NC4yNC42NC40Yy4xOS4xNi4zNC4zNS40Ni41OC4xMS4yMy4xNy41LjE3LjgyIDAgLjMtLjA2LjU4LS4xNy44My0uMTIuMjYtLjI5LjQ4LS41MS42OC0uMjMuMTktLjUxLjM0LS44NC40NS0uMzQuMTEtLjcyLjE3LTEuMTUuMTctLjQ4IDAtLjk1LS4wOS0xLjQxLS4yNy0uNDYtLjE5LS44Ni0uNDEtMS4yLS42OHoiIGZpbGw9IiM1MzUzNTMiLz48L2c+PC9zdmc+"/></a></p><div><h3 id="citeas">Cite this article</h3><p>Grover, W.H. CandyCodes: simple universally unique edible identifiers for confirming the authenticity of pharmaceuticals.
                    <i>Sci Rep</i> <b>12, </b>7452 (2022). https://doi.org/10.1038/s41598-022-11234-4</p><p><a data-test="citation-link" data-track="click" data-track-action="download article citation" data-track-label="link" data-track-external="" href="https://citation-needed.springer.com/v2/references/10.1038/s41598-022-11234-4?format=refman&amp;flavour=citation">Download citation<svg width="16" height="16" focusable="false" role="img" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#global-icon-download"></use></svg></a></p><ul data-test="publication-history"><li><p>Received<span>: </span><span><time datetime="2022-01-06">06 January 2022</time></span></p></li><li><p>Accepted<span>: </span><span><time datetime="2022-04-19">19 April 2022</time></span></p></li><li><p>Published<span>: </span><span><time datetime="2022-05-06">06 May 2022</time></span></p></li><li><p><abbr title="Digital Object Identifier">DOI</abbr><span>: </span><span>https://doi.org/10.1038/s41598-022-11234-4</span></p></li></ul></div></div></div></div></section>

            

            
                <section data-title="Comments"><div id="article-comments-section"><h2 id="article-comments">Comments</h2><p>By submitting a comment you agree to abide by our <a href="https://www.nature.com/info/tandc.html">Terms</a> and <a href="https://www.nature.com/info/community-guidelines.html">Community Guidelines</a>. If you find something abusive or that does not comply with our terms or guidelines please flag it as inappropriate.</p></div></section>
                
            

            </div></div>
  </body>
</html>
