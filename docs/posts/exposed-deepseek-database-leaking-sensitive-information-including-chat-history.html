<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.wiz.io/blog/wiz-research-uncovers-exposed-deepseek-database-leak">Original</a>
    <h1>Exposed DeepSeek database leaking sensitive information, including chat history</h1>
    
    <div id="readability-page-1" class="page"><div><p>Wiz Research has identified a publicly accessible ClickHouse database belonging to DeepSeek, which allows full control over database operations, including the ability to access internal data. The exposure includes over a million lines of log streams containing chat history, secret keys, backend details, and other highly sensitive information. The Wiz Research team immediately and responsibly disclosed the issue to DeepSeek, which promptly secured the exposure. </p><p>In this blog post, we will detail our discovery and also consider the broader implications for the industry at large.   </p><p>DeepSeek, a Chinese AI startup, has recently garnered significant media attention due to its groundbreaking AI models, particularly the DeepSeek-R1 reasoning model. This model rivals leading AI systems like OpenAI’s o1 in performance and stands out for its cost-effectiveness and efficiency. </p><p>As DeepSeek made waves in the AI space, the Wiz Research team set out to assess its external security posture and identify any potential vulnerabilities. </p><p>Within minutes, we found a publicly accessible ClickHouse database linked to DeepSeek, completely open and unauthenticated, exposing sensitive data. It was hosted at oauth2callback.deepseek.com:9000 and dev.deepseek.com:9000. </p><p>This database contained a significant volume of chat history, backend data and sensitive information, including log streams, API Secrets, and operational details.  </p><p>More critically, the exposure allowed for full database control and potential <a href="https://www.wiz.io/academy/privilege-escalation">privilege escalation</a> within the DeepSeek environment, without any authentication or defense mechanism to the outside world. </p><figure></figure><figure></figure><p>Our reconnaissance began with assessing DeepSeek’s publicly accessible domains. By mapping the external attack surface with straightforward reconnaissance techniques (passive and active discovery of subdomains), we identified around 30 internet-facing subdomains. Most appeared benign, hosting elements like the chatbot interface, status page, and API documentation—none of which initially suggested a high-risk exposure. </p><p>However, as we expanded our search beyond standard HTTP ports (80/443), we detected two <strong>unusual, open ports (8123 &amp; 9000)</strong> associated with the following hosts: </p><ul><li><p><a rel="noreferrer noopener" target="_blank" href="http://oauth2callback.deepseek.com:8123/"><u>http://oauth2callback.deepseek.com:8123</u></a>  </p></li><li><p><a rel="noreferrer noopener" target="_blank" href="http://dev.deepseek.com:8123/"><u>http://dev.deepseek.com:8123</u></a>  </p></li><li><p><a rel="noreferrer noopener" target="_blank" href="http://oauth2callback.deepseek.com:9000/"><u>http://oauth2callback.deepseek.com:9000</u></a>  </p></li><li><p><a rel="noreferrer noopener" target="_blank" href="http://dev.deepseek.com:9000/"><u>http://dev.deepseek.com:9000</u></a> </p></li></ul><p>Upon further investigation, these ports led to a <strong>publicly exposed ClickHouse database</strong>, accessible without any authentication at all – immediately raising red flags.  </p><p>ClickHouse is an open-source, columnar database management system designed for fast analytical queries on large datasets. It was developed by Yandex and is widely used for real-time data processing, log storage, and big data analytics, which indicates such exposure as a very valuable and sensitive discovery. </p><figure></figure><p>By leveraging ClickHouse’s HTTP interface, we accessed the /play path, which <strong>allowed direct execution of arbitrary SQL queries</strong> via the browser. Running a simple SHOW TABLES; query returned a full list of accessible datasets. </p><figure><figcaption>Tables output from ClickHouse Web UI</figcaption></figure><p>Among them, one table stood out: log_stream, which contained extensive logs with <strong>highly sensitive data</strong>. </p><p>The log_stream table contained <strong>over 1 million log entries</strong>, with particularly revealing columns: </p><figure></figure><ul><li><p>timestamp – Logs dating from <strong>January 6, 2025</strong> </p></li><li><p>span_name – References to various internal <strong>DeepSeek API endpoints</strong> </p></li><li><p>string.values – <strong>Plaintext logs</strong>, including <strong>Chat History</strong>, <strong>API Keys, backend details, and operational metadata</strong> </p></li><li><p>_service – Indicating which <strong>DeepSeek service</strong> generated the logs </p></li><li><p>_source – Exposing the <strong>origin of log requests</strong>, containing <strong>Chat History, API Keys, directory structures, and chatbot metadata logs</strong> </p></li></ul><figure></figure><p>This level of access posed a critical risk to DeepSeek’s own security and for its end-users. Not only an attacker could retrieve sensitive logs and actual plain-text chat messages, but they could also potentially exfiltrate plaintext passwords and local files along propriety information directly from the server using queries like: SELECT * FROM file(&#39;filename&#39;) depending on their ClickHouse configuration. </p><p>The rapid adoption of AI services without corresponding security is inherently risky. This exposure underscores the fact that the immediate <a href="https://www.wiz.io/academy/ai-security-risks">security risks for AI applications</a> stem from the infrastructure and tools supporting them. </p><p>While much of the attention around AI security is focused on futuristic threats, the real dangers often come from basic risks—like accidental external exposure of databases. These risks, which are fundamental to security, should remain a top priority for security teams. </p><p>As organizations rush to adopt AI tools and services from a growing number of startups and providers, it’s essential to remember that by doing so, we’re entrusting these companies with sensitive data. The rapid pace of adoption often leads to overlooking security, but protecting customer data must remain the top priority. It’s crucial that security teams work closely with AI engineers to ensure visibility into the architecture, tooling, and models being used, so we can safeguard data and prevent exposure. </p><p>The world has never seen a piece of technology adopted at the pace of AI. Many AI companies have rapidly grown into critical infrastructure providers without the security frameworks that typically accompany such widespread adoptions. As AI becomes deeply integrated into businesses worldwide, the industry must recognize the risks of handling sensitive data and enforce security practices on par with those required for public cloud providers and major infrastructure providers.</p></div></div>
  </body>
</html>
