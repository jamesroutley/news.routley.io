<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/ReturnInfinity/BareMetal-OS">Original</a>
    <h1>BareMetal OS</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto">
	<a target="_blank" rel="noopener noreferrer" href="https://metavee.github.io/ReturnInfinity/BareMetal-OS/blob/master/images/BareMetal%20OS%20-%20Light.png#gh-light-mode-only"><img src="https://metavee.github.io/ReturnInfinity/BareMetal-OS/raw/master/images/BareMetal%20OS%20-%20Light.png#gh-light-mode-only"/></a>
	<a target="_blank" rel="noopener noreferrer" href="https://metavee.github.io/ReturnInfinity/BareMetal-OS/blob/master/images/BareMetal%20OS%20-%20Dark.png#gh-dark-mode-only"><img src="https://metavee.github.io/ReturnInfinity/BareMetal-OS/raw/master/images/BareMetal%20OS%20-%20Dark.png#gh-dark-mode-only"/></a>
	<a target="_blank" rel="noopener noreferrer" href="https://metavee.github.io/ReturnInfinity/BareMetal-OS/blob/master/images/Screenshot.png"><img src="https://metavee.github.io/ReturnInfinity/BareMetal-OS/raw/master/images/Screenshot.png"/></a>
</p>
<p dir="auto"><a href="https://github.com/ReturnInfinity/BareMetal-OS/discussions">Discuss this project here</a></p>
<p dir="auto"><strong>BareMetal OS</strong> is an exokernel-based operating system crafted entirely in x86-64 assembly and is designed to provide unparalleled levels of flexibility and efficiency. By exposing hardware resources directly to applications, it empowers developers to finely tune and optimize their software for specific tasks. With the exokernel&#39;s minimalist design, it minimizes the overhead imposed by traditional operating systems, enabling applications to achieve peak performance. Its x86-64 assembly implementation speaks to its commitment to squeezing every ounce of performance from the hardware, making it a compelling choice for those who demand the utmost control and efficiency from their computing environments.</p>
<div dir="auto"><p dir="auto"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</p>
<p dir="auto"><strong>BareMetal OS</strong> is under active development. Some physical hardware configurations may not work correctly.</p>
</div>

<ul dir="auto">
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#components">Components</a></li>
<li><a href="#supported-hardware">Supported hardware</a></li>
<li><a href="#initial-configuration">Initial configuration</a></li>
<li><a href="#building">Building the source code</a></li>
<li><a href="#installing">Installing</a>
<ul dir="auto">
<li><a href="#installing-the-system">Installing the system</a></li>
<li><a href="#installing-the-demos">Installing the demos</a></li>
</ul>
</li>
<li><a href="#running-on-a-virtual-system">Running on a virtual system</a>
<ul dir="auto">
<li><a href="#qemu">QEMU</a></li>
<li><a href="#qemu-via-uefi">QEMU via UEFI</a></li>
<li><a href="#qemu-second-instance">QEMU - Second Instance</a></li>
<li><a href="#vmware">VMware</a></li>
<li><a href="#virtualbox">VirtualBox</a></li>
<li><a href="#bochs">Bochs</a></li>
</ul>
</li>
<li><a href="#running-on-a-physical-system">Running on a physical system</a></li>
</ul>

<p dir="auto">The script in this repo depends on a Debian-based Linux system like <a href="https://www.ubuntu.com/download/desktop" rel="nofollow">Ubuntu</a> or <a href="https://elementary.io" rel="nofollow">Elementary</a>. macOS is also supported to build and test the OS, as well as the Assembly applications, if you are using <a href="https://brew.sh" rel="nofollow">Homebrew</a>.</p>
<ul dir="auto">
<li><a href="https://nasm.us" rel="nofollow">NASM</a> - Assembly compiler to build the loader and kernel, as well as the apps written in Assembly.</li>
<li><a href="https://www.qemu.org" rel="nofollow">QEMU</a> - Computer emulator if you plan on running the OS for quick testing.</li>
<li><a href="https://gcc.gnu.org" rel="nofollow">GCC</a> - C compiler for building C/C++ applications.</li>
<li><a href="https://git-scm.com" rel="nofollow">Git</a> - Version control software for pulling the source code from GitHub.</li>
<li><a href="https://www.gnu.org/software/mtools/" rel="nofollow">mtools</a> - Utilities to access DOS (FAT32) disk images in Unix.</li>
</ul>
<p dir="auto">In Linux this can be completed with the following command:</p>
<div data-snippet-clipboard-copy-content="sudo apt install nasm qemu-system-x86 gcc git mtools"><pre><code>sudo apt install nasm qemu-system-x86 gcc git mtools
</code></pre></div>
<p dir="auto">In macOS via Homebrew this can be completed with the following command:</p>
<div data-snippet-clipboard-copy-content="brew install nasm qemu gcc git mtools"><pre><code>brew install nasm qemu gcc git mtools
</code></pre></div>

<p dir="auto">BareMetal OS consists of several different projects:</p>
<ul dir="auto">
<li><a href="https://github.com/ReturnInfinity/Pure64">Pure64</a> - The software loader.</li>
<li><a href="https://github.com/ReturnInfinity/BareMetal">BareMetal</a> - The kernel.</li>
<li><a href="https://github.com/ReturnInfinity/BareMetal-Monitor">Monitor</a> - A simple command line interface.</li>
<li><a href="https://github.com/ReturnInfinity/BMFS">BMFS</a> - The BareMetal File System utility.</li>
<li><a href="https://github.com/ReturnInfinity/BareMetal-Demo">BareMetal-Demo</a> - Various demo programs.</li>
</ul>

<ul dir="auto">
<li>CPU
<ul dir="auto">
<li>Multi-core on 64-bit x86 systems (Intel/AMD)</li>
</ul>
</li>
<li>Bus
<ul dir="auto">
<li>PCIe</li>
<li>PCI</li>
</ul>
</li>
<li>Network
<ul dir="auto">
<li>Gigabit
<ul dir="auto">
<li>Intel 8254x Gigabit (e1000)</li>
<li>Intel 8257x Gigabit (e1000e)</li>
<li>Realtek 816x/811x Gigabit (rtl8169)</li>
</ul>
</li>
<li>Virtual
<ul dir="auto">
<li>Virtio-Net</li>
</ul>
</li>
</ul>
</li>
<li>Storage
<ul dir="auto">
<li>NVMe</li>
<li>AHCI (SATA)</li>
<li>IDE</li>
<li>Virtio-Blk</li>
</ul>
</li>
</ul>

<div data-snippet-clipboard-copy-content="git clone https://github.com/ReturnInfinity/BareMetal-OS.git
cd BareMetal-OS
./baremetal.sh setup"><pre><code>git clone https://github.com/ReturnInfinity/BareMetal-OS.git
cd BareMetal-OS
./baremetal.sh setup
</code></pre></div>
<p dir="auto"><code>baremetal.sh setup</code> automatically runs the build and install functions. Once the setup is complete you can execute <code>baremetal.sh run</code> to verify that everything installed correctly.</p>


<p dir="auto">This command builds the boot sector, loader (Pure64), kernel, and simple command line interface (Monitor) to the disk image. If you want to attach your own binary to the end of the kernel you can use <code>./baremetal.sh build mybinary.bin</code></p>



<p dir="auto">This command installs the software to the disk image.</p>


<p dir="auto">This command installs the demo programs to the disk image.</p>







<p dir="auto">Running a cloned second instance is useful for testing network connectivity between QEMU systems.</p>




<p dir="auto">Notes:</p>
<ul dir="auto">
<li>The VDI script rewrites the disk ID of the VDI file to avoid the disk warning in VirtualBox.</li>
<li>The <code>Chipset Type</code> for the VirtualBox VM must be <code>ICH9</code></li>
<li>The <code>Storage Controller</code> should be <code>ACHI (SATA)</code> or <code>NVMe (PCIe)</code></li>
</ul>


<p dir="auto">Notes:</p>
<ul dir="auto">
<li>The <code>bochs.cfg</code> file may need to be adjusted for your usage. It was created for a Linux-based system.</li>
<li><code>display_libary</code> is set to use <code>x</code> for X Windows with the GUI Debugger by default. On macOS or Windows you will need to use <code>sdl2</code> with no additional options.</li>
<li>The file paths for <code>romimage</code> and <code>vgaromimage</code> will need to be updated if the Bochs BIOS files are in a different location.</li>
</ul>

<p dir="auto">Booting via BIOS and UEFI is supported. Secure boot in UEFI mode must be disabled since this software isn&#39;t signed. You may need to press <kbd>DEL</kbd> or <kbd>F12</kbd> on the keyboard on power-up to select the boot drive.</p>
<p dir="auto">Debug logging is output via the serial port (115200 bps, 8 data bits, 1 stop bit, no parity, no flow control). The output should look similar to this:</p>
<div data-snippet-clipboard-copy-content="[ Pure64 ]
boot bios
pml4 ok
acpi ok
bsp ok
pic ok
smp ok
kernel start

[ BareMetal ]
64
bus
storage
network
system ready"><pre><code>[ Pure64 ]
boot bios
pml4 ok
acpi ok
bsp ok
pic ok
smp ok
kernel start

[ BareMetal ]
64
bus
storage
network
system ready
</code></pre></div>
<div dir="auto"><p dir="auto"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>Important</p><p dir="auto">Booting from a floppy or USB drive works. For BIOS-based floppy boot and UEFI-based USB drive booting there is a RAM drive image loaded that contains the demo programs.</p>
</div>
<div dir="auto"><p dir="auto"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M4.47.22A.749.749 0 0 1 5 0h6c.199 0 .389.079.53.22l4.25 4.25c.141.14.22.331.22.53v6a.749.749 0 0 1-.22.53l-4.25 4.25A.749.749 0 0 1 11 16H5a.749.749 0 0 1-.53-.22L.22 11.53A.749.749 0 0 1 0 11V5c0-.199.079-.389.22-.53Zm.84 1.28L1.5 5.31v5.38l3.81 3.81h5.38l3.81-3.81V5.31L10.69 1.5ZM8 4a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 4Zm0 8a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Caution</p><p dir="auto">Doublecheck that you are writing the disk image to the correct disk</p>
</div>
<div data-snippet-clipboard-copy-content="dd if=baremetal_os.img of=/dev/sdc"><pre><code>dd if=baremetal_os.img of=/dev/sdc
</code></pre></div>
<p dir="auto">Once the disk image is written you can install the disk in the system and boot from it.</p>
<p dir="auto">// EOF</p>
</article></div></div>
  </body>
</html>
