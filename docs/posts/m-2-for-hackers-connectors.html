<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://hackaday.com/2022/11/03/m-2-for-hackers-connectors/">Original</a>
    <h1>M.2 for Hackers – Connectors</h1>
    
    <div id="readability-page-1" class="page"><div itemprop="articleBody">
        <p>In <a href="https://hackaday.com/2022/10/27/m-2-for-hackers-expand-your-laptop/">the first M.2 article,</a> I’ve described real-world types and usecases of M.2 devices, so that you don’t get confused when dealing with various cards and ports available out there. I’ve also designed quite a few M.2 cards and card-accepting adapters myself. And today, I’d like to tell you everything you need to know in order to build M.2 tech on your own.</p>
<p>There’s two sides to building with M.2 – adding M.2 sockets onto your PCBs, and building the PCBs that are M.2 cards. I’ll cover both of these, starting with the former, and knowing how to deal with M.2 sockets might be the only thing you ever need. Apart from what I’ll be describing, there’s some decent guides you can learn bits and pieces from, like <a href="https://learn.sparkfun.com/tutorials/designing-with-micromod" target="_blank">the Sparkfun MicroMod design guide,</a> most of which is MicroMod-specific but includes quite a few M.2 tips and tricks too.</p>
<h2>First, Let’s Talk About The Y-Key</h2>
<p>What could you do with a M.2 socket on your PCB? For a start, many tasty hobbyist-friendly SoMs and CPUs now have a PCIe interface accessible, and if you’re building a development board or a simple breakout, an M.2 socket will let you connect an NVMe SSD for all your high-speed low-power storage needs – many Raspberry Pi Compute Module mainboards have M.2 M-key sockets specifically for that, and there’s <a href="https://hackaday.com/2021/03/29/nvme-boot-finally-comes-to-the-pi-compute-module-4/">NVMe support</a> in the RPi firmware to boot. Plus, you can always plug a full-sized PCIe adapter or an extender into such a socket and connect a PCIe network card or other much-needed device – even perhaps, <a href="https://hackaday.com/2022/04/28/a-real-gpu-on-the-raspberry-pi-barely/">an external GPU!</a> However, as much as PCIe-equipped SoMs are tasty, they’re far from the only reason to use M.2 sockets.</p>

<p><img data-attachment-id="560807" data-permalink="https://hackaday.com/2022/11/03/m-2-for-hackers-connectors/hadimg_m2_sockets_5/" data-orig-file="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_5.jpg" data-orig-size="600,365" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="hadimg_m2_sockets_5" data-image-description="" data-image-caption="" data-medium-file="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_5.jpg?w=400" data-large-file="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_5.jpg?w=600" decoding="async" loading="lazy" src="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_5.jpg?w=400" alt="" width="400" height="243" srcset="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_5.jpg 600w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_5.jpg?resize=250,152 250w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_5.jpg?resize=400,243 400w" sizes="(max-width: 400px) 100vw, 400px"/>PCIe itself is an interface <a href="https://twitter.com/whitequark/status/1552038782060437507" target="_blank">increasing in its popularity</a> and accessibility. We’ve covered someone make an <a href="https://hackaday.com/2022/04/20/developing-your-own-digital-film/">adapter aimed at digital cameras,</a> letting you use NVMe SSDs in place of CFExpress cards – both interfaces with PCIe as their backbone. A different adapter we’ve seen lets you <a href="https://hackaday.com/2020/04/27/adapter-brings-m-2-wifi-cards-to-the-pinebook-pro/">put a PCIe WiFi card into a Pinebook,</a> helping you increase the WiFi speeds quite a bit. And of course, it’s not just PCIe, not even when coupled with SATA or USB. Would you like to design a RISC-V <a href="https://www.phoronix.com/news/Ubuntu-22.10-LicheeRV-RISC-V" target="_blank">Linux-capable</a> SBC into a board of yours? Well, Sipeed <a href="https://twitter.com/Sosowski/status/1481716036089139206" target="_blank">makes one of the few RISC-V SoMs available right now,</a> called LicheeRV, and it’s a $20 SOM using two M.2 B-key connectors with a completely custom pinout.</p>
<p>You can do a lot with a low-footprint group of 67 pins, it turns out. For instance, <a href="https://www.sparkfun.com/micromod" target="_blank">Sparkfun MicroMod</a> is a microcontroller ecosystem that makes use of M.2 hardware with a custom pinout – in MicroMod’s case, it’s E-key hardware, with custom card length and the retention screw location being shifted so that WiFi cards can’t be plugged in. For hobbyists, they’re a neat and funky ecosystem with tons of different CPUs and sensors to play with – in business speak, they let us evaluate a variety of different processors for our applications. In fact, last year’s <a href="https://hackaday.com/2021/11/10/the-hackaday-remoticon-2-badge-an-exercise-in-your-own-ingenuity/">Remoticon badge spin by [Thomas Flummer]</a> was designed for MicroMod CPUs, and just recently, [tzarc] <a href="https://discord.gg/UfF2g7YG" target="_blank">on Hackaday Discord</a> told us they had plenty of fun building <a href="https://github.com/tzarc/ghoul" target="_blank">a MicroMod-based keyboard!</a></p>
<p><img data-attachment-id="560806" data-permalink="https://hackaday.com/2022/11/03/m-2-for-hackers-connectors/hadimg_m2_sockets_4/" data-orig-file="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_4.jpg" data-orig-size="4032,3024" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;1&#34;}" data-image-title="hadimg_m2_sockets_4" data-image-description="" data-image-caption="" data-medium-file="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_4.jpg?w=400" data-large-file="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_4.jpg?w=800" decoding="async" loading="lazy" src="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_4.jpg?w=400" alt="" width="400" height="300" srcset="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_4.jpg 4032w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_4.jpg?resize=250,188 250w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_4.jpg?resize=400,300 400w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_4.jpg?resize=800,600 800w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_4.jpg?resize=1536,1152 1536w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_4.jpg?resize=2048,1536 2048w" sizes="(max-width: 400px) 100vw, 400px"/>My own work with M.2 is mainly about improving laptops and bringing new life into old hardware. For instance, I’ve built quite a few adapters for reviving old laptops – i.e. small-footprint <a href="https://github.com/CRImier/MyKiCad/tree/master/Laptop%20mods/mpcie_nvme" target="_blank">mPCIe to M.2 M-key NVMe adapters,</a> which me and my friends use to put fast and cheap NVMe SSDs into old but still usable machines. I’ve also built a trove of M.2 key-to-key adapters for my friends’ usecases, such as one that lets you <a href="https://github.com/CRImier/MyKiCad/blob/master/Laptop%20mods/nvme_ae_to_m/" target="_blank">replace an A/E WiFi card with a M-key SSD</a>, or <a href="https://github.com/CRImier/MyKiCad/blob/master/Laptop%20mods/nvme_bm_to_e/" target="_blank">vice-versa,</a> and <a href="https://github.com/CRImier/MyKiCad/tree/master/Repairs/xserve_sata_adapter" target="_blank">an adapter for Apple Xserve boards</a> to use M.2 SATA SSDs in its proprietary SATA boot drive connector.</p>
<p>There’s a lot of fun to be had with M.2 sockets. Now – how?</p>
<h2>Mechanical Mandates</h2>
<p>What does it take for you to add a M.2 socket? Mechanically, its footprint, as well as some free board space. Let’s talk about board space first. Of course, you can make the card hang off your PCB – transferring the problem from the “PCB space” to the “space inside your case” area, but you still need to account for size. M.2 card size is described with four digits in WWHH format, which are width and height in millimeters – a 3042 WWAN card is 30mm wide and 42mm tall (including the card edge), and a 2280 SSD is 22mm wide and 80mm tall. When putting a footprint on a PCB, the exact location of the card edge related to the footprint will either be explicitly shown in the datasheet, or can be inferred from the cross-section image.</p>
<p><img data-attachment-id="560852" data-permalink="https://hackaday.com/2022/11/03/m-2-for-hackers-connectors/hadimg_m2_sockets_8-2/" data-orig-file="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_8.jpeg" data-orig-size="4032,3024" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;2.2&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;iPhone 6s&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;1667245116&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;4.15&#34;,&#34;iso&#34;:&#34;320&#34;,&#34;shutter_speed&#34;:&#34;0.058823529411765&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;1&#34;}" data-image-title="hadimg_m2_sockets_8" data-image-description="" data-image-caption="" data-medium-file="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_8.jpeg?w=400" data-large-file="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_8.jpeg?w=800" decoding="async" loading="lazy" src="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_8.jpeg?w=400" alt="" width="400" height="300" srcset="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_8.jpeg 4032w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_8.jpeg?resize=250,188 250w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_8.jpeg?resize=400,300 400w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_8.jpeg?resize=800,600 800w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_8.jpeg?resize=1536,1152 1536w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_8.jpeg?resize=2048,1536 2048w" sizes="(max-width: 400px) 100vw, 400px"/>There’s various M.2 sockets you can get – I separate them into mid-mount, flat and angled insertion, and their most important difference is the height above your PCB. M.2 socket PCB-to-card distances are actually standardized, but mid-mount and flat-mounted sockets are a less-than-standardized area – nevertheless, they’re extremely useful for making your projects small and thin. I’m a big fan of using flat sockets because they just hold your card in place, no standoff required – that said, they likely won’t work well with double-sided cards like some fancier SSDs, and I wouldn’t dare put components under the card either.</p>
<p>Most of the M.2 sockets, regardless of the height, use the same exact PCB footprint, since it’s standardized as well – save for mid-mount sockets, which are very useful when you need to save vertical space, but their footprints vary quite a bit more. This footprint is actually standardized in the spec and will be the same for overwhelming majority of the sockets you encounter. A friend has recently shown to me, however, that this isn’t always the case – <a href="https://lcsc.com/product-detail/Card-Edge-Connectors_LOTES-APCI0162-P001A_C841662.html" target="_blank">LOTES APCI0162</a> is an example of an angled insertion connector that has lower distance between pads than the usual footprint sockets do. So, do recheck the footprint when buying a new part, just in case!</p>
<h2>Acquisition And Attachment</h2>
<p>Proper places like Digikey and Mouser will have M.2 connectors nicely sorted by key, height and mounting type. In case you, like me, choose price over convenience by shopping at LCSC, about a month ago I’ve <a href="https://gist.github.com/CRImier/43406e05fdb6c857342eed8243dfb5c7" target="_blank">compiled a small database of then-in-stock M.2 sockets on LCSC,</a> since LCSC is so bad at actually keeping track of the important parameters. There’s even some G-key sockets in case your contraptions are too wacky to fit the in-spec pinouts!</p>
<p>I couldn’t find M.2 socket footprints in KiCad standard library – if you don’t mind borrowing footprints, I have some for you to reuse. Here’s footprints for <a href="https://github.com/CRImier/MyKiCad/blob/master/Laptop%20mods/mpcie_nvme/nvme_lib/Conn_TE-M.2-0.5-67P-doublesided_TypeM.kicad_mod" target="_blank">M</a>, <a href="https://github.com/CRImier/MyKiCad/blob/master/Repairs/xserve_sata_adapter/Conn_TE-M.2-0.5-67P-doublesided_TypeB.kicad_mod" target="_blank">B</a> and E-key sockets, and here’s an<a href="https://github.com/CRImier/MyKiCad/blob/master/Laptop%20mods/mpcie_nvme/nvme_lib/Conn_TE-M.2-0.5-67P-doublesided.kicad_mod" target="_blank"> “all M.2 socket pads” footprint</a> – if you need a G-key or some other socket footprint, take this one and remove the pins you don’t need. This is, again, the standardized footprint that most angled-insertion and flat sockets will fit, but do check if your specific one does.</p>
<figure id="attachment_560803" aria-describedby="caption-attachment-560803"><img data-attachment-id="560803" data-permalink="https://hackaday.com/2022/11/03/m-2-for-hackers-connectors/hadimg_m2_sockets_1/" data-orig-file="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_1.jpeg" data-orig-size="1280,960" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="hadimg_m2_sockets_1" data-image-description="" data-image-caption="" data-medium-file="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_1.jpeg?w=400" data-large-file="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_1.jpeg?w=800" decoding="async" loading="lazy" src="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_1.jpeg?w=400" alt="" width="400" height="300" srcset="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_1.jpeg 1280w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_1.jpeg?resize=250,188 250w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_1.jpeg?resize=400,300 400w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_1.jpeg?resize=800,600 800w" sizes="(max-width: 400px) 100vw, 400px"/><figcaption id="caption-attachment-560803">if you forget to add a standoff, you’ll have to improvise</figcaption></figure>
<p>With angled insertion cards, you’ll want a standoff – otherwise, it’s not likely that the card will mechanically connect until you hold it down properly. M2 hardware will work best, and M2.5 will work in a pinch. If the card will be fastened into your case, you’ll probably grab some threaded inserts and be done with it. If you need to fasten your SSD to your PCB, however, you’ll want solderable standoffs – and when shopping at LCSC, <a href="https://twitter.com/S0lll0s/status/1541910633859485699" target="_blank">s-ol on Twitter reminds us</a> that we can find them using the keyword “smtso”.</p>
<p>What about assembly? My experience is that you’ll absolutely want a stencil with solder paste, as these are pretty dense 0.5 mm pitch parts, and a hot air gun/hotplate/reflow oven will work best. That said, with a thin enough tip and maybe preheating, you can stencil your board and then use a soldering iron in a pinch, too, or perhaps thin solder with thin iron tip – but it will be tiresome if you want to assemble more than two or three boards.</p>
<p>After soldering, you might still end up with solder bridges between pins – in my experience, you can clear these bridges beautifully by heating the bridge area through a narrow hot air gun nozzle from below, adding flux after the bridge’s melted and then using sharp tweezers or a needle to mechanically separate the pins. If the short joins right after separation because you stenciled too much solder paste on the pads, using good old solder wick beforehand should help too.</p>
<h2>Electrical Essentials</h2>
<figure id="attachment_560840" aria-describedby="caption-attachment-560840"><img data-attachment-id="560840" data-permalink="https://hackaday.com/2022/11/03/m-2-for-hackers-connectors/hadimg_m2_sockets_7a/" data-orig-file="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_7a.jpg" data-orig-size="758,672" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="hadimg_m2_sockets_7a" data-image-description="" data-image-caption="&lt;p&gt;Not just any socket will do.&lt;/p&gt;
" data-medium-file="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_7a.jpg?w=400" data-large-file="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_7a.jpg?w=705" decoding="async" loading="lazy" src="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_7a.jpg?w=400" alt="" width="400" height="355" srcset="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_7a.jpg 758w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_7a.jpg?resize=250,222 250w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_7a.jpg?resize=400,355 400w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_7a.jpg?resize=705,625 705w" sizes="(max-width: 400px) 100vw, 400px"/><figcaption id="caption-attachment-560840">Not just any socket will do.</figcaption></figure>
<p>For PCIe, I recommend you use M-key for SSDs, B-key for WWAN-compatible cards and E-key for WiFi-compatible slots. These three slots can handle up to 4x, 2x and 1x wide PCIe links respectively, but even if you only have 1x PCIe on your CPU, you can use either of these three, only connecting the first lane pins – read <a href="https://hackaday.com/2021/02/03/the-bus-thats-not-a-bus-the-joys-of-hacking-pci-express/">our PCIe hacking article</a> if you’d like to know more. If SATA is what you want instead, it’s also pretty simple, just two diffpairs. At that, you can use either B-key or M-key, since overwhelming majority of SATA SSDs are B+M – here’s <a href="https://github.com/CRImier/MyKiCad/tree/master/Laptop mods/satappy" target="_blank">a board where I used M-key for SATA,</a> simply because by that point I stocked up on some nice M-key sockets.</p>
<p>Where do you get pinouts and symbols from? For a start, there’s symbols in KiCad standard library, at least, in KiCad 6. Other than that, you can, yet again, get symbols from my repo – I got some for <a href="https://github.com/CRImier/MyKiCad/blob/master/Laptop%20mods/nvme_ae_to_m/nvme.lib" target="_blank">M-key, B-key, B+M key, A+E key and E-key</a>; these work with both sockets and cards, as the footprints for cards will just ignore lack of the mounting pads that are present on the sockets. If those are limiting and you need more specific ones, there’s always the dodgy websites, and the specification floating around that I mentioned in the end of the last article.</p>
<p>M.2 cards will only require 3.3 V, but they might use up quite a bit of current. If you’re building custom cards, that won’t be an issue, since you know how much your device might consume. When reusing existing SSDs, WiFi and WWAN cards in your designs, however, things might get a bit more complex. Learning from laptop schematics is the simplest way – to sum it up, providing 1 A – 2 A for WiFi cards and 1 A – 3 A for WWAN and SSD cards is likely a good idea. Also, the M.2 specification mentions some WWAN cards may be built for input voltage in single-cell LiIon range (3 V-4.2 V) instead of 3.3 V. You likely won’t encounter such cards and it’s likely to be written on the label or first page of the datasheet, but this is good to know about nevertheless.</p>
<figure id="attachment_560839" aria-describedby="caption-attachment-560839"><img data-attachment-id="560839" data-permalink="https://hackaday.com/2022/11/03/m-2-for-hackers-connectors/hadimg_m2_sockets_8/" data-orig-file="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_8.jpg" data-orig-size="4160,3120" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="hadimg_m2_sockets_8" data-image-description="" data-image-caption="" data-medium-file="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_8.jpg?w=400" data-large-file="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_8.jpg?w=800" decoding="async" loading="lazy" src="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_8.jpg?w=400" alt="" width="400" height="300" srcset="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_8.jpg 4160w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_8.jpg?resize=250,188 250w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_8.jpg?resize=400,300 400w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_8.jpg?resize=800,600 800w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_8.jpg?resize=1536,1152 1536w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_8.jpg?resize=2048,1536 2048w" sizes="(max-width: 400px) 100vw, 400px"/><figcaption id="caption-attachment-560839">An adapter tapping PCIe from proprietary Dell ODD bay and adding a SATA SSD in there while at it</figcaption></figure>
<p>PCIe cards require PERST, CLKREQ and PEWAKE signals. That said, CLKREQ is used for gating the clock for power management purposes, and can be tied to GND on the PCIe host side – as a testament to that, the ever-abundant USB 3-cable-abusing PCIe 1x risers only forward PEWAKE and PERST. For W_DISABLE signals on WWAN and WiFi cards, you might want to add pullups to VCC – I believe they’re active low, but please do double-check. DAA/DSS signal on SATA and NVMe is a nice ‘drive activity’ open-drain signal that you can use to drive a LED. SUSCLK is a 32 kHz clock useful for card power-saving but not required in practice, and DEVSLP is <a href="https://en.wikipedia.org/wiki/DevSlp" target="_blank">a SATA-only low-power mode</a> signal. I2C signals likely won’t be useful, but it won’t hurt if you connect them to your target – through 0R resistors, just in case.</p>
<h2>Nifty Niceties</h2>
<p>Building a higher-current card, or card+host combination? Technically, M.2 connectors are rated at 0.5 A per pin, so, M-key with its nine 3.3 V pins would result in 4.5 A max – that said, the recommendation for M-key is to not exceed 2.5 A, and that’s what you’ll want to adhere to. In case both sides of the equation are under your control and you’re creating your own pinout (preferably, using something like G-key), go wild and make use of as many pins with as many different voltages as you want. I just wish that Sipeed knew that when designing LicheeRV – apparently, they <a href="https://dl.sipeed.com/shareURL/LICHEE/D1/Lichee_RV/HDK/2_Schematic" target="_blank">only use one M.2 socket pin</a> for feeding 5 V into the baseboard. I don’t know if it’s an actual problem, but it looks suboptimal for sure!</p>
<p><img data-attachment-id="560808" data-permalink="https://hackaday.com/2022/11/03/m-2-for-hackers-connectors/hadimg_m2_sockets_6/" data-orig-file="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_6.jpg" data-orig-size="3120,4160" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="hadimg_m2_sockets_6" data-image-description="" data-image-caption="" data-medium-file="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_6.jpg?w=300" data-large-file="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_6.jpg?w=469" decoding="async" loading="lazy" src="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_6.jpg?w=300" alt="" width="300" height="400" srcset="https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_6.jpg 3120w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_6.jpg?resize=188,250 188w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_6.jpg?resize=300,400 300w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_6.jpg?resize=469,625 469w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_6.jpg?resize=1152,1536 1152w, https://hackaday.com/wp-content/uploads/2022/10/hadimg_m2_sockets_6.jpg?resize=1536,2048 1536w" sizes="(max-width: 300px) 100vw, 300px"/>Facing an unjustifiably non-populated M.2 socket on your laptop’s mainboard? Finding a receptacle won’t be the hard part, what’s with footprints being standardized – especially if you have the schematics, as those often list the connector part number. Soldering the connector on would be trickier, however, as you can’t exactly stencil it on a populated mainboard. I recommend you wick off the factory-applied solder first so that the connector can sit flush to the PCB, then put the connector on, and use a thin tip soldering iron with thin solder to attach pads one-by-one. From there, it might be that some power management parts and signal passives, say, capacitors will be unpopulated. A good value for PCIe or SATA series capacitors <a href="https://electronics.stackexchange.com/questions/632972/can-i-use-a-250-nf-instead-of-a-200-nf-smd-ceramic-capacitor" target="_blank">is about 220nF;</a> USB signals and stuff like PEWAKE/CLKREQ/PERST can be jumpered with something like 0R or 22 R, power management can typically just be jumpered to 3.3 V, and many other signals you’ll find to be optional.</p>
<p>Now, you’re well-equipped to build and hack M.2-accepting stuff, and know quite a few places where it’s useful. Next time, I want to show you how to build M.2 cards – there’s a trove of cool applications for these as well!</p>
	            </div></div>
  </body>
</html>
