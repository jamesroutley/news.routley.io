<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://kracekumar.com/post/rafting_raft/">Original</a>
    <h1>Rafting Raft Workshop</h1>
    
    <div id="readability-page-1" class="page"><article role="main">
        <p>Last week, May 2-6, 2022, I attended <a href="http://www.dabeaz.com/raft.html">Rafting Raft</a> workshop by <a href="http://www.dabeaz.com/index.html">David Beazley</a>.
The workshop focussed on building a raft implementation and it was intense and exhausting.</p>
<p>A few folks had asked me about the workshop and how it works. The post focuses on what happens before and during the workshop,
so future attendees can decide.</p>

<p>Someday when you’re contemplating attending the workshop, you register on <a href="http://www.dabeaz.com/raft.html">the website</a>.
You get a confirmation email from David Beazley to confirm your availability to attend the workshop.</p>
<p>Email looks like</p>
<blockquote>
<p>Thanks for your interest in the upcoming Raft course.   I can confirm that space is available.  I simply need you to confirm your email by replying to this message.  Once I hear back, I will provide more details about logistics and other details.   Hopefully, I’ll see you in the course!</p>
</blockquote>

<p>You will receive a stripe link to pay the workshop fee. The workshop cost was $1250. Is it worth paying $1250 for 5 days workshop? It’s subjective!</p>

<p>You will receive an email asking for a Github username for <a href="https://github.com/dabeaz-course">collaboration</a> to a private repo.</p>

<p>Later you will be added to a Github repo with instructions to follow and preparation materials. The live discussion during the session happens in gitter channel.</p>

<p>Reminder about the workshop and materials to read up and programming warmup tasks - socket programming, concurrency primitives.
You introduce yourself in a Github thread.</p>

<p>Reminder about the workshop.</p>

<p>The workshop started on India time, 8:00 PM, and went to till 4:00 AM in Zoom.</p>
<p>The first day was divided into a presentation session and an implementation session.
In the presentation session, Beazley walked us through the housekeeping tasks, - introduction, the structure of the workshop, and warm-up tasks.</p>
<p>In the implementation session, David started sharing his setup and started coding the tasks.
The first day was warmup tasks on <code>socket programming</code>, <code>concurrency primitives</code>, and <code>implementing a simple Key-Value server</code>
that will be used as an application for forthcoming raft implementation.</p>
<p>Another implementation session was focused on building a traffic system with two traffic lights and some constraints.</p>
<p>The first day was filled with the necessary concepts for next four days.</p>
<p>All the presentation sessions were recorded and uploaded to Vimeo by the end of the day.</p>
<p>These presentation sessions were lively and hands-on, the participants ask questions during the session.</p>
<p>The format</p>
<ul>
<li>Presentation/Discussion - 1 hour</li>
<li>Project implementation - 2 hours</li>
<li>Presentation/Discussion - 1 hour</li>
<li>Break - 1 hour</li>
<li>Implementation - 2 hour</li>
<li>Discussion - 1 hour</li>
</ul>
<p>At the end of the day, it was clear, what to expect and how you will go about implementing raft.</p>
<p>The entire implementation was split into multiple projects</p>
<ul>
<li>Project 1 - Key-Value Server</li>
<li>Project 2 - Event Driven Programming</li>
<li>Project 3 - Starting Out/Planning</li>
<li>Project 4 - The Log</li>
<li>Project 5 - Log Replication</li>
<li>Project 6 - Consensus</li>
<li>Project 7 - Leader Election</li>
<li>Project 8 - Testing</li>
<li>Project 9 - Simulation</li>
<li>Project 10 - The System</li>
<li>Project 11 - The Rest of Raft</li>
</ul>

<p>The day started with the discussion on how to layout the project - different message types, components, timers, elections, log replications etc. How should we approach implementing the algorithm?
All the participants started building an outline of the project - <code>handlers, messages, enums, classes, etc...</code></p>
<p>After the break, David discussed the topic of <code>log and log replication.</code>
He gave the rationale why this is core and the first and most important piece to implement.</p>
<p>Everyone pushed their code to a separate branch in a shared Github repository including David.
So it was easy to cross verify the implementation and look it up.</p>
<p>There was discussion on how to test the components, especially unit tests.</p>
<p>Everyone used Python and but you’re free to use any language.</p>

<p>We’re halfway through the workshop. At this point, more or less project structure, the core modules, and the style of programming are clear.
Now the use of event-driven programming and the simplicity of using queues to communicate is clear.</p>
<p>The main discussion of the day was <code>consensus</code> while applying the requests. Without consensus from the raft, the application cannot commit the changes. The implementation was focused on getting consensus working.</p>

<p>David started the day with TLA+ and he implemented a simple TLA+ for a traffic system that was implemented earlier.
He shared his experience with using TLA+ for distributed systems.</p>
<p>While looking at the <a href="https://github.com/ongardie/raft.tla/blob/master/raft.tla">Raft TLA+</a>, we noticed extra fields in the
RPC messages.</p>
<p>Then we continued implementation of the project on pending tasks in log replication and consensus.</p>
<p>After the break, David presented the leader election along with various cases and edge cases that aren’t clear from the paper.
Then we continued to implement the leader election for the rest day.</p>

<p>On the last day, David discussed how to design the application to communicate with the raft server.
For all practical purposes, the raft was implemented like a module inside the Key-Value server.</p>
<p>Everyone agreed the code looked like a big ball of mud.
The complexity of designing the distributed system in 4 days with
perfect separation of concern and testable code is hard. The question of testing was the main point during every component implementation. Especially, how do we do integration tests?</p>
<p>We continued to implement the rest of the pending pieces in the project.
I was tired by the middle of the day and slept off :P</p>

<ul>
<li>
<p>It was neatly organized and focused on implementing the raft <strong>correctly</strong>.
I stress correctly because it is easy to overlook certain portions and paper ends up implementing something close enough. How do you verify the correctness of implementation?</p>
</li>
<li>
<p>David has done the workshop more than 10 times and focussing on one topic a day helped to
understand and implement.</p>
</li>
<li>
<p>I haven’t completed the entire raft implementation. Need to complete leader election edge cases and backtracking out-of-sync followers.</p>
</li>
<li>
<p>The workshop was attended by 13 folks - the participants were from India, the UK, France, and the USA.</p>
</li>
<li>
<p>The workshop format may change in the future, it’s better to email all the doubts to David Beazley.</p>
</li>
<li>
<p>It’s a fun and intense workshop. Give it a try!</p>
</li>
</ul>

<ul>
<li><a href="https://kracekumar.com/post/rafting_raft/raft.github.io/">Raft web page</a></li>
<li><a href="https://github.com/ongardie/raft.tla/blob/master/raft.tla">Raft TLA+</a></li>
<li><a href="https://eli.thegreenplace.net/2020/implementing-raft-part-0-introduction/">Implementing Raft by Eli Bendersky</a></li>
<li><a href="https://chelseatroy.com/tag/raft/">Chelsa Troy’s Raft Tutorial</a></li>
<li><a href="https://indradhanush.github.io/blog/notes-on-raft/">Indradhanush Notes on Raft</a></li>
</ul>


        
          
        

        

        
          

          
                  
       <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"/></a></article></div>
  </body>
</html>
