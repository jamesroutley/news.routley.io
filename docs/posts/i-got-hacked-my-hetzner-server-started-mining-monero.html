<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.jakesaunders.dev/my-server-started-mining-monero-this-morning/">Original</a>
    <h1>I got hacked: My Hetzner server started mining Monero</h1>
    
    <div id="readability-page-1" class="page"><div>
                <!-- Toc if any -->
                
                <!-- End Toc -->
                <blockquote>
  <p>Edit: This got way more attention than I was ever expecting. I originally asked claude to draft it from a transcript
of my panicked messages and the feedback was clear, nobody likes AI slop. As a result I’ve redrafted it this morning
to fix some inaccuracies and make it sound human. - Jake</p>
</blockquote>

<p><em>Or: How I learned that “I don’t use Next.js” doesn’t mean your dependencies don’t use Next.js</em></p>

<h2 id="825-am-the-email">8:25 AM: The Email</h2>

<p>I woke up to this beauty from Hetzner:</p>

<blockquote>
  <p>Dear Mr Jake Saunders,</p>
</blockquote>

<blockquote>
  <p>We have indications that there was an attack from your server.
Please take all necessary measures to avoid this in the future and to solve the issue.</p>
</blockquote>

<blockquote>
  <p>We also request that you send a short response to us. This response should contain information about how this could
have happened and what you intend to do about it.
In the event that the following steps are not completed successfully, your server can be blocked at any time after the
2025-12-17 12:46:15 +0100.</p>
</blockquote>

<blockquote>
  <p>Attached was evidence of network scanning from my server to some IP range in Thailand. Great. Nothing says “good
morning” like an abuse report and the threat of getting your infrastructure shut down in 4 hours.</p>
</blockquote>

<p>Background: I run a Hetzner server with Coolify. It runs all my <em>stuff</em>, like my little corner of the internet:</p>

<ul>
  <li><a href="https://inventronix.club/connect">My IoT Side Project</a></li>
  <li>This Blog</li>
  <li>Analytics</li>
  <li>My dads site (he’s an electrician)</li>
</ul>

<h2 id="830-am-oh-fuck">8:30 AM: Oh Fuck</h2>

<p>First thing I did was SSH in and check the load average:</p>

<div><div><pre><code><table><tbody><tr><td><pre>1
2
</pre></td><td><pre><span>$ </span>w
 08:25:17 up 55 days, 17:23,  5 <span>users</span>,  load average: 15.35, 15.44, 15.60
</pre></td></tr></tbody></table></code></pre></div></div>

<p>I run a bunch of Go backend services and some SvelteKit frontend stuff on there. My grand total of daily users peaks at
20, so something was very wrong.</p>

<p>I ran <code>ps aux</code> to see what was eating my CPU:</p>

<div><div><pre><code><table><tbody><tr><td><pre>1
2
3
4
5
6
</pre></td><td><pre>USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
1001      714822  819  3.6 2464788 2423424 ?     Sl   Dec16 9385:36 /tmp/.XIN-unix/javae
1001       35035  760  0.0      0     0 ?        Z    Dec14 31638:25 [javae] &lt;defunct&gt;
1001     3687838  586  0.0      0     0 ?        Z    Dec07 82103:58 [runnv] &lt;defunct&gt;
1001     4011270  125  0.0      0     0 ?        Z    Dec11 10151:54 [xmrig] &lt;defunct&gt;
1001       35652 62.3  0.0      0     0 ?        Z    Dec12 4405:17 [xmrig] &lt;defunct&gt;
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>819% CPU usage.</strong> On a process called <code>javae</code> running from <code>/tmp/.XIN-unix/</code>. And multiple <code>xmrig</code> processes - that’s
literally cryptocurrency mining software (Monero, specifically).</p>

<p>Looks like I’d been mining cryptocurrency for someone since December 7th. For <strong>ten days</strong>. Brilliant.</p>

<h2 id="the-investigation">The Investigation</h2>

<p>My first thought was “I’m completely fucked.” My host had been running a crypto miner for a week, the whole think was
borked. Time to just nuke it from orbit and rebuild.</p>

<p>Fortunately, I had the foresight to do a little detective work beforehand to at least learn how I’d been compromised so
I could learn for the future. I set out to do this with the help of Claude (this is not my speciality).</p>

<p>First, I noticed something interesting. All these processes were running as user <code>1001</code>. Not root. Not a system user.
UID 1001.</p>

<p>Let me check what’s actually running:</p>



<div><div><pre><code><table><tbody><tr><td><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td><pre>CONTAINER ID   IMAGE                                                               CREATED       STATUS                 PORTS            NAMES
c604f579efd5   dsw80g4w8g0kgog8oskc0sks:63e3be6167b43de47663445dd72f92f97887b843   2 days ago    Up 2 days <span>(</span>healthy<span>)</span>     <span>[</span>DELETED]       dsw80g4w8g0kgog8oskc0sks-075301203997
00aec82c2650   o4wk8gsckwgkcgcgkcw8gcsc:40497e7208602d31d7b5e58af4f2e86611b9850c   2 days ago    Up 2 days               <span>[</span>DELETED]       o4wk8gsckwgkcgcgkcw8gcsc-072326337252
a42f72cb1bc5   ghcr.io/umami-software/umami:postgresql-latest                      9 days ago    Up 9 days <span>(</span>healthy<span>)</span>     <span>[</span>DELETED]       umami-bkc4kkss848cc4kw4gkw8s44
7c365a792902   postgres:16-alpine                                                  9 days ago    Up 9 days <span>(</span>healthy<span>)</span>     <span>[</span>DELETED]       postgresql-bkc4kkss848cc4kw4gkw8s44
af077d142471   ghcr.io/coollabsio/coolify:4.0.0-beta.452                           10 days ago   Up 10 days <span>(</span>healthy<span>)</span>    <span>[</span>DELETED]       coolify
fdc3cc9b926b   ghcr.io/coollabsio/coolify-realtime:1.0.10                          10 days ago   Up 10 days <span>(</span>healthy<span>)</span>    <span>[</span>DELETED]       coolify-realtime
d3dc2af3ff4d   postgres:15-alpine                                                  10 days ago   Up 10 days <span>(</span>healthy<span>)</span>    <span>[</span>DELETED]       coolify-db
dc77adba40bb   redis:7-alpine                                                      10 days ago   Up 10 days <span>(</span>healthy<span>)</span>    <span>[</span>DELETED]       coolify-redis
4962dd18bed7   ghcr.io/coollabsio/sentinel:0.0.18                                  3 weeks ago   Up 7 hours <span>(</span>healthy<span>)</span>    <span>[</span>DELETED]       coolify-sentinel
5ec997e35140   nginx:stable-alpine                                                 6 weeks ago   Up 6 weeks <span>(</span>healthy<span>)</span>    <span>[</span>DELETED]       kcwsosksw084swoog04g0w0k-proxy
5da5e2f2052b   prom/prometheus:latest                                              6 weeks ago   Up 6 weeks              <span>[</span>DELETED]       yg400wo4wok8k0cgo8844gcg-155648790718
32815a5e2e52   twakedrive/tdrive-frontend                                          7 weeks ago   Up 7 weeks              <span>[</span>DELETED]       frontend-ssowscwgccgk8k0k8oos8w40-120609116307
5d6bc828fe7f   twakedrive/tdrive-node                                              7 weeks ago   Up 7 weeks              <span>[</span>DELETED]       tdrive_node-ssowscwgccgk8k0k8oos8w40-120609108796
3e727b84415d   mongo                                                               7 weeks ago   Up 7 weeks              <span>[</span>DELETED]       mongo-ssowscwgccgk8k0k8oos8w40-120609102533
3506728b808b   a4c00g0ggkk4cww4scsw8scw:682dfd679845535f873d3c5b4599295f4d855ba5   7 weeks ago   Up 7 weeks              <span>[</span>DELETED]       a4c00g0ggkk4cww4scsw8scw-113711308615
736d9f03d152   rccwscgosk48gs0844sogsgw:51d68c7e7665371569aacc5f044c82ec1f06fa4c   7 weeks ago   Up 7 weeks              <span>[</span>DELETED]       rccwscgosk48gs0844sogsgw-111702410410
8f79e6f4c981   grafana/grafana-oss                                                 7 weeks ago   Up 7 weeks <span>(</span>healthy<span>)</span>    <span>[</span>DELETED]       grafana-ik8wokwgowow8gksok8k40sc
09d013497f9f   24a90047f2d2                                                        7 weeks ago   Up 7 weeks <span>(</span>healthy<span>)</span>    <span>[</span>DELETED]       postgresql-ik8wokwgowow8gksok8k40sc
bf8b6a969b19   gcr.io/cadvisor/cadvisor:latest                                     7 weeks ago   Up 7 weeks <span>(</span>healthy<span>)</span>    <span>[</span>DELETED]       k0gkw4koc8swo4wkg44w408g-211926055160
30e4d6edf675   prom/node-exporter:latest                                           7 weeks ago   Up 7 weeks              <span>[</span>DELETED]       yc4c4ckg80ogggc4ck8gwgww-211604215046
b227504e8787   rabbitmq:3-management                                               7 weeks ago   Up 7 weeks <span>(</span>healthy<span>)</span>    <span>[</span>DELETED]       rabbitmq-xscowck8kgc0wssokoggcskc
b260ad24c434   d741b3768746                                                        7 weeks ago   Up 7 weeks <span>(</span>healthy<span>)</span>    <span>[</span>DELETED]       kcwsosksw084swoog04g0w0k
6d038254e9ef   grafana/loki:latest                                                 7 weeks ago   Up 7 weeks              <span>[</span>DELETED]       b88cwo8ckwo0gw840oo444kk-193205274080
fe2aad5d9704   traefik:v3.1                                                        7 weeks ago   Up 7 weeks <span>(</span>healthy<span>)</span>    <span>[</span>DELETED]       coolify-proxy
</pre></td></tr></tbody></table></code></pre></div></div>

<blockquote>
  <p>Note: Deleted ports from this list as i feel like the might expose some inner workings.</p>
</blockquote>

<p>Crucially, I was running <strong>Umami</strong> - a privacy-focused analytics tool I’d re-deployed 9 days ago to track traffic on my
blog. I redeployed it because it had started acting up and I wasn’t sure why. The timing was suspicious to me.</p>

<p>Let me check which container has user 1001:</p>

<div><div><pre><code><table><tbody><tr><td><pre>1
2
3
4
</pre></td><td><pre><span>$ </span>docker ps <span>-q</span> | <span>while </span><span>read </span>container<span>;</span> <span>do
  </span><span>echo</span> <span>&#34;=== </span><span>$container</span><span> ===&#34;</span>
  docker <span>exec</span> <span>$container</span> <span>ls</span> <span>-la</span> /app/node_modules/next/dist/server/lib/ 2&gt;/dev/null | <span>grep </span>xmrig
<span>done</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Output:</p>

<div><div><pre><code><table><tbody><tr><td><pre>1
2
</pre></td><td><pre>=== a42f72cb1bc5 ===
drwxr-xr-x    2 nextjs   nogroup       4096 Dec 17 05:11 xmrig-6.24.0
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>There it is.</strong> Container <code>a42f72cb1bc5</code> - that’s my Umami analytics container. And it’s got a whole <code>xmrig-6.24.0</code>
directory sitting in what should be Next.js server internals.</p>

<p>The mining command in the process list confirmed it:</p>

<div><div><pre><code><table><tbody><tr><td><pre>1
2
3
4
5
</pre></td><td><pre>/app/node_modules/next/dist/server/lib/xmrig-6.24.0/xmrig 
  --url auto.c3pool.org:443 
  --user 8Bt9BEG98SbBPNTp1svQtDQs7PMztqzGoNQHo58eaUYdf8apDkbzp8HbLJH89fMzzciFQ7fb4ZiqUbymDZR6S9asKHZR6wn 
  --pass WUZHRkYOHh1GW1RZWBxaWENRX0ZBWVtdSRxQWkBWHg== 
  --donate-level 0
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Someone had exploited my analytics container and was mining Monero using my CPU. Nice.</p>

<h2 id="wait-i-dont-use-nextjs">Wait, I Don’t Use Next.js</h2>

<p>I’d actually seen a post on HN referencing this
<a href="https://www.reddit.com/r/nextjs/comments/1pgiaj3/i_got_hacked_and_traced_how_much_money_hacker/">Reddit post</a> about a
critical Next.js (CVE-2025-66478). My immediate reaction was “lol who cares, I don’t run Next.js.”</p>

<blockquote>
  <p>Oh my sweet summer child.</p>
</blockquote>

<p>Except… Umami <strong>is built with Next.js</strong>. I did not know this, nor did I bother looking. Oops.</p>

<p>The vulnerability (CVE-2025-66478) was in Next.js’s React Server Components deserialization. The “Flight” protocol that
RSC uses to serialize/deserialize data between client and server had an unsafe deserialization flaw. An attacker could
send a specially crafted HTTP request with a malicious payload to any App Router endpoint, and when deserialized, it
would execute arbitrary code on the server.</p>

<ol>
  <li>Attacker sends crafted HTTP request to Umami’s Next.js endpoint</li>
  <li>RSC deserializes the malicious payload</li>
  <li>RCE achieved via unsafe deserialization</li>
  <li>Download and install cryptominers</li>
  <li>Profit (for them)</li>
</ol>

<p>So much for “I don’t use Next.js.”</p>

<h2 id="the-panic-has-it-escaped-the-container">The Panic: Has It Escaped the Container?</h2>

<p>This is where I started to properly panic. Looking at that process list:</p>

<div><div><pre><code><table><tbody><tr><td><pre>1
</pre></td><td><pre>1001      714822  819  3.6 2464788 2423424 ?     Sl   Dec16 9385:36 /tmp/.XIN-unix/javae
</pre></td></tr></tbody></table></code></pre></div></div>

<p>That path - <code>/tmp/.XIN-unix/javae</code> - looks like it’s on the <strong>host filesystem</strong>, not inside a container. That means it
can get access to my database, all my environment variables, the works. Claude was telling me I’d need to:</p>

<ol>
  <li>Assume everything is compromised</li>
  <li>Check for rootkits, backdoors, persistence mechanisms</li>
  <li>Probably rebuild from scratch</li>
  <li>Spend my entire day unfucking this</li>
</ol>

<p>I checked for persistence mechanisms:</p>

<div><div><pre><code><table><tbody><tr><td><pre>1
2
3
4
5
</pre></td><td><pre><span>$ </span>crontab <span>-l</span>
no crontab <span>for </span>root

<span>$ </span>systemctl list-unit-files | <span>grep </span>enabled
<span># ... all legitimate system services, nothing suspicious</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>No malicious cron jobs. No fake systemd services pretending to be <code>nginxs</code> or <code>apaches</code>. That’s… good?</p>

<p>But I still needed to know: <strong>Did the malware actually escape the container or not?</strong></p>

<h2 id="the-moment-of-truth">The Moment of Truth</h2>

<p>The test was, if <code>/tmp/.XIN-unix/javae</code> exists on the host, I’m fucked. If it doesn’t exist, then apparently what I’m
seeing is
just Docker’s default behavior of showing container processes in the host’s <code>ps</code> output, but they’re actually isolated.</p>

<div><div><pre><code><table><tbody><tr><td><pre>1
2
</pre></td><td><pre><span>$ </span><span>ls</span> <span>-la</span> /tmp/.XIN-unix/javae
<span>ls</span>: cannot access <span>&#39;/tmp/.XIN-unix/javae&#39;</span>: No such file or directory
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>IT NEVER ESCAPED.</strong></p>

<p>Or at least it doesn’t look like it. We can downgrade this incident from DEFCON1 to ‘point a gun at it and do some more
checks, but no guillotine yet’.</p>

<p>The malware was entirely contained within the Umami container. Apparently, when you run <code>ps aux</code> on a Docker host, you
see processes
from all containers because they share the same kernel. But those processes are in their own mount namespace - they
can’t see or touch the host filesystem.</p>

<p>I verified what user that container was actually running as:</p>

<div><div><pre><code><table><tbody><tr><td><pre>1
2
3
4
5
6
7
8
</pre></td><td><pre><span>$ </span>docker inspect umami-bkc4kkss848cc4kw4gkw8s44 | <span>grep</span> <span>&#39;&#34;User&#34;&#39;</span>
<span>&#34;User&#34;</span>: <span>&#34;nextjs&#34;</span>,

<span>$ </span>docker inspect umami-bkc4kkss848cc4kw4gkw8s44 | <span>grep</span> <span>&#39;&#34;Privileged&#34;&#39;</span>
<span>&#34;Privileged&#34;</span>: <span>false</span>,

<span>$ </span>docker inspect umami-bkc4kkss848cc4kw4gkw8s44 | <span>grep</span> <span>-A</span> 30 <span>&#34;Mounts&#34;</span>
<span>&#34;Mounts&#34;</span>: <span>[]</span>,
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>So here’s what I now know, and why I’m not totally fucked:</strong></p>

<ul>
  <li>Container ran as user <code>nextjs</code> (UID 1001), not root.</li>
  <li>Container was not privileged.</li>
  <li>Container had <strong>zero volume mounts</strong>.</li>
</ul>

<p>Which means:</p>

<ul>
  <li>Run processes inside the container</li>
  <li>Mine cryptocurrency</li>
  <li>Scan networks (hence the Hetzner abuse report)</li>
  <li>Consume 100% CPU</li>
</ul>

<p>The malware could NOT:</p>

<ul>
  <li>Access the host filesystem</li>
  <li>Install cron jobs</li>
  <li>Create systemd services</li>
  <li>Persist across container restarts</li>
  <li>Escape to other containers</li>
  <li>Install rootkits</li>
</ul>

<p>Container isolation actually worked. Nice.</p>

<h2 id="dockerfiles-vs-auto-generated-images">Dockerfiles vs. Auto-Generated Images</h2>

<p>There were a couple of things which saved me in this case IMO compared to the Reddit post I linked:</p>

<ul>
  <li>I write all my own dockerfiles for my applications. This isn;t a silver bullet on it’s own but compared to
autogenerated ones you have a better idea of what’s in there.</li>
  <li>Coolify and Dockers approach to containerization in general. I’ve since learned that we can’t rely on container
separation for security but honestly it seems better than running everything on the host.</li>
</ul>

<p>The Reddit post I’d seen earlier? That guy got completely screwed because his container was running as root. The malware
could:</p>

<ul>
  <li>Install cron jobs for persistence</li>
  <li>Create systemd services</li>
  <li>Write anywhere on the filesystem</li>
  <li>Survive reboots</li>
</ul>

<p>So in this case, container isolation had worked!</p>

<p>What I did not do, was keep track of the tolling I was using and what tooling <em>that</em> was using. In fact, I installed
Umami from Coolify’s services screen. I didn’t even configure it.</p>

<blockquote>
  <p>Obviously none of this is Umami’s fault by the way. They released a fix for their free software like a week ago. I
just
didn’t think to do anything about it.</p>
</blockquote>

<h2 id="the-fix">The Fix</h2>

<div><div><pre><code><table><tbody><tr><td><pre>1
2
3
4
5
6
7
</pre></td><td><pre><span># Stop and remove the compromised container</span>
<span>$ </span>docker stop umami-bkc4kkss848cc4kw4gkw8s44
<span>$ </span>docker <span>rm </span>umami-bkc4kkss848cc4kw4gkw8s44

<span># Check CPU usage</span>
<span>$ </span><span>uptime
 </span>08:45:17 up 55 days, 17:43,  1 user,  load average: 0.52, 1.24, 4.83
</pre></td></tr></tbody></table></code></pre></div></div>

<p>CPU back to normal. It’s been two days since and my CPU is just chilling at like 5%.</p>

<p>I also enabled UFW (which I should have done ages ago):</p>

<div><div><pre><code><table><tbody><tr><td><pre>1
2
3
4
5
6
</pre></td><td><pre><span>$ </span><span>sudo </span>ufw default deny incoming
<span>$ </span><span>sudo </span>ufw default allow outgoing
<span>$ </span><span>sudo </span>ufw allow ssh
<span>$ </span><span>sudo </span>ufw allow 80/tcp
<span>$ </span><span>sudo </span>ufw allow 443/tcp
<span>$ </span><span>sudo </span>ufw <span>enable</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>This blocks all inbound connections except SSH, HTTP, and HTTPS. No more exposed PostgreSQL ports, no more RabbitMQ
ports open to the internet. In my mind this shouldn’t be too big a deal because 5432 wasn’t open to he host from the
docker container. But worth doing.</p>

<p>I sent Hetzner a brief explanation:</p>

<blockquote>
  <p>Investigation complete. The scanning originated from a compromised Umami analytics container (CVE-2025-66478).</p>

  <p>The container ran as non-root user with no privileged access or host mounts, so the compromise was fully contained.
Container has been removed and firewall hardened.</p>
</blockquote>

<p>They closed the ticket within an hour.</p>

<h2 id="lessons-learned">Lessons Learned</h2>

<h3 id="1-i-dont-use-x-doesnt-mean-your-dependencies-dont-use-x">1. “I don’t use X” doesn’t mean your dependencies don’t use X</h3>

<p>I don’t write Next.js applications. But I run third-party tools that are built with Next.js. When CVE-2025-66478 was
disclosed, I thought “not my problem.” Wrong.</p>

<p>Know what your dependencies are actually built with. That “simple analytics tool” is a full web application with a
complex stack.</p>

<h3 id="2-container-isolation-works-when-configured-properly">2. Container isolation works (when configured properly)</h3>

<p>This could have been so much worse. If that container had been running as root, or had volume mounts to sensitive
directories, or had access to the Docker socket, I’d be writing a very different blog post about rebuilding my entire
infrastructure.</p>

<p>Instead, I deleted one container and moved on with my day.</p>

<p><strong>Write your own Dockerfiles.</strong> Understand what user your processes run as. Avoid <code>USER root</code> unless you have a very
good reason. Don’t mount volumes you don’t need. Don’t give containers <code>--privileged</code> access.</p>

<h3 id="3-the-sophistication-gap">3. The sophistication gap</h3>

<p>This malware wasn’t like those people who auto-poll for <code>/wpadmin</code> <em>every</em> time I make a DNS change. This was spicy.</p>

<ul>
  <li>Disguised itself in legitimate-looking paths (<code>/app/node_modules/next/dist/server/lib/</code>)</li>
  <li>Used process names that blend in (<code>javae</code>, <code>runnv</code>)</li>
  <li>Attempted to establish persistence</li>
  <li>According to other reports, even had “killer scripts” to murder competing miners</li>
</ul>

<p>But it was still limited by container isolation. Good security practices beat sophisticated malware.</p>

<h3 id="4-defense-in-depth-matters">4. Defense in depth matters</h3>

<p>Even though the container isolation held, I still should have:</p>

<ul>
  <li>Had a firewall enabled from day one (not “I’ll do it later”)</li>
  <li>Been running fail2ban to stop those SSH brute force attempts</li>
  <li>Had proper monitoring/alerting (I only noticed because of the Hetzner email)</li>
  <li>Updated Umami when the CVE was disclosed</li>
</ul>

<p>I got lucky. Container isolation saved me from my own laziness.</p>

<h2 id="what-im-doing-differently">What I’m Doing Differently</h2>

<ol>
  <li>
    <p><strong>No more Umami.</strong> - Meh, I’ve gone back on this. This wasn’t Umami’s fault, and their open source software is super
cool. I’ve rebooted a fresh version of Umami.</p>
  </li>
  <li><strong>Audit all third-party containers.</strong> Going through everything I run and checking:
    <ul>
      <li>What user does it run as?</li>
      <li>What volumes does it have?</li>
      <li>When was it last updated?</li>
      <li>Do I actually need it?</li>
    </ul>
  </li>
  <li>
    <p><strong>SSH hardening.</strong> Moving to key-based authentication only, disabling password auth, and setting up fail2ban.</p>
  </li>
  <li>
    <p><strong>Proper monitoring.</strong> Setting up alerts for CPU usage, load average, and suspicious network activity. I shouldn’t
find out about compromises from my hosting provider. I actually have grafana and Node exporter set up, but it’s not
good unless I go look at it!</p>
  </li>
  <li><strong>Regular security updates.</strong> No more “I’ll update it later.” If there’s a CVE, I patch or I remove the service.</li>
</ol>

<h2 id="the-silver-lining">The Silver Lining</h2>

<p>This was actually a pretty good learning experience. I got to:</p>

<ul>
  <li>Practice incident response on a real compromise (never done this before!)</li>
  <li>Prove that container isolation actually works</li>
  <li>Learn about Docker namespaces, user mapping, and privilege boundaries</li>
  <li>Harden my infrastructure without the pressure of active data loss</li>
</ul>

<p>And I only lost about 2 hours of my morning before work. Could’ve been way worse.</p>

<p>Though I do wonder how much Monero I mined for that dickhead. Based on the CPU usage and duration… probably enough for
them to have a nice lunch. You’re welcome, mysterious attacker. Hope you enjoyed it.</p>

<h2 id="tldr">TL;DR</h2>

<ul>
  <li>Umami analytics (built with Next.js) had an RCE vulnerability.</li>
  <li>Got exploited, installed cryptominers</li>
  <li>Mined Monero for 10 days at 1000%+ CPU</li>
  <li>Container isolation saved me because it ran as non-root with no mounts</li>
  <li>Fix: <code>docker rm umami</code> and enable firewall</li>
  <li>Lesson: Know what your dependencies are built with, and configure containers properly</li>
</ul>

            </div></div>
  </body>
</html>
