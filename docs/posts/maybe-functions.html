<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.benwinding.com/maybe-functions/">Original</a>
    <h1>Maybe Functions</h1>
    
    <div id="readability-page-1" class="page"><div id="wrap">
      
      <div>
        <section id="main"><article id="post-maybe-functions" itemscope="" itemprop="blogPost">
  
  <div>
    
<div>
  <p><a href="https://blog.benwinding.com/images/imgur/762bc434ec06.jpg" rel="gallery_cltmsld0a0011gfpz3ylp865r">
        <img src="https://blog.benwinding.com/images/imgur/762bc434ec06.jpg" itemprop="image"/>
      </a>
    
  </p>
</div>

    
      <header>
        
  
    
  

      </header>
    
    <div itemprop="articleBody">
      
        <p>The maybe function is a subtle monster that spreads it’s tentacles across the code-base. It’s alternating functionality of “<em>does/doesn’t do something</em>” makes code hard to understand, maintain and debug.</p>
<h3 id="Example">Example</h3>
<p>Here’s a specific example, it’s a “maybe” function as it only returns the friends of a user, if the user is logged in. Basically it introduces a possible <code>return null</code>.</p>
<figure><div><pre><span><span>function</span> <span>maybeGetUser</span>(<span></span>): <span>User</span> | <span>null</span> {</span></pre></div></figure>
<p><em>Notes:</em></p>
<ul>
<li>This is highly related to the “Null Object Pattern”, but I thought I would explain it from the perspective of functions.</li>
<li>It’s also important to note here, that in the wild “maybe functions” might not be conveniently prefixed with “maybe”…</li>
</ul>
<p>So what are the trade-off’s when using “maybe functions”?</p>
<h2 id="Advantages">Advantages</h2>
<ul>
<li>Validation logic coupled with implementation</li>
<li>Easy for the caller, can be called in many places</li>
</ul>
<h2 id="Disadvantages">Disadvantages</h2>
<ul>
<li>Caller has less control, they depend on validation hidden in “maybe function”</li>
<li>Hides complexity but doesn’t actually remove it</li>
<li>Things that depend on the output now need to handle the maybeness case</li>
</ul>
<p>When a “maybe function” is implemented, it makes it far more likely that <strong>more</strong> “maybe functions” will be introduced to deal with all the <code>null</code> values. Here’s some pseudo code to show the basic problem:</p>
<figure><div><pre><span></span></pre></div></figure>
<p>You can see how this pattern <em>maybe</em> getting out of control… it does look clean in the consumer, with no control logic. However the <code>null</code> handling spreads to all new functions, and obscures what functions are actually doing… which is usually “nothing”, so why even call it?</p>
<p>How can we improve this?</p>
<h2 id="Solution-1-Lift-the-maybeness-up">Solution 1 - Lift the maybeness up</h2>
<p>The easiest way to remove the “maybeness” from functions is to lift up the “maybe” logic into the consumer, this removes the possible <code>null</code> aspects of the function, which allows other functions to remove theirs too!</p>
<figure><div><pre><span></span></pre></div></figure>
<p>This is much easier to understand, as each function does what it says and there’s much less “maybeness” to account for.</p>
<h2 id="Solution-2-Monads">Solution 2 - Monads</h2>
<p>It’s also possible to generalize and isolate the “maybeness” by using monads. In the below example, all <code>null</code> checks go through “runSafely”, which removes a lot of “maybeness” in remaining functions.</p>
<figure><div><pre><span></span></pre></div></figure>
<p>This might be appropriate for a lot of situations, but I believe the 1st solution should definitely be reached for first, as it doesn’t rely on another level of abstraction.</p>
<h2 id="Conclusion">Conclusion</h2>
<p>Maybe functions have always annoyed me personally and they can found in many codebases across any language that allows <code>null</code>. They seem to be trivial to add, but difficult to remove. But hopefully this illustrates the concern and ways to fix it.</p>
<blockquote><p>“Functions should do something, not <em>maybe</em> do something…”</p>
</blockquote>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="https://blog.benwinding.com/the-history-of-writing-tech/" id="article-nav-older">
      <strong>Older</strong>
      <p>The history of writing tech!</p>
    </a>
  
</nav>

  
</article>
</section>
        
          
        
      </div>
      
    </div></div>
  </body>
</html>
