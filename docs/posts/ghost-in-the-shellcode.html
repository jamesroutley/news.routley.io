<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.notcheckmark.com/2022/05/ghost-in-the-shellcode/">Original</a>
    <h1>Ghost in the Shellcode</h1>
    
    <div id="readability-page-1" class="page"><section>
        <p>We ran <a href="http://ghostintheshellcode.com/">Ghost in the Shellcode</a> (GitS) from 2010 to 2015. It was one of the earlier Capture the Flag (CTF) hacking competitions. When we launched it, there really were only four other CTFs: <a href="https://defcon.org/html/links/dc-ctf.html">DEFCON CTF</a> and <a href="http://www.codegate.org/en/hacking/general">Codegate CTF</a> were open to everyone and <a href="https://www.csaw.io/ctf">CSAW CTF</a> and <a href="https://shellphish.net/ictf/">iCTF</a> were academic-oriented. ¬†There may have been others, but this is how I remember it.</p><figure><img src="https://www.notcheckmark.com/content/images/2022/05/gitsc-logo.webp" alt="" loading="lazy" width="1000" height="400" srcset="https://www.notcheckmark.com/content/images/size/w600/2022/05/gitsc-logo.webp 600w, https://www.notcheckmark.com/content/images/2022/05/gitsc-logo.webp 1000w" sizes="(min-width: 720px) 720px"/><figcaption>Ghost in the Shellcode</figcaption></figure><p>Most of us had just won the DEFCON 17 CTF finals as VedaGodz and decided that we too should run a CTF and we&#39;d do it at a conference for a little added prestige. <a href="https://shmoocon.org/">ShmooCon</a> was coming up soon and was the next largest US conference and they didn&#39;t have a CTF. <a href="https://twitter.com/psifertex">Jordan</a> knew <a href="https://twitter.com/gdead">Bruce</a>, the founder of the Shmoo Group and the conference. He reached out around Thanksgiving and we were in, they were going to give us a room to host our very own CTF!</p><h2 id="dont-panic">(Don&#39;t) Panic</h2><p>ShmooCon happens in January in most years but was in February that year (2010). Which meant we only had about 8 weeks to design and put together a CTF, but we still took a few weeks to start.</p><p>First, we had to pick a name. Someone ‚Äì Jordan? Brandon? <a href="https://github.com/verylazyguy">Greg</a>? ‚Äì on the team was watching Ghost in the Shell during the meeting and it was suggested we do a Ghost in the Shell themed game and use the name Ghost in the Shellcode. We didn&#39;t have a better name, so we went with it and decided we&#39;d change the theme <em>and</em> name every year.</p><p>Next, we had to figure out game dynamics. Were we going to do an attack-defense CTF like the DEFCON CTF finals or are we going to do an attack-only CTF ‚Äì aka Jeopardy board? We really wanted to do an attack-defense game but time constraints made us go with the Jeopardy board. </p><p>Someone volunteered to write the scoring server. Remember, it was 2009, CTFd wouldn&#39;t be written or released for another 6 or so years. At the time CSAW CTF handled submissions by having competitors email flags to the organizers.</p><p>The rest of us then went and tried to write as many challenges as we could. </p><p>However, that person dropped the ball and we didn&#39;t have a scoring server with only two days left. Greg and <a href="https://twitter.com/computerality">Jay</a> picked up the task ‚Äì writing the majority of it on the plane and in the hotel room the night before. They decided to write it in Python, which was fairly new to us ‚Äì most of us only wrote C and maybe a bit of Perl.</p><figure><pre><code>class AJAXHandler(SimpleHTTPServer.SimpleHTTPRequestHandler):
        def do_GET(self):
                print &#34;GET in thread: %s\n&#34; % (threading.currenThread().getName(),)
                &#34;&#34;&#34;Serve a GET request.&#34;&#34;&#34;
                self.encoder = json.JSONEncoder()
                parsed_path = urlparse.urlparse(self.path)
                #parsed_path: (scheme,netloc,path,params,query,fragment)
                #print parsed_path[2]
                if parsed_path[2] == &#34;/ajax/&#34;:
                        self.do_OPTIONS()
                else:
                        f = self.send_head()
                        if f:
                                self.copyfile(f, self.wfile)
                                f.close()</code></pre><figcaption>A small sample of our first score server. This was before flask existed but also we didn&#39;t know what we were doing.</figcaption></figure><p>I was definitely unhelpful that night. I was sleep-deprived and kept suggesting we go buy golf pencils ‚úèÔ∏è and golf score sheets to let competitors submit flags. Dustin and Andrew were late flying in and were panicked about the lack of scoring server. I definitely got on their nerves with this suggestion.</p><h3 id="sphere-grid">Sphere Grid</h3><p>For our scoreboard interface, we went with a &#34;sphere grid&#34; design. We weren&#39;t great about sticking to the theme of &#34;Ghost in the Shell&#34; ‚Äì to this day 12 years later I&#39;ve never seen an episode. The sphere grid was inspired by one of the Final Fantasy game&#39;s tech trees.</p><figure><img src="https://www.notcheckmark.com/content/images/2022/05/scoreboard-1.webp" alt="" loading="lazy" width="2000" height="1434" srcset="https://www.notcheckmark.com/content/images/size/w600/2022/05/scoreboard-1.webp 600w, https://www.notcheckmark.com/content/images/size/w1000/2022/05/scoreboard-1.webp 1000w, https://www.notcheckmark.com/content/images/size/w1600/2022/05/scoreboard-1.webp 1600w, https://www.notcheckmark.com/content/images/2022/05/scoreboard-1.webp 2256w" sizes="(min-width: 720px) 720px"/><figcaption>The &#34;Sphere Grid&#34; scoreboard</figcaption></figure><p>This was another concession we made due to lack of time. We didn&#39;t have enough challenges to fill a normal scoreboard. We had too many pwnables and not enough crypto or web challenges ‚Äì which is an evergreen statement about GitS. We devised this complicated scoreboard where we started in the center of the grid and you could only unlock one or two other challenges ‚Äì giving us some extra time to write more challenges as the game went on.</p><p>We strategically placed harder challenges on junction points to slow the game down. We were terrified of someone unlocking half the game board in the first few hours. Notice in the screenshot above that only about half of the nodes are glowing, we only had 12 challenges for the 21 spots. At the time we lied and said we&#39;d release those &#34;unopened&#34; challenges next year. </p><p>Running the game itself was interesting since we were new to ShmooCon ‚Äì none of us had attended it prior ‚Äì we didn&#39;t know what the conference network situation would be. The game was going to be in person only which made it a little easier. We decided to bring our own network equipment to put up a wireless network and two small Dell Optiplex 960s as our servers. All of us lived in Florida so we had to carry these servers as personal items on the flights. I&#39;ve brought a few small form factor PCs through TSA and it&#39;s always a struggle explaining it&#39;s a computer even without a monitor.</p><figure><img src="https://www.notcheckmark.com/content/images/2022/05/dell960.webp" alt="" loading="lazy" width="450" height="450"/><figcaption>Our server infrastructure</figcaption></figure><p>There was a problem though. WiFi at the time was 802.11b/g and WEP was the widely supported encryption protocol and deauthorization attacks to sniff everyone&#39;s traffic were easily achieved. The Shmoo Group itself published <a href="https://ftp.unpad.ac.id/orari/library/library-sw-hw/linux-1/airsnort/AirSnort%20Homepage.htm">AirSnort</a>, a tool for doing exactly that. Shortly after we made it to the hotel we realized it would be a problem and had to set up our own self-signed CA and cut TLS certs for all the services. </p><p>We launched the game on time and had about 15 people playing! The scoreboard broke immediately after the first solution ‚Äì we had failed to properly map the sphere grid connections. After the first few hours, we were pretty confident the board wouldn&#39;t be cleared so we were able to enjoy the conference and socialize with the competitors.</p><figure><img src="https://www.notcheckmark.com/content/images/2022/05/snow.webp" alt="" loading="lazy" width="847" height="755" srcset="https://www.notcheckmark.com/content/images/size/w600/2022/05/snow.webp 600w, https://www.notcheckmark.com/content/images/2022/05/snow.webp 847w" sizes="(min-width: 720px) 720px"/><figcaption>A Historic Mess</figcaption></figure><p>Then the snow came. They called it Snowmageddon and it was historic amounts of snow for the DC region. Most of the team grew up in Florida, so it was their first time seeing snow ‚Äì definitely the first to see so much snow. We stole serving trays from the hotel and used them as (very poor) saucer snow sleds and chucked them into the bushes for the hotel to find them in the spring. Jordan found a couple of people who decided they were going to leave the conference early and drive home to Florida. The rest of us stayed, for what turned out to be an extra week longer as every flight was canceled consistently for that week. </p><p>The first year was in the bag and we could switch focus to preparing for DEFCON CTF. We now had two CTF seasons: competing in DEFCON CTF and hosting Ghost in the Shellcode.</p><h2 id="year-two">Year Two</h2><figure><img src="https://www.notcheckmark.com/content/images/2022/05/2011team.webp" alt="" loading="lazy" width="1316" height="978" srcset="https://www.notcheckmark.com/content/images/size/w600/2022/05/2011team.webp 600w, https://www.notcheckmark.com/content/images/size/w1000/2022/05/2011team.webp 1000w, https://www.notcheckmark.com/content/images/2022/05/2011team.webp 1316w" sizes="(min-width: 720px) 720px"/><figcaption>Most of the 2011 Ghost in the Shellcode organizing team. Not pictured: me.</figcaption></figure><p>As you probably guessed, we never changed the name with a new theme. This year the conference was moving to the wonderful Washington Hilton. <a href="https://twitter.com/heidishmoo">Heidi</a>, who is the main point of contact for all things ShmooCon, gave us a larger room and even gave us a free ticket to the conference to give away.</p><p>We were trying to build a little hype but also wanted to get tickets out to people who wanted to play. ShmooCon is notorious for being difficult to get tickets to ‚Äì they generally sell out in less than 20 seconds. We thought, &#34;Hey, we can do a mini-competition and host it online to give out the ticket.&#34;</p><p>We called it the &#34;CTF Warm-up&#34; but in later years changed the name to the teaser. The first teaser was won by <a href="https://twitter.com/zoaedk">awesie</a>, one of the original members of <a href="http://pwning.net/">PPP</a>.</p><p>For the challenges that year, I had spent a bit of time reversing ddtek&#39;s and kenshoto&#39;s standard pwnable library and reimplementing it for our own use. It was fun having <a href="https://twitter.com/invisig0th">Visi</a> and <a href="https://twitter.com/sk3wl">Eagle</a> claiming we stole it, but Eagle himself stole it from Visi!</p><figure><pre><code>// Service setup functions
int socketListen(unsigned short);
void loop(int fd, int (*childHandler)(int));
int drop_privs_user(const char *user);
int drop_privs(struct passwd *user);
void alarm_handler(int);

// main child handler
int handleConnection(int);

// socket read and write functions
ssize_t sendAll(int, char *, size_t);
ssize_t sendMsg(int, char *);
ssize_t sendMsgf(int, const char *, ...);
ssize_t readAll(int sock, char *buf, size_t len);
ssize_t readUntil(int sock, char *buf, size_t len, char sentinal);</code></pre><figcaption>&#34;Our&#34; standard library header</figcaption></figure><p>The biggest concern was screwing up process privileges and having a standard wrapper made that far less likely.</p><p>I also decided I&#39;d rewrite the score server and introduce a ton of leader board sorting bugs. We fixed them live every year we used that software and then promptly forgot to commit the changes to our SVN server (remember, it was 2011 and git was difficult).</p><p>I think 2011 was the year that Jordan and I flew up a little early for some work-related reason and got stuck on the DC Metro under the Potomac for an hour when the metro system lost power. It should have been a sign.</p><figure><img src="https://www.notcheckmark.com/content/images/2022/05/snow2011.webp" alt="" loading="lazy" width="1024" height="576" srcset="https://www.notcheckmark.com/content/images/size/w600/2022/05/snow2011.webp 600w, https://www.notcheckmark.com/content/images/size/w1000/2022/05/snow2011.webp 1000w, https://www.notcheckmark.com/content/images/2022/05/snow2011.webp 1024w" sizes="(min-width: 720px) 720px"/><figcaption>In 2011 they called it &#34;Snowpocalypse&#34;</figcaption></figure><p>The competition went off without any issues. It was still an in-person-only CTF. I remember giving away points to a team who brought us donuts.</p><p>But the snow started again and it was somehow worse than the year before. Several of our friends got stranded overnight in their cars on the interstates. It was decided that I would rent a car since I had seen snow before in my life ‚Äì being from the scary northern US. It was less joyous this year as we remembered the prior year. Greg and I ended up driving back to Florida because our flights kept getting canceled again.</p><p>Having to create 30 challenges a year can be daunting, so we&#39;d have brainstorming sessions. I found these old challenge ideas from our <a href="https://trac.edgewall.org/">trac</a> from around this time. Only a few are winners:</p><ul><li>Something called buffalo overrun.</li><li>An animated gif where the timeout between frames spells out another</li><li>Something like the <code>ashdoc2.png</code> where they <code>cat</code>&#39;d a wav on the end of a png</li><li>I really like the idea of using the Compton lyrics and mac <code>say</code>. <code>say</code> has a</li><li>Opcode trivia, six bytes to jump to <code>eax+0x100</code>. (use a different reg?)</li><li>Dustin&#39;s SHA*FUN</li><li>A bonus points question that gives you complete stack control and requires</li><li>A challenge that executes the shellcode in a QR code and prints out</li><li>Wub (dubstep) encoded data - from Dillon</li><li>pascal strings</li><li>one&#39;s complement</li><li>The embarrass Jordan contest (get a picture with Jordan where he&#39;s super</li><li>ddtekd, all format strings, ipv6</li><li><a href="http://www.usenix.org/events/woot11/tech/final_files/Oakley.pdf">dwarf byte-code</a></li></ul><p>The ROP one is funny in retrospect. ROP was new and exciting at the time. </p><p>I had liked the idea of giving people large, unwieldy prizes for winning. Surfboards seemed appropriate, but were logistically difficult. We ended up ordering custom skateboards.</p><figure><img src="https://www.notcheckmark.com/content/images/2022/05/skate.webp" alt="" loading="lazy" width="730" height="527" srcset="https://www.notcheckmark.com/content/images/size/w600/2022/05/skate.webp 600w, https://www.notcheckmark.com/content/images/2022/05/skate.webp 730w" sizes="(min-width: 720px) 720px"/><figcaption>The picture above says we ordered four, but I only remember ordering three. Maybe one fell off a truck? üëÄ</figcaption></figure><p>We had planned to give the winning team three boards, but managed to destroy two of them before we gave them away. The boards were shipped without grip tape on the top side, but the grip tape was included ‚Äì so we figured we&#39;d afix it. I left them in my office on my office couch. Later, a coworker came in and stacked and moved them so he could sit and ask a question. Stacking them put the Ghost in the Shellcode logos in direct contact with the super coarse grip tape, scratching the decks ‚Äì only the outer one survived and we awarded it to awesie for winning that year.</p><h2 id="year-three">Year Three</h2><p>After two years of flying up with all our infrastructure and having to spend the night before frantically setting it up, we decided to try hosting the competition on Amazon AWS. No one else had tried it yet and we had no idea what it would cost us.</p><p>Around this time, I decided I was going to be the treasurer of the team and I started charging yearly membership dues of $100. We had a lot of people who wanted to be part of the team but never actually contributed anything. I thought the dues would make them more serious but in the end, we just had more spending money. The larger budget helped us buy nicer prizes, swag, and pay for the unknown AWS bill.</p><p>This was the first big Ghost in the Shellcode as it was the first one where we allowed remote teams to compete. All the biggest teams of the day played: PPP, Eindbazen, EuroNOP, pwningyeti, TracerTea, More Smoked Leet Chicken, 0ld Europe, and others. </p><p>We switched the scoreboard away from the sphere grid and had a custom monopoly game commissioned for both the scoreboard and had one printed for the prize. </p><figure><img src="https://www.notcheckmark.com/content/images/2022/05/monopoly.webp" alt="" loading="lazy" width="1576" height="1558" srcset="https://www.notcheckmark.com/content/images/size/w600/2022/05/monopoly.webp 600w, https://www.notcheckmark.com/content/images/size/w1000/2022/05/monopoly.webp 1000w, https://www.notcheckmark.com/content/images/2022/05/monopoly.webp 1576w" sizes="(min-width: 720px) 720px"/><figcaption>GitSopoly</figcaption></figure><p>This year we released one of our best challenges: KhazaÃÇd. KhazaÃÇd was a 600-point pwnable written in C++ and used exceptions pretty extensively. KhazaÃÇd was sneaky, it was only exploitable due to a bug in the DWARF exception handling functions. 0xff did a fantastic <a href="https://web.archive.org/web/20120410105542/http://blog.oxff.net/#k6jx7ewsq2bbid6giflq">write-up</a> that I was able to dig out of the Wayback Machine. 0xff&#39;s impression of the competition as a whole was poor but also he&#39;s German.</p><p>PPP won for the second year in a row ‚Äì at the time PPP was actually notorious for coming in 2nd place in most of their competitions. They used to joke that they could never win. They probably don&#39;t make that joke anymore. I hope they still have the monopoly game somewhere in Pittsburgh.</p><p>No massive snowstorms that year ‚Äì the weather was pretty nice. The AWS bill ended up being somewhere around $100 and that&#39;s with a ton of overprovisioning.</p><h2 id="year-four">Year Four</h2><figure><img src="https://www.notcheckmark.com/content/images/2022/05/IMG_0118.webp" alt="" loading="lazy" width="807" height="1077" srcset="https://www.notcheckmark.com/content/images/size/w600/2022/05/IMG_0118.webp 600w, https://www.notcheckmark.com/content/images/2022/05/IMG_0118.webp 807w" sizes="(min-width: 720px) 720px"/><figcaption>For 2013, ShmooCon went with a snow theme. I stole this banner and other the ones from other years too ‚Äì presumably, it&#39;s still hanging in Florida.</figcaption></figure><p>2012 was an election year so the conference had to move hotels, as the Washington Hilton was unavailable ‚Äì booked by the Romney transition team for if he had won. We moved to the Hyatt Regency Capitol Hill. The hotel was smaller and we had to share a room ‚Äì but don&#39;t worry, we managed to take over most of the room.</p><figure><img src="https://www.notcheckmark.com/content/images/2022/05/IMG_0121.webp" alt="" loading="lazy" width="1077" height="807" srcset="https://www.notcheckmark.com/content/images/size/w600/2022/05/IMG_0121.webp 600w, https://www.notcheckmark.com/content/images/size/w1000/2022/05/IMG_0121.webp 1000w, https://www.notcheckmark.com/content/images/2022/05/IMG_0121.webp 1077w" sizes="(min-width: 720px) 720px"/><figcaption>We ran it from the back corner. We also all had matching embroidered GitS hoodies with thumbholes (boo hiss)</figcaption></figure><p>For this year&#39;s game, we introduced shellcode.tv, a streaming site we used to play distracting videos and some CTF-appropriate music. I wanted to make the scoreboard only accessible via the video stream but was overruled. Not everyone had the connection required to stream our HD distraction. We played all the CTF room classics such as Benny Benassi (<a href="https://www.youtube.com/watch?v=a0fkNdPiIL4">1</a>) (<a href="https://www.youtube.com/watch?v=McoZeLJhKok">2</a>), Die Antwoord (<a href="https://www.youtube.com/watch?v=8Uee_mcxvrw">1</a>), deadmau5 (<a href="https://www.youtube.com/watch?v=h7ArUgxtlJs">1</a>), and probably an embarrassing amount of dubstep.</p><figure><img src="https://www.notcheckmark.com/content/images/2022/05/shellcodetv-warning.webp" alt="" loading="lazy" width="1520" height="226" srcset="https://www.notcheckmark.com/content/images/size/w600/2022/05/shellcodetv-warning.webp 600w, https://www.notcheckmark.com/content/images/size/w1000/2022/05/shellcodetv-warning.webp 1000w, https://www.notcheckmark.com/content/images/2022/05/shellcodetv-warning.webp 1520w" sizes="(min-width: 720px) 720px"/><figcaption>The warning we ran at the bottom of shellcode.tv. We were so hip.</figcaption></figure><p>A challenge I particularly liked was folly, which I wrote. Folly was a shellcoding challenge with several stages. When you connected you were prompted with a choose your own adventure prompt. Apparently, I was reading Don Quixote at the time because I made it Don Quixote-themed.</p><pre><code>$ nc folly.2013.ghostintheshellcode.com 5679
Hola! I am Sancho, who are you?
Don Quixote de la Mancha
Hello! Are you ready for your adventure?
Sire, what should we do?
  (S)earch for your lady love, Dulcinea del Toboso
  (A)ttack Giants
  (M)ount Rocinante
  (Q)uit

&gt;M
Sire! Let me help you onto your steed.
Sire, what should we do?
  (S)earch for your lady love, Dulcinea del Toboso
  (A)ttack Giants
  (M)ount Rocinante
  (Q)uit

&gt;A
Just then they came in sight of thirty or forty windmills that rise from that plain.And no sooner did Don Quixote see them that he said to his squire, &#34;Fortune is guiding our affairsbetter than we ourselves could have wished. Do you see over yonder, friend Sancho, thirty or fortyhulking giants? I intend to do battle with them and slay them. With their spoils we shall begin tobe rich for this is a righteous war and the removal of so foul a brood from off the face of the earth is a service God will bless.&#34;

&#34;What giants?&#34; asked Sancho Panza.

&#34;Those you see over there,&#34; replied his master, &#34;with their long arms. Some of them have arms well nigh two leagues in length.&#34;

&#34;Take care, sir,&#34; cried Sancho. &#34;Those over there are not giants but windmills. Those things that seem to be their arms are sails which, when they are whirled around by the wind, turn the millstone.&#34;

What will you shout as you attack the giants?
TEST
Sire, what should we do?
  (S)earch for your lady love, Dulcinea del Toboso
  (A)ttack Giants
  (M)ount Rocinante
  (Q)uit

&gt;Q</code></pre><p>The &#34;(A)ttack Giants&#34; option allowed you to send up to 1024 bytes of shellcode that it would execute. The flag was:</p><blockquote>There is no book so bad...that it does not have something good in it.</blockquote><p>The first flag linked you to the next stage. It was a &#34;the princess is in another castle&#34; challenge. The challenge was 7 stages in total with each being a different architecture: x86, ARM, MIPS, PPC, 68k, ALPHA, and HPPA. Since I&#39;m a miserable bastard I put them all on consecutive ports and added a few repeats at the end so if you scanned them you&#39;d think there were 20 stages. </p><h2 id="year-five">Year Five</h2><figure><img src="https://www.notcheckmark.com/content/images/2022/05/teaser2014.webp" alt="" loading="lazy" width="2000" height="1111" srcset="https://www.notcheckmark.com/content/images/size/w600/2022/05/teaser2014.webp 600w, https://www.notcheckmark.com/content/images/size/w1000/2022/05/teaser2014.webp 1000w, https://www.notcheckmark.com/content/images/size/w1600/2022/05/teaser2014.webp 1600w, https://www.notcheckmark.com/content/images/2022/05/teaser2014.webp 2012w" sizes="(min-width: 720px) 720px"/></figure><p>For 2014 we updated the teaser to be a little slicker and made it Grand Theft Auto 5 themed. By 2014 there were a bunch of other CTFs and we were starting to riff on each other&#39;s challenges. That year it was hip to make QR code challenges. Codegate did a bunch and <a href="https://plaidctf.com/">PlaidCTF</a> even more in response ‚Äì in hopes that it would kill QR codes as a challenge. It backfired because we ended up doing our own QR code challenge and naming it after them: Plaid Parliament of Codegate. </p><p>I haven&#39;t mentioned him yet, but <a href="https://twitter.com/eipwned">Rusty</a> was a part of Ghost in the Shellcode from the beginning, always producing really solid challenges. Rusty is an annoyingly talented person ‚Äì he&#39;s seemingly good at everything. At the time, Rusty would spend 8 hours at work implementing (still) cutting-edge emulators for software analysis and then go home and spend 8 more hours working on his video game. In 2014, he built Choose your Pwn Adventure 2, a fully hackable 3D FPS.</p><h3 id="choose-your-pwn-adventure-2">Choose your Pwn Adventure 2</h3><p>Pwn Adventure 2 was a 3D FPS built on the Unity engine. It was filled with challenges that were impossible if you played the game straight-up. You had to find and exploit vulnerabilities in the game to complete the challenges. Challenges required you to figure out infinite health hacks, how to fly, speed hacks, and more.</p><figure><img src="https://www.notcheckmark.com/content/images/2022/05/bear_wine.webp" alt="" loading="lazy" width="1361" height="763" srcset="https://www.notcheckmark.com/content/images/size/w600/2022/05/bear_wine.webp 600w, https://www.notcheckmark.com/content/images/size/w1000/2022/05/bear_wine.webp 1000w, https://www.notcheckmark.com/content/images/2022/05/bear_wine.webp 1361w" sizes="(min-width: 720px) 720px"/><figcaption>Unbearable: Open the chest before the bears kill you. Also, in the last few minutes, they have had assault rifles.</figcaption></figure><p>The Unity engine is written in C#, so you could solve these challenges by decompiling it and patching it. You could also solve it purely with network attacks. For each of the challenges, the server trusted the client a little too much and you had to figure out what you could manipulate to unlock the required superpowers.</p><figure><img src="https://www.notcheckmark.com/content/images/2022/05/board2014.webp" alt="" loading="lazy" width="2000" height="988" srcset="https://www.notcheckmark.com/content/images/size/w600/2022/05/board2014.webp 600w, https://www.notcheckmark.com/content/images/size/w1000/2022/05/board2014.webp 1000w, https://www.notcheckmark.com/content/images/size/w1600/2022/05/board2014.webp 1600w, https://www.notcheckmark.com/content/images/size/w2400/2022/05/board2014.webp 2400w" sizes="(min-width: 720px) 720px"/><figcaption>Doge was in vogue then</figcaption></figure><p>The scoreboard was updated to remove any form of challenge unlocking controls. Half the game board was available only in the context of Pwn Adventure 2, but we had plenty of other challenges.</p><p>One notable challenge from that year was ByteSexual. Somehow, we discovered that on Linux you can <a href="https://stackoverflow.com/q/18272384">far call with </a><code><a href="https://stackoverflow.com/q/18272384">0x23</a></code><a href="https://stackoverflow.com/q/18272384"> as your </a><code><a href="https://stackoverflow.com/q/18272384">CS</a></code><a href="https://stackoverflow.com/q/18272384"> segment selector</a> value to switch between 32bit and 64bit execution modes. We used this trick to constantly switch between the two execution modes and abusing how the differing instruction decoders to confuse IDA and GDB&#39;s disassemblers.</p><p>We also updated our shellcode.tv setup to have a slick GitS-themed test card.</p><figure><img src="https://www.notcheckmark.com/content/images/2022/05/shellcodetv-banner-small-1.webp" alt="" loading="lazy" width="1333" height="750" srcset="https://www.notcheckmark.com/content/images/size/w600/2022/05/shellcodetv-banner-small-1.webp 600w, https://www.notcheckmark.com/content/images/size/w1000/2022/05/shellcodetv-banner-small-1.webp 1000w, https://www.notcheckmark.com/content/images/2022/05/shellcodetv-banner-small-1.webp 1333w" sizes="(min-width: 720px) 720px"/><figcaption>Frequency in Megacycles</figcaption></figure><h2 id="year-six">Year Six</h2><p>Our sixth year was our biggest year. Rusty had spent much of the previous year working on <a href="http://pwnadventure.com/">Choose your Pwn Adventure 3</a>, a completely new iteration of the game. This time it was written in C++ and used the Unreal engine.</p><figure><img src="https://www.notcheckmark.com/content/images/2022/05/pa3.webp" alt="" loading="lazy" width="640" height="374" srcset="https://www.notcheckmark.com/content/images/size/w600/2022/05/pa3.webp 600w, https://www.notcheckmark.com/content/images/2022/05/pa3.webp 640w"/><figcaption>PA3: Pwnie Island</figcaption></figure><p>Pwn Adventure 3 was a much larger part of the game that year. The bears were back too.</p><p>I mentioned previously that we started to make challenges that riffed on the challenges of other competitions ‚Äì normally PlaidCTF. Plaid had a series of great challenges called &#34;ECE&#39;s Revenge&#34;, where they would force us to decode some discrete logic circuit to get the flag. For PA3, we had our own version of that called &#34;Blocky&#39;s Revenge&#34;. In Blocky&#39;s Revenge, you had to decode a Minecraft-esc discrete logic circuit to get the flag. LiveOverflow did a video on analyzing it, jump to <a href="https://youtu.be/PQPO5Z4lVTU?t=66">66 seconds</a> to see the circuit.</p><figure><iframe width="200" height="113" src="https://www.youtube.com/embed/PQPO5Z4lVTU?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><figcaption>LiveOverflow: Analyzing the Blocky Logic Puzzle</figcaption></figure><p>I actually don&#39;t remember much about the competition that year. It was really the PA3 show. I was more interested in distracting the competitors who were in the room ‚Äì I remember playing full episodes of Archer on the projector which would totally DoS half the teams. </p><h2 id="year-seven-postponed-since-2015">Year Seven (Postponed since 2015)</h2><p>Ghost in the Shellcode never made it to its 7th year. We had intended to continue hosting it but by December 2015 it was pretty clear that we had lost all momentum and we decided to postpone the competition. You can still see the postponement message on <a href="http://ghostintheshellcode.com/">the website</a>. There wasn&#39;t a single reason why we called it quits, life just moved on. Jay and I had both moved to NYC and it felt kinda odd running a competition associated so strongly with our former employer. Jordan, <a href="https://twitter.com/PeterLaFosse">Peter</a>, and Rusty left to found <a href="https://vector35.com/">Vector35</a> and work on <a href="https://binary.ninja/">Binary Ninja</a>. I should say, most of us wanted to keep hosting it but we weren&#39;t putting in the effort and it would not have been able to maintain the quality we had held ourselves prior.</p><p>When I talk about Ghost in the Shellcode these days, I sound like a horrible old man. When we started, CTF was still in its infancy. When we started, the <code>flag</code> files were actually called <code>key</code>, because keys were the secrets we wanted to steal. We also didn&#39;t have a standard flag format until much later, it was even slightly controversial internally to suggest we use one. </p><p>The biggest change has been CTFs gaining respect. When we started, all the old-school hackers looked down on CTFs as not being real or just being toys. Now, those old-school hackers are still around and grumpy but most of them have begrudgingly admitted that CTFs are a good thing for our industry and develop very real skills. </p><p>The CTF industry has evolved a lot in the 12 years since we started Ghost in the Shellcode. I wonder where it goes next.</p>
    </section></div>
  </body>
</html>
