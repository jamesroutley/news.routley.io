<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/reteps/dockerfmt">Original</a>
    <h1>Dockerfmt: A Dockerfile Formatter</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">Dockerfile format and parser, and a modern version of <a href="https://github.com/jessfraz/dockfmt">dockfmt</a>. Built on top of the internal <a href="https://github.com/moby/buildkit">buildkit</a> parser.</p>

<p dir="auto">Binaries are available from the <a href="https://github.com/reteps/dockerfmt/releases">releases</a> page.</p>

<div data-snippet-clipboard-copy-content="A updated version of the dockfmt. Uses the dockerfile parser from moby/buildkit and the shell formatter from mvdan/sh.

Usage:
  dockerfmt [Dockerfile] [flags]
  dockerfmt [command]

Available Commands:
  completion  Generate the autocompletion script for the specified shell
  help        Help about any command
  version     Print the version number of dockerfmt

Flags:
  -c, --check         Check if the file(s) are formatted
  -h, --help          help for dockerfmt
  -i, --indent uint   Number of spaces to use for indentation (default 4)
  -n, --newline       End the file with a trailing newline
  -w, --write         Write the formatted output back to the file(s)

Use &#34;dockerfmt [command] --help&#34; for more information about a command."><pre lang="output"><code>A updated version of the dockfmt. Uses the dockerfile parser from moby/buildkit and the shell formatter from mvdan/sh.

Usage:
  dockerfmt [Dockerfile] [flags]
  dockerfmt [command]

Available Commands:
  completion  Generate the autocompletion script for the specified shell
  help        Help about any command
  version     Print the version number of dockerfmt

Flags:
  -c, --check         Check if the file(s) are formatted
  -h, --help          help for dockerfmt
  -i, --indent uint   Number of spaces to use for indentation (default 4)
  -n, --newline       End the file with a trailing newline
  -w, --write         Write the formatted output back to the file(s)

Use &#34;dockerfmt [command] --help&#34; for more information about a command.
</code></pre></div>

<p dir="auto">You can add the following entry to your <code>.pre-commit-config.yaml</code> file to use
<code>dockerfmt</code> as a pre-commit hook:</p>
<div dir="auto" data-snippet-clipboard-copy-content="repos:
  - repo: https://github.com/reteps/dockerfmt
    # run `pre-commit autoupdate` to pin the version
    rev: main
    hooks:
      - id: dockerfmt
        args:
          # optional: add additional arguments here
          - --indent=4"><pre><span>repos</span>:
  - <span>repo</span>: <span>https://github.com/reteps/dockerfmt</span>
    <span><span>#</span> run `pre-commit autoupdate` to pin the version</span>
    <span>rev</span>: <span>main</span>
    <span>hooks</span>:
      - <span>id</span>: <span>dockerfmt</span>
        <span>args</span>:
          <span><span>#</span> optional: add additional arguments here</span>
          - <span>--indent=4</span></pre></div>

<ul dir="auto">
<li>The <code>RUN</code> parser currently doesn&#39;t support grouping or semicolons in commands</li>
<li>No line wrapping is performed for long JSON commands</li>
<li>The <code># escape=X</code> directive is not supported</li>
</ul>
<p dir="auto">Contributions are welcome!</p>

<ul dir="auto">
<li>Format <code>RUN</code> steps with <a href="https://github.com/mvdan/sh">https://github.com/mvdan/sh</a></li>
<li>Support for basic heredocs:</li>
</ul>
<div dir="auto" data-snippet-clipboard-copy-content="RUN &lt;&lt;EOF
echo &#34;hello&#34;
echo &#34;world&#34;
EOF"><pre><span>RUN</span> &lt;&lt;EOF
echo <span>&#34;hello&#34;</span>
echo <span>&#34;world&#34;</span>
EOF</pre></div>
<ul dir="auto">
<li>Support for basic inline comments in run steps:</li>
</ul>
<div dir="auto" data-snippet-clipboard-copy-content="RUN echo &#34;hello&#34; \
    # this is a comment
    &amp;&amp; echo &#34;world&#34;"><pre><span>RUN</span> echo <span>&#34;hello&#34;</span> \
    <span><span>#</span> this is a comment</span>
    &amp;&amp; echo <span>&#34;world&#34;</span></pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="RUN echo &#34;hello&#34; \
    # this is a comment
    # that spans multiple lines
    &amp;&amp; echo &#34;world&#34;"><pre><span>RUN</span> echo <span>&#34;hello&#34;</span> \
    <span><span>#</span> this is a comment</span>
    <span><span>#</span> that spans multiple lines</span>
    &amp;&amp; echo <span>&#34;world&#34;</span></pre></div>
<p dir="auto">This is surprisingly <a href="https://github.com/moby/buildkit/issues/5889" data-hovercard-type="issue" data-hovercard-url="/moby/buildkit/issues/5889/hovercard">non-trivial</a> as we want to attach the comments to their position in the formatted output, but they are stripped by the parser beforehand.</p>

<p dir="auto">The JS bindings are available in the <code>js</code> directory. More information on how to use them can be found in the <a href="https://github.com/reteps/dockerfmt/blob/main/js/README.md">README</a> file.</p>
</article></div></div>
  </body>
</html>
