<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://vermaden.wordpress.com/2026/02/01/150-mb-minimal-freebsd-installation/">Original</a>
    <h1>150 MB Minimal FreeBSD Installation</h1>
    
    <div id="readability-page-1" class="page"><div>
			<p>Sometimes an article starts with a simple question or a single message on one of the available social platforms. This is the case today with this article where <a href="https://x.com/ooberober/status/2016859667805176127">@ooberober</a> asked:</p>
<blockquote><p><i><span>How small can the root get in its most minimal setup, as far as you know, with pkgbase(8)?</span><br/>
</i></p></blockquote>
<p>Tiny OS installations sounds similar to me to tiny houses … not sure why.</p>
<p><img src="https://vermaden.wordpress.com/wp-content/uploads/2026/01/tiny-house-freebsd-small.jpg"/></p>
<p>I wrote about many/most aspects of PKGBASE in the <a href="https://vermaden.wordpress.com/2025/10/20/brave-new-pkgbase-world/"><b>Brave New PKGBASE World</b></a> article … but not the installation size. I checked one of my FreeBSD 15.0 PKGBASE installations and <a href="https://x.com/vermaden/status/2016881773515272313">replied</a> right away – <b>450 MB</b> of disk space … but maybe that can be pushed further?</p>
<p>What I am gonna share with You today is <u>unsupported</u> – probably <u>unrecomended</u> – you may render your system <u>broken</u>. Only use it in test environment – as I did in a fresh Bhyve VM. <b>You have been warned</b>.</p>
<p>To make you interested – this is what I was able to achieve with FreeBSD 15.0-RELEASE with PKGBASE installation.</p>
<pre><b>root@space:~ # <span>df -m</span></b>
Filesystem          1M-blocks Used Avail Capacity  Mounted on
zroot/ROOT/default       7437  150  7287     2%    /
devfs                       0    0     0     0%    /dev
/dev/gpt/efiboot0         255    1   254     0%    /boot/efi
zroot/home               7287    0  7287     0%    /home
zroot/tmp                7287    0  7287     0%    /tmp
zroot/usr/ports          7287    0  7287     0%    /usr/ports
zroot/var/log            7287    0  7287     0%    /var/log
zroot/var/mail           7287    0  7287     0%    /var/mail
zroot/usr/src            7287    0  7287     0%    /usr/src
zroot/var/tmp            7287    0  7287     0%    /var/tmp
zroot/var/audit          7287    0  7287     0%    /var/audit
zroot/var/crash          7287    0  7287     0%    /var/crash
</pre>
<p>About <b>150 MB</b> of physically used space. I used <tt><b>zstd-19</b></tt> ZFS compression at <tt><b>bsdinstall(8)</b></tt> installer.</p>
<p>I started with simple plain FreeBSD 15.0-RELEASE installation with these options:</p>
<pre><b>Select Installation Type</b>
- Packages (Tech Preview)

<b>Network or Offline Installation</b>
- Offline (Limited Packages)

<b>Partitioning</b>
- Auto (ZFS)
  - ZFS Configuration
    - ZFS Pool Options: -O compression=zstd-19

<b>Select System Components</b>
- [X] base
</pre>
<p>If you select that <tt><b>[X] base</b></tt> option you will end up with 450 MB of physical space used and these sets installed.</p>
<pre><b>root@space:~ # <span>pkg sets | grep :</span></b>
FreeBSD-set-base-15.0:
FreeBSD-set-devel-15.0:
FreeBSD-set-minimal-15.0:
FreeBSD-set-optional-15.0:
</pre>
<p>As we are working with PKGBASE world – for a start will will try to make sure <tt><b>pkg(8)</b></tt> preserves our ‘cuts’.</p>
<pre><b>root@space:~ # <span>pkg info -d pkg</span></b>
pkg-2.4.2:
        FreeBSD-libarchive-15.0 (libarchive.so.7)
        FreeBSD-clibs-15.0 (libc.so.7)
        FreeBSD-clibs-15.0 (libm.so.5)
        FreeBSD-clibs-15.0 (libthr.so.3)
        FreeBSD-openssl-lib-15.0 (libcrypto.so.35)
        FreeBSD-openssl-lib-15.0 (libssl.so.35)
        FreeBSD-runtime-15.0 (libelf.so.2)
        FreeBSD-runtime-15.0 (libjail.so.1)
        FreeBSD-runtime-15.0 (libutil.so.10)
        FreeBSD-zlib-15.0 (libz.so.6)
</pre>
<p>So in theory these are the PKGBASE packages we must preserve to keep <tt><b>pkg(8)</b></tt> alive.</p>
<pre><b>root@space:~ # <span>pkg info -d pkg | awk &#39;{print $1}&#39; | sed 1d | sort -u</span></b>
FreeBSD-clibs-15.0
FreeBSD-libarchive-15.0
FreeBSD-openssl-lib-15.0
FreeBSD-runtime-15.0
FreeBSD-zlib-15.0

<b>root@space:~ # <span>pkg info -d pkg | awk &#39;{print $1}&#39; | sed 1d | sort -u | while read I; do echo -n &#34;$I: &#34;; pkg info ${I} | grep set; done | column -t</span></b>
FreeBSD-clibs-15.0:        set  :  minimal,minimal-jail
FreeBSD-libarchive-15.0:   set  :  optional,optional-jail
FreeBSD-openssl-lib-15.0:  set  :  optional,optional-jail
FreeBSD-runtime-15.0:      set  :  minimal,minimal-jail
FreeBSD-zlib-15.0:         set  :  minimal,minimal-jail
</pre>
<p>As we want to keep both <b><tt>FreeBSD-set-base</tt></b> and <tt><b>FreeBSD-set-minimal</b></tt> sets – that gives us these:</p>
<pre><b>root@space:~ # <span>pkg info -d pkg | awk &#39;{print $1}&#39; | sed 1d | sort -u | while read I; do echo -n &#34;$I: &#34;; pkg info ${I} | grep set; done | column -t | grep -v minimal</span></b>
FreeBSD-libarchive-15.0:   set  :  optional,optional-jail
FreeBSD-openssl-lib-15.0:  set  :  optional,optional-jail

</pre>
<p>So in theory we can remove all packages of <tt><b>FreeBSD-set-devel</b></tt> and <tt><b>FreeBSD-set-minimal</b></tt> sets and just keep these <tt><b>FreeBSD-libarchive</b></tt> and <tt><b>FreeBSD-openssl-lib</b></tt> packages to have working <tt><b>pkg(8)</b></tt> right?</p>
<p><img src="https://vermaden.wordpress.com/wp-content/uploads/2026/01/star-wars-yoda-another-there-is.gif"/></p>

<p>Unfortunately no – as master <i>Yoda</i> once said – <i>“No, there is another.”</i> – and the answer is that both <tt><b>FreeBSD-xz-lib</b></tt> and <tt><b>FreeBSD-libucl</b></tt> packages to not keep you waiting – but we will come to that later.</p>
<p>For a start lets check <tt><b>FreeBSD-libarchive</b></tt> and <tt><b>FreeBSD-openssl-lib</b></tt> packages.</p>
<pre><b>root@space:~ # <span>pkg info -d FreeBSD-set-devel-15.0 | wc -l</span></b>
      70

<b>root@space:~ # <span>pkg info -d FreeBSD-set-devel-15.0 | grep -v -e FreeBSD-libarchive-15 -e FreeBSD-openssl-lib-15 | wc -l</span></b>
      70

<b>root@space:~ # <span>pkg info -d FreeBSD-set-optional-15.0 | wc -l</span></b>
      93

<b>root@space:~ # <span>pkg info -d FreeBSD-set-optional-15.0 | grep -v -e FreeBSD-libarchive-15 -e FreeBSD-openssl-lib-15 | wc -l</span></b>
      91
</pre>
<p>So they are both in <tt><b>FreeBSD-set-optional</b></tt> set.</p>
<p>We can now <tt><b>lock</b></tt> needed ones.</p>
<pre><b>root@space:~ # <span>pkg lock -y FreeBSD-libarchive</span></b>
Locking FreeBSD-libarchive-15.0

<b>root@space:~ # <span>pkg lock -y FreeBSD-openssl-lib</span></b>
Locking FreeBSD-openssl-lib-15.0
</pre>
<p>We should also create a ‘backup’ ZFS Boot Environment before we potentially break our system.</p>
<pre><b>root@space:~ # <span>bectl create backup</span></b>
</pre>
<p>Now … if we start deleting these – we will come to this point below.</p>
<pre>(...)
Installed packages to be REMOVED:
        FreeBSD-xz-lib: 15.0

Number of packages to be removed: 1
[1/1] Deinstalling FreeBSD-xz-lib-15.0...
[1/1] Deleting files for FreeBSD-xz-lib-15.0: 100%
<span>ld-elf.so.1: Shared object &#34;liblzma.so.5&#34; not found, required by &#34;libarchive.so.7&#34;
ld-elf.so.1: Shared object &#34;liblzma.so.5&#34; not found, required by &#34;libarchive.so.7&#34;
ld-elf.so.1: Shared object &#34;liblzma.so.5&#34; not found, required by &#34;libarchive.so.7&#34;</span>
(...)
</pre>
<p>Same with the other one.</p>
<pre>(...)
Installed packages to be REMOVED:
        FreeBSD-libucl: 15.0

Number of packages to be removed: 1
[1/1] Deinstalling FreeBSD-libucl-15.0...
[1/1] Deleting files for FreeBSD-libucl-15.0: 100%
<span>ld-elf.so.1: Shared object &#34;libprivateucl.so.1&#34; not found, required by &#34;pkg&#34;
ld-elf.so.1: Shared object &#34;libprivateucl.so.1&#34; not found, required by &#34;pkg&#34;
ld-elf.so.1: Shared object &#34;libprivateucl.so.1&#34; not found, required by &#34;pkg&#34;</span>
(...)
</pre>
<p>… and yes – we do not want that.</p>
<p>The <tt><b>pkg-static(8)</b></tt> will still work fortunately.</p>
<p>The disappointing thing about so called experience is that you get it just after you needed it – and its no different this time.</p>
<p>So – we also need to <tt><b>lock</b></tt> these:</p>
<ul>
<li><tt><b>FreeBSD-xz-lib</b></tt></li>
<li><tt><b>FreeBSD-libucl</b></tt></li>
<li><tt><b>FreeBSD-libcasper</b></tt></li>
</ul>
<p>Lets do that.</p>
<pre><b>root@space:~ # <span>pkg lock -y FreeBSD-xz-lib</span></b>
Locking FreeBSD-xz-lib-15.0

<b>root@space:~ # <span>pkg lock -y FreeBSD-libucl</span></b>
Locking FreeBSD-libucl-15.0

<b>root@space:~ # <span>pkg lock -y FreeBSD-libcasper</span></b>
Locking FreeBSD-libcasper-15.0
</pre>
<p>Now – we can remove these sets and packages.</p>
<p>Lets just make sure that <tt><b>lock</b></tt> really works.</p>
<pre><b>root@space:~ # <span>pkg delete -fy FreeBSD-libarchive</span></b>
Checking integrity... done (0 conflicting)
The following package(s) are locked or vital and may not be removed:

        FreeBSD-libarchive

1 packages requested for removal: 1 locked, 0 missing
</pre>
<p>Yep. Works. Lets go hunting.</p>
<pre><b>root@space:~ # <span>pkg lock -l</span></b>
Currently locked packages:
FreeBSD-libarchive-15.0
FreeBSD-libucl-15.0
FreeBSD-openssl-lib-15.0
FreeBSD-xz-lib-15.0
FreeBSD-libcasper-15.0

<b>root@space:~ # <span>pkg info -d FreeBSD-set-devel-15.0    | tr &#39;:&#39; &#39; &#39; | while read PKG; do pkg delete -fy ${PKG}; done</span>

root@space:~ # <span>pkg info -d FreeBSD-set-optional-15.0 | tr &#39;:&#39; &#39; &#39; | while read PKG; do pkg delete -fy ${PKG}; done</span></b>
</pre>
<p>After these operations … and needed locks for three mentioned packages You should have a working FreeBSD 15.0-RELEASE system that takes about <strong>150 MB</strong> of space.</p>
<p>The downside? The <tt><b>pkg(8)</b></tt> will still try to reinstall most/all the removed packages during upgrade.</p>
<pre><b>root@space:~ # <span>pkg upgrade</span></b>
Updating FreeBSD-ports repository catalogue...
Fetching meta.conf: 100%    179 B   0.2 k/s    00:01    
Fetching data: 100%   10 MiB 514.3 k/s    00:21    
Processing entries: 100%
FreeBSD-ports repository update completed. 36679 packages processed.
Updating FreeBSD-ports-kmods repository catalogue...
Fetching meta.conf: 100%    179 B   0.2 k/s    00:01    
Fetching data: 100%   35 KiB  35.7 k/s    00:01    
Processing entries: 100%
FreeBSD-ports-kmods repository update completed. 239 packages processed.
Updating FreeBSD-base repository catalogue...
Fetching meta.conf: 100%    179 B   0.2 k/s    00:01    
Fetching data: 100%   80 KiB  81.5 k/s    00:01    
Processing entries: 100%
FreeBSD-base repository update completed. 496 packages processed.
All repositories are up to date.
Updating database digests format: 100%
Checking for upgrades (9 candidates): 100%
Processing candidates (9 candidates): 100%
The following 79 package(s) will be affected (of 0 checked):

New packages to be INSTALLED:
        FreeBSD-atf-dev: 15.0 [FreeBSD-base]
        FreeBSD-audit-dev: 15.0 [FreeBSD-base]
        FreeBSD-blocklist-dev: 15.0 [FreeBSD-base]
        FreeBSD-bluetooth-dev: 15.0 [FreeBSD-base]
        FreeBSD-bmake: 15.0 [FreeBSD-base]
        FreeBSD-bootloader-dev: 15.0 [FreeBSD-base]
        FreeBSD-bsnmp-dev: 15.0 [FreeBSD-base]
        FreeBSD-bzip2-dev: 15.0 [FreeBSD-base]
        FreeBSD-clang: 15.0 [FreeBSD-base]
        FreeBSD-clang-dev: 15.0 [FreeBSD-base]
        FreeBSD-clibs-dev: 15.0 [FreeBSD-base]
        FreeBSD-clibs-lib32: 15.0 [FreeBSD-base]
        FreeBSD-ctf: 15.0 [FreeBSD-base]
        FreeBSD-ctf-dev: 15.0 [FreeBSD-base]
        FreeBSD-ctf-lib: 15.0 [FreeBSD-base]
        FreeBSD-devmatch-dev: 15.0 [FreeBSD-base]
        FreeBSD-dtrace-dev: 15.0 [FreeBSD-base]
        FreeBSD-efi-tools-dev: 15.0 [FreeBSD-base]
        FreeBSD-fetch-dev: 15.0 [FreeBSD-base]
        FreeBSD-flua-dev: 15.0 [FreeBSD-base]
        FreeBSD-kerberos-dev: 15.0 [FreeBSD-base]
        FreeBSD-kyua: 15.0 [FreeBSD-base]
        FreeBSD-lib9p-dev: 15.0 [FreeBSD-base]
        FreeBSD-libarchive-dev: 15.0 [FreeBSD-base]
        FreeBSD-libbegemot-dev: 15.0 [FreeBSD-base]
        FreeBSD-libblocksruntime-dev: 15.0 [FreeBSD-base]
        FreeBSD-libbsdstat-dev: 15.0 [FreeBSD-base]
        FreeBSD-libcasper-dev: 15.0 [FreeBSD-base]
        FreeBSD-libcompat-dev: 15.0 [FreeBSD-base]
        FreeBSD-libcompiler_rt-dev: 15.0 [FreeBSD-base]
        FreeBSD-libcuse-dev: 15.0 [FreeBSD-base]
        FreeBSD-libdwarf-dev: 15.0 [FreeBSD-base]
        FreeBSD-libevent1-dev: 15.0 [FreeBSD-base]
        FreeBSD-libexecinfo-dev: 15.0 [FreeBSD-base]
        FreeBSD-libipt-dev: 15.0 [FreeBSD-base]
        FreeBSD-libldns-dev: 15.0 [FreeBSD-base]
        FreeBSD-libmagic-dev: 15.0 [FreeBSD-base]
        FreeBSD-libmilter-dev: 15.0 [FreeBSD-base]
        FreeBSD-libpathconv-dev: 15.0 [FreeBSD-base]
        FreeBSD-librpcsec_gss-dev: 15.0 [FreeBSD-base]
        FreeBSD-librss-dev: 15.0 [FreeBSD-base]
        FreeBSD-libsqlite3-dev: 15.0 [FreeBSD-base]
        FreeBSD-libthread_db-dev: 15.0 [FreeBSD-base]
        FreeBSD-libucl-dev: 15.0 [FreeBSD-base]
        FreeBSD-libvgl-dev: 15.0 [FreeBSD-base]
        FreeBSD-libvmmapi-dev: 15.0 [FreeBSD-base]
        FreeBSD-libyaml-dev: 15.0 [FreeBSD-base]
        FreeBSD-lld: 15.0 [FreeBSD-base]
        FreeBSD-lldb: 15.0 [FreeBSD-base]
        FreeBSD-lldb-dev: 15.0 [FreeBSD-base]
        FreeBSD-local-unbound-dev: 15.0 [FreeBSD-base]
        FreeBSD-mtree: 15.0 [FreeBSD-base]
        FreeBSD-natd-dev: 15.0 [FreeBSD-base]
        FreeBSD-ncurses-dev: 15.0 [FreeBSD-base]
        FreeBSD-netmap-dev: 15.0 [FreeBSD-base]
        FreeBSD-openssl-dev: 15.0p2 [FreeBSD-base]
        FreeBSD-pf-dev: 15.0 [FreeBSD-base]
        FreeBSD-pmc-dev: 15.0 [FreeBSD-base]
        FreeBSD-runtime-dev: 15.0 [FreeBSD-base]
        FreeBSD-set-devel: 15.0 [FreeBSD-base]
        FreeBSD-set-optional: 15.0 [FreeBSD-base]
        FreeBSD-smbutils-dev: 15.0 [FreeBSD-base]
        FreeBSD-sound-dev: 15.0 [FreeBSD-base]
        FreeBSD-ssh-dev: 15.0 [FreeBSD-base]
        FreeBSD-tcpd-dev: 15.0 [FreeBSD-base]
        FreeBSD-toolchain: 15.0 [FreeBSD-base]
        FreeBSD-toolchain-dev: 15.0 [FreeBSD-base]
        FreeBSD-ufs-dev: 15.0 [FreeBSD-base]
        FreeBSD-utilities-dev: 15.0 [FreeBSD-base]
        FreeBSD-xz-dev: 15.0 [FreeBSD-base]
        FreeBSD-yp: 15.0 [FreeBSD-base]
        FreeBSD-zfs-dev: 15.0 [FreeBSD-base]
        FreeBSD-zlib-dev: 15.0 [FreeBSD-base]

Installed packages to be UPGRADED:
        FreeBSD-devmatch: 15.0 -&gt; 15.0p2 [FreeBSD-base]
        FreeBSD-kernel-generic: 15.0 -&gt; 15.0p2 [FreeBSD-base]
        FreeBSD-openssl: 15.0 -&gt; 15.0p2 [FreeBSD-base]
        FreeBSD-rescue: 15.0 -&gt; 15.0p2 [FreeBSD-base]
        FreeBSD-runtime: 15.0 -&gt; 15.0p2 [FreeBSD-base]
        FreeBSD-utilities: 15.0 -&gt; 15.0p1 [FreeBSD-base]

Number of packages to be installed: 73
Number of packages to be upgraded: 6

The process will require 458 MiB more space.
190 MiB to be downloaded.

Proceed with this action? [y/N]: <span><b>n</b>
</span></pre>
<p>We can overcome that by removing the <tt><b>base/FreeBSD-set-devel</b></tt> dependency on <tt><b>base/FreeBSD-set-base</b></tt>.</p>
<p>This way <tt><b>pkg(8)</b></tt> would not want to reinstall <tt><b>base/FreeBSD-set-devel</b></tt> next time during upgrade.</p>
<p>Before we do that we will backup the <tt><b>pkg(8)</b></tt> SQLite database at <tt><b>/var/db/pkg/local.sqlite</b></tt> file.</p>
<pre><strong>root@space:~ # <span>cp /var/db/pkg/local.sqlite /var/db/pkg/local.sqlite.BACKUP</span></strong>

<strong>root@space:~ # <span>pkg shell</span></strong>

<strong>sqlite&gt; <span>.header on</span></strong>

<strong>sqlite&gt; <span>.mode column</span></strong>

<strong>sqlite&gt; <span>.tables</span></strong>
annotation           pkg_annotation       pkg_provides       
categories           pkg_categories       pkg_requires       
config_files         pkg_conflicts        pkg_script         
<span><strong><span>deps</span></strong></span>                 pkg_directories      pkg_shlibs_provided
directories          pkg_groups           pkg_shlibs_required
files                pkg_licenses         pkg_users          
groups               pkg_lock             provides           
licenses             pkg_lock_pid         requires           
lua_script           pkg_lua_script       script             
option               pkg_option           shlibs             
option_desc          pkg_option_default   users              
<span><strong>packages</strong></span>             pkg_option_desc    
</pre>
<p>The two important tables that are in our interest are <tt><b>deps</b></tt> and <tt><b>packages</b></tt> here.</p>
<p>This is how relation between these two tables look in <b>DBeaver</b> tool.</p>
<p><img src="https://vermaden.wordpress.com/wp-content/uploads/2026/01/sqlite-pkg-database-relations.png"/></p>
<p>These are the dependencies.</p>
<pre><strong>sqlite&gt; <span>select * from deps where origin like &#39;%-set-%&#39;;</span></strong>
origin                     name                  version  package_id
-------------------------  --------------------  -------  ----------
base/FreeBSD-set-devel     FreeBSD-set-devel     15.0     208       
base/FreeBSD-set-minimal   FreeBSD-set-minimal   15.0     208       
base/FreeBSD-set-optional  FreeBSD-set-optional  15.0     208       

<strong>sqlite&gt; <span>select origin,package_id from deps where origin = &#39;base/FreeBSD-set-devel&#39;;</span></strong>
origin                  package_id
----------------------  ----------
base/FreeBSD-set-devel  208       

<strong>sqlite&gt; <span>select id,name from packages where id = 208;</span></strong>
id   name            
---  ----------------
208  FreeBSD-set-base</pre>
<p>Now we will <tt><b>DELETE</b></tt> the <tt><b>base/FreeBSD-set-devel</b></tt> dependency on <tt><b>base/FFreeBSD-set-base</b></tt> set.</p>
<pre><strong>sqlite&gt; <span>delete from deps where origin = &#34;base/FreeBSD-set-devel&#34;;</span>

sqlite&gt; <span>.quit
</span></strong></pre>
<p>It can also be done non-interactively this way below.</p>
<pre><strong>root@space: # <span>echo &#39;delete from deps where origin = &#34;base/FreeBSD-set-devel&#34;;&#39; | pkg shell

</span></strong></pre>
<p>Lets check how <tt><b>pkg(8)</b></tt> upgrade will now behave.</p>
<pre><b>root@space:~ # <span>pkg upgrade</span></b>
Updating FreeBSD-ports repository catalogue...
FreeBSD-ports repository is up to date.
Updating FreeBSD-ports-kmods repository catalogue...
FreeBSD-ports-kmods repository is up to date.
Updating FreeBSD-base repository catalogue...
FreeBSD-base repository is up to date.
All repositories are up to date.
Checking for upgrades (9 candidates): 100%
Processing candidates (9 candidates): 100%
The following 10 package(s) will be affected (of 0 checked):

New packages to be INSTALLED:
        FreeBSD-bmake: 15.0 [FreeBSD-base]
        FreeBSD-ctf-lib: 15.0 [FreeBSD-base]
        FreeBSD-set-optional: 15.0 [FreeBSD-base]
        FreeBSD-yp: 15.0 [FreeBSD-base]

Installed packages to be UPGRADED:
        FreeBSD-devmatch: 15.0 -&gt; 15.0p2 [FreeBSD-base]
        FreeBSD-kernel-generic: 15.0 -&gt; 15.0p2 [FreeBSD-base]
        FreeBSD-openssl: 15.0 -&gt; 15.0p2 [FreeBSD-base]
        FreeBSD-rescue: 15.0 -&gt; 15.0p2 [FreeBSD-base]
        FreeBSD-runtime: 15.0 -&gt; 15.0p2 [FreeBSD-base]
        FreeBSD-utilities: 15.0 -&gt; 15.0p1 [FreeBSD-base]

Number of packages to be installed: 4
Number of packages to be upgraded: 6

The process will require 1 MiB more space.
63 MiB to be downloaded.

Proceed with this action? [y/N]: <span><b>n</b>

</span></pre>
<p>Better.</p>
<p>The <tt><b>pkg(8)</b></tt> no longer wants to reinstall the <tt><b>base/FreeBSD-set-devel</b></tt> set and its packages.</p>
<p>You can also check other <a href="https://vermaden.wordpress.com/2019/01/17/less-known-pkg8-features/"><b>Less Known <tt>pkg(8)</tt> Features</b></a> here.</p>
<p>So there You have it.</p>
<p>Minimal unsupported FreeBSD 15.0-RELEASE installation in PKGBASE fashion.</p>
<p>To be honest … I was thinking that PKGBASE would be more ‘modular’ to say the least … but seems that packaging/upgrades/integrity are really its goals – not modularity … and in todays world of ‘gigabytes’ and ‘terabytes’ the disk space savings are not that important. Its 2026 … we do not put entire OS into 3.5 inch floppy anymore … nowhere to read or write such floppy either.</p>
<p>Some additional space showing commands.</p>
<pre><b>root@space:~ # <span>df -h /</span></b>
Filesystem            Size    Used   Avail Capacity  Mounted on
zroot/ROOT/default    7.3G    150M    7.1G     2%    /

<b>root@space:~ # <span>bectl list</span></b>
BE      Active Mountpoint Space Created
default NR     /          150M  2026-01-31 18:23</pre>
<p>List of installed <tt><b>pkg(8)</b></tt> packages.</p>
<pre><b>root@space:~ # <span>pkg info -as | sort -k 2 -h</span></b>
FreeBSD-set-base-15.0          0.00B
FreeBSD-powerd-15.0            23.3KiB
FreeBSD-certctl-15.0           26.1KiB
FreeBSD-nuageinit-15.0         40.8KiB
FreeBSD-devmatch-15.0          43.8KiB
FreeBSD-hyperv-tools-15.0      43.9KiB
FreeBSD-at-15.0                48.9KiB
FreeBSD-ufs-lib-15.0           50.5KiB
FreeBSD-bzip2-15.0             50.8KiB
FreeBSD-fwget-15.0             54.5KiB
FreeBSD-resolvconf-15.0        56.4KiB
FreeBSD-newsyslog-15.0         57.4KiB
FreeBSD-periodic-15.0          61.6KiB
FreeBSD-bzip2-lib-15.0         80.7KiB
FreeBSD-syslogd-15.0           82.5KiB
FreeBSD-devd-15.0              87.1KiB
FreeBSD-cron-15.0              91.2KiB
FreeBSD-zlib-15.0              99.4KiB
FreeBSD-fetch-15.0             110KiB
FreeBSD-libcasper-15.0         142KiB
FreeBSD-libucl-15.0            142KiB
FreeBSD-dhclient-15.0          150KiB
FreeBSD-efi-tools-15.0         152KiB
FreeBSD-xz-lib-15.0            198KiB
FreeBSD-rc-15.0                406KiB
FreeBSD-geom-15.0              510KiB
FreeBSD-ncurses-15.0           527KiB
FreeBSD-pkg-bootstrap-15.0     579KiB
FreeBSD-ppp-15.0               579KiB
FreeBSD-ncurses-lib-15.0       586KiB
FreeBSD-ufs-15.0               619KiB
FreeBSD-mandoc-15.0            638KiB
FreeBSD-vi-15.0                775KiB
FreeBSD-zoneinfo-15.0          828KiB
FreeBSD-libarchive-15.0        885KiB
FreeBSD-caroot-15.0            1.03MiB
FreeBSD-zfs-15.0               1.25MiB
FreeBSD-vt-data-15.0           1.54MiB
FreeBSD-wpa-15.0               1.59MiB
FreeBSD-kernel-man-15.0        2.63MiB
FreeBSD-clibs-15.0             3.79MiB
FreeBSD-zfs-lib-15.0           4.58MiB
FreeBSD-bootloader-15.0        6.50MiB
FreeBSD-openssl-lib-15.0       7.26MiB
FreeBSD-runtime-15.0           8.81MiB
FreeBSD-firmware-iwm-15.0      13.8MiB
FreeBSD-rescue-15.0            19.0MiB
FreeBSD-locales-15.0           24.3MiB
FreeBSD-utilities-15.0         48.6MiB
pkg-2.4.2                      53.4MiB
FreeBSD-kernel-generic-15.0    153MiB
</pre>
<p>On of the biggest packages is … <tt><b>pkg(8)</b></tt> – and about 70% of that space is the static <tt><b>pkg-static(8)</b></tt> binary.</p>
<pre><b>root@space:~ # <span>pkg info -l pkg | sed 1d | xargs du -smc | sort -n | tail -10</span></b>
1       /usr/local/share/man/man8/pkg-upgrade.8.gz
1       /usr/local/share/man/man8/pkg-version.8.gz
1       /usr/local/share/man/man8/pkg-which.8.gz
1       /usr/local/share/man/man8/pkg.8.gz
1       /usr/local/share/zsh/site-functions/_pkg
2       /usr/local/lib/libpkg.a
2       /usr/local/lib/libpkg.so.4
2       /usr/local/sbin/pkg
13      /usr/local/sbin/pkg-static
<strong>19      total
</strong></pre>
<p>Lets check the largest one – the FreeBSD kernel package.</p>
<p>This system currently only has <tt><b>zfs.ko</b></tt> kernel module loaded for ZFS support.</p>
<pre><b>root@space:~ # <span>kldstat</span></b>
Id Refs Address                Size Name
 1   10 0xffffffff80200000  1f4daa0 kernel
 2    1 0xffffffff8214e000   620c10 zfs.ko
</pre>
<p>Lets check the largest kernel modules we can live without.</p>
<pre><b>root@space:~ # <span>cd /boot/kernel</span>

root@space:/boot/kernel # <span>du -skc qat*     \
                                  iw*      \
                                  if_*     \
                                  pmspcv*  \
                                  ispfw*   \
                                  sfxge*   \
                                  ice_ddp* \
                                  hpt27xx* \
                                  cam*     \
                                  ipl*     \
                                  ocs_fc*  \
                                  sctp*</span></b>
577     qat_200xx_fw.ko
337     qat_4xxx_fw.ko
185     qat_api.ko
69      qat_c2xxx.ko
157     qat_c2xxxfw.ko
577     qat_c3xxx_fw.ko
1413    qat_c4xxx_fw.ko
829     qat_c62x_fw.ko
201     qat_common.ko
625     qat_dh895xcc_fw.ko
105     qat_hw.ko
57      qat.ko
161     iw_cxgbe.ko
133     iwi_bss.ko
129     iwi_ibss.ko
133     iwi_monitor.ko
597     iwm3160fw.ko
537     iwm3168fw.ko
637     iwm7260fw.ko
565     iwm7265Dfw.ko
693     iwm7265fw.ko
1089    iwm8000Cfw.ko
953     iwm8265fw.ko
1385    iwm9000fw.ko
1385    iwm9260fw.ko
233     iwn1000fw.ko
233     iwn100fw.ko
425     iwn105fw.ko
437     iwn135fw.ko
433     iwn2000fw.ko
441     iwn2030fw.ko
109     iwn4965fw.ko
233     iwn5000fw.ko
229     iwn5150fw.ko
281     iwn6000fw.ko
413     iwn6000g2afw.ko
417     iwn6000g2bfw.ko
289     iwn6050fw.ko
41      if_ae.ko
49      if_age.ko
57      if_alc.ko
49      if_ale.ko
9       if_ath.ko
29      if_aue.ko
33      if_axe.ko
33      if_axge.ko
141     if_axp.ko
229     if_bce.ko
37      if_bfe.ko
85      if_bge.ko
221     if_bnxt.ko
49      if_bridge.ko
117     if_bwi.ko
181     if_bwn.ko
1269    if_bxe.ko
45      if_cas.ko
5       if_cc.ko
5       if_ccv.ko
37      if_cdce.ko
29      if_cdceem.ko
25      if_cue.ko
173     if_cxgb.ko
469     if_cxgbe.ko
45      if_cxgbev.ko
5       if_cxl.ko
5       if_cxlv.ko
53      if_dc.ko
21      if_disc.ko
21      if_edsc.ko
237     if_em.ko
145     if_ena.ko
25      if_enc.ko
57      if_enic.ko
25      if_epair.ko
45      if_et.ko
29      if_fwe.ko
37      if_fwip.ko
49      if_fxp.ko
37      if_gem.ko
33      if_gif.ko
41      if_gre.ko
89      if_gve.ko
97      if_iavf.ko
25      if_ic.ko
377     if_ice.ko
1       if_igb.ko
73      if_igc.ko
25      if_infiniband.ko
25      if_ipheth.ko
57      if_ipw.ko
69      if_iwi.ko
781     if_iwlwifi.ko
133     if_iwm.ko
109     if_iwn.ko
185     if_ix.ko
209     if_ixl.ko
1       if_ixlv.ko
157     if_ixv.ko
49      if_jme.ko
29      if_kue.ko
61      if_lagg.ko
33      if_le.ko
33      if_lge.ko
813     if_lio.ko
61      if_malo.ko
93      if_mana.ko
29      if_me.ko
25      if_mgb.ko
33      if_mos.ko
57      if_msk.ko
37      if_muge.ko
105     if_mwl.ko
69      if_mxge.ko
33      if_my.ko
49      if_nfe.ko
41      if_nge.ko
25      if_ntb.ko
113     if_oce.ko
65      if_otus.ko
53      if_ovpn.ko
1317    if_qlnxe.ko
1221    if_qlnxev.ko
69      if_qlxgb.ko
1921    if_qlxgbe.ko
85      if_qlxge.ko
121     if_ral.ko
57      if_re.ko
37      if_rl.ko
69      if_rsu.ko
509     if_rtw88.ko
1441    if_rtw89.ko
65      if_rtwn_pci.ko
97      if_rtwn_usb.ko
29      if_rue.ko
65      if_rum.ko
101     if_run.ko
37      if_sge.ko
37      if_sis.ko
49      if_sk.ko
37      if_smsc.ko
37      if_ste.ko
33      if_stf.ko
37      if_stge.ko
33      if_sume.ko
133     if_ti.ko
45      if_tuntap.ko
53      if_uath.ko
29      if_udav.ko
49      if_upgt.ko
53      if_ural.ko
45      if_ure.ko
33      if_urndis.ko
69      if_urtw.ko
41      if_vge.ko
37      if_vlan.ko
41      if_vmx.ko
41      if_vr.ko
37      if_vte.ko
61      if_vtnet.ko
49      if_vxlan.ko
97      if_wg.ko
93      if_wpi.ko
45      if_xl.ko
69      if_zyd.ko
2033    pmspcv.ko
1329    ispfw.ko
565     sfxge.ko
165     ice_ddp.ko
601     hpt27xx.ko
529     cam.ko
453     ipl.ko
517     ocs_fc.ko
477     sctp.ko
<strong>41555   total
</strong></pre>
<p>Another about <b>40 MB</b> that can be removed assuming you do not need these kernel modules.</p>
<p>That means we can get even under <b>100 MB</b> if we remove <b>40 MB</b> of unused kernel modules and <b>13 MB</b> of <tt><b>pkg-static(8)</b></tt> binary.</p>
<p>Also keep in mind that You have entire static FreeBSD <i>Rescue System</i> available under <tt><b>/rescue</b></tt> dir.</p>
<p>Not sure how (if anyhow) this helps – but still – wanted to share.</p>
<p>Let me know – if you tried it – if I missed any additional dependencies that should be kept.</p>
<p>EOF</p>
					</div></div>
  </body>
</html>
