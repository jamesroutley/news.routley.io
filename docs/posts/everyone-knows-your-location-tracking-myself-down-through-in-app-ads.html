<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://timsh.org/tracking-myself-down-through-in-app-ads/">Original</a>
    <h1>Everyone knows your location: tracking myself down through in-app ads</h1>
    
    <div id="readability-page-1" class="page"><div>

    <article>

        <header>

            

            <div>
                <p><a href="https://timsh.org/author/tim/">
                                <img src="https://timsh.org/content/images/size/w160/2025/01/wg21-2.jpg" alt="tim"/>
                            </a>
                </p>
                <div>
                    
                    <p><time datetime="2025-02-01">01 Feb 2025</time>
                            <span><span>—</span> 11 min read</span>
                    </p>
                </div>
            </div>

                <figure>
        <img srcset="/content/images/size/w320/2025/02/dataflow_upd.png 320w,
                    /content/images/size/w600/2025/02/dataflow_upd.png 600w,
                    /content/images/size/w960/2025/02/dataflow_upd.png 960w,
                    /content/images/size/w1200/2025/02/dataflow_upd.png 1200w,
                    /content/images/size/w2000/2025/02/dataflow_upd.png 2000w" sizes="(max-width: 1200px) 100vw, 1120px" src="https://timsh.org/content/images/size/w1200/2025/02/dataflow_upd.png" alt="Everyone knows your location: tracking myself down through in-app ads"/>
    </figure>

        </header>

        <section>
            <p>Recently I read about a <a href="https://www.404media.co/hackers-claim-massive-breach-of-location-data-giant-threaten-to-leak-data/?ref=timsh.org" rel="noreferrer">massive geolocation data leak from Gravy Analytics</a>, which exposed more than 2000 apps, both in AppStore and Google Play, that secretly collect geolocation data without user consent. Oftentimes, even without developers` knowledge. </p><p>I looked into the list (<a href="https://docs.google.com/spreadsheets/d/1Ukgd0gIWd9gpV6bOx2pcSHsVO6yIUqbjnlM4ewjO6Cs/edit?gid=1257088277&amp;ref=timsh.org#gid=1257088277" rel="noreferrer">link here</a>) and found at least 3 apps I have installed on my iPhone. Take a look for yourself! </p><h3 id="tldr">TL;DR</h3><p>After more than couple dozen hours of trying, here are the main takeaways: </p><ol><li>I found a couple requests sent by my phone with <strong>my location </strong>+ 5 requests that leak <strong>my IP address</strong>, which can be turned into geolocation using reverse DNS. </li><li>Learned a lot about the RTB (real-time bidding) auctions and OpenRTB protocol and was shocked by the amount and types of data sent with the bids to ad exchanges. </li><li>Gave up on the idea to buy my location data from a data broker or a tracking service, because I don&#39;t have a big enough company to take a trial or $10-50k to buy a huge database with the data of millions of people + me. </li></ol><p>But still, I know my location data was collected and I know where to buy it! </p><hr/><h2 id="starting-point">Starting point</h2><p>My setup for this research included:</p><ul><li>My old iPhone 11 restored to factory defaults + new apple id. </li><li>Charles Proxy to record all traffic coming in and out. </li><li>A simple game called Stack by KetchApp - I remember playing it at school 10-12 years ago. Choosing it as a lab rat felt nostalgic. </li></ul><figure><img src="https://timsh.org/content/images/2025/01/image-1.png" alt="" loading="lazy" width="320" height="180"/></figure><h3 id="huge-amount-of-requests">Huge amount of requests</h3><p>Ok, here we go: only 1 app installed without the default Apple ones, Charles on, launching Stack in 3, 2, 1.... </p><figure data-kg-thumbnail="https://timsh.org/content/media/2025/01/Screen-Recording-2025-01-19-at-00.02.51_thumb.jpg" data-kg-custom-thumbnail="">
            <div>
                <video src="https://timsh.org/content/media/2025/01/Screen-Recording-2025-01-19-at-00.02.51.mp4" poster="https://img.spacergif.org/v1/2410x2152/0a/spacer.png" width="2410" height="2152" loop="" autoplay="" muted="" playsinline="" preload="metadata"></video>
                
                <div>
                    <div>
                        <p>
                        
                        <span>0:00</span></p><p>
                            /<span>0:11</span>
                        </p>
                        </div>
                </div>
            </div>
            
        </figure><p>These are the requests that the app sends in the first minute after launch. </p><p>Let&#39;s take a look at the contents of the requests. </p><h3 id="unity-ads">Unity [ads]</h3><p>Let&#39;s start with the juiciest request sent to <code>https://o.isx.unity3d.com</code> - the first one that included my geo, while I <strong>disabled Location Services</strong> on iPhone for all apps! </p><p>Turns out that Unity&#39;s main revenue stream (they made $2 bln+ in 2023) is Unity Ads - &#34;Mobile Game Ad Network&#34;. Sounds quite interesting.</p><p>Below is the request body in json format sent to Unity Ads. I will only leave the  fields worth mentioning - the actual size is 200+ keys. </p><pre><code>{
  &#34;ts&#34;: &#34;2025-01-18T23:27:39Z&#34;, // Timestamp
  &#34;c&#34;: &#34;ES&#34;, // Country code,
  &#34;d&#34;: &#34;sports.bwin.es&#34;, // Domain; the app or website where the ad will be displayed.
  &#34;bn&#34;: &#34;molocoads-eu-banner&#34;, // WTF is moloco ads? We&#39;ll see!
  &#34;cip&#34;: &#34;181.41.[redacted]&#34;, // my IP !!
  &#34;dm&#34;: &#34;iPhone12,1&#34;, 
  &#34;ct&#34;: &#34;2&#34;, // Connection type; e.g., Wi-Fi
  &#34;car&#34;: &#34;Yoigo&#34;, // mobile network operator
  &#34;ifv&#34;: &#34;6B00D8E5-E37B-4EA0-BB58-[redacted]&#34;, // ID for Vendor. We&#39;ll get back to it!
  &#34;lon&#34;: &#34;2.[redacted]&#34;, // Longitude ... 
  &#34;lat&#34;: &#34;41.[redacted]&#34;, // Latitude ... 
  &#34;sip&#34;: &#34;34.227.224.225&#34;, // Server IP (Amazon AWS in US) 
  &#34;uc&#34;: &#34;1&#34;, // User consent for tracking = True; OK what ?!
}</code></pre><p>Ok, so my IP + location + timestamp + some <code>ifv</code> id are shared with Unity → Moloco Ads → Bwin, and then I see the actual Bwin ad in the game. </p><div><div><p>As a quick note - location shared was not very precise (but still in the same postal index), I guess due to the fact that iPhone was connected to WiFi and had no SIM installed. </p></div></div><h3 id="hello-facebook-what-are-you-doing-here">Hello Facebook... What are you doing here?</h3><p>Next interesting request that leaks my IP + timestamp (= geo-datapoint) is Facebook.</p><ul><li>I don&#39;t have any Meta [Facebook] app installed on this iPhone</li><li>I didn&#39;t link the app nor my Apple ID to any Facebook account</li><li>I didn&#39;t consent to Facebook getting my IP address!</li></ul><p>And yet here we are:</p><pre><code>{ 
	&#34;bundles&#34;: {
		&#34;bidder_token_info&#34;: {
			&#34;data&#34;: {
				&#34;bt_extras&#34;: {
                  &#34;ip&#34;:&#34;181.41.[redacted], // nice Extras, bro
                  &#34;ts&#34;:1737244649
			},
			&#34;fingerprint&#34;: null
		},
        {
          &#34;a lot of data: yes a loooooooot&#34;
         }</code></pre><p>We&#39;ll talk more about this one in the next section. </p><h3 id="why-do-you-need-my-screen-brightness-level">Why do you need my screen brightness level? </h3><p>Last request I found interesting was sent to... Unity again: </p><pre><code>{
  &#34;osVersion&#34;:&#34;16.7.1&#34;,
  &#34;connectionType&#34;:&#34;wifi&#34;,
  &#34;eventTimeStamp&#34;:1737244651,
  &#34;vendorIdentifier&#34;:&#34;6B00D8E5-E37B-[redacted]&#34;, // ifv once again 
  &#34;wiredHeadset&#34;:false, // excuse me? 
  &#34;volume&#34;:0.5,
  &#34;cpuCount&#34;:6,
  &#34;systemBootTime&#34;:1737215978,
  &#34;batteryStatus&#34;:3,
  &#34;screenBrightness&#34;:0.34999999403953552,
  &#34;freeMemory&#34;:507888,
  &#34;totalMemory&#34;:3550640, // is this RAM?
  &#34;timeZone&#34;:&#34;+0100&#34;,
  &#34;deviceFreeSpace&#34;:112945148
  &#34;networkOperator&#34;:&#34;6553565535&#34;
  &#34;advertisingTrackingId&#34;:&#34;00000000-0000....&#34;, // interesting ...
  }</code></pre><p>There&#39;s no &#34;personal information&#34; here, but honestly this amount of data shared with an arbitrary list of 3rd parties is scary. </p><p>I know the &#34;right&#34; answer - to help companies target their audience better! </p><p>But I also heard lots of controversies on this topic. </p><p>I can&#39;t know if that or another one is true. </p><p>Ok, enough with the requests. </p><hr/><h2 id="lets-talk-ids">Let&#39;s talk IDs</h2><p>You might&#39;ve already noticed <code>ifv</code> and <code>advertisingTrackingId</code> == <code>IDFA</code> in the requests above - what are those? </p><p>IFV, or IDFV, is &#34;ID for Vendor&#34;. </p><p>Advertising Tracking ID, on the other hand, is the cross-vendor value, the one that is shared with an app if you choose &#34;Allow app to track your activity across ...&#34;. </p><p>I checked this by manually disabling and enabling tracking option for the Stack app and comparing requests in both cases. </p><h3 id="and-thats-the-only-difference-between-allowing-and-disallowing-tracking"><strong>And that&#39;s the only difference between allowing and disallowing tracking</strong></h3><p>But I believe this is <strong>not</strong> communicated correctly to the end users, you and me, in any adequate way, shape or form: the free apps you install and use <strong>collect your precise location</strong> with timestamp and send it to some 3rd-party companies. </p><p>The only thing that stops anyone with access to bid data (yet another ad buying agent, or ad exchange, or a dataset bought or rented from data broker, as you&#39;ll see later) from tracking you down with all trips you make daily is this <code>IDFA</code> that is not shared when you disallow apps to &#34;track you across apps&#34; to &#34;enhance and personalise your ads experience&#34;. </p><p>By the way: if you&#39;re using 10 apps from the same vendor (Playrix, KetchApp or another 1000-app company) and allow <strong>a single app</strong> to track you – it would mean that the data collected in all 10 apps will be enriched with your IDFA which can later be exchanged to your personal data. </p><p>At the same time, there is so much data in the requests that I&#39;d expect ad exchanges to find some loophole ID that would allow cross-app tracking without the need for IDFA. </p><p>By the way, the fact that Facebook collected my IP + timestamp without any adequate consent / app connection from my end is crazy. </p><hr/><h2 id="how-does-the-data-flow">How does the data flow?</h2><p>Let&#39;s get back to the request that leaked my location for a second and look at its trace. We&#39;ll focus on the parties in the middle:</p><p>stack<strong> →  o.isx.unity3d.com → molocoads →</strong> bwin (advertiser)</p><p>Unity [ads] is an SSP (supply-side platform) that acts as a collector of data from the app via SDK. </p><p>All right, what about <a href="https://www.moloco.com/?ref=timsh.org" rel="noreferrer">Molocoads</a>? </p><figure><img src="https://timsh.org/content/images/2025/01/Screenshot-2025-01-29-at-23.06.38.png" alt="" loading="lazy" width="2000" height="786" srcset="https://timsh.org/content/images/size/w600/2025/01/Screenshot-2025-01-29-at-23.06.38.png 600w, https://timsh.org/content/images/size/w1000/2025/01/Screenshot-2025-01-29-at-23.06.38.png 1000w, https://timsh.org/content/images/size/w1600/2025/01/Screenshot-2025-01-29-at-23.06.38.png 1600w, https://timsh.org/content/images/2025/01/Screenshot-2025-01-29-at-23.06.38.png 2286w" sizes="(min-width: 720px) 720px"/><figcaption><span>screenshot from Molocoads landing page</span></figcaption></figure><p>Moloco ads is a DSP network that resells data from multiple SSPs (like Unity, Applovin, Chartboost). Basically, from almost every one of the requested hosts I&#39;ve seen pop up in Charles Proxy.</p><p>Sounds like moloco aggregates a lot of data and basically anyone (<em>to be clear</em> <em>- any company that becomes an ad partner</em>) can access the data by bidding lower than others. </p><p>At this point I was looking for any mentions of Moloco on Telegram and Reddit, and I ran into <a href="https://www.reddit.com/r/adops/comments/rqlr36/eli5_what_is_the_controversy_behind_bidstream?ref=timsh.org" rel="noreferrer">this post</a> that answered a lot of my questions:</p><figure><img src="https://timsh.org/content/images/2025/02/Screenshot-2025-02-03-at-12.38.37.png" alt="" loading="lazy" width="1444" height="634" srcset="https://timsh.org/content/images/size/w600/2025/02/Screenshot-2025-02-03-at-12.38.37.png 600w, https://timsh.org/content/images/size/w1000/2025/02/Screenshot-2025-02-03-at-12.38.37.png 1000w, https://timsh.org/content/images/2025/02/Screenshot-2025-02-03-at-12.38.37.png 1444w" sizes="(min-width: 720px) 720px"/></figure><p>Especially, <a href="https://www.reddit.com/r/adops/comments/rqlr36/comment/hqbwmbr/?ref=timsh.org" rel="noreferrer">this comment</a>. To quote a part of it:</p><blockquote>They access it if they integrate with the provider of bidstream, which would be the SSP. It&#39;s on the SSP to verify the vendor to whom they give access to bids. Usually, the requirement would be that you actually... bid. </blockquote><p>Just wonderful. </p><h3 id="data-brokers">Data Brokers</h3><p>Let&#39;s move further. When I found out how the data gets out, I started looking for any place where it&#39;s being sold. It was a quick search.</p><p>I found a data marketplace called <a href="https://datarade.ai/data-categories/device-graph-data?ref=timsh.org" rel="noreferrer">Datarade</a> which is a panel with all sorts of data. When I searched for MAID-specific data, hundreds of options showed up, like these two: </p><figure><img src="https://timsh.org/content/images/2025/01/Screenshot-2025-01-29-at-23.24.10.png" alt="" loading="lazy" width="1680" height="740" srcset="https://timsh.org/content/images/size/w600/2025/01/Screenshot-2025-01-29-at-23.24.10.png 600w, https://timsh.org/content/images/size/w1000/2025/01/Screenshot-2025-01-29-at-23.24.10.png 1000w, https://timsh.org/content/images/size/w1600/2025/01/Screenshot-2025-01-29-at-23.24.10.png 1600w, https://timsh.org/content/images/2025/01/Screenshot-2025-01-29-at-23.24.10.png 1680w" sizes="(min-width: 720px) 720px"/></figure><p>The price of the Redmob dataset surprised me, - $120k a year... for what?</p><figure><img src="https://timsh.org/content/images/2025/01/Screenshot-2025-01-29-at-23.26.05.png" alt="" loading="lazy" width="1626" height="838" srcset="https://timsh.org/content/images/size/w600/2025/01/Screenshot-2025-01-29-at-23.26.05.png 600w, https://timsh.org/content/images/size/w1000/2025/01/Screenshot-2025-01-29-at-23.26.05.png 1000w, https://timsh.org/content/images/size/w1600/2025/01/Screenshot-2025-01-29-at-23.26.05.png 1600w, https://timsh.org/content/images/2025/01/Screenshot-2025-01-29-at-23.26.05.png 1626w" sizes="(min-width: 720px) 720px"/></figure><p>Check out the list of features on the right - do any of them look familiar? </p><p>I tried to request it from their website, but the sample never landed in my mailbox (surprise-surprise, timsh.org doesn&#39;t seem like a customer with high potential). </p><blockquote>Enhance your products and services using our global location data covering over 1.5 billion devices. Using our extensive location dataset, you can unearth concealed patterns, conduct rapid analyses, and obtain profound knowledge.</blockquote><figure><img src="https://timsh.org/content/images/2025/01/Screenshot-2025-01-31-at-01.12.16.png" alt="" loading="lazy" width="2000" height="562" srcset="https://timsh.org/content/images/size/w600/2025/01/Screenshot-2025-01-31-at-01.12.16.png 600w, https://timsh.org/content/images/size/w1000/2025/01/Screenshot-2025-01-31-at-01.12.16.png 1000w, https://timsh.org/content/images/size/w1600/2025/01/Screenshot-2025-01-31-at-01.12.16.png 1600w, https://timsh.org/content/images/size/w2400/2025/01/Screenshot-2025-01-31-at-01.12.16.png 2400w" sizes="(min-width: 1200px) 1200px"/><figcaption><span>Some sample data for better understanding</span></figcaption></figure><p>To me, the most absurd part is the <code>app</code> column - the source of the data can&#39;t be more obvious. I&#39;m also quite interested in the <code>yod</code> column - if it&#39;s the birthyear, where did they get it from? Never mind, who cares about your birthyear.</p><h3 id="show-me-the-pii">Show me the PII!</h3><p>All right, imagine I bought the access to a huge stream of Redmob data. </p><p>No problem! This kind of dataset is surprisingly also present on Datarade. </p><figure><a href="https://docs.google.com/spreadsheets/d/1gbom_3YO-oFB6Yrg_MAhrJKGkYtNHR2S/edit?gid=2029445799&amp;ref=timsh.org#gid=2029445799"><div><p>AGR_Mobile_Intent_PII20240903.xlsx</p><p><img src="https://timsh.org/content/images/icon/spreadsheets_2023q4.ico" alt=""/><span>Google Docs</span></p></div><p><img src="https://timsh.org/content/images/thumbnail/AHkbwyL0Y-RadP94i-3ntHlOyBNz5QtZLseHmdD1MAKSAFQi7l2fIzkQjGmDmSQRI2yTN7B1h5cNCpCeVlmlA0dsdek_xQhi6nazcP6xeg-w1200-h630-p" alt="" onerror="this.style.display = &#39;none&#39;"/></p></a></figure><p>Inside - all personal info (full name, email, phone number, physical address, property ownership... and IDFAs. </p><p>Congrats, you have just reached the bottom of this rabbit hole. </p><hr/><h2 id="how-to-track-yourself-down">How to track yourself down?</h2><p>Easy! Just follow this simple step-by-step guide:</p><ol><li>Use some free apps for a bit. </li><li>&#34;Allow&#34; or &#34;ask not to track&#34; - a combo of IP + location + User-agent + geolocation will still be leaked to hundreds of &#34;3rd parties&#34; regardless of your choice.</li><li>Wait for a few seconds until fake DSPs and data brokers receive your data.</li><li>Exchange your full name or phone number for an IDFA (if present), IP address and user-agent through the <code>MAID &lt;&gt; PII</code> data purchased somewhere.</li><li>Now, access the &#34;Mobility data&#34; consisting of geolocation history, and filter it using the values from the previous step. </li></ol><p>Congratulations! You found yourself. </p><p>I <a href="https://excalidraw.com/?ref=timsh.org#json=Ip5AaR-FPppPmtL3AcrBg,-woEvDuI7vER5B7skpT3zA" rel="noreferrer">created a flowchart</a> that includes almost all actors and data mentioned above - now you can see how it&#39;s all connected. </p><figure><img src="https://timsh.org/content/images/2025/02/dataflow_upd-1.png" alt="" loading="lazy" width="2000" height="747" srcset="https://timsh.org/content/images/size/w600/2025/02/dataflow_upd-1.png 600w, https://timsh.org/content/images/size/w1000/2025/02/dataflow_upd-1.png 1000w, https://timsh.org/content/images/size/w1600/2025/02/dataflow_upd-1.png 1600w, https://timsh.org/content/images/size/w2400/2025/02/dataflow_upd-1.png 2400w"/></figure><p>This is the worst thing about these data trades that happen constantly around the world - each small part of it is (or seems) legit. It&#39;s the bigger picture that makes them look ugly. </p><hr/><h2 id="afterwords">Afterwords</h2><p>Thanks for reading this story until the end!</p><figure><a href="https://krebsonsecurity.com/2024/10/the-global-surveillance-free-for-all-in-mobile-ad-data/?ref=timsh.org"><div><p>The Global Surveillance Free-for-All in Mobile Ad Data</p><p>Not long ago, the ability to remotely track someone’s daily movements just by knowing their home address, employer, or place of worship was considered a powerful surveillance tool that should only be in the purview of nation states. But a…</p><p><img src="https://timsh.org/content/images/icon/favicon.ico" alt=""/><span>Krebs on Security</span><span>Skip to content</span></p></div><p><img src="https://timsh.org/content/images/thumbnail/peoplephone.png" alt="" onerror="this.style.display = &#39;none&#39;"/></p></a></figure><figure><a href="https://www.404media.co/candy-crush-tinder-myfitnesspal-see-the-thousands-of-apps-hijacked-to-spy-on-your-location/?ref=timsh.org"><div><p>Candy Crush, Tinder, MyFitnessPal: See the Thousands of Apps Hijacked to Spy on Your Location</p><p>A hack of location data company Gravy Analytics has revealed which apps are—knowingly or not—being used to collect your information behind the scenes.</p><p><img src="https://timsh.org/content/images/icon/favicon-3.svg" alt=""/><span>404 Media</span><span>Joseph Cox</span></p></div><p><img src="https://timsh.org/content/images/thumbnail/andrew-guan-lTUyP3RaLpw-unsplash.jpg" alt="" onerror="this.style.display = &#39;none&#39;"/></p></a></figure><figure><a href="https://interaktiv.br.de/ausspioniert-mit-standortdaten/en/index.html?ref=timsh.org"><div><p>Under Surveillance</p><p>How Location Data Jeopardizes German Security</p><p><img src="https://timsh.org/content/images/icon/apple-touch-icon.png" alt=""/><span>BR</span><span>BR Data</span></p></div><p><img src="https://timsh.org/content/images/thumbnail/teaser.png" alt="" onerror="this.style.display = &#39;none&#39;"/></p></a></figure>
        </section>

    </article>

        

</div></div>
  </body>
</html>
