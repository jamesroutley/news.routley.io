<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.johndcook.com/blog/2023/06/23/every-factorial-is-a-power/">Original</a>
    <h1>Every factorial is a power</h1>
    
    <div id="readability-page-1" class="page"><article id="post-194206">
	<!-- .entry-header -->

	<div>
		<p>The <a href="https://www.johndcook.com/blog/2023/06/22/mentally-approximating-factorials/">previous post</a> mentioned that 24! ≈ 10<sup>24</sup> and 25! ≈ 10<sup>25</sup>.</p>
<p>For every <em>n</em>, there is some base <em>b</em> such that <em>n</em>! = <em>b</em><sup><em>n</em></sup>. For example, 30! ≈ 12<sup>30</sup>.</p>
<p>It’s easy to find <em>b</em> [1]:</p>
<p><img decoding="async" src="https://www.johndcook.com/factorialbase1.svg" alt="b = \exp\left( \frac{\log n!}{n} \right)" width="129" height="43"/></p>
<p>What’s interesting is that <em>b</em> is very nearly a linear function of <em>n</em>.</p>
<p><img decoding="async" loading="lazy" src="https://www.johndcook.com/factorial_base2.png" width="480" height="360"/></p>
<p>In hindsight it’s clear that this should be the case—it follows easily from Stirling’s approximation—but I didn’t anticipate this before I plotted it.</p>
<p>Now fix <em>n</em> and find <em>b</em> such that <em>n</em>! = <em>b</em><sup><em>n</em></sup>. Since the relationship between <em>n</em> and <em>b</em>(<em>n</em>) is nearly linear, this suggests</p>
<p><img decoding="async" loading="lazy" src="https://www.johndcook.com/factorialbase2.svg" alt="(2n)! \approx (2b)^{2n} = 2^{2n} (n!)^2" width="189" height="20"/></p>
<p>which is true. It follows from the <a href="https://www.johndcook.com/blog/gamma_identities/">multiplication identity</a> for the gamma function:</p>
<p><img decoding="async" loading="lazy" src="https://www.johndcook.com/gamma_multiplication_simple.png" alt="" width="246" height="42"/></p>
<p>Let <em>z</em> = <em>n</em> + 1/2 so that the left side is (2<em>n</em>)!. On the right side, Γ(<em>z</em> + 1/2) = <em>n</em>! and Γ(<em>z</em>) is not too different from <em>n</em>!. The rest of the right side is 2<sup>2<em>n</em></sup>/√π.</p>
<p>So our observation that <em>b</em>(<em>n</em>) is nearly linear gave us a hint of Gauss’s multiplication formula.</p>
<p>[1] Numerically you would probably evaluate this function by calling a routine that computes log Γ(<em>n</em> + 1) directly without computing Γ(<em>n</em> + 1) first. This avoids overflow for large <em>n</em>.</p>
<p>This is why mathematical libraries will have not only gamma functions but also loggamma functions. The latter seems redundant, but <a href="https://www.johndcook.com/blog/2010/06/07/math-library-functions-that-seem-unnecessary/">it’s not</a>.</p>
			</div><!-- .entry-content -->

	<!-- .entry-meta -->
</article></div>
  </body>
</html>
