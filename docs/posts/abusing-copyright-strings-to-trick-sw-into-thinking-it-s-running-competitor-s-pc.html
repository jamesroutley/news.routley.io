<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://devblogs.microsoft.com/oldnewthing/20250624-00/?p=111299">Original</a>
    <h1>Abusing copyright strings to trick SW into thinking it&#39;s running competitor&#39;s PC</h1>
    
    <div id="readability-page-1" class="page"><div id="single-wrapper">
    
    <article data-clarity-region="article" id="post-111299">
        <div data-bi-area="body_article" data-bi-id="post_page_body_article">
            <p>One very complicated part of bringing up Plug and Play was bootstrapping the entire process. After all, the number of computers that supported the Plug and Play specification started at zero, because the specification was still being written. A lot of clever tricks were used to retrofit Plug and Play onto legacy hardware.¹</p>
<p>The Windows 95 team worked to gather a very large range of PC brands and models, and as part of doing “Plug and Play for PCs that predate the Plug and Play specification”, the team gathered information from all of those PCs to look for clues on how they could be identified. This often included searching the BIOS for copyright strings and BIOS firmware dates.</p>
<p>One of the strings they found was “<tt>Not Copyright Fabrikam Computer</tt>.”</p>
<p>Why would a BIOS deny that it was copyrighted?</p>
<p>We weren’t sure, but we had a theory.</p>
<p>Back in the early 1990’s, it was not uncommon for PCs to come with preinstalled software that was locked to the manufacturer. If you bought (say) a Fabrikam PC, it would come with a copy of “LitWare Word Processor”. This version of LitWare Word Processor was just the trial edition, but the secret was that the trial edition checked if it was running on a PC manufactured by one of its licensees. If so, then it unlocked its features and became the full version.</p>
<p>LitWare detected whether it was running on a PC manufactured by one of its licensees by searching the BIOS for specific copyright strings. For example, since Fabrikam was a licensee, it searched the BIOS for the string <tt>Copyright Fabrikam Computer</tt>, and if if found it, it would unlock the features that were normally disabled in the trial edition.</p>
<p>The makers of Contoso PCs wanted to include the free LitWare Word Processor trial edition with their PC, but they also wanted to unlock the features of the full version despite not being a Fabrikam PC.</p>
<p>The solution: In addition to the normal Contoso copyright string, also put the string <tt>Not Copyright Fabrikam Computer</tt> in the BIOS!</p>
<p>¹ Some of those retrofitting techniques were really convoluted, because you needed a way to signal information without confusing existing hardware that didn’t understand that signal, and to allow multiple devices to coordinate responses to the same signal. For example, the serial port detection sequence involves writing specific values to the ADDRESS port to enter configuration mode, and then reading values from the READ_DATA port. If the index of the read matches a set bit in the device ID, then the device responds with a value; otherwise, it does an electrical engineering thing that allows the response to default to zero, while still monitoring the actual value read. The result of the read is nonzero if anybody actively responded, and it is zero if nobody responded. If a device wanted to respond zero, but it saw that the actual value was nonzero, then it means that another device with a higher ID number responded to the query, so it backs off for the remainder of the cycle. After the operating system gathers all the bits of the device ID for the highest-numbered ID, it restarts the process, and the device that won the “highest ID” voting backs off to allow the lower-numbered device IDs to respond. This cycle repeats until an ID of zero is read back (meaning that nobody responded to anything), indicating that all the devices have been identified.</p>
        </div><!-- .entry-content -->

        <!-- AI Disclaimer -->
            </article>
    
</div></div>
  </body>
</html>
