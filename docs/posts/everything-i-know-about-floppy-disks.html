<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://thejpster.org.uk/blog/blog-2023-08-28/">Original</a>
    <h1>Everything I know about floppy disks</h1>
    
    <div id="readability-page-1" class="page"><div id="main" role="main">

      
      <header role="banner">
        <h3>
          <a href="https://thejpster.org.uk" title="Home">JP&#39;s Website</a>
          </h3>
      </header>
      <hr/>
      

      



<p><strong>2023-08-28</strong></p>

<p>Floppy disk drives are curious things. We know them as the slots that ingest those small almost-square plastic &#34;floppy disks&#34; and we only really see them now in Computer Museums. But there&#39;s a lot going on in that humble square of plastic and I wanted to write down what I&#39;ve learned so far.</p>
<p>We&#39;re going to talk about:</p>
<ul>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#the-physical-disks">The Physical Disks</a></li>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#the-mechanisms">The Mechanisms</a>
<ul>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#sides">Sides</a></li>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#tracks">Tracks</a></li>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#inserting-and-removing-the-floppy-disk">Inserting and Removing the Floppy Disk</a></li>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#interfaces">Interfaces</a>
<ul>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#standard-shugart-pinout">Standard Shugart Pinout</a></li>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#ibm-pc-pinout">IBM PC Pinout</a></li>
</ul>
</li>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#rotation-speed">Rotation Speed</a></li>
</ul>
</li>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#the-flux-transitions">The Flux Transitions</a>
<ul>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#hard-and-soft-sectors">Hard and Soft Sectors</a></li>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#fm-encoding">FM Encoding</a></li>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#mfm-encoding">MFM Encoding</a>
<ul>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#double-density">Double Density</a></li>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#quad-density">Quad Density</a></li>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#high-density-5-25">High Density 5.25&#34;</a></li>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#high-density-3-5">High Density 3.5&#34;</a></li>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#extended-density-3-5">Extended Density 3.5&#34;</a></li>
</ul>
</li>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#group-coded-recording-gcr-encoding">Group Coded Recording (GCR) Encoding</a>
<ul>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#apple-s-disk-ii">Apple&#39;s Disk II</a></li>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#commodore">Commodore</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#a-comparison-table">A Comparison Table</a></li>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#references">References</a></li>
<li><a href="https://thejpster.org.uk/blog/blog-2023-08-28/#edits-2023-09-03">Edits 2023-09-03</a></li>
</ul>

<p>There are four main sizes of Floppy Disk.</p>
<ul>
<li>The 8&#34; <em>Floppy Disk</em>, which is the oldest and dates from the very early 1970s. It&#39;s a black plastic sleeve around 200mm by 200mm, encasing a thin disc of flexible magnetic material (known as a <em>biscuit</em>). The sleeve has a small hole in it so the biscuit can be accessed by the read/write head in the floppy disk drive. There is also a hole in the centre of both the sleeve and the biscuit, so that the motor spindle can clamp down on to the biscuit in order to rotate it (typically clockwise). Disks and drives can store varying amounts of data depending on their design and specification, from 80 KiB to 1184 KiB.</li>
<li>The 5.25&#34; <em>Minifloppy</em> or <em>Mini Diskette</em> is like an 8&#34; disk but shrunk down to around 130mm x 130mm. It has the same kind of sleeve and biscuit - just smaller. Again, disks and drives can store varying amounts of data depending on their design, from 180 KiB to 1200 KiB.</li>
<li>The 3&#34; <em>Compact Floppy Disk</em> (or <em>CF-2</em>) has a hard plastic shell surrounding the biscuit, and the access window is covered by a metal shutter that is moved out of the way by sliding a mechanism accessed from the edge of the shell. Instead of just a central hole, there is a strong, thick, plastic circle for engaging with the drive motor. Came in single-sided, 40-track versions storing 180 KiB of data and double-sided 80-track versions that hold 720 KiB.</li>
<li>The 3.5&#34; <em>Micro Floppy Disk</em> (or <em>MF2</em>) also has a plastic shell that is somewhere between the 5.25&#34; and 3&#34; in terms of stiffness. The size is 90mm x 93mm. Like the 3&#34; there is a metal shutter but it sits outside of the sleeve rather than within it, so it can be easily moved by hand to access the biscuit. The biscuit has a metal hub in the centre, for engaging with the drive motor. The very earliest mechanisms (e.g. Epson <a href="https://cowlark.com/fluxengine/doc/disk-epsonpf10.html">PF10</a>) were 40-track but almost all drives are 80-track. Being so popular, there are a wide variety of formats leading to it storing between 400 KiB and 2880 KiB of data per disk.</li>
</ul>

<p>Each of the floppy disk physical formats involves some kind of outer shell, which does not move, and a biscuit, which rotates - typically clockwise when viewed from above. The biscuit is made of a magnetic material - basically a thin layer of rust stuck to a thin sheet of plastic, much like a cassette tape.</p>
<p>A floppy disk (or disk) must be placed into a floppy disk drive (or drive) before it can be read or written to. The drive will rotate the biscuit past a <em>head</em>, which is the component used to measure or alter the magnetic patterns in the material. When reading, the head will will generate an electrical signal according to the magnetic patterns contained with the material. When writing, the head is given an electrical signal, and will cause magnetic patterns to be recorded into the material.</p>
<h2 id="sides">Sides</h2>
<p>Typically a drive contains either one combined read/write head, which can only access one side of the disk, or it contains two read/write heads, one for each side of the disk.</p>
<p>Some disks can only be read/written on one side (<em>single-sided</em>), and some can be read/written on both sides (<em>double-sided</em>). The same terms apply to drives with one or two heads, respectively.</p>
<p>If you have a double-sided 8&#34;, 5.25&#34; or 3&#34; disk, but only single-sided drive mechanism, it may be possible to insert the disk into the drive upside down, to read the reverse side. Note that if you do this, the information will be recorded backwards compared to writing the same information on a double-sided drive. You may also find the disk drive has optical sensors to detect the presence of a <em>notch</em> cut into the outer sleeve on only one side of the disk, to prevent you performing this trick. Back in the day, cost-sensitive consumers would simply cut a second notch on the opposite side of the disk, to trick the mechanism into accepting an upside down disk. The risk was that if you did this but then obtained a double-sided drive, there was a very real chance of you inserting the disk upside down, whereupon all the data would appear to the drive backwards and unreadable.</p>
<h2 id="tracks">Tracks</h2>
<p>The read/write head is quite small compared to our disks. If it was fixed in position, we would only be able to record data within one thin circular stripe around the surface of the inner disc and most of the disk would be wasted. This thin circular stripe is called a <em>track</em>. The drive can read or write multiple tracks on a single disk by moving the head in towards the centre of the disk. The head is often moved using a stepper motor which drives a worm-gear, as it provide very precise and repeatable positioning.</p>
<p>8&#34; and 5.25&#34; disks usually have 35 or 40 tracks, with the head stepping at 48 tracks per inch (tpi). Some later mechanisms could step at 100 tpi, typically resulting in 77 tracks, whilst some others moved at 96 tpi for up to 80 tracks. Annoyingly the 100 tpi and 96 tpi systems were sort-of compatible on the outer (lower numbered) tracks, but became less reliable as you moved towards the centre of the floppy disk and the track and head moved out of alignment.</p>
<p>3&#34; drives were 40-track or 80-track. 3.5&#34; drives were almost all 80-track (or perhaps slightly more if you wanted to push the mechanism and the media) but there were some very early 40-track units from Epson, like the <a href="https://cowlark.com/fluxengine/doc/disk-epsonpf10.html">PF10</a>.</p>
<p>Moving the head back to Track 0 usually triggers some kind of sensor so the Disk Drive Controller knows that it has reached the edge of the disk and doesn&#39;t accidentally move the head too far and off the edge of the biscuit. Cheaper drives, like those famously designed for the Commodore 64 and Apple II drives, skipped this sensor and replaced it with a hard stop that prevented the head moving to far. If the disk drive controller wanted to ensure the head was at Track Zero, it would step the head backwards at least as many times as there were tracks on disk, causing a distinctive <em>rat-tat-tat-tat-tat</em> noise as the head banged against the stop.</p>
<p>A 77-track or 80-track drive will have a narrower read/write head than a 35-track or 40-track drive, to ensure that the tracks do not overlap. If you write a 40-track disk with a 40-track drive, it will have nice wide tracks. If you then read this disk in an 80-track drive, you will have to make sure you move the head two steps for each track (known as <em>double stepping</em>) but the data should be readable. However, if you then attempt to write to the disk, the 80-track drive lays down a thin track over the top of the existing wide track, which can cause issues when it comes to reading back the data (on either kind of drive). For this reason, <em>enthusiasts</em> of the format will often have both 80-track and 40-track 5.25&#34; floppy disk drives to hand.</p>
<p>In the late 1990s, the LS-120 system was introduced by Matsushita. This was backwards-compatible with standard 3.5&#34; 80-track <em>double-density</em> and <em>high-density</em> disks, but could also write to special 120 MiB LS-120 media. In this mode it used a laser to control head positioning, allowing for for 1,736 tracks per side. But, USB flash drives were just around the corner and the format ended in 2003.</p>
<h2 id="inserting-and-removing-the-floppy-disk">Inserting and Removing the Floppy Disk</h2>
<p>Most 5.25&#34; mechanisms use a lever or handle to manually drop the floppy disk down onto the motor spindle and engage the read/write head/heads. The floppy disk cannot be removed until the mechanism is unlatched by reversing the loading operation.</p>
<p>Conversely, 3&#34; and 3.5&#34; mechanisms normally auto-mount onto the spindle on insertion, and are typically ejected using a mechanical push-button that unlatches the mechanism and uses spring pressure to eject the disk. A notable exception are the floppy drives used in the Apple Macintosh which removed the eject button and used a software controlled motor to operate the eject mechanism. This ensured the computer had unmounted the filesystem and flushed the disk cache before the disk actually ejected.</p>
<h2 id="interfaces">Interfaces</h2>
<p>Most drives implement the same interface as the very early drive mechanisms, designed by a company called Shugart Associates, founded in 1973 by Alan Shugart. It is hence known as the <em>Shugart Interface</em> and its drives (the SA800 8&#34; and the SA400 5.25&#34;) were very popular and set the standard for the industry.</p>
<p>The Shugart Interface has either 50 pins or 34 pins and allows you to connect the <em>floppy disk controller</em> to the <em>floppy disk drive</em> with a piece of ribbon cable that can be up to around 500mm in length. The controller is in charge of making the drive move move the head in and out, and generating or receiving the electrical signals from the read/write head.</p>
<p>8&#34; drives use a 50 pin PCB edge connector. 5.25&#34; drives use a 34 pin PCB edge connector, and 3&#34; and 3.5&#34; drives use a 34-pin IDC pin header connector. All three are basically electrically equivalent; the 8&#34; drives just need a small adapter to use the newer 34-pin interface, and you can get cables that have both IDC Card Edge and IDC Pin Header connectors, allowing you to use the appropriate one for your drive.</p>
<h3 id="standard-shugart-pinout">Standard Shugart Pinout</h3>
<p>Supports up to four drives on one cable, selected by the <code>/DSx</code> select signals.</p>
<p>Note: D&gt;C means the signal is an output from the Drive and an input on the Controller, whilst C&gt;D is the opposite.</p>
<table><thead><tr><th>Pin</th><th>Name</th><th>Dir</th><th>Function</th></tr></thead><tbody>
<tr><td>2</td><td><code>/DCC</code></td><td>D&gt;C</td><td>Disk Change Detect</td></tr>
<tr><td>4</td><td><code>/DS3</code></td><td>C&gt;D</td><td>Select Drive 3</td></tr>
<tr><td>6</td><td>N/C</td><td>N/A</td><td>Not used</td></tr>
<tr><td>8</td><td><code>/INDEX</code></td><td>D&gt;C</td><td>Index hole detected</td></tr>
<tr><td>10</td><td><code>/DS0</code></td><td>C&gt;D</td><td>Select Drive 0</td></tr>
<tr><td>12</td><td><code>/DS1</code></td><td>C&gt;D</td><td>Select Drive 1</td></tr>
<tr><td>14</td><td><code>/DS2</code></td><td>C&gt;D</td><td>Select Drive 2</td></tr>
<tr><td>16</td><td><code>/MOTOR</code></td><td>C&gt;D</td><td>Enable Motor</td></tr>
<tr><td>18</td><td><code>/DIR</code></td><td>C&gt;D</td><td>Set head stepper direction</td></tr>
<tr><td>20</td><td><code>/STEP</code></td><td>C&gt;D</td><td>A pulse moves the head one step</td></tr>
<tr><td>22</td><td><code>/WDATA</code></td><td>C&gt;D</td><td>Data to be written</td></tr>
<tr><td>24</td><td><code>/WGATE</code></td><td>C&gt;D</td><td>Enable writing of data</td></tr>
<tr><td>26</td><td><code>/TRK00</code></td><td>D&gt;C</td><td>Head is at Track 0 position</td></tr>
<tr><td>28</td><td><code>/WPT</code></td><td>D&gt;C</td><td>Disk is write protected</td></tr>
<tr><td>30</td><td><code>/RDATA</code></td><td>D&gt;C</td><td>Data read from the disk</td></tr>
<tr><td>32</td><td><code>/SIDE1</code></td><td>C&gt;D</td><td>Select which side</td></tr>
<tr><td>34</td><td><code>/RDY</code></td><td>D&gt;C</td><td>Indicates Drive is Ready</td></tr>
</tbody></table>
<h3 id="ibm-pc-pinout">IBM PC Pinout</h3>
<p>Supports two drives on one cable. Because it was assumed the IBM drives could not be modified to listen to different <code>/DSx</code> enable signals, all drives are set to <code>DS1</code> and the cable is twisted between pins 8 and 16, swapping <code>/MOTEA</code> with <code>/MOTEB</code> and swapping <code>/DRVSA</code> with <code>/DRVSB</code> - thus allowing two drives on one cable.</p>
<p>Note: D&gt;C means the signal is an output from the Drive and an input on the Controller, whilst C&gt;D is the opposite. Unlisted pins do the same thing as on the Shugart interface.</p>
<table><thead><tr><th>Pin</th><th>Name</th><th>Dir</th><th>Function</th></tr></thead><tbody>
<tr><td>2</td><td><code>/REDWC</code></td><td>C&gt;D</td><td>Select Reduced Write Density</td></tr>
<tr><td>4</td><td>N/C</td><td>N/A</td><td>N/A</td></tr>
<tr><td>10</td><td><code>/MOTEA</code></td><td>C&gt;D</td><td>Enable Motor for Drive A</td></tr>
<tr><td>12</td><td><code>/DRVSA</code></td><td>C&gt;D</td><td>Select Drive A</td></tr>
<tr><td>14</td><td><code>/DRVSB</code></td><td>C&gt;D</td><td>Select Drive B</td></tr>
<tr><td>16</td><td><code>/MOTEB</code></td><td>C&gt;D</td><td>Enable Motor for Drive B</td></tr>
<tr><td>34</td><td><code>/DSKCHG</code></td><td>D&gt;C</td><td>Indicates disk has been changed</td></tr>
</tbody></table>
<p>All the odd numbered pins are connected to Ground. The <code>/REDWC</code> signal is unused on 3.5&#34; drives as it can auto-detect the kind of media inserted (more on that later).</p>
<p>The subtle differences between these two standards explain why you can&#39;t just stick a cheap IBM PC floppy drive into a Commodore Amiga (which has a Shugart interface) without an adapter.</p>
<h2 id="rotation-speed">Rotation Speed</h2>
<p>Almost all drives rotate the biscuit at 300 rpm, except 8&#34; drives, and the &#34;High Density&#34; 5.25&#34; drives from the IBM PC/AT, which both use 360 rpm.</p>
<p>Also of note are early Apple Macintosh 3.5&#34; drives, which vary the drive rpm according to which track is being accessed. I guess this was an attempt to equalise the linear speed of the biscuit past the head (note that Track 0 is much longer than Track 80, yet in a standard drive they go past the head in the exact the same amount of time), but it only really serves to make the disks completely unreadable in anything except another Macintosh variable-speed drive.</p>

<p>The floppy disk drive is a purely analog device. It cares not for bits or bytes, only a time-varying electrical signal with corresponds with <em>flux transitions</em>, or changes in magnetic flux (i.e. a switch from a being <em>magnetised</em> in one orientation to being <em>magnetised</em> in the other orientation). It is the floppy disk controller that must decide how many of these signals to send per second, and how to synchronise them with whatever other data may currently exist within any given track.</p>
<p>Sadly, Physics prevents us from storing an infinite number of flux transitions within each track - some minimum amount of distance (which maps to time, because the biscuit is rotating) is required to reliably magnetise a piece of track on a biscuit and transition to the opposite magnetisation. This is sometimes reported as &#34;bit density&#34;, in &#34;bits per inch&#34;, assuming some specific encoding of bits to magnetic flux transitions. As technology has improved over the years, the number of &#34;bits per inch&#34; has increased, from the earliest 8&#34; disks at 1,594 bpi to Extended Density 3.5&#34; floppies at nearly 35,000 bpi.</p>
<p>Most 5.25&#34; disks (those called <em>single-density</em> or <em>double-density</em>) can reliably hold around 11,600 flux transitions per inch, and have track radii from 2.250 inch (57.2 mm) to 1.354 inch (34.4 mm), or track lengths of 359 mm to 216 mm. The most flux transitions you could fit on a track, assuming you don&#39;t vary the spindle speed or encoding rate (and some do), would be around 100,000 transitions. At 300 rpm (or 5 Hz), that is 500,000 transitions per second, or 2 μs per transition. This is our <em>minimum pulse period</em>. When 3.5&#34; disks were introduced, the track radii and track lengths were shorter, and the media was improved so it could handle the same number of transitions per second (a higher number of transitions per inch), and hence work on the exact same disk controllers as the earlier 5.25&#34; drives and disks. In fact, a 720K 3.5&#34; floppy drive and 360K 5.25&#34; floppy drive read data at the exact same speed in bits per second - the difference is that the 3.5&#34; drives always have 80-track mechanisms, whilst the 360K 5.25&#34; drive has a 40-track mechanisms.</p>
<h2 id="hard-and-soft-sectors">Hard and Soft Sectors</h2>
<p>Most disk drive controllers divide up each endlessly looping linear track (and hence endlessly looping stream of bits) into numbered <em>sectors</em>. Each sector has a fixed number of payload bytes (usually 256, 512 or 1024) plus a sector ID and something to uniquely indicate this is the <em>start-of-sector</em> (that you can also <em>never</em> see inside valid sector data).</p>
<p>The earliest drives had physical holes punched into the edge of the biscuit (before Track 0), and the drive could indicate when these index holes were seen, thus allowing the controller to time the reading or writing of each sector. These are so-called <em>hard sector floppy disks</em>. Later drives removed this feature; the controllers simply read each sector header in turn to work out the angle of the biscuit at any given moment, and hence when to read or write the desired sector. Either way, you also need to leave a gap between sectors, to allow for small errors in the speed of rotation (which would then affect precisely how many degrees each sector took up out of the full 360 degree track). After all, a sector overflowing into the one after is a recipe for data loss.</p>
<h2 id="fm-encoding">FM Encoding</h2>
<p>The earliest method for encoding data bits into flux transitions was based on that used for magnetic tape, and called Frequency Modulation Encoding, or FM for short. It&#39;s a mechanism that encodes a clock signal alongside the data, allowing for a degree of tolerance on the precise rotational speed of the media (e.g. if you take the disk out and put it in another drive that&#39;s running slightly fast). After the introduction of <a href="https://thejpster.org.uk/blog/blog-2023-08-28/#mfm-encoding">MFM</a>, FM Encoding was also known as <em>Single Density</em>.</p>
<p>FM Encoding converts our data into into <em>flux transitions</em>, using something called <em>differential Manchester Encoding</em>. A nice property of this conversion is that we don&#39;t care about the absolute state of each piece of our magnetic medium (the circular track on our biscuit, as swept by the read/write head) - we only care about when it changes from one state to another. Should the electronics in the reading drive be wired up the other way around to those in the drive that wrote the data, it won&#39;t matter at all. Another nice property on this conversion is that you don&#39;t need to accurate control or track the rotational speed of the disk - the encoded flux transitions contain a clock signal which you can use to reconstruct the original data bits.</p>
<p>With FM Encoding, we need four minimum-pulse-periods to encode each data bit (or 8 μs with our typical 500,000 transition/sec system). One pulse is the clock bit, followed by a gap bit, followed by the data bit, and then another gap bit. Another way of looking at this is that a <code>0</code> data bit encodes one flux transition into our 8 μs window, and a <code>1</code> data bit encodes two flux transitions into our 8 μs window. It&#39;s not very space efficient, but it can be decoded using mid-1970s-era electronics. Our resulting data rate is 125,000 bits per second, or 3,125 bytes per track at 300 rpm. Out of that we then lose some bits for encoding sector IDs and sync words (especially on <a href="https://thejpster.org.uk/blog/blog-2023-08-28/#hard-and-soft-sectors">soft-sectored</a> disks). Allowing for typical headers and sync words, a <em>single-density</em> 5.25&#34; disk drive system might get around 2,560 bytes of useful data (perhaps as ten sectors of 256 bytes each) on each track.</p>
<ul>
<li>8&#34; SD, bits per track: 41,700</li>
<li>5.25&#34; SD, bits per track: 25,000</li>
<li>3.5&#34; SD, bits per track: 25,000 (rarely used)</li>
</ul>
<h2 id="mfm-encoding">MFM Encoding</h2>
<p>MFM Encoding is more space efficient than <a href="https://thejpster.org.uk/blog/blog-2023-08-28/#fm-encoding">FM Encoding</a>, but requires more complicated electronics to decode. With MFM Encoding, you only need one flux transition per data bit. The controller encodes the data by moving that pulse within a given window - the pulse is either in the middle, or at the end of the window. This means we double the usable data rate compared to <em>FM Encoding</em>, using the exact same media - just by using a more advanced disk controller chip and perhaps improving the electronics within the drive mechanism to measure the timing of the flux transitions more precisely.</p>
<h3 id="double-density">Double Density</h3>
<p>Using the same 500,000 transitions per second as supported on <a href="https://thejpster.org.uk/blog/blog-2023-08-28/#fm-encoding"><em>single-density</em> disks</a>, we can now get 250,000 bits per second, or 50,000 bits (6,250 bytes) per 200 ms (300 rpm) revolution of the biscuit. This is known as <em>double-density</em> and works using the exact same physical disks and drive mechanism as for <em>single-density</em> - it&#39;s just the controller that is smarter. Allowing for typical headers and sync words, a <em>double-density</em> disk drive system can get between 4,096 and 5,120 bytes of useful data per track.</p>
<ul>
<li>8&#34; DD, bits per track: 83,300</li>
<li>5.25&#34; DD, bits per track: 50,000</li>
<li>3&#34; DD, bits per track: 50,000</li>
<li>3.5&#34; DD, bits per track: 50,000</li>
</ul>
<h3 id="quad-density">Quad Density</h3>
<p>A <em>quad-density</em> 5.25&#34; drive actually has the exactly same linear data rate as a <em>double-density</em> drive, it just has an 80-track mechanism instead of a 40-track mechanism. Such drives were not supported on IBM PCs, but were popular with Acorn&#39;s BBC Micro line of computers.</p>
<h3 id="high-density-5-25">High Density 5.25&#34;</h3>
<p>With the IBM PC/AT, IBM introduce a new kind of 5.25&#34; drive and controller. It doubled the speed of the disk controller chip to 1,000,000 transitions per second (500,000 bits per second), but also sped up the rotational speed of the disk to 360 rpm instead of 300 rpm, to bring the transitions-per-inch back into a range the updated media could handle. A <em>double density</em> drive was 50,000 data bits per track, whilst these new <em>high density</em> drives were 83,333 data bits per track (without the speed adjustment they&#39;d have been 100,000 data bits per track). These drives also exclusively came with an 80-track mechanism, whilst the earlier 5.25&#34; double density drives could have either 40 or 80-track mechanisms.</p>
<p>Once side-affect of the increased spindle speed was that disk recorded at 250 kbit/sec on a 300 rpm drive would read at 300 kbit/sec on a 360 rpm drive. The disks would read faster, but the operating system and disk controller would need to be aware of what was going on. If you programmed the controller to run at 250 kbit/sec on a 360 rpm drive, the end of the track would crash into the start of the track and the data would be corrupted.</p>
<p>The change in the coercivity of the biscuit and the change in track width means that High Density 5.25&#34; drives are quite poor at writing Double Density 5.25&#34; disks.</p>
<ul>
<li>5.25&#34; HD, bits per track: 83,300 (like an 8&#34; DD)</li>
</ul>
<h3 id="high-density-3-5">High Density 3.5&#34;</h3>
<p><em>High Density</em> 3.5&#34; drives double the data rate compared to a <em>double density</em> 3.5&#34; drive but leave the spindle speed unchanged. This requires a biscuit with higher coercivity and hence a higher drive current through the head is needed to write the flux transitions. The 3.5&#34; HD disks have an extra hole in the corner of the shell, which triggers a switch that causes the drive to apply the higher drive strength automatically. You can format an HD disk at DD speeds, but it may not read 100% reliably when transferred to a DD drive (although these backwards-compatibility issues are not as pronounced as with 5.25&#34; High Density drives).</p>
<ul>
<li>3.5&#34; HD, bits per track: 100,000</li>
</ul>
<h3 id="extended-density-3-5">Extended Density 3.5&#34;</h3>
<p><em>Extended Density</em> 3.5&#34; drives again double the data rate compared to <em>high density</em>. They also change the recording from horizontal to vertical. This requires a biscuit with two layers, to help the magnetic fields turn around within a shorter distance and hence bunch up and allow the cells on the medium to be smaller.</p>
<ul>
<li>3.5&#34; ED, bits per track: 200,000</li>
</ul>
<h2 id="group-coded-recording-gcr-encoding">Group Coded Recording (GCR) Encoding</h2>
<p>You can of course create alternative encoding schemes for mapping data bits to flux transitions as an alternative to FM and MFM. There are two notable examples - Apple and Commodore.</p>
<h3 id="apple-s-disk-ii">Apple&#39;s Disk II</h3>
<p>At Apple, Steve Wozniak developed a unique, and ingenious, for the Apple II computer and its Disk II floppy disk drives. Rather than use an off-the-shelf floppy disk drive controller chip, like the WD FD1771 or the NEC μPD765, Wozniak designed a controller that used just eight standard 74-series logic chips, including a shift-register. This works because system ensures that every byte written to the disk starts with a <code>1</code> bit, so that as bits are shifted into a shift-register, a <code>1</code> in the most-significant position indicates that this could be a byte of data. At this point, the CPU reads all eight bits from the shift-register and clears it. Synchronisation is ensured by adding a special 50 bit sequence at the start of every sector, of <code>1111111100</code> repeated five times. This guarantees that no-matter where the drive starts reading on the track, the shift-register will be synchronised with the bytes on disk after this sequence. The second rule for this encoding is that you cannot have two zero bits in a row, because with three zero bits (gaps in the patterns of flux transitions) the hardware becomes unreliable at reading the data. Wozniak therefore invented a look-up table which converts arbitrary 6-bit values into valid 8-bit values (<code>1</code> start bit, no more than two <code>0</code> bits in a row), which allows you to pack three arbitrary bytes into four bytes on disk. This is then combined with two unique bytes (<code>D5</code> and <code>AA</code>) that don&#39;t otherwise appear in the table (there are 66 valid combinations but only 64 entries from the 6-bit input) to uniquely identify the start of each sector.</p>
<p>The scheme enables the Apple II and the Disk II controller card to store 4096 bytes per track (sixteen sectors of 256 bytes), across the 35 tracks of the early Shugart SA-400 mechanism - and it&#39;s handled almost entirely in software on the 6502 processor with look-up tables. This puts it somewhere between a <em>single-density</em> FM controller chip and a <em>double-density</em> MFM controller chip, but at much lower price point than either.</p>
<h3 id="commodore">Commodore</h3>
<p>Commodore were similar to Apple in using a 6502 processor to run the floppy disk drive instead of a dedicated controller IC. However instead of using the computer&#39;s main processor, they put a whole second 6502 processor inside the floppy disk drive unit with its own ROM and RAM. This means the floppy disk drive actually runs the Commodore Disk Operating System internally, and was given commands over a bus - the parallel IEE-488 bus initially, then a proprietary serial version of it - to read and write files.</p>
<p>Commodore also used a GCR encoding scheme, but used the flexibility of having a dedicated processor to increase the amount of data stored on the disk. They did this by changing the clock rate according to which track of the disk was being accessed - noting that longer tracks can store many more data bits before running into the flux transition spacing limits of the media. The underlying GCR scheme was similar to that used on tape drives running at 6250 bit per inch, in that four bits of data were converted into five bits for writing to the disk. This ensured you never had three consecutive zero bits on disk (the same restriction that Apple were working with). A sequence of ten <code>1</code> bits was used as a synchronisation mark.</p>
<p>Using this system the Commodore 2040 floppy disk drive could store 170 KiB on one disk of a 35-track 5.25&#34; floppy disk, with between 17 and 21 sectors, of 256 bytes, per track. Some later drives were double-sided, and some drives moved to an 77-track 5.25&#34; mechanism (which at 100 tracks per inch is incompatible with the 80-track, 96 tpi mechanism used by other systems).</p>
<p>The Commodore 1541 was perhaps the most famous Commodore disk drive, being designed to pair with the incredibly popular Commodore 64 home computer. Like the 2040, it has a single-sided 35-track mechanism.</p>

<p>Here is a comparison table of some common formats.</p>
<table><thead><tr><th>Machine</th><th>Media</th><th>Enc</th><th>Trks</th><th>Sides</th><th>Sec/Trk</th><th>SecSz (B)</th><th>DiskSz (KiB)</th></tr></thead><tbody>
<tr><td>Acorn DFS (SSSD)</td><td>5.25&#34;</td><td>SD</td><td>40</td><td>1</td><td>10</td><td>256</td><td>100</td></tr>
<tr><td>Acorn DFS (DSSD)</td><td>5.25&#34;</td><td>SD</td><td>40</td><td>2</td><td>10</td><td>256</td><td>200</td></tr>
<tr><td>Acorn DFS (SSDD)</td><td>5.25&#34;</td><td>SD</td><td>80</td><td>1</td><td>10</td><td>256</td><td>200</td></tr>
<tr><td>Acorn DFS (DSDD)</td><td>5.25&#34;</td><td>SD</td><td>80</td><td>2</td><td>10</td><td>256</td><td>400</td></tr>
<tr><td>Acorn ADFS (S)</td><td>5.25&#34;</td><td>DD</td><td>40</td><td>1</td><td>10</td><td>256</td><td>160</td></tr>
<tr><td>Acorn ADFS (M)</td><td>5.25&#34;</td><td>DD</td><td>80</td><td>1</td><td>10</td><td>256</td><td>320</td></tr>
<tr><td>Acorn ADFS (L)</td><td>5.25&#34;</td><td>DD</td><td>80</td><td>2</td><td>10</td><td>256</td><td>640</td></tr>
<tr><td>Acorn ADFS (D/E)</td><td>3.5&#34;</td><td>DD</td><td>80</td><td>2</td><td>5</td><td>1024</td><td>800</td></tr>
<tr><td>Acorn ADFS (F)</td><td>3.5&#34;</td><td>HD</td><td>80</td><td>2</td><td>10</td><td>1024</td><td>1600</td></tr>
<tr><td>Amstrad PCW8256</td><td>3&#34;</td><td>DD</td><td>40</td><td>1</td><td>9</td><td>512</td><td>180</td></tr>
<tr><td>Amstrad PCW9512</td><td>3&#34;</td><td>DD</td><td>80</td><td>2</td><td>9</td><td>512</td><td>720</td></tr>
<tr><td>Commodore 8250</td><td>5.25&#34;</td><td>GCR</td><td>77</td><td>2</td><td>23..29</td><td>256</td><td>1041.5</td></tr>
<tr><td>Commodore 1541</td><td>5.25&#34;</td><td>GCR</td><td>35</td><td>1</td><td>17..21</td><td>256</td><td>170</td></tr>
<tr><td>Commodore 1571</td><td>5.25&#34;</td><td>GCR</td><td>35</td><td>2</td><td>17..21</td><td>256</td><td>340</td></tr>
<tr><td>Commodore 1571 (CP/M)</td><td>5.25&#34;</td><td>DD</td><td>40</td><td>2</td><td>16</td><td>256</td><td>320</td></tr>
<tr><td>Commodore Amiga</td><td>3.5&#34;</td><td>DD</td><td>80</td><td>2</td><td>11</td><td>512</td><td>880</td></tr>
<tr><td>Commodore Amiga 4000</td><td>3.5&#34;</td><td>HD</td><td>80</td><td>2</td><td>22</td><td>512</td><td>1760</td></tr>
<tr><td>IBM PC (PC-DOS 1)</td><td>5.25&#34;</td><td>DD</td><td>40</td><td>1</td><td>8</td><td>512</td><td>160</td></tr>
<tr><td>IBM PC (PC-DOS 1)</td><td>5.25&#34;</td><td>DD</td><td>40</td><td>2</td><td>8</td><td>512</td><td>320</td></tr>
<tr><td>IBM PC (PC-DOS 2)</td><td>5.25&#34;</td><td>DD</td><td>40</td><td>1</td><td>9</td><td>512</td><td>180</td></tr>
<tr><td>IBM PC (PC-DOS 2)</td><td>5.25&#34;</td><td>DD</td><td>40</td><td>2</td><td>9</td><td>512</td><td>360</td></tr>
<tr><td>IBM PC/AT (PC-DOS 3)</td><td>5.25&#34;</td><td>HD360</td><td>80</td><td>2</td><td>15</td><td>512</td><td>1200</td></tr>
<tr><td>IBM PS/2 (PC-DOS 3)</td><td>3.5&#34;</td><td>DD</td><td>80</td><td>2</td><td>9</td><td>512</td><td>720</td></tr>
<tr><td>IBM PS/2 (PC-DOS 3)</td><td>3.5&#34;</td><td>HD</td><td>80</td><td>2</td><td>18</td><td>512</td><td>1440</td></tr>
<tr><td>IBM PS/2 (PC-DOS 5)</td><td>3.5&#34;</td><td>ED</td><td>80</td><td>2</td><td>36</td><td>512</td><td>2880</td></tr>
</tbody></table>
<ul>
<li>SD = FM Encoding at 250 kbit/sec, see <a href="https://thejpster.org.uk/blog/blog-2023-08-28/#fm-encoding"><em>Single Density</em></a></li>
<li>DD = MFM Encoding at 250 kbit/sec, see <a href="https://thejpster.org.uk/blog/blog-2023-08-28/#double-density"><em>Double Density</em></a></li>
<li>HD = MFM Encoding at 500 kbit/sec, see <a href="https://thejpster.org.uk/blog/blog-2023-08-28/#high-density-3-5"><em>High Density 3.5&#34;</em></a></li>
<li>HD360 = MFM Encoding at 500 kbit/sec and 360 rpm, see <a href="https://thejpster.org.uk/blog/blog-2023-08-28/#high-density-5-25"><em>High Density 5.25</em></a></li>
<li>ED = MFM Encoding at 1000 kbit/sec, see <a href="https://thejpster.org.uk/blog/blog-2023-08-28/#extended-density-3-5"><em>Extended Density</em></a></li>
<li>GCR = <a href="https://thejpster.org.uk/blog/blog-2023-08-28/#group-coded-recording-gcr-encoding">Group Coded Recording Encoding</a></li>
</ul>
<p>Note that 3.5&#34; High Density floppies in an IBM PC are often called &#34;1.44MB&#34; but they are in fact 1440 KiB or 1.40625 MiB. I presume a marketing person at some point didn&#39;t understand the difference between a binary-kibibyte of 1024 bytes (which is what all the prior drives are measured in and is a natural consequence of the 256/512/1024 byte sectors) and a decimal-kilobyte of 1000 bytes. You therefore end up with a nonsense number that uses a &#39;Megabyte&#39; worth 1,024,000 (1024 * 1000) bytes. Calling it &#34;1.4MB&#34; would have been accurate (to within one decimal place) - the extra &#34;4&#34; is redundant and wrong. But, sadly, if you point this out, people get angry with you for spoiling their fun or something.</p>
<h2 id="references">References</h2>
<ul>
<li>Wikipedia: <a href="https://en.wikipedia.org/wiki/Floppy_disk">Floppy disk</a></li>
<li>Wikipedia: <a href="https://en.wikipedia.org/wiki/List_of_floppy_disk_formats">List of floppy formats</a></li>
<li>Wikipedia: <a href="https://en.wikipedia.org/wiki/Commodore_1541">Commodore 1541</a></li>
<li>Wikipedia: <a href="https://en.wikipedia.org/wiki/Floppy_disk_drive_interface">Floppy disk drive interface</a></li>
<li>Cowlark&#39;s FluxEngine pages talk about the Epson <a href="https://cowlark.com/fluxengine/doc/disk-epsonpf10.html">PF10</a></li>
</ul>
<h2 id="edits-2023-09-03">Edits 2023-09-03</h2>
<ul>
<li>Removed duplicates from IBM pinout table</li>
<li>Corrected 32-pin IDC to 34-pin IDC</li>
<li>Note that yes, there was like one 40-track 3.5&#34; drive from Epson at the very start</li>
<li>Added some references</li>
</ul>




      
      
      

    </div></div>
  </body>
</html>
