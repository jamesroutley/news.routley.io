<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.qualys.com/vulnerabilities-threat-research/2023/07/19/cve-2023-38408-remote-code-execution-in-opensshs-forwarded-ssh-agent">Original</a>
    <h1>Remote code execution in OpenSSH’s forwarded SSH-agent</h1>
    
    <div id="readability-page-1" class="page"><div id="page">

	
		

	
	<div>

	<main id="primary">

		
<article id="post-33427">
	

	<div>

		
		<div>
			
<p>The Qualys Threat Research Unit (TRU) has discovered a remote code execution vulnerability in OpenSSH’s forwarded ssh-agent. This vulnerability allows a remote attacker to potentially execute arbitrary commands on vulnerable OpenSSH’s forwarded ssh-agent. Given the widespread use of OpenSSH’s forwarded ssh-agent Qualys Research Unit recommends that security teams apply patches for this vulnerability on priority. </p>



<h2 id="about-opensshs-agent-forwarding"><strong>About OpenSSH’s Agent Forwarding</strong> </h2>



<p>The ssh-agent is a background program that caches private keys for SSH public key authentication, reducing the need for regular passphrase input. Initiated at the start of an X or login session, it operates by storing keys in memory and unloading only when the process ends. </p>



<p>It’s instrumental in automation scripts or tasks requiring frequent server connections, as it prevents the need for insecure password storage or constant passphrase input. The connections to ssh-agent may be forwarded from further remote to avoid the need for authentication data to be stored on other machines. Nonetheless, it’s still crucial to secure the keys with robust passphrases.  </p>







<h2 id="potential-impact-of-opensshs-agent-forwarding"><strong>Potential Impact of OpenSSH’s Agent Forwarding</strong> </h2>



<p>Successful exploitation of this vulnerability allows a remote attacker to execute arbitrary commands on vulnerable OpenSSH forwarded ssh-agent.  Qualys security researchers have been able to independently verify the vulnerability, develop a PoC exploit on installations of Ubuntu Desktop 22.04 and 21.10. Other Linux distributions are likely vulnerable and probably exploitable. </p>



<p>As soon as the Qualys research team confirmed the vulnerability, Qualys engaged in responsible vulnerability disclosure and coordinated with the vendor, OpenSSH, on this occasion to announce the vulnerability. </p>







<h2 id="disclosure-timeline">Disclosure Timeline </h2>



<p>2023-07-06: Draft advisory and initial patch sent to OpenSSH. </p>



<p>2023-07-07: OpenSSH sent refined patches. </p>



<p>2023-07-09: Feedback on patches sent to OpenSSH. </p>



<p>2023-07-11: Received final patches from OpenSSH; feedback sent. </p>



<p>2023-07-14: OpenSSH plans for security-only release on July 19th. </p>



<p>2023-07-19: Coordinated release. </p>







<h2 id="technical-details"><strong>Technical Details</strong></h2>



<p>You can find the technical details of these vulnerabilities at:  </p>



<p><a rel="noreferrer noopener" href="https://www.qualys.com/2023/07/19/cve-2023-38408/rce-openssh-forwarded-ssh-agent.txt" target="_blank">https://www.qualys.com/2023/07/19/cve-2023-38408/rce-openssh-forwarded-ssh-agent.txt</a></p>



<p><a href="https://www.qualys.com/2023/07/19/cve-2023-38408/rce-openssh-forwarded-ssh-agent.tar.gz">https://www.qualys.com/2023/07/19/cve-2023-38408/rce-openssh-forwarded-ssh-agent.tar.gz</a></p>







<h2 id="conclusion"><strong>Conclusion</strong> </h2>



<p>This newly uncovered ssh-agent vulnerability underlines the continuous need for rigorous security measures and immediate response. Even robust systems can harbor hidden vulnerabilities, as demonstrated by the shortcomings of the ssh-agent. Proactively rectifying such vulnerabilities through actions such as implementing patches is critical to maintaining the integrity of digital assets.  </p>

		</div>
	</div>

	
</article>


<!-- #comments -->

	</main><!-- #main -->


</div><!-- .q-main_content-container -->
</div></div>
  </body>
</html>
