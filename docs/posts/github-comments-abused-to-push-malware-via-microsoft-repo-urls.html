<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.bleepingcomputer.com/news/security/github-comments-abused-to-push-malware-via-microsoft-repo-urls/">Original</a>
    <h1>GitHub comments abused to push malware via Microsoft repo URLs</h1>
    
    <div id="readability-page-1" class="page"><div>
<p><img alt="GitHub" height="900" src="https://www.bleepstatic.com/content/hl-images/2021/05/10/GitHub-headpic.jpg" width="1804"/></p>
<p>A GitHub flaw, or possibly a design decision, is being abused by threat actors to distribute malware using URLs associated with a Microsoft repository, making the files appear trustworthy.</p>
<p>While most of the malware activity has been based around the Microsoft GitHub URLs, this &#34;flaw&#34; could be abused with any public repository on GitHub, allowing threat actors to create very convincing lures.</p>
<h2>Abusing GitHub&#39;s file upload feature</h2>
<p>Yesterday, McAfee released a report on a <a href="https://www.bleepingcomputer.com/news/security/fake-cheat-lures-gamers-into-spreading-infostealer-malware/" target="_blank">new LUA malware loader</a> distributed through what appeared to be a legitimate Microsoft GitHub repository for the &#34;C++ Library Manager for Windows, Linux, and MacOS,&#34; known as <a href="https://github.com/microsoft/vcpkg" target="_blank" rel="nofollow noopener">vcpkg</a>.</p>
<p>The URLs for the malware installers, shown below, clearly indicate that they belong to the Microsoft repo, but we could not find any reference to the files in the project&#39;s source code.</p>
<pre><code>https://github[.]com/microsoft/vcpkg/files/14125503/Cheat.Lab.2.7.2.zip
https://github[.]com/microsoft/STL/files/14432565/Cheater.Pro.1.6.0.zip
</code></pre>
<p>Finding it strange that a Microsoft repo would be <a href="http://urlhaus.abuse.ch/url/2760438/" target="_blank" rel="nofollow noopener">distributing malware since February</a>, BleepingComputer looked into it and found that the files are not part of <em>vcpkg</em> but were uploaded as part of a comment left on a commit or issue in the project.</p>
<p>When leaving a comment, a GitHub user can attach a file, which will be uploaded to GitHub&#39;s CDN and associated with the related project using a unique URL in this format: &#39;<em>https://www.github.com/{project_user}/{repo_name}/files/{file_id}/{file_name}.</em>&#39;</p>
<p>Instead of generating the URL after a comment is posted, GitHub automatically generates the download link after you add the file to an unsaved comment, as shown below. This allows threat actors to attach their malware to any repository without them knowing.</p>
<div>
<figure><img alt="Download link auto-generated when adding a file to a comment" height="300" src="https://www.bleepstatic.com/images/news/security/g/github/github-file-uploads/github-comment-file-upload.jpg" width="795"/><figcaption><strong>Download link auto-generated when adding a file to a comment</strong></figcaption></figure></div>
<p>Even if you decide not to post the comment or delete it after it is posted, the files are not deleted from GitHub&#39;s CDN, and the download URLs continue to work forever.</p>
<p>As the file&#39;s URL contains the name of the repository the comment was created in, and as almost every software company uses GitHub, this flaw can allow threat actors to develop extraordinarily crafty and trustworthy lures.</p>
<p>For example, a threat actor could upload a malware executable in <a href="https://github.com/NVIDIA/nvidia-installer" target="_blank" rel="nofollow noopener">NVIDIA&#39;s driver installer repo</a> that pretends to be a new driver fixing issues in a popular game. Or a threat actor could upload a file in a comment to the <a href="https://github.com/chromium/chromium" target="_blank" rel="nofollow noopener">Google Chromium source code</a> and pretend it&#39;s a new test version of the web browser.</p>
<p>These URLs would also appear to belong to the company&#39;s repositories, making them far more trustworthy.</p>
<p>Unfortunately, even if a company learns their repos are abused to distribute malware, BleepingComputer could not find any settings that allow you to manage files attached to your projects.</p>
<p>Furthermore, you can only protect a GitHub account from being abused in this way and tarnishing your reputation by disabling comments. According to this <a href="https://docs.github.com/en/communities/moderating-comments-and-conversations/limiting-interactions-in-your-repository" target="_blank" rel="nofollow noopener">GitHub support document</a>, you can only temporarily disable comments for a maximum of six months at a time.</p>
<p>However, restricting comments can significantly impact a project&#39;s development as it will not allow users to report bugs or suggestions.</p>
<p>Sergei Frankoff, of automated malware analysis service UNPACME, did a livestream on Twitch about this bug just last month, saying that threat actors were actively abusing it.</p>
<blockquote>
<p dir="ltr" lang="en">Weeks later... GitHub bug still dropping malware <a href="https://t.co/s165zOAsoI" rel="nofollow noopener">pic.twitter.com/s165zOAsoI</a></p>
â€” herrcore (@herrcore) <a href="https://twitter.com/herrcore/status/1772988192678969567?ref_src=twsrc%5Etfw" rel="nofollow noopener">March 27, 2024</a></blockquote>
<p>As part of our research into this bug, BleepingComputer could only find one other repo, <a href="https://urlhaus.abuse.ch/url/2780254/" target="_blank" rel="nofollow noopener">httprouter</a>, abused to distribute malware in this way, and it was the same &#39;Cheater.Pro.1.6.0.zip&#39; as seen in Microsoft&#39;s URLs.</p>
<p>However, Frankoff told BleepingComputer that they <a href="https://research.openanalysis.net/github/lua/2024/03/03/lua-malware.html" target="_blank" rel="nofollow noopener">discovered a similar campaign in March</a> that utilizes the same LUA loader malware, which is called <a href="https://www.unpac.me/results/f3a0a729-afcf-4209-9323-fbf470be2835#/" target="_blank" rel="nofollow noopener">SmartLoader</a>, disguised as the Aimmy cheat software.</p>
<p>Frankoff told BleepingComputer that SmartLoader is commonly installed alongside other payloads, such as the RedLine information-stealing malware.</p>
<p>BleepingComputer contacted both GitHub and Microsoft on Thursday about this abuse but did not receive a response.</p>
<p>At the time of this publication, the information-stealing malware is still being distributed through links associated with Microsoft&#39; GitHub repository.</p>

</div></div>
  </body>
</html>
