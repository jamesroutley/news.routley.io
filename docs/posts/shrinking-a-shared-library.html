<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://serge-sans-paille.github.io/pythran-stories/shrinking-a-shared-library.html">Original</a>
    <h1>Shrinking a Shared Library</h1>
    
    <div id="readability-page-1" class="page"><p>Recently, I&#39;ve submitted a <a href="https://phabricator.services.mozilla.com/D179806">patch</a> that shaves ~2.5MB on one
of the core Firefox library, <tt>libxul.so</tt>. The patch is remarkably simple, but
it&#39;s a good opportunity to dive into some techniques to shrink binary size.</p><div id="generic-approach">
<h2>Generic Approach</h2>
<p>We&#39;ll use the <a href="https://github.com/madler/zlib">libz</a> library
from the official <a href="https://zlib.net/">zlib</a> as an example program to build. In
this series, we use revision <strong>1.2.13</strong>, sha1 <strong>04f42ceca40f73e2978b50e93806c2a18c1281fc</strong>.</p>
<p>The compiler used is clang <strong>14.0.5</strong>, the linker used is lld.</p>
<div id="compilation-levels">
<h3>Compilation Levels</h3>
<p>Let&#39;s start with the obvious approach and explore the effect of the various
optimization levels <tt><span>-O0</span></tt>, <tt><span>-O1</span></tt>, <tt><span>-Oz</span></tt>, <tt><span>-O2</span></tt> and <tt><span>-O3</span></tt>.</p>
<p>The <tt>size</tt> program <em>list section sizes and total size of binary files</em>, that&#39;s
perfectly suited to our needs. We will dive into its detailed output later.</p>
<div><pre><span></span><span>for</span><span> </span>opt<span> </span><span>in</span><span> </span>-O0<span> </span>-O1<span> </span>-O2<span> </span>-O3<span> </span>-Oz
<span>do</span>
<span>        </span>rm<span> </span>-rf<span> </span>_build
<span>        </span>mkdir<span> </span>_build
<span>        </span><span>(</span><span>cd</span><span> </span>./_build<span> </span><span>;</span><span> </span><span>LDFLAGS</span><span>=</span>-fuse-ld<span>=</span>lld<span> </span><span>CFLAGS</span><span>=</span><span>$opt</span><span> </span><span>CC</span><span>=</span>clang<span> </span>../configure<span> </span><span>&amp;&amp;</span><span> </span>make<span>)</span><span> </span><span>1</span>&gt;/dev/null
<span>        </span>size<span> </span>-A<span> </span>_build/libz.so<span> </span><span>|</span><span> </span>awk<span> </span>-v<span> </span><span>cflag</span><span>=</span><span>$opt</span><span> </span><span>&#39;/Total/ { printf &#34;%8s: %8d\n&#34;, cflag, $2 }&#39;</span>
<span>done</span>
</pre></div>
<table>
<caption>Impact of optimization level on binary size for libz.so</caption>
<colgroup>
<col width="50%"/>
<col width="50%"/>
</colgroup>
<thead>
<tr><th>CFLAGS</th>
<th>size</th>
</tr>
</thead>
<tbody>
<tr><td>-O0</td>
<td>141608</td>
</tr>
<tr><td>-O1</td>
<td>88164</td>
</tr>
<tr><td>-O2</td>
<td>99532</td>
</tr>
<tr><td>-O3</td>
<td>101644</td>
</tr>
<tr><td>-Oz</td>
<td>81006</td>
</tr>
</tbody>
</table>
<p>Unsurprisingly <tt><span>-Oz</span></tt> yields the smaller binaries. , and <tt><span>-O0</span></tt> performs a
direct translation which uses a lot of space. Performing basic optimizations as
<tt><span>-O1</span></tt> does generally lead to code shrinking because the optimized assembly is
more dense, and it looks like some of the optimization added by <tt><span>-O2</span></tt> generate
more instructions (Could be the result of <em>inlining</em> or <em>loop unrolling</em>).
<tt><span>-O3</span></tt> trades even more binary size for performance (could be the result of
<em>function specialization</em> or more aggressive <em>inlining</em>).</p>
</div>
<div id="link-time-optimization">
<h3>Link Time Optimization</h3>
<p>Interestingly, using the various flavor of <tt><span>-flto</span></tt> also have an effect on the binary size:</p>
<div><pre><span></span>$<span> </span><span>LDFLAGS</span><span>=</span>-fuse-ld<span>=</span>lld<span>\ </span>-flto<span>=</span>full<span> </span><span>CFLAGS</span><span>=</span>-Oz<span>\ </span>-flto<span>=</span>full<span> </span><span>CC</span><span>=</span>clang<span> </span>../configure<span> </span><span>&amp;&amp;</span><span> </span>make<span> </span><span>&amp;&amp;</span><span> </span>size<span> </span>-A<span> </span>libz.so
<span>[</span>...<span>]</span>
Total<span>                    </span><span>80971</span>
</pre></div>
<div><pre><span></span>$<span> </span><span>LDFLAGS</span><span>=</span>-fuse-ld<span>=</span>lld<span>\ </span>-flto<span>=</span>full<span> </span><span>CFLAGS</span><span>=</span>-O2<span>\ </span>-flto<span>=</span>full<span> </span><span>CC</span><span>=</span>clang<span> </span>../configure<span> </span><span>&amp;&amp;</span><span> </span>make<span> </span><span>&amp;&amp;</span><span> </span>size<span> </span>-A<span> </span>libz.so
<span>[</span>...<span>]</span>
Total<span>                   </span><span>102868</span>
</pre></div>
<div><pre><span></span>$<span> </span><span>LDFLAGS</span><span>=</span>-fuse-ld<span>=</span>lld<span>\ </span>-flto<span>=</span>thin<span> </span><span>CFLAGS</span><span>=</span>-Oz<span>\ </span>-flto<span>=</span>thin<span> </span><span>CC</span><span>=</span>clang<span> </span>../configure<span> </span><span>&amp;&amp;</span><span> </span>make<span> </span><span>&amp;&amp;</span><span> </span>size<span> </span>-A<span> </span>libz.so
<span>[</span>...<span>]</span>
Total<span>                    </span><span>82096</span>
</pre></div>
<div><pre><span></span>$<span> </span><span>LDFLAGS</span><span>=</span>-fuse-ld<span>=</span>lld<span>\ </span>-flto<span>=</span>thin<span> </span><span>CFLAGS</span><span>=</span>-O2<span>\ </span>-flto<span>=</span>thin<span> </span><span>CC</span><span>=</span>clang<span> </span>../configure<span> </span><span>&amp;&amp;</span><span> </span>make<span> </span><span>&amp;&amp;</span><span> </span>size<span> </span>-A<span> </span>libz.so
<span>[</span>...<span>]</span>
Total<span>                   </span><span>102464</span>
</pre></div>
<p>Again, nothing surprising: having access to more information (through
<tt><span>-flto=full</span></tt>) gives more optimization space than <tt><span>-flto=thin</span></tt> which
(slightly) trades performance of the generated binary for memory usage of the
actual compilation process. A trade-off we do not need to make for zlib but it&#39;s
another story for big project like Firefox.</p>
</div>
<div id="a-note-on-stripping">
<h3>A Note on Stripping</h3>
<p>It&#39;s very common to compile a code with debug information:</p>
<div><pre><span></span>$<span> </span><span>LDFLAGS</span><span>=</span>-fuse-ld<span>=</span>lld<span>\ </span>-flto<span>=</span>full<span> </span><span>CFLAGS</span><span>=</span>-Oz<span>\ </span>-g<span>\ </span>-flto<span>=</span>full<span> </span><span>CC</span><span>=</span>clang<span> </span>../configure<span> </span><span>&amp;&amp;</span><span> </span>make<span> </span><span>&amp;&amp;</span><span> </span>size<span> </span>-A<span> </span>libz.so
<span>[</span>...<span>]</span>
.debug_loc<span>               </span><span>89689</span><span>       </span><span>0</span>
.debug_abbrev<span>             </span><span>1716</span><span>       </span><span>0</span>
.debug_info<span>              </span><span>33472</span><span>       </span><span>0</span>
.debug_ranges<span>             </span><span>3744</span><span>       </span><span>0</span>
.debug_str<span>                </span><span>5422</span><span>       </span><span>0</span>
.debug_line<span>              </span><span>29136</span><span>       </span><span>0</span>
Total<span>                   </span><span>244152</span>
</pre></div>
<p>The impact of debug information on code size is significant. We can compress
them using <tt>dwz</tt> for a minor gain:</p>
<div><pre><span></span>$<span> </span>dwz<span> </span>libz.so<span> </span><span>&amp;&amp;</span><span> </span>size<span> </span>-A<span> </span>libz.so
<span>[</span>...<span>]</span>
.debug_loc<span>               </span><span>89689</span><span>       </span><span>0</span>
.debug_abbrev<span>             </span><span>1728</span><span>       </span><span>0</span>
.debug_info<span>              </span><span>27563</span><span>       </span><span>0</span>
.debug_ranges<span>             </span><span>3744</span><span>       </span><span>0</span>
.debug_str<span>                </span><span>5422</span><span>       </span><span>0</span>
.debug_line<span>              </span><span>29136</span><span>       </span><span>0</span>
Total<span>                   </span><span>238255</span>
</pre></div>
<p>We usually do not ship debug info as part of a binary, yet we may want to keep minimal ones:</p>
<div><pre><span></span>$<span> </span><span>LDFLAGS</span><span>=</span>-fuse-ld<span>=</span>lld<span>\ </span>-flto<span>=</span>full<span> </span><span>CFLAGS</span><span>=</span>-Oz<span>\ </span>-gline-tables-only<span>\ </span>-flto<span>=</span>full<span> </span><span>CC</span><span>=</span>clang<span> </span>../configure<span> </span><span>&amp;&amp;</span><span> </span>make<span> </span><span>&amp;&amp;</span><span> </span>size<span> </span>-A<span> </span>libz.so
<span>[</span>...<span>]</span>
Total<span>                   </span><span>113441</span>
</pre></div>
<p>The usual approach though is to separate debug information from the actual
binary (e.g. through <tt>objcopy <span>--only-keep-debug</span></tt>) then stripping it:</p>
<div><pre><span></span>$<span> </span>strip<span> </span>libz.so<span> </span><span>&amp;&amp;</span><span> </span>size<span> </span>-A<span> </span>libz.so
<span>[</span>...<span>]</span>
Total<span>                   </span><span>80755</span>
</pre></div>
<p>It even removes some extra bytes (by shrinking the section
<tt>.gnu.build.attributes</tt>)!</p>
</div>
</div><div id="specializing-the-binary">
<h2>Specializing the Binary</h2>
<p>For a given scenario, we may be ok with removing some of the capability of the
binary in exchange for smaller binaries.</p>
<div id="removing-eh-frame">
<h3>Removing <tt>.eh_frame</tt></h3>
<p>The complete result of the best setup we have (let&#39;s forget about stripping), <tt><span>CFLAGS=-Oz\</span> <span>-flto=full</span></tt>, is:</p>
<div><pre><span></span>$<span> </span>size<span> </span>-A<span> </span>libz.so
libz.so<span>  </span>:
section<span>                  </span>size<span>    </span>addr
.note.gnu.build-id<span>         </span><span>24</span><span>     </span><span>624</span>
.dynsym<span>                  </span><span>2616</span><span>     </span><span>648</span>
.gnu.version<span>              </span><span>218</span><span>    </span><span>3264</span>
.gnu.version_d<span>            </span><span>420</span><span>    </span><span>3484</span>
.gnu.version_r<span>             </span><span>48</span><span>    </span><span>3904</span>
.gnu.hash<span>                 </span><span>712</span><span>    </span><span>3952</span>
.dynstr<span>                  </span><span>1478</span><span>    </span><span>4664</span>
.rela.dyn<span>                 </span><span>768</span><span>    </span><span>6144</span>
.rela.plt<span>                </span><span>1056</span><span>    </span><span>6912</span>
.rodata<span>                 </span><span>17832</span><span>    </span><span>7968</span>
.eh_frame_hdr<span>            </span><span>1076</span><span>   </span><span>25800</span>
.eh_frame<span>                </span><span>7764</span><span>   </span><span>26880</span>
.text<span>                   </span><span>44592</span><span>   </span><span>38752</span>
.init<span>                      </span><span>27</span><span>   </span><span>83344</span>
.fini<span>                      </span><span>13</span><span>   </span><span>83372</span>
.plt<span>                      </span><span>720</span><span>   </span><span>83392</span>
.data.rel.ro<span>              </span><span>352</span><span>   </span><span>88208</span>
.fini_array<span>                 </span><span>8</span><span>   </span><span>88560</span>
.init_array<span>                 </span><span>8</span><span>   </span><span>88568</span>
.dynamic<span>                  </span><span>432</span><span>   </span><span>88576</span>
.got<span>                       </span><span>32</span><span>   </span><span>89008</span>
.data<span>                       </span><span>0</span><span>   </span><span>93136</span>
.tm_clone_table<span>             </span><span>0</span><span>   </span><span>93136</span>
.got.plt<span>                  </span><span>376</span><span>   </span><span>93136</span>
.bss<span>                        </span><span>1</span><span>   </span><span>93512</span>
.gnu.build.attributes<span>     </span><span>288</span><span>       </span><span>0</span>
.comment<span>                  </span><span>110</span><span>       </span><span>0</span>
Total<span>                   </span><span>80971</span>
</pre></div>
<p>We can get rid of some bytes by removing support for stack unwinding:</p>
<div><pre><span></span>$<span> </span><span>LDFLAGS</span><span>=</span>-fuse-ld<span>=</span>lld<span>\ </span>-flto<span>=</span>full<span>\ </span>-Wl,--lto-O2<span> </span><span>CFLAGS</span><span>=</span>-Oz<span>\ </span>-flto<span>=</span>full<span>\ </span>-fno-unwind-tables<span>\ </span>-fno-exceptions<span>\ </span>-fno-asynchronous-unwind-tables<span>\ </span>-fomit-frame-pointer<span> </span><span>CC</span><span>=</span>clang<span> </span>../configure<span> </span><span>&amp;&amp;</span><span> </span>make<span> </span><span>&amp;&amp;</span><span> </span>size<span> </span>-A<span> </span>libz.so
<span>[</span>...<span>]</span>
libz.so<span>  </span>:
section<span>                  </span>size<span>    </span>addr
.note.gnu.build-id<span>         </span><span>24</span><span>     </span><span>624</span>
.dynsym<span>                  </span><span>2616</span><span>     </span><span>648</span>
.gnu.version<span>              </span><span>218</span><span>    </span><span>3264</span>
.gnu.version_d<span>            </span><span>420</span><span>    </span><span>3484</span>
.gnu.version_r<span>             </span><span>48</span><span>    </span><span>3904</span>
.gnu.hash<span>                 </span><span>712</span><span>    </span><span>3952</span>
.dynstr<span>                  </span><span>1478</span><span>    </span><span>4664</span>
.rela.dyn<span>                 </span><span>768</span><span>    </span><span>6144</span>
.rela.plt<span>                </span><span>1056</span><span>    </span><span>6912</span>
.rodata<span>                 </span><span>17832</span><span>    </span><span>7968</span>
.eh_frame_hdr<span>              </span><span>12</span><span>   </span><span>25800</span>
.eh_frame<span>                   </span><span>4</span><span>   </span><span>25812</span>
.text<span>                   </span><span>44592</span><span>   </span><span>29920</span>
.init<span>                      </span><span>27</span><span>   </span><span>74512</span>
.fini<span>                      </span><span>13</span><span>   </span><span>74540</span>
.plt<span>                      </span><span>720</span><span>   </span><span>74560</span>
.data.rel.ro<span>              </span><span>352</span><span>   </span><span>79376</span>
.fini_array<span>                 </span><span>8</span><span>   </span><span>79728</span>
.init_array<span>                 </span><span>8</span><span>   </span><span>79736</span>
.dynamic<span>                  </span><span>432</span><span>   </span><span>79744</span>
.got<span>                       </span><span>32</span><span>   </span><span>80176</span>
.data<span>                       </span><span>0</span><span>   </span><span>84304</span>
.tm_clone_table<span>             </span><span>0</span><span>   </span><span>84304</span>
.got.plt<span>                  </span><span>376</span><span>   </span><span>84304</span>
.bss<span>                        </span><span>1</span><span>   </span><span>84680</span>
.gnu.build.attributes<span>     </span><span>288</span><span>       </span><span>0</span>
.comment<span>                  </span><span>110</span><span>       </span><span>0</span>
Total<span>                   </span><span>72147</span>
</pre></div>
<p>We reduced the <tt>.eh_frame</tt> and <tt>.eh_frame_hdr</tt> sections at the expense of
removing support for stack unwinding. Again, it&#39;s a trade-off but one we may want
to make. Keep in mind the frame pointer and the exception frame are very helpful
to debug a core file!</p>
</div>
<div id="specializing-for-a-given-usage">
<h3>Specializing for a given usage</h3>
<p>Now let&#39;s compile the example code <tt>minigzip.c</tt> (it&#39;s part of zlib source code) while linking with our shared library, and examine the used symbols:</p>
<div><pre><span></span>$<span> </span>clang<span> </span>../test/minigzip.c<span> </span>-o<span> </span>minizip<span> </span>-L.<span> </span>-lz
$<span> </span>nm<span> </span>minizip<span> </span><span>|</span><span> </span>grep<span> </span><span>&#39; U &#39;</span>
<span>                 </span>U<span> </span>exit@GLIBC_2.2.5
<span>                 </span>U<span> </span>fclose@GLIBC_2.2.5
<span>                 </span>U<span> </span>ferror@GLIBC_2.2.5
<span>                 </span>U<span> </span>fileno@GLIBC_2.2.5
<span>                 </span>U<span> </span>fopen@GLIBC_2.2.5
<span>                 </span>U<span> </span>fprintf@GLIBC_2.2.5
<span>                 </span>U<span> </span>fread@GLIBC_2.2.5
<span>                 </span>U<span> </span>fwrite@GLIBC_2.2.5
<span>                 </span>U<span> </span>gzclose
<span>                 </span>U<span> </span>gzdopen
<span>                 </span>U<span> </span>gzerror
<span>                 </span>U<span> </span>gzopen
<span>                 </span>U<span> </span>gzread
<span>                 </span>U<span> </span>gzwrite
<span>                 </span>U<span> </span>__libc_start_main@GLIBC_2.34
<span>                 </span>U<span> </span>perror@GLIBC_2.2.5
<span>                 </span>U<span> </span>snprintf@GLIBC_2.2.5
<span>                 </span>U<span> </span>strcmp@GLIBC_2.2.5
<span>                 </span>U<span> </span>strlen@GLIBC_2.2.5
<span>                 </span>U<span> </span>strrchr@GLIBC_2.2.5
<span>                 </span>U<span> </span>unlink@GLIBC_2.2.5
</pre></div>
<p>In addition to symbols from the libc, it uses a few symbols from zlib.
This doesn&#39;t cover the whole zlib ABI though. Let&#39;s shrink the library just for our
usage using a version script that only references the symbols we want to use:</p>
<div><pre><span></span>$<span> </span>cat<span> </span>../zlib.map
MYZLIB_1<span> </span><span>{</span>
<span>    </span>global:
<span>                 </span>gzclose<span>;</span>
<span>                 </span>gzdopen<span>;</span>
<span>                 </span>gzerror<span>;</span>
<span>                 </span>gzopen<span>;</span>
<span>                 </span>gzread<span>;</span>
<span>                 </span>gzwrite<span>;</span>
<span>    </span>local:
<span>      </span>*<span>;</span>
<span>}</span><span>;</span>
</pre></div>
<p>And pass this to the linker:</p>
<div><pre><span></span>$<span> </span><span>LDFLAGS</span><span>=</span>-fuse-ld<span>=</span>lld<span>\ </span>-flto<span>=</span>full<span>\ </span>-Wl,--gc-sections<span>\ </span>-Wl,--version-script,../zlib.map<span> </span><span>CFLAGS</span><span>=</span>-Oz<span>\ </span>-flto<span>=</span>full<span>&#34; -fno-unwind-tables -fno-exceptions -fno-asynchronous-unwind-tables -fomit-frame-pointer -ffunction-sections -fdata-sections&#34;</span><span>  </span><span>CC</span><span>=</span>clang<span> </span>../configure<span> </span><span>&amp;&amp;</span><span> </span>make<span> </span>placebo<span> </span><span>&amp;&amp;</span><span> </span>size<span> </span>-A<span> </span>libz.so
<span>[</span>...<span>]</span>
libz.so<span>  </span>:
section<span>                  </span>size<span>    </span>addr
.note.gnu.build-id<span>         </span><span>24</span><span>     </span><span>624</span>
.dynsym<span>                   </span><span>576</span><span>     </span><span>648</span>
.gnu.version<span>               </span><span>48</span><span>    </span><span>1224</span>
.gnu.version_d<span>             </span><span>84</span><span>    </span><span>1272</span>
.gnu.version_r<span>             </span><span>48</span><span>    </span><span>1356</span>
.gnu.hash<span>                  </span><span>60</span><span>    </span><span>1408</span>
.dynstr<span>                   </span><span>281</span><span>    </span><span>1468</span>
.rela.dyn<span>                 </span><span>528</span><span>    </span><span>1752</span>
.rela.plt<span>                 </span><span>336</span><span>    </span><span>2280</span>
.rodata<span>                 </span><span>15320</span><span>    </span><span>2624</span>
.eh_frame_hdr<span>              </span><span>12</span><span>   </span><span>17944</span>
.eh_frame<span>                   </span><span>4</span><span>   </span><span>17956</span>
.init<span>                      </span><span>27</span><span>   </span><span>22056</span>
.fini<span>                      </span><span>13</span><span>   </span><span>22084</span>
.text<span>                   </span><span>32608</span><span>   </span><span>22112</span>
.plt<span>                      </span><span>240</span><span>   </span><span>54720</span>
.data.rel.ro<span>              </span><span>272</span><span>   </span><span>59056</span>
.fini_array<span>                 </span><span>8</span><span>   </span><span>59328</span>
.init_array<span>                 </span><span>8</span><span>   </span><span>59336</span>
.dynamic<span>                  </span><span>432</span><span>   </span><span>59344</span>
.got<span>                       </span><span>32</span><span>   </span><span>59776</span>
.tm_clone_table<span>             </span><span>0</span><span>   </span><span>63904</span>
.got.plt<span>                  </span><span>136</span><span>   </span><span>63904</span>
.bss<span>                        </span><span>1</span><span>   </span><span>64040</span>
.gnu.build.attributes<span>     </span><span>288</span><span>       </span><span>0</span>
.comment<span>                  </span><span>110</span><span>       </span><span>0</span>
Total<span>                   </span><span>51496</span>
</pre></div>
<p>The linker uses the visibility information to iteratively remove code
that&#39;s never referenced.</p>
</div>
<div id="concluding-notes">
<h3>Concluding Notes</h3>
<p>Some of the remaining sections are purely informational. For instance:</p>
<div><pre><span></span>$<span> </span>objdump<span> </span>-s<span> </span>-j<span> </span>.comment<span> </span>libz.so

<span> </span><span>0000</span><span> </span>4743433a<span> </span>2028474e<span> </span><span>55292031</span><span> </span>322e322e<span>  </span>GCC:<span> </span><span>(</span>GNU<span>)</span><span> </span><span>12</span>.2.
<span> </span><span>0010</span><span> </span><span>31203230</span><span> </span><span>32323131</span><span> </span><span>32312028</span><span> </span><span>52656420</span><span>  </span><span>1</span><span> </span><span>20221121</span><span> </span><span>(</span>Red
<span> </span><span>0020</span><span> </span><span>48617420</span><span> </span>31322e32<span> </span>2e312d34<span> </span>2900004c<span>  </span>Hat<span> </span><span>12</span>.2.1-4<span>)</span>..L
<span> </span><span>0030</span><span> </span>696e6b65<span> </span>723a204c<span> </span>4c442031<span> </span>342e302e<span>  </span>inker:<span> </span>LLD<span> </span><span>14</span>.0.
<span> </span><span>0040</span><span> </span>3500636c<span> </span>616e6720<span> </span><span>76657273</span><span> </span>696f6e20<span>  </span><span>5</span>.clang<span> </span>version
<span> </span><span>0050</span><span> </span>31342e30<span> </span>2e352028<span> </span>4665646f<span> </span><span>72612031</span><span>  </span><span>14</span>.0.5<span> </span><span>(</span>Fedora<span> </span><span>1</span>
<span> </span><span>0060</span><span> </span>342e302e<span> </span>352d322e<span> </span><span>66633336</span><span> </span><span>2900</span><span>      </span><span>4</span>.0.5-2.fc36<span>)</span>.
</pre></div>
<p>That&#39;s just some compiler version information, we can safely drop them:</p>
<div><pre><span></span>$<span> </span>objcopy<span> </span>-R<span> </span>.comment<span> </span>libz.s
$<span> </span>size<span> </span>-A<span> </span>libz.so
<span>[</span>...<span>]</span>
Total<span>                   </span><span>51386</span>
</pre></div>
<p>We could probably shave a few extra bytes, but we already came a long way ☺.</p>
</div>
<div id="acknowledgments">
<h3>Acknowledgments</h3>
<p>Thanks to <strong>Sylvestre Ledru</strong> and <strong>Lancelot Six</strong> for proof-reading this post.
You rock!</p>
</div>
</div></div>
  </body>
</html>
