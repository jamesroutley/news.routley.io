<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/alufers/mitmproxy2swagger">Original</a>
    <h1>MitmProxy2Swagger: Automagically reverse-engineer REST APIs</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto"><a href="https://badge.fury.io/py/mitmproxy2swagger" rel="nofollow"><img src="https://camo.githubusercontent.com/18c1534b2b1e7a23bf322f06d52749c1a511f391fb6cb7153339e71fa93a3b97/68747470733a2f2f62616467652e667572792e696f2f70792f6d69746d70726f787932737761676765722e737667" alt="PyPI version" data-canonical-src="https://badge.fury.io/py/mitmproxy2swagger.svg"/></a>
<a href="https://archlinux.org/packages/extra/any/mitmproxy2swagger/" rel="nofollow"><img src="https://camo.githubusercontent.com/65853a26d224252b94a0df6938cab3da25f7afa499508cdb9df96fbbeae00b7f/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f617263686c696e75782d6d69746d70726f787932737761676765722d626c7565" alt="Arch Linux repository" data-canonical-src="https://img.shields.io/badge/archlinux-mitmproxy2swagger-blue"/></a></p>
<details open="">
  <summary>
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M16 3.75v8.5a.75.75 0 0 1-1.136.643L11 10.575v.675A1.75 1.75 0 0 1 9.25 13h-7.5A1.75 1.75 0 0 1 0 11.25v-6.5C0 3.784.784 3 1.75 3h7.5c.966 0 1.75.784 1.75 1.75v.675l3.864-2.318A.75.75 0 0 1 16 3.75Zm-6.5 1a.25.25 0 0 0-.25-.25h-7.5a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-6.5ZM11 8.825l3.5 2.1v-5.85l-3.5 2.1Z"></path>
</svg>
    <span aria-label="Video description video.mp4">video.mp4</span>
    <span></span>
  </summary>

  <video src="https://private-user-images.githubusercontent.com/5400940/168086818-c48f60ab-3f95-42eb-b435-c8b1a6326b81.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzU4NDI0NjUsIm5iZiI6MTczNTg0MjE2NSwicGF0aCI6Ii81NDAwOTQwLzE2ODA4NjgxOC1jNDhmNjBhYi0zZjk1LTQyZWItYjQzNS1jOGIxYTYzMjZiODEubXA0P1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDEwMiUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMDJUMTgyMjQ1WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9OGMyMTMyYWZlOWY3MDdmOTkwZjhjY2RlMjYzNWVkZjU2M2M3OWY2NDYzZTZkZWI3ZjdlOGQzMTRjMGMwMmM5NiZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.7EWghAe4pgeGSQC7KkeJ9DzSLL31R6pUkQJrz3y9PYY" data-canonical-src="https://private-user-images.githubusercontent.com/5400940/168086818-c48f60ab-3f95-42eb-b435-c8b1a6326b81.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzU4NDI0NjUsIm5iZiI6MTczNTg0MjE2NSwicGF0aCI6Ii81NDAwOTQwLzE2ODA4NjgxOC1jNDhmNjBhYi0zZjk1LTQyZWItYjQzNS1jOGIxYTYzMjZiODEubXA0P1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDEwMiUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMDJUMTgyMjQ1WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9OGMyMTMyYWZlOWY3MDdmOTkwZjhjY2RlMjYzNWVkZjU2M2M3OWY2NDYzZTZkZWI3ZjdlOGQzMTRjMGMwMmM5NiZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.7EWghAe4pgeGSQC7KkeJ9DzSLL31R6pUkQJrz3y9PYY" controls="controls" muted="muted">

  </video>
</details>

<p dir="auto">A tool for automatically converting <a href="https://mitmproxy.org/" rel="nofollow">mitmproxy</a> captures to <a href="https://swagger.io/specification/" rel="nofollow">OpenAPI 3.0</a> specifications. This means that you can automatically reverse-engineer REST APIs by just running the apps and capturing the traffic.</p>
<hr/>
<p dir="auto"><strong>ðŸ†• NEW!</strong></p>
<p dir="auto">Added support for processing HAR exported from the browser DevTools. See <a href="#har">Usage - HAR</a> for more details.</p>
<hr/>

<p dir="auto">First you will need python3 and pip3.</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ pip install mitmproxy2swagger
# ... or ...
$ pip3 install mitmproxy2swagger
# ... or ...
$ git clone git@github.com:alufers/mitmproxy2swagger.git
$ cd mitmproxy2swagger
$ docker build -t mitmproxy2swagger ."><pre>$ pip install mitmproxy2swagger
<span><span>#</span> ... or ...</span>
$ pip3 install mitmproxy2swagger
<span><span>#</span> ... or ...</span>
$ git clone git@github.com:alufers/mitmproxy2swagger.git
$ <span>cd</span> mitmproxy2swagger
$ docker build -t mitmproxy2swagger <span>.</span></pre></div>
<p dir="auto">Then clone the repo and run <code>mitmproxy2swagger</code> as per examples below.</p>


<p dir="auto">To create a specification by inspecting HTTP traffic you will need to:</p>
<ol dir="auto">
<li>
<p dir="auto">Capture the traffic by using the mitmproxy tool. I personally recommend using mitmweb, which is a web interface built-in to mitmproxy.</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ mitmweb
Web server listening at http://127.0.0.1:8081/
Proxy server listening at http://*:9999
..."><pre>$ mitmweb
Web server listening at http://127.0.0.1:8081/
Proxy server listening at http://<span>*</span>:9999
...</pre></div>
<p dir="auto"><strong>IMPORTANT</strong></p>
<p dir="auto">To configure your client to use the proxy exposed by mitm proxy, please consult the <a href="https://docs.mitmproxy.org/stable/" rel="nofollow">mitmproxy documentation</a> for more information.</p>
</li>
<li>
<p dir="auto">Save the traffic to a flow file.</p>
<p dir="auto">In mitmweb you can do this by using the &#34;File&#34; menu and selecting &#34;Save&#34;:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/alufers/mitmproxy2swagger/blob/master/docs/mitmweb_save.png"><img src="https://github.com/alufers/mitmproxy2swagger/raw/master/docs/mitmweb_save.png" alt="A screenshot showing the location of the &#34;Save&#34; option in the &#34;File&#34; menu"/></a></p>
</li>
<li>
<p dir="auto">Run the first pass of mitmproxy2swagger:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ mitmproxy2swagger -i &lt;path_to_mitmptoxy_flow&gt; -o &lt;path_to_output_schema&gt; -p &lt;api_prefix&gt;
# ... or ...
$ docker run -it -v $PWD:/app mitmproxy2swagger mitmproxy2swagger -i &lt;path_to_mitmptoxy_flow&gt; -o &lt;path_to_output_schema&gt; -p &lt;api_prefix&gt;"><pre>$ mitmproxy2swagger -i <span>&lt;</span>path_to_mitmptoxy_flow<span>&gt;</span> -o <span>&lt;</span>path_to_output_schema<span>&gt;</span> -p <span>&lt;</span>api_prefix<span>&gt;</span>
<span><span>#</span> ... or ...</span>
$ docker run -it -v <span>$PWD</span>:/app mitmproxy2swagger mitmproxy2swagger -i <span>&lt;</span>path_to_mitmptoxy_flow<span>&gt;</span> -o <span>&lt;</span>path_to_output_schema<span>&gt;</span> -p <span>&lt;</span>api_prefix<span>&gt;</span></pre></div>
<p dir="auto">Please note that you can use an existing schema, in which case the existing schema will be extended with the new data. You can also run it a few times with different flow captures, the captured data will be safely merged.</p>
<p dir="auto"><code>&lt;api_prefix&gt;</code> is the base url of the API you wish to reverse-engineer. You will need to obtain it by observing the requests being made in mitmproxy.</p>
<p dir="auto">For example if an app has made requests like these:</p>
<div dir="auto" data-snippet-clipboard-copy-content="https://api.example.com/v1/login
https://api.example.com/v1/users/2
https://api.example.com/v1/users/2/profile"><pre><span>https://api.example.com/v1/login</span>
<span>https://api.example.com/v1/users/2</span>
<span>https://api.example.com/v1/users/2/profile</span></pre></div>
<p dir="auto">The likely prefix is <code>https://api.example.com/v1</code>.</p>
</li>
<li>
<p dir="auto">Running the first pass should have created a section in the schema file like this:</p>
<div dir="auto" data-snippet-clipboard-copy-content="x-path-templates:
  # Remove the ignore: prefix to generate an endpoint with its URL
  # Lines that are closer to the top take precedence, the matching is greedy
  - ignore:/addresses
  - ignore:/basket
  - ignore:/basket/add
  - ignore:/basket/checkouts
  - ignore:/basket/coupons/attach/{id}
  - ignore:/basket/coupons/attach/104754"><pre><span>x-path-templates</span>:
  <span><span>#</span> Remove the ignore: prefix to generate an endpoint with its URL</span>
  <span><span>#</span> Lines that are closer to the top take precedence, the matching is greedy</span>
  - <span>ignore:/addresses</span>
  - <span>ignore:/basket</span>
  - <span>ignore:/basket/add</span>
  - <span>ignore:/basket/checkouts</span>
  - <span>ignore:/basket/coupons/attach/{id}</span>
  - <span>ignore:/basket/coupons/attach/104754</span></pre></div>
<p dir="auto">You should edit the schema file with a text editor and remove the <code>ignore:</code> prefix from the paths you wish to be generated. You can also adjust the parameters appearing in the paths.</p>
</li>
<li>
<p dir="auto">Run the second pass of mitmproxy2swagger:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ mitmproxy2swagger -i &lt;path_to_mitmptoxy_flow&gt; -o &lt;path_to_output_schema&gt; -p &lt;api_prefix&gt; [--examples]
# ... or ...
$ docker run -it -v $PWD:/app mitmproxy2swagger mitmproxy2swagger -i &lt;path_to_mitmptoxy_flow&gt; -o &lt;path_to_output_schema&gt; -p &lt;api_prefix&gt; [--examples]"><pre>$ mitmproxy2swagger -i <span>&lt;</span>path_to_mitmptoxy_flow<span>&gt;</span> -o <span>&lt;</span>path_to_output_schema<span>&gt;</span> -p <span>&lt;</span>api_prefix<span>&gt;</span> [--examples]
<span><span>#</span> ... or ...</span>
$ docker run -it -v <span>$PWD</span>:/app mitmproxy2swagger mitmproxy2swagger -i <span>&lt;</span>path_to_mitmptoxy_flow<span>&gt;</span> -o <span>&lt;</span>path_to_output_schema<span>&gt;</span> -p <span>&lt;</span>api_prefix<span>&gt;</span> [--examples]</pre></div>
<p dir="auto">Run the command a second time (with the same schema file). It will pick up the edited lines and generate endpoint descriptions.</p>
<p dir="auto">Please note that mitmproxy2swagger will not overwrite existing endpoint descriptions, if you want to overwrite them, you can delete them before running the second pass.</p>
<p dir="auto">Passing <code>--examples</code> will add example data to requests and responses. Take caution when using this option, as it may add sensitive data (tokens, passwords, personal information etc.) to the schema.
Passing <code>--headers</code> will add headers data to requests and responses. Take caution when using this option, as it may add sensitive data (tokens, passwords, personal information etc.) to the schema.</p>
</li>
</ol>

<ol dir="auto">
<li>
<p dir="auto">Capture and export the traffic from the browser DevTools.</p>
<p dir="auto">In the browser DevTools, go to the Network tab and click the &#34;Export HAR&#34; button.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/alufers/mitmproxy2swagger/blob/master/docs/export_har_button.png"><img src="https://github.com/alufers/mitmproxy2swagger/raw/master/docs/export_har_button.png" alt="A screenshot showing where the export har button is located"/></a></p>
</li>
<li>
<p dir="auto">Continue the same way you would do with the mitmproxy dump. <code>mitmproxy2swagger</code> will automatically detect the HAR file and process it.</p>
</li>
</ol>

<p dir="auto">See the <a href="https://github.com/alufers/mitmproxy2swagger/blob/master/example_outputs">examples</a>. You will find a generated schema there and an html file with the generated documentation (via <a href="https://www.npmjs.com/package/redoc-cli" rel="nofollow">redoc-cli</a>).</p>
<p dir="auto">See the generated html file <a href="https://raw.githack.com/alufers/mitmproxy2swagger/master/example_outputs/lisek-static.html" rel="nofollow">here</a>.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Development and contributing</h2><a id="user-content-development-and-contributing" aria-label="Permalink: Development and contributing" href="#development-and-contributing"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">This project uses:</p>
<ul dir="auto">
<li><a href="https://python-poetry.org/" rel="nofollow">poetry</a> for dependency management</li>
<li><a href="https://pre-commit.com/" rel="nofollow">pre-commit</a> for code formatting and linting</li>
<li><a href="https://docs.pytest.org/en/stable/" rel="nofollow">pytest</a> for unit testing</li>
</ul>
<p dir="auto">To install the dependencies:</p>

<p dir="auto">Run linters:</p>
<div dir="auto" data-snippet-clipboard-copy-content="pre-commit run --all-files"><pre>pre-commit run --all-files</pre></div>
<p dir="auto">Install pre-commit hooks:</p>

<p dir="auto">Run tests:</p>

<p dir="auto">Run tests with coverage:</p>
<div dir="auto" data-snippet-clipboard-copy-content="poetry run pytest --cov=mitmproxy2swagger"><pre>poetry run pytest --cov=mitmproxy2swagger</pre></div>

<p dir="auto">MIT</p>
</article></div></div>
  </body>
</html>
